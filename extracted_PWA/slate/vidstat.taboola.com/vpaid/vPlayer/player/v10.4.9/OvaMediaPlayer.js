!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(50)},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e){if(!e)return!1;var t=parseInt(e.get("ga_factor"));if(null!==se||!t)return se;if(1===t)return se=!0;t>100&&(t=100);var i=v(0,t);return se=i===t}function o(e){if(e=Math.max(Math.min(100,e),0),0===e)return!1;if(1===e)return!0;var t=this.getRandomInt(0,e);return t===e}function a(e,t,i){s(i)&&h(e,t,i)}function d(e,t,i,n){s(n)&&p(e,t,i,n)}function l(e,t,i){s(i)&&f(e,t,i)}function u(e){return e?1:0}function c(e){return""+(e.requiredViewabilityDrawn?"!ronrv":"")+(e.moatSampling?"!mtsmp":"")}function h(e,t,i){var n=i.get("player_version"),r=i.get("ab_test")||"";r=""+r+c(t.tag);var s=new XMLHttpRequest;s.open("POST",i.get("kbnul")+"/putes",!0);var o={event:e,timestamp:(new Date).toISOString(),version:n,abTest:r};o=Object.assign(o,t),s.send(I(o))}function p(e,t,i,n){var r=n.get("player_version"),s=n.get("ab_test")||"",o=new XMLHttpRequest;o.open("POST",n.get("kbnul")+"/putes/"+e,!0);var a={event:t,timestamp:(new Date).toISOString(),version:r,abTest:s};a=Object.assign(a,i),o.send(I(a))}function f(e,t,i){var n=i.get("player_version"),r=new XMLHttpRequest;r.open("POST",i.get("kbnul")+"/putes/vast",!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e=Object.assign(e,{version:n,timestamp:(new Date).toISOString()},t),r.send(I(e))}function v(e,t){var i=Math.floor(Math.random()*(t-e+1))+e;return i}function m(e,t){var i=oe,n=[],r=0;for(t=t||i.length,e=e||22,r=0;r<e;r++)n[r]=i[0|Math.random()*t];return n.join("")}function g(e){return"string"!=typeof e?e:(e=e.replace(/^(http[s]?:|ftp:)/g,""),0!==e.indexOf("//")&&(e="//"+e),e)}function y(e){if(!e||"string"!=typeof e)return 0;var t;e=b(e);var i="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";"undefined"==typeof t&&(t=0);var n=0,r=0;t^=-1;for(var s=0,o=e.length;s<o;s++)r=255&(t^e.charCodeAt(s)),n="0x"+i.substr(9*r,8),t=t>>>8^n;return t^-1}function _(e){var t=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n]+)/im.exec(e);return t&&t.length?t[1]:null}function b(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}function w(e){var t=0,i={"pre-roll":0,preroll:0,"mid-roll":-1,midroll:-1,"post-roll":-2,postroll:-2};return i.hasOwnProperty(e)&&(t=i[e]),t}function k(e){return e.replace(/\s/g,"")}function A(e,t){e.className.indexOf(t)===-1&&(e.className+=" "+t),e.className=e.className.split("  ").join(" ")}function T(e,t){e.className=e.className.split(t).join("").split("  ").join(" ")}function C(e){var t={};for(var i in e)if(e.hasOwnProperty(i))if("object"==ee(e[i])){var n=C(e[i]);for(var r in n)n.hasOwnProperty(r)&&"function"!=typeof n[r]&&(t[i+"_"+r]=n[r])}else t[i]=e[i];return t}function E(e){try{return JSON.parse(I(e))}catch(e){return{}}}function P(e,t,i,n,r){var s=this;try{!r&&e.contentWindow.console.error&&(e.contentWindow.console.error=function(){});var o="iframe"==e.tagName.toLowerCase()?e.contentDocument:e;if(!o)return;var a=o.querySelectorAll(t);a.forEach(function(e){s.DOMIterator(e,t,i,n,r)}),i(o.querySelectorAll(n))}catch(e){return}}function S(e){if(!e)return null;for(var t=e.querySelector("iframe");t;)try{t=t.contentDocument.querySelector("iframe")}catch(e){break}return t}function V(e,t){return{current:e,hasNext:function(){try{return!t&&e.contentWindow.console.error&&(this.current.contentWindow.console.error=function(){}),this.current=this.current.contentDocument.querySelector("iframe"),!0}catch(e){return!1}}}}function x(e){try{return/\{\s*\[native code\]\s*\}/.test(e.toString())}catch(e){return!0}}function I(e,t){try{var i,n=[],r=null;x(Array.prototype.toJSON)||(r=Array.prototype.toJSON,delete Array.prototype.toJSON),i=JSON.stringify(e,function(e,t){if(null!=t&&"object"==("undefined"==typeof t?"undefined":ee(t))){if(n.indexOf(t)>-1)return;n.push(t)}return t},t)}catch(e){i=""}return null!==r&&(Array.prototype.toJSON=r),i}function O(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e&&e.push(t,i,n,r)}function D(e){return e>1?e/100:e}function M(e){return parseInt(e)}function R(e){return e<1e3?1e3*e:e}function F(e){var t=window.cmTag&&window.cmTag.config?window.cmTag.config:{baseReportD:"taboola.com",dataCenter:"am"},i=e.get("baseReportD")||t.baseReportD,n=e.get("dataCenter")||t.dataCenter;return{baseReportD:i,dataCenter:n}}function L(e,t){var i={cijs:"convusmp",ttype:e,cisd:"convusmp",cipid:t.get("cipid")||"",crid:t.get("creativeId")||"",dast:t.get("auc_dast")||"",cmcv:"",uv:t.get("unit_version")||"",unm:t.get("unit_type")||"",cb:Date.now(),abt:t.get("ab_test")||""};return i=Object.assign(i,F(t))}function B(e){var t="//conv"+e.dataCenter+"mp."+e.baseReportD+"/st?";for(var i in e)t+=i+"="+e[i]+"&";var n=document.createElement("img");n.src=t}function j(e,t){return e.filter(function(e){var i=t&&e.hasOwnProperty(t)?e[t]:e;return void 0!==i})}function H(e){var t={};return e.forEach(function(e){t[e.key]=e.value}),t}function U(e,t){for(var i in e)if(e[i]===t)return i;return""}function N(e){var t=e.split("."),i=t[0],n=i.split(":"),r=0,s=1;for(2===t.length&&(r+=parseInt(t[1])/1e3);n.length>0;)r+=s*parseInt(n.pop(),10),s*=60;return r}function W(e,t,i){var n=t.get("creatives"),r=encodeURIComponent(n.VIDEO_URL&&n.VIDEO_URL.url?n.VIDEO_URL.url:n.VIDEO_URL),s=(new Date).getTime(),o=null;return i&&(o=t.get("adxCardSize")),e=e.replace(/(%%|\[)referrer(%%|\])/gi,n.REFERRER),e=e.replace(/(%%|\[)domain(%%|\])/gi,n.DOMAIN),e=e.replace(/(%%|\[)video-url(%%|\])/gi,r),e=e.replace(/(%%|\[)page-url(%%|\])/gi,n.PAGE_URL),e=e.replace(/(%%|\[)player-width(%%|\])/gi,o?o.width:n.PLAYER_WIDTH),e=e.replace(/(%%|\[)player-height(%%|\])/gi,o?o.height:n.PLAYER_HEIGHT),e=e.replace(/(%%|\[)timestamp(%%|\])/gi,Math.floor(s/1e3)),e=e.replace(/(%%|\[)vidlength(%%|\])/gi,n.VIDLENGTH),e=e.replace(/(%%|\[)keywords(%%|\])/gi,n.KEY_WORDS),e=e.replace(/(%%|\[)description(%%|\])/gi,n.DESCRIPTION),e=e.replace(/(%%|\[)vertical(%%|\])/gi,n.VERTICAL),e=e.replace(/(%%|\[)tag(%%|\])/gi,n.TAG?n.TAG:""),e=e.replace(/(%%|\[)title(%%|\])/gi,n.TITLE),e=e.replace(/(%%|\[)cirf(%%|\])/gi,encodeURIComponent(decodeURIComponent(n.CIRF))),e=e.replace(/(%%|\[)cb(%%|\])/gi,"R0."+s),e=e.replace(/(%%|\[)country(%%|\])/gi,t.get("country")),e=e.replace(/(%%|\[)ip(%%|\])/gi,t.get("ip")),e=e.replace(/(%%|\[)ua(%%|\])/gi,encodeURIComponent(navigator.userAgent)),e=e.replace(/(%%|\[)dast(%%|\])/gi,t.get("auc_dast")||""),e=e.replace(/%%[^%]*%%/gi,"")}function z(){return ie.UAParser(window.navigator.userAgent)}function q(e){for(var t,i=JSON.stringify(e),n="",r="PlAyER",s=0;s<i.length;s++)t=s%r.length,n+=String.fromCharCode(i[s].charCodeAt(0).toString(10)^r[t].charCodeAt(0).toString(10));try{n=btoa(n)}catch(e){return!1}return n}function G(e,t,i){var n=e.document.createElement("script");n.type="text/javascript",n.innerHTML=t,n.onload=function(){i&&i()},n.onerror=function(e){i&&i(e)},e.document.head.appendChild(n)}function K(e){return e.get("usscrtgurl")||"https:"===window.location.protocol&&e.get("httpsOverride")}function Q(e){return"https:"===window.location.protocol&&e.get("scrmf")}function X(e){return e.replace(/\//g,"_").replace(/\+/g,"-")}function Y(e){return X(btoa(unescape(encodeURIComponent(I(e)))))}function $(e){if(!e)return re.default.undefinedError;try{if(e.eventData){var t=I(e.eventData),i=t.match(re.default.codesMatcher);if(i&&i[0])return parseInt(i[0]);if(t.toLowerCase().match(re.default.noAdsMatcher))return re.default.schemaValidationError;if(t.toLowerCase().match("timeout"))return re.default.timeout}}catch(e){}return re.default.undefinedError}function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"content",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=e.get("videoElement");return new r({decodeUrl:e.get("dcdvdurl"),secureMediaFiles:e.get("scrmf"),isMobile:e.get("isMobile"),isMultiVpaidUnit:e.get("isMultiVpaidUnit"),logToBI:n||function(){},videoState:i,canvas:{force:e.get("forcecnvsmpg"),onAutoplayDetected:t.onAutoplayDetected||function(){},dataSaverServerSide:e.get("dataSaver"),dataSaverUrl:e.get("dtsvrurl"),disableWebGl:e.get("dsbgl"),parent:t.target||document.body,defaultVolume:e.get("dfltvlm"),aspectRatio:e.get("playerAspectRatio"),canvasLoadRate:e.get("cnvsldrt"),mpegServerBaseUrl:e.get("gtvid2"),additionalCss:t.additionalCss||{},repeat:e.get("repeat")||!1,useAutoplayForContent:e.get("useapforcntnt")||!1}})}function Z(e,t){return e.match(new RegExp(t+"$"))}Object.defineProperty(t,"__esModule",{value:!0});var ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.shouldReport=s,t.shouldFirePixels=o,t.reportDb=a,t.reportByIndex=d,t.reportVastToDb=l,t.boolToInt=u,t.addAbTests=c,t.getRandomInt=v,t.generateGuid=m,t.setUrlPrefix=g,t.crc32=y,t.stripDomain=_,t.getStreamType=w,t.trim=k,t.addClass=A,t.removeClass=T,t.flattenObject=C,t.deepClone=E,t.DOMIterator=P,t.getDeepestIframe=S,t.domIframeIterator=V,t.isNativeCode=x,t.stringify=I,t.logToBI=O,t.normalizeVolume=D,t.roundNumericValue=M,t.normalizeMilliseconds=R,t.createPixelBaseUrlParams=F,t.createPixelParams=L,t.sendPixel=B,t.filterUndefinededValues=j,t.flattenKeys=H,t.getObjectKeyByValue=U,t.hmsmToSecondsOnly=N,t.replaceMacros=W,t.parseUserAgent=z,t.encodeText=q,t.injectResource=G,t.shouldSecureWfUrl=K,t.shouldSecureWrapperAndMediaFile=Q,t.escapeBase64=X,t.encodeData=Y,t.getIABErrorCode=$,t.createVideoElement=J,t.endsWith=Z;var te=i(155),ie=r(te),ne=i(28),re=n(ne),se=null,oe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split("")},function(e,t,i){!function(i,n){e.exports=t=n()}(this,function(){var e=e||function(e,t){var i=Object.create||function(){function e(){}return function(t){var i;return e.prototype=t,i=new e,e.prototype=null,i}}(),n={},r=n.lib={},s=r.Base=function(){return{extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=s.extend({init:function(e,i){e=this.words=e||[],i!=t?this.sigBytes=i:this.sigBytes=4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes,r=e.sigBytes;if(this.clamp(),n%4)for(var s=0;s<r;s++){var o=i[s>>>2]>>>24-s%4*8&255;t[n+s>>>2]|=o<<24-(n+s)%4*8}else for(var s=0;s<r;s+=4)t[n+s>>>2]=i[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i,n=[],r=function(t){var t=t,i=987654321,n=4294967295;return function(){i=36969*(65535&i)+(i>>16)&n,t=18e3*(65535&t)+(t>>16)&n;var r=(i<<16)+t&n;return r/=4294967296,r+=.5,r*(e.random()>.5?1:-1)}},s=0;s<t;s+=4){var a=r(4294967296*(i||e.random()));i=987654071*a(),n.push(4294967296*a()|0)}return new o.init(n,t)}}),a=n.enc={},d=a.Hex={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],r=0;r<i;r++){var s=t[r>>>2]>>>24-r%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new o.init(i,t/2)}},l=a.Latin1={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],r=0;r<i;r++){var s=t[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new o.init(i,t)}},u=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},c=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,r=i.sigBytes,s=this.blockSize,a=4*s,d=r/a;d=t?e.ceil(d):e.max((0|d)-this._minBufferSize,0);var l=d*s,u=e.min(4*l,r);if(l){for(var c=0;c<l;c+=s)this._doProcessBlock(n,c);var h=n.splice(0,l);i.sigBytes-=u}return new o.init(h,u)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(r.Hasher=c.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new h.HMAC.init(e,i).finalize(t)}}}),n.algo={});return n}(Math);return e})},function(e,t,i){(function(t,n){"use strict";function r(){try{var e=P;return P=null,e.apply(this,arguments)}catch(e){return x.e=e,x}}function s(e){return P=e,r}function o(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function a(e){return"function"==typeof e||"object"==typeof e&&null!==e}function d(e){return o(e)?new Error(g(e)):e}function l(e,t){var i,n=e.length,r=new Array(n+1);for(i=0;i<n;++i)r[i]=e[i];return r[i]=t,r}function u(e,t,i){if(!S.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var n=Object.getOwnPropertyDescriptor(e,t);return null!=n?null==n.get&&null==n.set?n.value:i:void 0}function c(e,t,i){if(o(e))return e;var n={value:i,configurable:!0,enumerable:!1,writable:!0};return S.defineProperty(e,t,n),e}function h(e){throw e}function p(e){try{if("function"==typeof e){var t=S.names(e.prototype),i=S.isES5&&t.length>1,n=t.length>0&&!(1===t.length&&"constructor"===t[0]),r=M.test(e+"")&&S.names(e).length>0;if(i||n||r)return!0}return!1}catch(e){return!1}}function f(e){function t(){}function i(){return typeof n.foo}t.prototype=e;var n=new t;return i(),i(),e}function v(e){return R.test(e)}function m(e,t,i){for(var n=new Array(e),r=0;r<e;++r)n[r]=t+r+i;return n}function g(e){try{return e+""}catch(e){return"[no string representation]"}}function y(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function _(e){try{c(e,"isOperational",!0)}catch(e){}}function b(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0)}function w(e){return y(e)&&S.propertyIsWritable(e,"stack")}function k(e){return{}.toString.call(e)}function A(e,t,i){for(var n=S.names(e),r=0;r<n.length;++r){var s=n[r];if(i(s))try{S.defineProperty(t,s,S.getDescriptor(e,s))}catch(e){}}}function T(e){return H?n.env[e]:void 0}function C(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(e){}}function E(e,t){return e.bind(t)}var P,S=i(8),V="undefined"==typeof navigator,x={e:{}},I="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof t?t:void 0!==this?this:null,O=function(e,t){function i(){this.constructor=e,this.constructor$=t;for(var i in t.prototype)n.call(t.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=t.prototype[i])}var n={}.hasOwnProperty;return i.prototype=t.prototype,e.prototype=new i,e.prototype},D=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var i=0;i<e.length;++i)if(e[i]===t)return!0;return!1};if(S.isES5){var i=Object.getOwnPropertyNames;return function(e){for(var n=[],r=Object.create(null);null!=e&&!t(e);){var s;try{s=i(e)}catch(e){return n}for(var o=0;o<s.length;++o){var a=s[o];if(!r[a]){r[a]=!0;var d=Object.getOwnPropertyDescriptor(e,a);null!=d&&null==d.get&&null==d.set&&n.push(a)}}e=S.getPrototypeOf(e)}return n}}var n={}.hasOwnProperty;return function(i){if(t(i))return[];var r=[];e:for(var s in i)if(n.call(i,s))r.push(s);else{for(var o=0;o<e.length;++o)if(n.call(e[o],s))continue e;r.push(s)}return r}}(),M=/this\s*\.\s*\S+\s*=/,R=/^[a-z$_][a-z$_0-9]*$/i,F=function(){return"stack"in new Error?function(e){return w(e)?e:new Error(g(e))}:function(e){if(w(e))return e;try{throw new Error(g(e))}catch(e){return e}}}(),L=function(e){return S.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var B="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,i=[],n=e[Symbol.iterator]();!(t=n.next()).done;)i.push(t.value);return i};L=function(e){return S.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?B(e):null}}var j="undefined"!=typeof n&&"[object process]"===k(n).toLowerCase(),H="undefined"!=typeof n&&"undefined"!=typeof n.env,U={isClass:p,isIdentifier:v,inheritedDataKeys:D,getDataPropertyOrDefault:u,thrower:h,isArray:S.isArray,asArray:L,notEnumerableProp:c,isPrimitive:o,isObject:a,isError:y,canEvaluate:V,errorObj:x,tryCatch:s,inherits:O,withAppended:l,maybeWrapAsError:d,toFastProperties:f,filledRange:m,toString:g,canAttachTrace:w,ensureErrorObject:F,originatesFromRejection:b,markAsOriginatingFromRejection:_,classString:k,copyDescriptors:A,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:j,hasEnvVariables:H,env:T,global:I,getNativePromise:C,domainBind:E};U.isRecentNode=U.isNode&&function(){var e;return n.versions&&n.versions.node?e=n.versions.node.split(".").map(Number):n.version&&(e=n.version.split(".").map(Number)),0===e[0]&&e[1]>10||e[0]>0}(),U.isNode&&U.toFastProperties(n);try{throw new Error}catch(e){U.lastLineError=e}e.exports=U}).call(t,function(){return this}(),i(16))},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(9))}(this,function(e){e.lib.Cipher||function(t){var i=e,n=i.lib,r=n.Base,s=n.WordArray,o=n.BufferedBlockAlgorithm,a=i.enc,d=(a.Utf8,a.Base64),l=i.algo,u=l.EvpKDF,c=n.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?A:b}return function(t){return{encrypt:function(i,n,r){return e(n).encrypt(t,i,n,r)},decrypt:function(i,n,r){return e(n).decrypt(t,i,n,r)}}}}()}),h=(n.StreamCipher=c.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),i.mode={}),p=n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=h.CBC=function(){function e(e,i,n){var r=this._iv;if(r){var s=r;this._iv=t}else var s=this._prevBlock;for(var o=0;o<n;o++)e[i+o]^=s[o]}var i=p.extend();return i.Encryptor=i.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize;e.call(this,t,i,r),n.encryptBlock(t,i),this._prevBlock=t.slice(i,i+r)}}),i.Decryptor=i.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,s=t.slice(i,i+r);n.decryptBlock(t,i),e.call(this,t,i,r),this._prevBlock=s}}),i}(),v=i.pad={},m=v.Pkcs7={pad:function(e,t){for(var i=4*t,n=i-e.sigBytes%i,r=n<<24|n<<16|n<<8|n,o=[],a=0;a<n;a+=4)o.push(r);var d=s.create(o,n);e.concat(d)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(n.BlockCipher=c.extend({cfg:c.cfg.extend({mode:f,padding:m}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,i=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=i.createEncryptor;else{var n=i.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(i,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),y=i.format={},_=y.OpenSSL={stringify:function(e){var t=e.ciphertext,i=e.salt;if(i)var n=s.create([1398893684,1701076831]).concat(i).concat(t);else var n=t;return n.toString(d)},parse:function(e){var t=d.parse(e),i=t.words;if(1398893684==i[0]&&1701076831==i[1]){var n=s.create(i.slice(2,4));i.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:n})}},b=n.SerializableCipher=r.extend({cfg:r.extend({format:_}),encrypt:function(e,t,i,n){n=this.cfg.extend(n);var r=e.createEncryptor(i,n),s=r.finalize(t),o=r.cfg;return g.create({ciphertext:s,key:i,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,i,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var r=e.createDecryptor(i,n).finalize(t.ciphertext);return r},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),w=i.kdf={},k=w.OpenSSL={execute:function(e,t,i,n){n||(n=s.random(8));var r=u.create({keySize:t+i}).compute(e,n),o=s.create(r.words.slice(t),4*i);return r.sigBytes=4*t,g.create({key:r,iv:o,salt:n})}},A=n.PasswordBasedCipher=b.extend({cfg:b.cfg.extend({kdf:k}),encrypt:function(e,t,i,n){n=this.cfg.extend(n);var r=n.kdf.execute(i,e.keySize,e.ivSize);n.iv=r.iv;var s=b.encrypt.call(this,e,t,r.key,n);return s.mixIn(r),s},decrypt:function(e,t,i,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var r=n.kdf.execute(i,e.keySize,e.ivSize,t.salt);n.iv=r.iv;var s=b.decrypt.call(this,e,t,r.key,n);return s}})}()})},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.label="["+t+"]",this.isDevelopModeOn=this.debugLevels.indexOf("develop")>-1,this.isTrackerOn=this.debugLevels.indexOf("*")>-1||this.debugLevels.indexOf("qa")>-1||this.isDevelopModeOn}return n(e,[{key:"table",value:function(e){this.isDevelopModeOn&&console.table(e)}},{key:"_templateLogging",value:function(e,t,i,n){if(this.isTrackerOn){var r="";for(var s in i)r+=s+": "+i[s]+"; ";"string"==typeof t?console[n]("%c"+this.label+" ["+e+"] "+t,r):console[n]("%c"+this.label+" ["+e+"]",r,t)}}},{key:"debug",value:function(e,t,i){}},{key:"error",value:function(e,t,i){this._templateLogging(e,t,i,"error")}},{key:"warn",value:function(e,t,i){this._templateLogging(e,t,i,"warn")}},{key:"info",value:function(e,t,i){this._templateLogging(e,t,i,"info")}},{key:"log",value:function(e,t,i){this._templateLogging(e,t,i,"log")}}]),e}();r.prototype.debugLevels="",t.default=r},function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function r(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,r,a,d,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(i=this._events[e],o(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(s(i))for(a=Array.prototype.slice.call(arguments,1),l=i.slice(),r=l.length,d=0;d<r;d++)l[d].apply(this,a);return!0},i.prototype.addListener=function(e,t){var r;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(r=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var r=!1;return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var i,r,o,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],o=i.length,r=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(a=o;a-- >0;)if(i[a]===t||i[a].listener&&i[a].listener===t){r=a;break}if(r<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],n(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,i){"use strict";function n(e,t){function i(n){return this instanceof i?(c(this,"message","string"==typeof n?n:t),c(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new i(n)}return u(i,Error),i}function r(e){return this instanceof r?(c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new r(e)}var s,o,a=i(8),d=a.freeze,l=i(3),u=l.inherits,c=l.notEnumerableProp,h=n("Warning","warning"),p=n("CancellationError","cancellation error"),f=n("TimeoutError","timeout error"),v=n("AggregateError","aggregate error");try{s=TypeError,o=RangeError}catch(e){s=n("TypeError","type error"),o=n("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(v.prototype[m[g]]=Array.prototype[m[g]]);a.defineProperty(v.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),v.prototype.isOperational=!0;var y=0;v.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var i=0;i<this.length;++i){for(var n=this[i]===this?"[Circular AggregateError]":this[i]+"",r=n.split("\n"),s=0;s<r.length;++s)r[s]=e+r[s];n=r.join("\n"),t+=n+"\n"}return y--,t},u(r,Error);var _=Error.__BluebirdErrorTypes__;_||(_=d({CancellationError:p,TimeoutError:f,OperationalError:r,RejectionError:r,AggregateError:v}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:_,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:s,RangeError:o,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:h}},function(e,t){var i=function(){"use strict";
return void 0===this}();if(i)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(e,t){var i=Object.getOwnPropertyDescriptor(e,t);return!(i&&!i.writable&&!i.set)}};else{var n={}.hasOwnProperty,r={}.toString,s={}.constructor.prototype,o=function(e){var t=[];for(var i in e)n.call(e,i)&&t.push(i);return t},a=function(e,t){return{value:e[t]}},d=function(e,t,i){return e[t]=i.value,e},l=function(e){return e},u=function(e){try{return Object(e).constructor.prototype}catch(e){return s}},c=function(e){try{return"[object Array]"===r.call(e)}catch(e){return!1}};e.exports={isArray:c,keys:o,names:o,defineProperty:d,getDescriptor:a,freeze:l,getPrototypeOf:u,isES5:i,propertyIsWritable:function(){return!0}}}},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(22),i(21))}(this,function(e){return function(){var t=e,i=t.lib,n=i.Base,r=i.WordArray,s=t.algo,o=s.MD5,a=s.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=this.cfg,n=i.hasher.create(),s=r.create(),o=s.words,a=i.keySize,d=i.iterations;o.length<a;){l&&n.update(l);var l=n.update(e).finalize(t);n.reset();for(var u=1;u<d;u++)l=n.finalize(l),n.reset();s.concat(l)}return s.sigBytes=4*a,s}});t.EvpKDF=function(e,t,i){return a.create(i).compute(e,t)}}(),e.EvpKDF})},function(e,t){"use strict";function i(e,t,i,n,r,s){function o(e,t,i,n,r,s,o){if(!e)return!1;t=t||"";var d=new XMLHttpRequest,l=t?"POST":"GET";return d.open(l,e,!0),d.withCredentials=!0,s===!1&&(d.withCredentials=!1),d.setRequestHeader("Content-type",u),d.async=void 0==r||r,d.callback="function"==typeof i?i:function(){},d.fallback="function"==typeof n?n:function(){},d.timeout=o,d.gotResponse=!1,d.addEventListener("error",function(e){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("load",function(e){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("abort",function(e){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("timeout",function(e){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("readystatechange",function(s){if(4==this.readyState){if(this.gotResponse)return;switch(this.gotResponse=!0,this.status+""){case"200":case"204":case"460":this.callback(this.responseText,p,e);break;default:if(!h)return p.push(this.status),void a(e,t,i,n,r,!1,o,this.status);p.push(this.status),this.fallback(p,e)}}}),d.send(t),!0}function a(e,t,i,n,r,s,a,l){h=!0,d&&(e+=(e.indexOf("?")>-1?"&":"?")+"rt=1&prst="+(l||"")),o(e,t,i,n,r,!1,a)}var d=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5e3,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"application/x-www-form-urlencoded",c=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],h=!c,p=[];o(e,t,i,n,r,s,l)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t){"use strict";e.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,adPlaying:40,adLoaded:41,startAd:42,globalAdTimeout:53,adUnmuted:58,vpaidProgress:59,unloadPage:60,adDropped:61,blockedActionByHijack:62,fallBackCanvas:70,unfriendlyVideo:83,buffering:90,bufferingEnded:91,firstImpression:99}},function(e,t){"use strict";e.exports={AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt",Progress:"Progress",TimeUpdated:"TimeUpdated"}},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(){function t(e,t,i){for(var n=[],s=0,o=0;o<t;o++)if(o%4){var a=i[e.charCodeAt(o-1)]<<o%4*2,d=i[e.charCodeAt(o)]>>>6-o%4*2;n[s>>>2]|=(a|d)<<24-s%4*8,s++}return r.create(n,s)}var i=e,n=i.lib,r=n.WordArray,s=i.enc;s.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp();for(var r=[],s=0;s<i;s+=3)for(var o=t[s>>>2]>>>24-s%4*8&255,a=t[s+1>>>2]>>>24-(s+1)%4*8&255,d=t[s+2>>>2]>>>24-(s+2)%4*8&255,l=o<<16|a<<8|d,u=0;u<4&&s+.75*u<i;u++)r.push(n.charAt(l>>>6*(3-u)&63));var c=n.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var i=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var s=0;s<n.length;s++)r[n.charCodeAt(s)]=s}var o=n.charAt(64);if(o){var a=e.indexOf(o);a!==-1&&(i=a)}return t(e,i,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64})},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(t){function i(e,t,i,n,r,s,o){var a=e+(t&i|~t&n)+r+o;return(a<<s|a>>>32-s)+t}function n(e,t,i,n,r,s,o){var a=e+(t&n|i&~n)+r+o;return(a<<s|a>>>32-s)+t}function r(e,t,i,n,r,s,o){var a=e+(t^i^n)+r+o;return(a<<s|a>>>32-s)+t}function s(e,t,i,n,r,s,o){var a=e+(i^(t|~n))+r+o;return(a<<s|a>>>32-s)+t}var o=e,a=o.lib,d=a.WordArray,l=a.Hasher,u=o.algo,c=[];!function(){for(var e=0;e<64;e++)c[e]=4294967296*t.abs(t.sin(e+1))|0}();var h=u.MD5=l.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var o=0;o<16;o++){var a=t+o,d=e[a];e[a]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}var l=this._hash.words,u=e[t+0],h=e[t+1],p=e[t+2],f=e[t+3],v=e[t+4],m=e[t+5],g=e[t+6],y=e[t+7],_=e[t+8],b=e[t+9],w=e[t+10],k=e[t+11],A=e[t+12],T=e[t+13],C=e[t+14],E=e[t+15],P=l[0],S=l[1],V=l[2],x=l[3];P=i(P,S,V,x,u,7,c[0]),x=i(x,P,S,V,h,12,c[1]),V=i(V,x,P,S,p,17,c[2]),S=i(S,V,x,P,f,22,c[3]),P=i(P,S,V,x,v,7,c[4]),x=i(x,P,S,V,m,12,c[5]),V=i(V,x,P,S,g,17,c[6]),S=i(S,V,x,P,y,22,c[7]),P=i(P,S,V,x,_,7,c[8]),x=i(x,P,S,V,b,12,c[9]),V=i(V,x,P,S,w,17,c[10]),S=i(S,V,x,P,k,22,c[11]),P=i(P,S,V,x,A,7,c[12]),x=i(x,P,S,V,T,12,c[13]),V=i(V,x,P,S,C,17,c[14]),S=i(S,V,x,P,E,22,c[15]),P=n(P,S,V,x,h,5,c[16]),x=n(x,P,S,V,g,9,c[17]),V=n(V,x,P,S,k,14,c[18]),S=n(S,V,x,P,u,20,c[19]),P=n(P,S,V,x,m,5,c[20]),x=n(x,P,S,V,w,9,c[21]),V=n(V,x,P,S,E,14,c[22]),S=n(S,V,x,P,v,20,c[23]),P=n(P,S,V,x,b,5,c[24]),x=n(x,P,S,V,C,9,c[25]),V=n(V,x,P,S,f,14,c[26]),S=n(S,V,x,P,_,20,c[27]),P=n(P,S,V,x,T,5,c[28]),x=n(x,P,S,V,p,9,c[29]),V=n(V,x,P,S,y,14,c[30]),S=n(S,V,x,P,A,20,c[31]),P=r(P,S,V,x,m,4,c[32]),x=r(x,P,S,V,_,11,c[33]),V=r(V,x,P,S,k,16,c[34]),S=r(S,V,x,P,C,23,c[35]),P=r(P,S,V,x,h,4,c[36]),x=r(x,P,S,V,v,11,c[37]),V=r(V,x,P,S,y,16,c[38]),S=r(S,V,x,P,w,23,c[39]),P=r(P,S,V,x,T,4,c[40]),x=r(x,P,S,V,u,11,c[41]),V=r(V,x,P,S,f,16,c[42]),S=r(S,V,x,P,g,23,c[43]),P=r(P,S,V,x,b,4,c[44]),x=r(x,P,S,V,A,11,c[45]),V=r(V,x,P,S,E,16,c[46]),S=r(S,V,x,P,p,23,c[47]),P=s(P,S,V,x,u,6,c[48]),x=s(x,P,S,V,y,10,c[49]),V=s(V,x,P,S,C,15,c[50]),S=s(S,V,x,P,m,21,c[51]),P=s(P,S,V,x,A,6,c[52]),x=s(x,P,S,V,f,10,c[53]),V=s(V,x,P,S,w,15,c[54]),S=s(S,V,x,P,h,21,c[55]),P=s(P,S,V,x,_,6,c[56]),x=s(x,P,S,V,E,10,c[57]),V=s(V,x,P,S,g,15,c[58]),S=s(S,V,x,P,T,21,c[59]),P=s(P,S,V,x,v,6,c[60]),x=s(x,P,S,V,k,10,c[61]),V=s(V,x,P,S,p,15,c[62]),S=s(S,V,x,P,b,21,c[63]),l[0]=l[0]+P|0,l[1]=l[1]+S|0,l[2]=l[2]+V|0,l[3]=l[3]+x|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;i[r>>>5]|=128<<24-r%32;var s=t.floor(n/4294967296),o=n;i[(r+64>>>9<<4)+15]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[(r+64>>>9<<4)+14]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(i.length+1),this._process();for(var a=this._hash,d=a.words,l=0;l<4;l++){var u=d[l];d[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}});o.MD5=l._createHelper(h),o.HmacMD5=l._createHmacHelper(h)}(Math),e.MD5})},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(t){i(this,e),this.parent=t,this.events={},this.dispatchEvent=function e(t,i,n){var r=e.beacon;if(void 0==i&&(i={}),t&&r.events[t]){for(var s=0;s<r.events[t].useCapture.length;s++)r.events[t].useCapture[s].assignedFunction.apply(r.parent,[{dispatcher:n?n:r.parent,type:t,eventData:i,staticData:r.events[t].useCapture[s].static_data}]);for(var s=0;s<r.events[t].noCapture.length;s++)r.events[t].noCapture[s].assignedFunction.apply(r.parent,[{dispatcher:n?n:r.parent,type:t,eventData:i,staticData:r.events[t].noCapture[s].static_data}])}},this.dispatchEvent.beacon=this,this.removeEventListener=function e(t,i){var n=e.beacon;if(t){if(void 0==i&&n.events[t])return void(n.events[t]={useCapture:[],noCapture:[]});if(i&&n.events[t]&&"function"==typeof i){for(var r=[],s=0;s<n.events[t].useCapture.length;s++)n.events[t].useCapture[s].assignedFunction!=i&&r.push(n.events[t].useCapture[s]);n.events[t].useCapture=r,r=[];for(var s=0;s<n.events[t].noCapture.length;s++)n.events[t].noCapture[s].assignedFunction==i&&r.push(n.events[t].noCapture[s]);n.events[t].noCapture=r}}},this.removeEventListener.beacon=this,this.addEventListener=function e(t,i,n){var r=e.beacon;if(t&&"function"==typeof i){for(var s=[],o=3;o<arguments.length;o++)s.push(arguments[o]);r.events[t]||(r.events[t]={useCapture:[],noCapture:[]}),n?r.events[t].useCapture.push({assignedFunction:i,static_data:s}):r.events[t].noCapture.push({assignedFunction:i,static_data:s})}},this.addEventListener.beacon=this,this.listEvents=function e(){return Object.keys(e.beacon.events)},this.listEvents.beacon=this,this.listEventHandlers=function(e){var t=dispatchEvent.beacon;if(!e||!t.events[e])return[];var i,n=[];i=t.events[e].useCapture;for(var r=0;r<i;r++)n.push(t.events[e].useCapture[r]);i=t.events[e].noCapture;for(var r=0;r<i;r++)n.push(t.events[e].noCapture[r]);return n},this.listEventHandlers.beacon=this,this.destroy=function(){for(var e in self.events)self.events[e]=null;self.events={}}};t.default=n},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(e){if(u===setTimeout)return setTimeout(e,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function s(e){if(c===clearTimeout)return clearTimeout(e);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function o(){v&&p&&(v=!1,p.length?f=p.concat(f):m=-1,f.length&&a())}function a(){if(!v){var e=r(o);v=!0;for(var t=f.length;t;){for(p=f,f=[];++m<t;)p&&p[m].run();m=-1,t=f.length}p=null,v=!1,s(e)}}function d(e,t){this.fun=e,this.array=t}function l(){}var u,c,h=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(e){u=i}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(e){c=n}}();var p,f=[],v=!1,m=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];f.push(new d(e,t)),1!==f.length||v||r(a)},d.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.prependListener=l,h.prependOnceListener=l,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,i){!function(t,i){e.exports=i()}(window,function(){return function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}({"./index.js":function(e,t,i){"use strict";var n=i("./options.js"),r=i("./utils.js"),s=function(e,t){if("trc"===n.mcrsrvcsnmspc)try{return window.TRC[e][t]}catch(e){}if("cmTag"===n.mcrsrvcsnmspc)try{return window.cmTag.config.ms[e][t]}catch(e){}return null};e.exports={get:function(e,t,i,o){e=r.cleanServiceName(e),t=t||function(e){return n.serviceDefaultVersion[e]}(e);var a=s(e,t);if(a)i&&i(a);else{var d=document.createElement("script"),l=r.setUrlPrefix(n.base_url);d.async=n.async,d.type="text/javascript",d.src=l+(/.*\/$/g.test(l)?"":"/")+e+"/"+t+"/"+e+".js",d.onload=function(){document.head.removeChild(d);try{i&&i(s(e,t))}catch(e){o&&o()}},d.onerror=function(){document.head.removeChild(d),o&&o()},document.head.appendChild(d)}},init:function(e){for(var t in n)e.hasOwnProperty(t)&&(n[t]=e[t])}}},"./options.js":function(e,t,i){"use strict";e.exports={base_url:"//vidstat.taboola.com/",async:!0,mcrsrvcsnmspc:"trc",serviceDefaultVersion:{oppsula:"1.0.1"}}},"./utils.js":function(e,t,i){"use strict";e.exports={setUrlPrefix:function(e){return"string"!=typeof e?e:(0!==(e=e.replace(/^(http[s]?:|ftp:)/g,"")).indexOf("//")&&(e="//"+e),e)},cleanServiceName:function(e){return e.replace(/.js$/,"")}}},0:function(e,t,i){e.exports=i("./index.js")}})})},function(e,t){"use strict";e.exports={KPI:70,playerDisplayImpression:81,getAd:115,emptyWFResponse:91,noTagsInWFResponse:92,passbackOnEmptyFirstWF:97}},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(t){var i=e,n=i.lib,r=n.Base,s=n.WordArray,o=i.x64={};o.Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=r.extend({init:function(e,i){e=this.words=e||[],i!=t?this.sigBytes=i:this.sigBytes=8*e.length},toX32:function(){for(var e=this.words,t=e.length,i=[],n=0;n<t;n++){var r=e[n];i.push(r.high),i.push(r.low)}return s.create(i,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),i=t.length,n=0;n<i;n++)t[n]=t[n].clone();return e}})}(),e})},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(5),d=r(a),l=i(12),u=r(l),c=i(15),h=r(c),p=i(1),f=n(p),v=function(){function e(t,i,n){s(this,e),this.vpaidLog=i,this.store=n,this.type="adx",this.stopped=!1,this.target=t.slot,this.adxScript=t.tag.url,this.isAmp=this.store.get("isAmp"),this.debugTracker=new d.default("AdxVpaid"),this.baseUrl=this.store.get("base_url"),this._onError=t.onError,this.vpaidEvents=Object.assign({},u.default),this.beacon=new h.default(this),this.gotAd=!1,this.adxCardSize=this.store.get("adxCardSize"),this.isAmp?this._buildAmpMethods():this._buildNonAmpMethods(),f.logToBI(this.vpaidLog,"adxCard",{width:this.adxCardSize.width,height:this.adxCardSize.height,card:this.adxScript}),setTimeout(t.onReady,2)}return o(e,[{key:"_buildNonAmpMethods",value:function(){this._initAd=this._initOnNonAmpPage.bind(this),this._parseScript=this._parseScriptOnNonAmpPage.bind(this),this._startAd=this._startOnNonAmpPage.bind(this),this._didConvert=this._didConvertOnNonAmpPage.bind(this)}},{key:"_buildAmpMethods",value:function(){this._initAd=this._initOnAmpPage.bind(this),this._parseScript=this._parseScriptOnAmpPage.bind(this),this._startAd=this._startOnAmpPage.bind(this),this._didConvert=this._didConvertOnAmpPage.bind(this)}},{key:"subscribe",value:function(e,t){this.vpaidEvents[t]&&this.beacon.addEventListener(t,e)}},{key:"unsubscribe",value:function(e,t){if(this.vpaidEvents[t]){if(!e)return;this.beacon.removeEventListener(t,e)}}},{key:"handshakeVersion",value:function(e){return"2.0"}},{key:"initAd",value:function(e,t,i,n,r,s){if(!this.stopped){var o=this._parseScript((new DOMParser).parseFromString(this.adxScript,"text/html"));if(!o)return void this.beacon.dispatchEvent(this.vpaidEvents.AdError,{error:"parsingIssue"});this.adxContainer=document.createElement("div"),this.adxContainer.style.textAlign="center",this.resizeAd(this.store.get("width"),this.store.get("height")),this.target.appendChild(this.adxContainer),this._initAd(),this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,{})}}},{key:"_initOnNonAmpPage",value:function(){this.adxContainer.id=this.adxDivElement.id;var e=document.createElement("script"),t=document.createElement("script");e.src=this.adxScriptElements[0].src,e.async=!0,this.adxContainer.appendChild(e),t.innerText=this.adxScriptElements[1].innerText,this.adxContainer.appendChild(t)}},{key:"_initOnAmpPage",value:function(){var e=document.createElement("script");e.src="https://cdn.ampproject.org/amp4ads-v0.js",e.async=!0,document.head.appendChild(e)}},{key:"_parseScriptOnNonAmpPage",value:function(e){return this.adxScriptElements=e.getElementsByTagName("script"),this.adxDivElement=e.getElementsByTagName("div")[0],3===this.adxScriptElements.length}},{key:"_parseScriptOnAmpPage",value:function(e){return this.adxAmpAdElement=e.getElementsByTagName("amp-ad")[0],this.adxAmpAdElement}},{key:"_getMediaUrl",value:function(){return""}},{key:"startAd",value:function(){if(!this.stopped){var e=this._startAd();this.adxContainer.appendChild(e),this._waitForConversion()}}},{key:"_startOnNonAmpPage",value:function(){var e=document.createElement("script");return e.innerText=this.adxScriptElements[2].innerText,e}},{key:"_startOnAmpPage",value:function(){for(var e=document.createElement("amp-ad"),t=0;t<this.adxAmpAdElement.attributes.length;t++)e.setAttribute(this.adxAmpAdElement.attributes[t].name,this.adxAmpAdElement.attributes[t].value);return e}},{key:"_waitForConversion",value:function(){var e=this,t=Date.now();this.lookForAdxAdInterval=setInterval(function(){e.stopped||e._didGotAdxAd()&&(e.gotAd=!0,e.lookForAdxAdInterval=clearInterval(e.lookForAdxAdInterval),e.didGotAdxAdTimeout=clearTimeout(e.didGotAdxAdTimeout),f.logToBI(e.vpaidLog,"adxCard",{gotAd:!0,timeToImpression:Date.now()-t}),e.beacon.dispatchEvent(e.vpaidEvents.AdImpression))},100),this.didGotAdxAdTimeout=setTimeout(function(){e.stopped||(e.lookForAdxAdInterval=clearInterval(e.lookForAdxAdInterval),f.logToBI(e.vpaidLog,"adxCard",{gotAd:!1},!0),e.beacon.dispatchEvent(e.vpaidEvents.AdError,{error:"noFill"}))},this.store.get("adxcrdgtadtmt")||5e3)}},{key:"_didGotAdxAd",value:function(){try{for(var e=this.adxContainer.querySelectorAll("iframe"),t=0;t<e.length;t++)if(this._didConvert(e[t]))return!0}catch(e){}return!1}},{key:"_didConvertOnNonAmpPage",value:function(e){return e&&e.getAttribute("data-load-complete")}},{key:"_didConvertOnAmpPage",value:function(e){return e&&e.src}},{key:"isReplayable",value:function(){return!1}},{key:"resizeAd",value:function(e,t,i){this.stopped||(this.width=e,this.height=t,this.adxContainer.style.width=e+"px",this.adxContainer.style.height=t+"px",this.adxContainer.style.marginTop=this._calcMarginTop())}},{key:"_calcMarginTop",value:function(){return this.height<=this.adxCardSize.height?"0px":(this.height-this.adxCardSize.height)/2+"px"}},{key:"getAdWidth",value:function(){return this.width}},{key:"getAdHeight",value:function(){return this.height}},{key:"getDOMContainer",value:function(){return this.adxContainer}},{key:"getVideoUrl",value:function(){return""}},{key:"getVPAIDVideoElement",value:function(){return null}},{key:"stopAd",value:function(){this.stopped=!0,this.adxContainer=this.injectionMethods=this._initAd=this._parseScript=this._startAd=this._didConvert=void 0,this.lookForAdxAdInterval=clearInterval(this.lookForAdxAdInterval),this.didGotAdxAdTimeout=clearTimeout(this.didGotAdxAdTimeout)}},{key:"pauseAd",value:function(){}},{key:"resumeAd",value:function(){}},{key:"skipAd",value:function(){}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"getAdSkippableRemainingTime",value:function(){}},{key:"getAdRemainingTime",value:function(){}},{key:"getAdDuration",value:function(){}},{key:"getAdSkippableState",value:function(){}},{key:"getAdVolume",value:function(){}},{key:"getAdIcons",value:function(){}},{key:"getAdCompanions",value:function(){}},{key:"getAdExpanded",value:function(){}},{key:"getAdLinear",value:function(){}},{key:"logVideoUrl",value:function(){}}]),e}();t.default={type:18,vpaid:v,selectValidSize:function(e){for(var t=e.get("creatives"),i=t.PLAYER_WIDTH||e.get("width"),n=t.PLAYER_HEIGHT||e.get("height"),r=300,s=250,o=(e.get("adtnladxsprtdszs")||[],[{width:580,height:400},{width:336,height:280},{width:300,height:250}].concat(e.get("adtnladxsprtdszs")||[]).sort(function(e,t){var i=e.width-t.width,n=e.height-t.height;return 0===i&&0===n?0:i>0||0===i&&n>0?-1:1})),a=0;a<o.length;a++)if(i>=o[a].width&&n>=o[a].height){r=o[a].width,s=o[a].height;break}e.set("adxCardSize",{width:r,height:s})}}},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){!function(){var t=e,i=t.lib,n=i.Base,r=t.enc,s=r.Utf8,o=t.algo;o.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var i=e.blockSize,n=4*i;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),o=this._iKey=t.clone(),a=r.words,d=o.words,l=0;l<i;l++)a[l]^=1549556828,d[l]^=909522486;r.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,i=t.finalize(e);t.reset();var n=t.finalize(this._oKey.clone().concat(i));return n}})}()})},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(){var t=e,i=t.lib,n=i.WordArray,r=i.Hasher,s=t.algo,o=[],a=s.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],a=i[3],d=i[4],l=0;l<80;l++){if(l<16)o[l]=0|e[t+l];else{var u=o[l-3]^o[l-8]^o[l-14]^o[l-16];o[l]=u<<1|u>>>31}var c=(n<<5|n>>>27)+d+o[l];c+=l<20?(r&s|~r&a)+1518500249:l<40?(r^s^a)+1859775393:l<60?(r&s|r&a|s&a)-1894007588:(r^s^a)-899497514,d=a,a=s,s=r<<30|r>>>2,r=n,n=c}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+a|0,i[4]=i[4]+d|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[(n+64>>>9<<4)+14]=Math.floor(i/4294967296),t[(n+64>>>9<<4)+15]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=r._createHelper(a),t.HmacSHA1=r._createHmacHelper(a)}(),e.SHA1})},function(e,t){"use strict";function i(){}function n(e,t){return e?null:new Error(t)}function r(e){var t=v[e];t&&(clearTimeout(t),delete v[e])}function s(e,t,n){var s,o;return o=setTimeout(function(){t=i,delete o[s],n()},e),s=function(){t.apply(this,arguments)&&r(s)},v[s]=o,s}function o(e,t,i){var n=document.createElement(t);return i&&(n.id=i),e.appendChild(n),n}function a(e,t,i){var n=d(e,null,i.zIndex);if(c(n,u(t,i)))return n}function d(e,t,i){var n=document.createElement("iframe");return n.src=t||"about:blank",n.className="cm-vpaid-iframe",n.marginWidth="0",n.marginHeight="0",n.frameBorder="0",n.width="100%",n.height="100%",i&&(n.style.zIndex=i),n.setAttribute("SCROLLING","NO"),e.innerHTML="",e.appendChild(n),n}function l(e){e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.margin="0px",e.style.padding="0px",e.style.border="none",e.style.width="100%",e.style.height="100%"}function u(e,t){return Object.keys(t).forEach(function(i){var n="object"===("undefined"==typeof n?"undefined":f(n))?JSON.stringify(t[i]):t[i];e=e.replace(new RegExp("{{"+i+"}}","g"),n)}),e}function c(e,t){var i=e.contentWindow&&e.contentWindow.document;return!!i&&(i.write(t),!0)}function h(e,t){return Object.keys(t).forEach(function(i){e[i]=t[i]}),e}function p(e){var t=-1;return function(){return e+"_"+ ++t}}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v={};e.exports={noop:i,validate:n,clearCallbackTimeout:r,callbackTimeout:s,createElementInEl:o,createIframeWithContent:a,createIframe:d,setFullSizeStyle:l,simpleTemplate:u,setIframeContent:c,extend:h,unique:p}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={vpaidCrawler:{serviceKey:"vpaidCrawler",storePathKey:"vpdcrwlr",versionRegex:/(?:\/vpaidCrawler\/)(.*)\/vpaidCrawler.js/,storeDataKey:"vpaidCrawlerFuncString",jsonpCallbackName:"vpdcrwlrclb"},hjk:{serviceKey:"hjk",storePathKey:"hjk",versionRegex:/(?:\/vpaid\/hjk.)(.*).js/,storeDataKey:"hjkFuncString",jsonpCallbackName:"hjkclb"},vpaidAnalytics:{serviceKey:"vpaidAnalytics",storePathKey:"anltcsurl",versionRegex:/(?:\/vpaid\/vpaidAnalytics.)(.*).js/,storeDataKey:"analyticsFuncString",jsonpCallbackName:"anltcsclb"},dsm:{serviceKey:"dsm",storePathKey:"dsu",versionRegex:/(?:\/vpaid\/ds\/)(.*)\//,storeDataKey:"dsm",jsonpCallbackName:""}}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(1),l=n(d),u=i(6),c="ad",h=function(e){function t(e,i,n,o,a){r(this,t);var d=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return d.store=i,d.video=e,d.target=e.parentElement||n,d.isMobile=d.store.get("isMobile"),d.useVideoControls=d.store.get("useVideoControls"),d.disclosureText=d.store.get("disctxt"),d.defaultVolume=d.store.get("dfltvlm"),d.hideAdsPlayPauseButton=d.store.get("hdeadsplypusbtn"),d.showAdMuteButton=d.store.get("shwadmtebtn"),d.initBg=!1,d.vpaidWrapper=a,d.state={},d._onSoundChange=function(){},d.isMobile?d._buildMobileControls():d._buildDesktopControls(),d._createElements(),d._addControlsEventListeres(),d._addSoundEventListener(),d._setInitialState(o),d.store.on("playerStatusChanged",d._onPlayerStatusChanged.bind(d)),d}return o(t,e),a(t,[{key:"_setInitialState",value:function(e){var t={volume:0,volumeBeforeMute:0,adDuration:0,adCurrentTime:0,adTickerId:0,adLastTickTime:0,isMuted:0===this.store.get("volume")||this.isMobile||!!this.canvas,isPaused:!1,playerState:e,vidDuration:30,vidCurrentTime:0,isVisible:e!==c};this.setState(t)}},{key:"_buildDesktopControls",value:function(){this._createElements=this._createDesktopElements.bind(this),this._addControlsEventListeres=this._addDesktopControlsEventListeners.bind(this),this._renderControls=this._renderDesktopControls.bind(this),this._onVolumeStateChanged=this._onDesktopVolumeStateChanged.bind(this),this._destroyControlsEvents=this._destroyDesktopControlsEvents.bind(this)}},{key:"_buildMobileControls",value:function(){this._createElements=this._createMobileElements.bind(this),this._addControlsEventListeres=this._addMobileControlsEventListeners.bind(this),this._renderControls=this._renderMobileControls.bind(this),this._onVolumeStateChanged=this._onMobileVolumeStateChanged.bind(this),this._destroyControlsEvents=this._destroyMobileControlsEvents.bind(this),this.resetAdControls=function(){}}},{key:"resetAdControls",value:function(){this._isAdState()&&this.vpaidWrapper&&this.setState({preventAdTicker:""!==this.vpaidWrapper.getVideoUrl(),isMuted:!0})}},{key:"_onPlayerStatusChanged",value:function(e){this.setState({playerState:e})}},{key:"_isAdState",value:function(){return this.state.playerState===c}},{key:"_isWorkingVpaid",value:function(e){return this._isAdState()&&e.workingVpaid}},{key:"_onControlsVisibilityChanged",value:function(){var e=this;this.useVideoControls&&requestAnimationFrame(function(){l.removeClass(e.element,e.state.isVisible?"hide":"show"),l.addClass(e.element,e.state.isVisible?"show":"hide")})}},{key:"_addDesktopControlsEventListeners",value:function(){this.target.addEventListener("dragstart",function(){}),this.element.addEventListener("click",function(e){e.stopPropagation()}),this._bindedOnProgressBarDown=this._onProgressBarDown.bind(this),this.progressBarArea.addEventListener("mousedown",this._bindedOnProgressBarDown),this._bindedOnPlayPauseClicked=this._onDesktopPlayPauseClicked.bind(this),this.playBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this._bindedOnProgressBarOut=this._onProgressBarOut.bind(this),this._bindedOnProgressBarMove=this._onProgressBarMove.bind(this),this._addContentVideoEventListeners(),this._bindedOnMuteClicked=this._onDesktopMuteClicked.bind(this)}},{key:"_addMobileControlsEventListeners",value:function(){this._bindedOnPlayPauseClicked=this._onMobilePlayPauseClicked.bind(this),this._bindedOnMuteClicked=this._onMobileMuteClicked.bind(this),this._bindedOnVideoEvent=this._onVideoEvent.bind(this),this.playPauseArea.addEventListener("click",this._bindedOnPlayPauseClicked),this.video&&this.video.addEventListener("timeupdate",this._bindedOnVideoEvent)}},{key:"_addSoundEventListener",value:function(){this.soundElement.addEventListener("click",this._bindedOnMuteClicked)}},{key:"_createDesktopElements",value:function(){this.element=document.createElement("div"),this.element.className="video_controls hide",this.element.innerHTML="<div class='video_controls video_controls_main_area'>\n                <div class='title text'>"+this.disclosureText+"</div>\n                <div class='cm_video_controls_progressbar_area'>\n                    <div class='cm_video_controls_progressbar_bg white_bg'></div>\n                    <div class='cm_video_controls_progressbar blue_bg'></div>\n                </div>\n                <div class='cm_video_controls_mute interactive display_mute'></div>\n                <div class='cm_video_controls_playpause interactive hide'>\n                    <div class='pause hide'></div>\n                    <div class='play'></div>\n                </div>\n            </div>",
this.target.appendChild(this.element),this.mainArea=this.element.children[0],this.progressBarArea=this.mainArea.children[1],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1],this.soundElement=this.mainArea.children[2],this.playPauseArea=this.mainArea.children[3],this.pauseBtn=this.playPauseArea.children[0],this.playBtn=this.playPauseArea.children[1],this.store.get("can_opt_out")||l.addClass(this.mainArea.children[0],"opt-out-hidden")}},{key:"_createMobileElements",value:function(){this.element=document.createElement("div"),this.element.className="video_controls_mobile",this.element.innerHTML='<div class="mc-pause hide" style="pointer-events: all;"></div>\n            <div class="speaker mute" style="pointer-events: all;"></div>\n            <div class="mc-progressbar_area">\n                <div class=\'mc-progressbar_bg white_bg\'></div>\n                <div class=\'mc-progressbar_bg blue_bg\'></div>\n            </div>\n            <div class="tbl-text">'+this.disclosureText+"</div>",(this.video.parentElement||this.target).appendChild(this.element),this.playPauseArea=this.element.children[0],this.soundElement=this.element.children[1],this.progressBarArea=this.element.children[2],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1]}},{key:"_setVideoProgress",value:function(){var e=this;requestAnimationFrame(function(){var t=(e.state.vidDuration-e.state.vidCurrentTime)/e.state.vidDuration*100,i=100-t,n=i+"%";if(e.progressBarPercentager.style.width!==n){var r=parseInt(e.progressBarPercentager.style.width);isNaN(r)||parseInt(i)<r?e.initBg||(e.initBg=!0,l.addClass(e.progressBarPercentager,"init_bg")):e.initBg&&(e.initBg=!1,l.removeClass(e.progressBarPercentager,"init_bg")),e.progressBarPercentager.style.width=n}})}},{key:"_addContentVideoEventListeners",value:function(){this._bindedOnVideoEvent=this._onVideoEvent.bind(this),this._bindedOnVideoClick=this._onVideoClick.bind(this),this.video.addEventListener("durationchange",this._bindedOnVideoEvent),this.video.addEventListener("progress",this._bindedOnVideoEvent),this.video.addEventListener("timeupdate",this._bindedOnVideoEvent),this.video.addEventListener("playing",this._bindedOnVideoEvent),this.video.addEventListener("pause",this._bindedOnVideoEvent),this.video.addEventListener("click",this._bindedOnVideoClick)}},{key:"_onVideoClick",value:function(e){this.video.currentTime===this.video.duration&&(this._isAdState()||(this.video.play(),e.stopPropagation()))}},{key:"_onVideoEvent",value:function(e){if(!this._isAdState()){if("timeupdate"===e.type)return void this.setState({vidDuration:this.video.duration,vidCurrentTime:this.video.currentTime});var t={volume:this.video.volume,isMuted:0===this.video.volume};"pause"!==e.type&&"playing"!==e.type||(t.isPaused="pause"===e.type),this.setState(t)}}},{key:"setVpaidHandler",value:function(e){this.vpaid=e,this._addVpaidListeners()}},{key:"_addVpaidListeners",value:function(){this._bindedOnVpaidEvent=this._onVpaidEvent.bind(this),this.vpaid.on("AdVolumeChange",this._bindedOnVpaidEvent),this.vpaid.on("AdPaused",this._bindedOnVpaidEvent),this.vpaid.on("AdPlaying",this._bindedOnVpaidEvent)}},{key:"_removeVpaidListeners",value:function(){this.vpaid&&this._bindedOnVpaidEvent&&(this.vpaid.removeListener("AdVolumeChange",this._bindedOnVpaidEvent),this.vpaid.removeListener("AdPaused",this._bindedOnVpaidEvent),this.vpaid.removeListener("AdPlaying",this._bindedOnVpaidEvent))}},{key:"_onVpaidEvent",value:function(e){if(this._isWorkingVpaid(this.vpaidWrapper)){var t={};if("AdVolumeChange"===e.type)this.isMobile||(t.volume=this.vpaidWrapper.adVolume,t.isMuted=0===this.vpaidWrapper.adVolume);else{var i="AdPaused"===e.type;this.state.isPaused!==i&&(t.isPaused=i)}this.setState(t)}}},{key:"_onAdTicks",value:function(){var e=Date.now(),t={};this.state.isPaused?0!=this.state.adLastTickTime&&(this.adStartTime+=e-this.state.adLastTickTime):(t.adCurrentTime=(e-this.adStartTime)/1e3,t.adCurrentTime>this.state.adDuration&&(t.adCurrentTime=this.adStartTime>0?this.state.adDuration:0),t.vidDuration=t.adDuration,t.vidCurrentTime=t.adCurrentTime),t.adLastTickTime=e,this.setState(t)}},{key:"_isAdsPlayPauseButtonHidden",value:function(){return this.hideAdsPlayPauseButton&&this._isAdState()}},{key:"_onDesktopPlayPauseClicked",value:function(e){var t=!this.state.isPaused;this._isAdsPlayPauseButtonHidden()||(!this.isMobile&&this.video&&(t?this.video.pause():this.video.play()),this.setState({isPaused:t}),e.stopPropagation())}},{key:"_onMobilePlayPauseClicked",value:function(e){this.video.playButtonClick&&this.video.playButtonClick(),this.setState({isPaused:!this.state.isPaused}),e.stopPropagation()}},{key:"_onDesktopMuteClicked",value:function(e){if(this.showAdMuteButton){0===this.state.volume&&this.emit("unmuteClicked");var t={};this.store.set("forceMute",!this.state.isMuted),this.state.isMuted?0===this.state.volumeBeforeMute&&(t.volumeBeforeMute=this.defaultVolume):t.volumeBeforeMute=this.state.volume,t.volume=this.state.isMuted?this.state.volumeBeforeMute||t.volumeBeforeMute:0,this.setState(t),e.stopPropagation()}}},{key:"_onMobileMuteClicked",value:function(e){this.showAdMuteButton&&(0===this.state.volume&&this.emit("unmuteClicked"),this.video.muteButtonClicked&&this.video.muteButtonClicked(),this.setState({isMuted:!this.state.isMuted}),e.stopPropagation())}},{key:"_onProgressBarDown",value:function(e){this._sendProgressBarPercentagesChanged(e.offsetX/this.progressBarArea.offsetWidth,e),this.progressBarArea.addEventListener("mouseleave",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mouseup",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mouseout",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mousemove",this._bindedOnProgressBarMove),e.stopPropagation()}},{key:"_sendProgressBarPercentagesChanged",value:function(e,t){this.store.emit("videoProgressBar",e),t.stopPropagation()}},{key:"_onProgressBarOut",value:function(e){this.progressBarArea.removeEventListener("mouseleave",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mouseup",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mouseout",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mousemove",this._bindedOnProgressBarMove),e.stopPropagation()}},{key:"_onProgressBarMove",value:function(e){this._sendProgressBarPercentagesChanged(e.offsetX/this.progressBarArea.offsetWidth,e)}},{key:"_didStateChanged",value:function(e){for(var t in e)if(void 0!==e[t]&&!this.state.hasOwnProperty(t)||this.state[t]!==e[t])return!0;return!1}},{key:"setState",value:function(e){if(this.state&&e&&Object.keys(e).length>0&&this._didStateChanged(e)){var t=!1;void 0!==e.playerState&&(this.state.playerState=e.playerState,this._updateMuteAndPlayPauseVisibility()),void 0===e.volume&&void 0===e.isMuted||(t=!0,this._onVolumeStateChanged(e),this._setVpaidVolume(),this._onSoundChange(this.state.isMuted)),void 0!==e.isPaused&&this.state.isPaused!==e.isPaused&&(t=!0,this.state.isPaused=e.isPaused,this._onPausedChanged(),this._isAdState()||this._toggleVpaidPlayPause(e)),void 0!==e.preventAdTicker&&e.preventAdTicker!==this.state.preventAdTicker&&(this.state.preventAdTicker=e.preventAdTicker,this.state.adTickerId=clearInterval(this.state.adTickerId),this.state.preventAdTicker?this.vpaidWrapper.registerToVPAIDVideoTimeupdateEvent():(this.adStartTime=Date.now(),this.vpaidWrapper.getAdDuration(),this.state.adTickerId=setInterval(this._onAdTicks.bind(this),250))),void 0===e.vidDuration&&void 0===e.vidCurrentTime||(this.state.vidDuration=e.vidDuration||this.state.vidDuration,this.state.vidCurrentTime=e.vidCurrentTime||this.state.vidCurrentTime,this._setVideoProgress()),void 0!==e.isVisible&&(this.state.isVisible=e.isVisible,this._onControlsVisibilityChanged()),t&&this._renderControls()}}},{key:"_onDesktopVolumeStateChanged",value:function(e){0===e.volume||e.isMuted?(this.state.volumeBeforeMute=void 0!==e.volumeBeforeMute?e.volumeBeforeMute:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume,this.store.emit("volumeBeforeMuteChanged",this.state.volumeBeforeMute),this.state.volume=0,this.state.isMuted=!0):(this.state.isMuted=!1,this.state.volume=void 0!==e.volume?e.volume:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume)}},{key:"_onMobileVolumeStateChanged",value:function(e){0===e.volume||e.isMuted?(this.state.volumeBeforeMute=void 0!==e.volumeBeforeMute?e.volumeBeforeMute:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume,this.state.volume=0,this.state.isMuted=!0):(this.state.isMuted=void 0!==e.isMuted?e.isMuted:this.state.isMuted,this.state.volume=void 0!==e.volume?e.volume:this.state.volumeBeforeMute||this.defaultVolume)}},{key:"_onPausedChanged",value:function(){if(this.video){if(this._isAdsPlayPauseButtonHidden()||this._isVideoEmpty()||!this.isMobile||this.canvas)return;this.state.isPaused?this.video.pause():this.video.play()}}},{key:"_isVideoEmpty",value:function(){return!(this.video.src&&this.video.attributes.src&&""!==this.video.attributes.src.value||0!==this.video.childNodes.length)}},{key:"_renderDesktopControls",value:function(){this._renderDesktopVolume(),this._renderDesktopPlayPause()}},{key:"_renderDesktopVolume",value:function(){if(!this._isAdState()){var e=this.state.volume>1?this.state.volume/100:this.state.volume;this.video.volume=e,this.video.muted=this.state.isMuted}l.removeClass(this.soundElement,"display_unmute"),l.removeClass(this.soundElement,"display_mute"),l.addClass(this.soundElement,"display_"+(this.state.isMuted?"mute":"unmute"))}},{key:"_renderDesktopPlayPause",value:function(){var e=this.state.isPaused?this.playBtn:this.pauseBtn,t=this.state.isPaused?this.pauseBtn:this.playBtn;l.removeClass(t,"show"),l.addClass(t,"hide"),l.removeClass(e,"hide"),l.addClass(e,"show")}},{key:"_renderMobileControls",value:function(){this._setMobilePlayPauseButton(),this._setMobileSoundButton()}},{key:"_setMobilePlayPauseButton",value:function(){var e=this;requestAnimationFrame(function(){e.state.isPaused?(l.removeClass(e.playPauseArea,"mc-pause"),l.addClass(e.playPauseArea,"mc-play")):(l.removeClass(e.playPauseArea,"mc-play"),l.addClass(e.playPauseArea,"mc-pause"))})}},{key:"_setMobileSoundButton",value:function(){var e=this;!this._isAdState()&&this.video&&(this.video.volume=this.state.volume,this.video.muted=this.state.isMuted),requestAnimationFrame(function(){e.state.isMuted?l.addClass(e.soundElement,"mute"):l.removeClass(e.soundElement,"mute")})}},{key:"_toggleVpaidPlayPause",value:function(){this._isAdState()&&this.vpaid&&(this.state.isPaused?this.vpaid.vpaidHandler.pauseAd():this.vpaid.vpaidHandler.resumeAd())}},{key:"_setVpaidVolume",value:function(){this._isAdState()&&this.vpaid&&this.vpaidWrapper&&this.vpaidWrapper.workingVpaid&&this.vpaidWrapper.setAdVolume(this.state.volume,!0)}},{key:"getValueFromControlsState",value:function(e){return this.state.hasOwnProperty(e)?this.state[e]:void 0}},{key:"destroy",value:function(){this._removeVpaidListeners(),this._destroyControlsEvents(),this._destroySoundEvents(),this.element.parentElement.removeChild(this.element),this.vpaid=this._bindedOnVpaidEvent=void 0,clearInterval(this.state.adTickerId)}},{key:"_destroyDesktopControlsEvents",value:function(){this.target.removeEventListener("dragstart",function(){}),this.element.removeEventListener("click",function(e){e.stopPropagation()}),this.progressBarArea.removeEventListener("mousedown",this._bindedOnProgressBarDown),this.video.removeEventListener("durationchange",this._bindedOnVideoEvent),this.video.removeEventListener("progress",this._bindedOnVideoEvent),this.video.removeEventListener("playing",this._bindedOnVideoEvent),this.video.removeEventListener("pause",this._bindedOnVideoEvent),this.video.removeEventListener("click",this._bindedOnVideoClick),this.playBtn.removeEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.removeEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_destroyMobileControlsEvents",value:function(){this.playPauseArea.removeEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_destroySoundEvents",value:function(){this.soundElement.removeEventListener("click",this._bindedOnMuteClicked),this.video&&this.video.removeEventListener("timeupdate",this._bindedOnVideoEvent)}},{key:"_updateMuteAndPlayPauseVisibility",value:function(){var e=this;requestAnimationFrame(function(){l.removeClass(e.playPauseArea,"hide"),l.removeClass(e.playPauseArea,"show"),l.removeClass(e.soundElement,"hide"),l.removeClass(e.soundElement,"show"),l.addClass(e.playPauseArea,e._isAdsPlayPauseButtonHidden()?"hide":"show"),l.addClass(e.soundElement,e.showAdMuteButton?"show":"hide")})}},{key:"setOnSoundChangeCallback",value:function(e){this._onSoundChange=e}},{key:"setCanvas",value:function(e){this.canvas=e}},{key:"setVideo",value:function(e){this.video=e,this.video.volume===this.state.volume&&this.video.muted===this.state.isMuted||(this.video.volume=this.state.volume,this.video.muted=this.state.isMuted)}}]),t}(u.EventEmitter);t.default=h},function(t,i,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=n(10),c=(s(u),n(5)),h=s(c),p=n(64),f=s(p),v=n(1),m=r(v),g=n(6),y=n(74),_=s(y),b=function(t){function i(e,t,n){o(this,i);var r=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));r.store=n,r.finished=!1,r.isFirstImpression=e.isFirstImpression,r.soundViolationFired=!1,r.iframe={},r.vpaid=null,r.uid="",r.debugTracker=new h.default("VpaidHandler"),r.vpaidCreated=!1,r.store.get("noplrcntr")||(r.videoWrapper={}),r.options=e,r.parent=e.parent,r.parentOptions=t,r.creativeData={},r.height=0,r.width=0,r.eventFunctions={},r.viewMode="normal",r.bitRate=512,r.timerId=0,r.adPlaying=!1,r.isAdPlayerVisible=!1,r.isMultiVpaidUnit=r.store.get("isMultiVpaidUnit"),r.environmentVars={};var s=Object.assign({},r.parentOptions.tagDefault,r.options.vpaidTag);return r.normalizeVpaidParam(s),r.options.vpaidTag=s,r.prepareVideoTag(),r.run(e.isPreRoll),r.store.on("stop",r.stop.bind(r)),r.store.on("hideAdPlayer",r.hideAdPlayer.bind(r)),r.isMultiAdsActive=r.store.get("mltads"),r.isMultiAdsActive&&r.store.on("resizeVpaidWrapper",r._onResizeAd.bind(r)),r.volumeBeforeMute=0,r.paused=!1,r.hideAdPlayerDelayId=0,r.store.emit("vpaidHandlerCreated",r),r}return d(i,t),l(i,[{key:"_onResizeAd",value:function(e){this.finished||(this.options.width=e.width,this.options.height=e.height)}},{key:"volumeControlClick",value:function(e,t,i){var n=e.parentNode.getBoundingClientRect(),r=parseInt((i.pageX-(n.left+5))/(n.width-10)*100);this.setVolumeControls(e,t,r),r>100&&(r=100),this.volume(r/100),this.options.parent.volume(r)}},{key:"setVolumeControls",value:function(e,t,i){i>100&&(i=100),i<=0?(i=0,t.className="vjs-mute-control vjs-control vjs-vol-0",t.muted=!0):(t.className="vjs-mute-control vjs-control vjs-vol-"+Math.floor(i/25),t.muted=!1),e.style.width=i+"%"}},{key:"muteControlClick",value:function(e,t,i){if(t.muted){t.className="vjs-mute-control vjs-control vjs-vol-4",t.muted=!1;var n=100*(this._beforeMuteVolume||1);e.style.width=n+"%",this.volume(n),this.options.parent.volume(100)}else t.className="vjs-mute-control vjs-control vjs-vol-0",t.muted=!0,this._beforeMuteVolume=this._volume,e.style.width="0",this.volume(0),this.options.parent.volume(0)}},{key:"playPauseClick",value:function(e,t){this.paused?(this.vpaid.resumeAd(),this.paused=!1,e.className="vjs-play-control vjs-control"):(this.vpaid.pauseAd(),this.paused=!0,e.className="vjs-play-control vjs-control vjs-playing c-paused"),t.stopPropagation()}},{key:"onVpaidCreated",value:function(e){this.vpaid=e,this.vpaid||this.debugTracker.error("onVpaidCreated","Vpaid Object is Invalid!"),this.subscribeToVpaid(e),this.environmentVars={slot:this.store.get("noplrcntr")?this.parent.target:this.videoWrapper,videoSlotCanAutoPlay:!0,videoSlotControls:!0},this.store.get("contentClickUrl")&&!this.store.get("noplrcntr")&&this.videoWrapper.addEventListener("click",function(e){e.stopPropagation()}),this.debugTracker.info("onVpaidCreated","Vpaid-Player->Creating..."),this.options.vpaidTag.skip_vast||!this.creativeData.adParameters?this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters=this.options.vpaidTag.ad_parameters:this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters;try{this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars),this.vpaidCreated=!0}catch(e){this.debugTracker.error("onVpaidCreated: Vpaid-initAd->failed!Trying to run with parsed <adParameters>...",e);try{var t=this.creativeData.adParameters;this.creativeData.adParameters={},this.creativeData.adParameters=new Function("return "+t+";")(),this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters,this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars),this.vpaidCreated=!0}catch(t){this.vpaidCreated=!1,this.onVpaidLoadError(e,t)}}this.vpaidCreated&&this.parent.ga.sendGaMessage({type:"vpaidInitiated"})}},{key:"resize",value:function(e,t,i){if(i=i||"normal",t=parseInt(t),e=parseInt(e),this.options.height=t,this.options.width=e,this.viewmode=i,!isNaN(e)||!isNaN(t)){this.store.get("noplrcntr")||(this.videoWrapper.style.width=e+"px",this.videoWrapper.style.height=t+"px");var n=this.isMultiVpaidUnit||!1;if(!this.isMultiVpaidUnit)try{this.vpaid&&(n=this.vpaid.resizeAd(e,t,i))}catch(e){this.debugTracker.error("resize",e),n=!1}return n}}},{key:"viewAdPlayer",value:function(e){clearTimeout(this.hideAdPlayerDelayId),this.adPlaying||(this.store.get("isMobile")||this.antiFlashBlackScreen(),this.adPlaying=!0,this.parent.video.pause(),this.parent.video.style.display="none",this.parent.video.forceCanvas?this.parent.video.hideCanvas():(this.parent.video.style.display="none",this.parent.video.style.zIndex=0),this.store.get("noplrcntr")||(this.videoWrapper.style.zIndex=100,this.videoWrapper.classList.add("_ad-cm-playing"),this.videoWrapper.style.display="block"),this.vpaid.manager.bringVpaidToFront()),this.store.get("vForce")?this.isAdPlayerVisible||(this.isAdPlayerVisible=!0,this.store.emit("AdPlayerVisible")):this.store.emit("AdPlayerVisible")}},{key:"antiFlashBlackScreen",value:function(){document.body.scrollTop=document.body.scrollTop+1,setTimeout(function(){document.body.scrollTop=document.body.scrollTop-1},2)}},{key:"hideAdPlayer",value:function(e){var t=this;clearTimeout(this.hideAdPlayerDelayId);var i=this;this.hideAdPlayerDelayId=setTimeout(function(){window.clearTimeout(i.timerId),i.store.get("vForce")||i.parent.playerIsClosed||i.adPlaying&&(i.adPlaying=!1,i.parent.video.forceCanvas?(i.parent.video.play(),i.parent.video.showCanvas()):(i.parent.video&&i.parent.video.paused&&(i.store.get("dataSaver")||(t.store.get("isMobile")&&(i.parent.video.muted=!0),i.parent.video.play())),i.parent.video&&(i.parent.video.style.display="block",i.parent.video.style.zIndex=1e3)),t.store.get("noplrcntr")||i.videoWrapper.classList.remove("_ad-cm-playing"),i.store.emit("AdPlayerHidden"),e&&e.stop("global_ad_timeout"))})}},{key:"onVpaidError",value:function(e,t,i){i?this.debugTracker.error("VPAID-"+this.options.uid,i?i[0]:""):this.debugTracker.error("VPAID-"+this.options.uid,"Vpaid Threw Error"),this.parent.options.onAdError(this.parent,this),window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"onVpaidLoadError",value:function(e,t){if(e=e||"",t=t||"",this.parent.ga.sendGaMessage({type:"VpaidLoadError"}),500==parseInt(1e3*Math.random()))try{var i="VpaidLoadError="+encodeURIComponent(e.toString()+"[][][][]"+t.toString()),n=new XMLHttpRequest;n.open("POST","//www.mikysrv.com/push.html",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(i),this.debugTracker.error("VPAID-"+this.options.uid,[e,t])}catch(e){}this.parent.options.onAdLoadError(this.parent,this),window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"onVpaidPageError",value:function(e){this.debugTracker.warn("VpaidPageError",e)}},{key:"stop",value:function(e){window.setTimeout(function(e){this.hideAdPlayer(e)}.bind(this,e),0)}},{key:"onVpaidStop",value:function(){window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"run",value:function(e){var t=this.store.get("ads_playing")||0,i=this.store.get("sncad")||!1;if(i&&t)return!1;var n=this.options.vpaidTag;if(!this.vpaid){if(this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters=this.options.vpaidTag.ad_parameters,this.vpaid=new f.default(n,this,this.store),this.store.get("cmbopps")){var r=new _.default(this.store,this.vpaid.config.creatives);this.store.set("oppsAggregator",r)}this.onVpaidCreated(this.vpaid),this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars)}return this.store.set("currentPubid",n.pubid),this.store.set("currentTagid",n.tagid),this.store.set("rollType",n.roll_type),this.vpaid.startAd(e),this.vpaidCreated=!0,!0}},{key:"startAd",value:function(){this.startAdFired=!0,this.vpaid.startAd()}},{key:"prepareVideoTag",value:function(){if(this.getWorkingVolume(),!this.store.get("noplrcntr")){var e=this.parent.target;this.videoWrapper=document.createElement("div"),this.videoWrapper.className=e.className,this.videoWrapper.className+=" vpaid-handler",this.videoWrapper.id=this.options.uid+"_"+e.id,this.videoWrapper.style.cssText=e.style.cssText+";position:absolute;top:0;left:0;border:0; z-index:0"}var t=this.options.vpaidTag.mute?this.options.vpaidTag.mute:this.parentOptions.mute;this.options.vpaidTag.mute=t,this.options.height=m.roundNumericValue(this.store.get("height")),this.options.width=m.roundNumericValue(this.store.get("width")),this.store.get("noplrcntr")||e.appendChild(this.videoWrapper)}},{key:"getWorkingVolume",value:function(){var e=0;return this.options.vpaidTag.volume?"auto"==this.options.vpaidTag.volume&&(e=this.parent.volume()/100,e=this.store.get("volume")):e=this.parentOptions.volume/100,0==e&&this.vpaid&&(e=this.vpaid.manager.getCurrentWorkingVpaidVolume()),e<1?parseInt(100*e):parseInt(e)}},{key:"normalizeVpaidParam",value:function(e){e.adto=e.ad_timeout,e["player-width"]=this.parent.video.offsetWidth||this.parent.video.width,e["player-height"]=this.parent.video.offsetHeight||this.parent.video.height,e["video-url"]=this.parent.video.name,e.vidlength=parseInt(this.parent.video.duration),e.sts=this.parent.repeatCount,e["vpaid-version"]=e.vpaid_version,e["auc-dast"]=e.auc_dast;var t=2;e.use_as_is||(t=0==e.plmd?e.muted?2:1:e.plmd),e.plmd=t}},{key:"volume",value:function(e){if(e=e>1?e/100:e,void 0!=e)try{this.vpaid&&(this.vpaid.setAdVolume(e),this._volume=e)}catch(e){return 0}else try{return this.vpaid.getAdVolume()}catch(e){return 0}}},{key:"subscribeToVpaid",value:function(t){var i=this;this.eventFunctions={AdLoaded:function(e){i.parent.ga.sendGaMessage({type:"AdLoaded"})},AdVideoStart:function(e){if(e.dispatcher.adPlayedCounter||e.dispatcher.isBf||(this.store.incr("ads_playing"),e.dispatcher.adPlayedCounter=!0),!i.finished){var t=i.getWorkingVolume();i.volume(t),i.parent.options.onAdVideoStart(i.parent,i)}},AdImpression:function(e){i.viewAdPlayer(e?e.dispatcher:void 0);var t=this.store.get("ads_playing"),n=this.store.incr("total_impressions");if(e.dispatcher.adPlayedCounter||e.dispatcher.isBf||(this.store.incr("ads_playing"),e.dispatcher.adPlayedCounter=!0),!i.finished){i.parent.ga.sendGaMessage({type:"AdImpression"},{vage:parseInt((Date.now()-e.dispatcher.created)/1e3),vpaidReadyInQue:e.vpaidReady,qsize:e.qsize,dp:e.dp,adImpInMS:e.adImpInMS,readyInMS:e.readyInMS,loadToImpMS:e.loadToImpMS,vast:e.dispatcher.vast,adsPlaying:t,totalImpressions:n,xhrErrors:e.dispatcher.xhrErrors||""});var r=e.tag;if(i.isFirstImpression()&&i.vpaid&&i.vpaid.fire99&&i.parent.options.fire99)try{e.dispatcher.fire99()}catch(e){}i.parent.options.onAdImpression(i,e.dispatcher,r);var s=i.getWorkingVolume();if(i.volume(s),i.vpaid&&!i.store.get("isMultiVpaidUnit"))try{i.vpaid.resizeAd(i.options.width,i.options.height,i.viewmode)}catch(e){console.log(e)}}},AdStopped:function(t){t.dispatcher.adPlayedCounter&&!t.dispatcher.isBf&&this.store.set("ads_playing",0),i.parent.options.onAdStopped(e.dispatcher.index,i),i.onVpaidStop()},AdVideoComplete:function(e){i.hideAdPlayer(),e.dispatcher.adPlayedCounter&&!e.dispatcher.isBf&&this.store.set("ads_playing",0),i.parent.options&&i.parent.options.onAdVideoEnd(i.parent,i)},AdError:function(e){i.onVpaidError("[VPAID-"+i.options.uid+"]::AdError","AdError",arguments),e.dispatcher.adPlayedCounter&&!e.dispatcher.isBf&&this.store.set("ads_playing",0)},AdStarted:function(){var e=i.getWorkingVolume();i.volume(e)},VpaidSpecial:function(){i.parent.ga.sendGaMessage({type:"VpaidSpecial"})},AdBlockEnabled:function(){i.parent.ga.sendGaMessage({type:"AdBlockEnabled"})},SoundViolation:function(){i.soundViolationFired||(i.soundViolationFired=!0,i.parent.ga.sendGaMessage({type:"SoundViolation"}))},HijackAttempt:function(e){var t="";"string"==typeof e&&(t=e),i.parent.ga.sendGaMessage({type:"HijackAttempt"}),(new Image).src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=31542217&dast="+i.options.vpaidTag.auc_dast+"&"+(new Date).getTime()},AdPaused:function(e){this.store.emit("contentPaused"),i.paused=!0,i.playButton&&(i.playButton.className="vjs-play-control vjs-control vjs-playing c-paused")},AdPlaying:function(e){i.paused&&(this.store.emit("contentResumed"),i.paused=!1),i.paused=!1,i.playButton&&(i.playButton.className="vjs-play-control vjs-control"),i.finished},AdSkipped:function(){i.eventFunctions.AdStopped()}};var n=this.vpaidEvents;for(var r in n)n[r]&&this.eventFunctions[r]&&(this.eventFunctions[r].controller=this,t.subscribe(this.eventFunctions[r],n[r]),this.on(n[r],this.eventFunctions[r]));this.on("viewAdPlayer",i.viewAdPlayer)}},{key:"trigger",value:function(e,t){this.eventFunctions.hasOwnProperty(e)&&"function"==typeof this.eventFunctions&&(this.emit(e,t),console.log("trigger event",e))}},{key:"getVpaidLogs",value:function(){if(this.vpaid)return this.vpaid.getVpaidLogs()}},{key:"getAd",value:function(e){return this.vpaid.getAd(e)}},{key:"runWaterfall",value:function(e){this.vpaid.runWaterfall(e)}},{key:"pause",value:function(){this.paused||(this.vpaid.pauseAd(),this.paused=!0)}},{key:"resume",value:function(){this.adPlaying&&this.paused&&(this.vpaid.resumeAd(),this.paused=!1)}},{key:"mute",value:function(){this.volumeBeforeMute=0===this._volume?50:this._volume,this.volume(0)}},{key:"unMute",value:function(e){this.volumeBeforeMute||(this.parentOptions.volumeBeforeMute=this.volumeBeforeMute=e||50),this._volume=e,this.volume(this._volume)}},{key:"setPaused",value:function(e){this.paused=e}},{key:"vpaidEvents",get:function(){return{VpaidSpecial:"VpaidSpecial",AdBlockEnabled:"AdBlockEnabled",AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt"}}}]),i}(g.EventEmitter);i.default=b},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(45),a=n(o),d=1,l=2,u=3,c=4,h=5,p=6,f=7,v=8,m=9,g=10,y=function(){function e(t,i){if(r(this,e),this.results=null,t){var n=[];this.dastKeys={0:{name:"stid",type:l},1:{name:"extuid",type:u},2:{name:"excid",type:g},3:{name:"ciuid",type:u},4:{name:"ciuidst",type:u},5:{name:"ciums",type:l},6:{name:"szid",type:g},7:{name:"cirid",type:h},8:{name:"cisid",type:h},9:{name:"segid",type:h},10:{name:"pstn",type:h},11:{name:"plcmnt",type:h},12:{name:"RID",type:l},13:{name:"cirf",type:h},14:{name:"base64",type:l},15:{name:"crid",type:l},16:{name:"cibp",type:f},17:{name:"cisbp",type:f},18:{name:"ciprbp",type:f},19:{name:"cmbb",type:f},20:{name:"noaop",type:g},21:{name:"ciage",type:d},22:{name:"cigndr",type:g},23:{name:"invc",type:l},24:{name:"slid",type:l},25:{name:"oslid",type:l},26:{name:"cntry",type:v},27:{name:"rgn",type:h},28:{name:"cty",type:h},29:{name:"citbp",type:f},30:{name:"rcatid",type:h},31:{name:"brsr",type:l},32:{name:"osid",type:l},33:{name:"frimp",type:l},34:{name:"frclk",type:l},35:{name:"frcnv",type:l},36:{name:"pubid",type:l},37:{name:"subid",type:l},38:{name:"ltstmp",type:u},39:{name:"mtmdlid",type:u},40:{name:"mdlid",type:u},41:{name:"cu1",type:l},42:{name:"cu2",type:l},43:{name:"cu3",type:l},44:{name:"cu4",type:l},45:{name:"cu5",type:l},46:{name:"cu6",type:l},47:{name:"cu7",type:l},48:{name:"cu8",type:l},49:{name:"cipid",type:l},50:{name:"cicmp",type:l},51:{name:"impts",type:l},52:{name:"clcts",type:l},53:{name:"convts",type:l},54:{name:"adid",type:u},55:{name:"dcid",type:g},56:{name:"compid",type:l},58:{name:"siteid",type:l},59:{name:"pix",type:u},60:{name:"chan",type:u},61:{name:"bo",type:v},62:{name:"so",type:v},63:{name:"oid",type:g},64:{name:"csec",type:u},65:{name:"skw",type:l},66:{name:"alng",type:l},67:{name:"auc64",type:u},68:{name:"mid",type:v},69:{name:"wif",type:p},70:{name:"ciipd",type:u},71:{name:"sec",type:p},72:{name:"adt",type:l},73:{name:"nsl",type:p},74:{name:"pti",type:p},75:{name:"dncf",type:p},76:{name:"obp",type:f},77:{name:"tz",type:h},78:{name:"md",type:p},79:{name:"mmt",type:d},83:{name:"udc",type:p},84:{name:"umexcid",type:g},85:{name:"verticalId",type:l},86:{name:"mbr",type:g},87:{name:"ts",type:u},88:{name:"omni",type:l},89:{name:"rpm",type:f},90:{name:"abt",type:h},91:{name:"dspadid",type:h},92:{name:"dspbid",type:h},93:{name:"dspcid",type:h},94:{name:"dspcrid",type:h},95:{name:"dspid",type:l},96:{name:"dspseat",type:h},97:{name:"urlDepth",type:l},98:{name:"ordid",type:u},99:{name:"servingDomain",type:h},100:{name:"omniType",type:m},101:{name:"frmi",type:u},102:{name:"fmmt",type:d},103:{name:"cmt",type:d},104:{name:"lat",type:f},105:{name:"long",type:f},106:{name:"prrp",
type:f},107:{name:"pfrp",type:f},108:{name:"pgtp",type:m},109:{name:"tblc",type:m},110:{name:"mcr",type:v},111:{name:"ct",type:g},112:{name:"platform",type:m},113:{name:"cncat",type:h},114:{name:"cisrf",type:h},115:{name:"sortOrderType",type:d},116:{name:"groupId",type:h},117:{name:"testId",type:h},118:{name:"prl",type:l},119:{name:"pfrl",type:l},120:{name:"rtd",type:u},121:{name:"rndmt",type:l},122:{name:"sesid",type:h},123:{name:"seshas",type:u},124:{name:"palfr",type:f},125:{name:"splcmt",type:h},126:{name:"wurflb",type:h},127:{name:"wurflbv",type:h},128:{name:"wurflo",type:h},129:{name:"wurflov",type:h},130:{name:"wurflbn",type:h},131:{name:"wurflff",type:h},132:{name:"wurflmn",type:h},133:{name:"difa",type:h},134:{name:"aid",type:h},135:{name:"extuidst",type:h},136:{name:"tbuidst",type:h},137:{name:"aname",type:h},138:{name:"abRTB",type:h},139:{name:"mda",type:h},140:{name:"audsegid",type:h},141:{name:"smdt",type:u},142:{name:"at",type:l},143:{name:"ip",type:h},144:{name:"bundid",type:h},145:{name:"sturl",type:h},146:{name:"asiid",type:h},147:{name:"sid",type:h},148:{name:"appver",type:h},149:{name:"floor",type:c},150:{name:"instl",type:p},151:{name:"blang",type:h},152:{name:"gdpr",type:p},153:{name:"uconsnt",type:p},154:{name:"pcat",type:h},155:{name:"sdepth",type:l},156:{name:"pubidstr",type:h},157:{name:"tagidstr",type:h},158:{name:"uconsntstr",type:h},159:{name:"burl",type:h},160:{name:"pwidth",type:l},161:{name:"pheight",type:l},162:{name:"ctcs",type:g},163:{name:"cetcs",type:g},164:{name:"dspcats",type:h},165:{name:"smidis",type:l},166:{name:"smivrtb",type:l},167:{name:"smiv",type:l},168:{name:"mfrn",type:h},169:{name:"mfri",type:l},170:{name:"mfrp",type:c},171:{name:"mfrpl",type:l},172:{name:"mvecpmn",type:h},173:{name:"mvecpmi",type:l},174:{name:"mvecpmp",type:c},175:{name:"mvecpmpl",type:l},176:{name:"mfrtbn",type:h},177:{name:"mfrtbi",type:l},178:{name:"mfrtbp",type:c},179:{name:"mfrtbpl",type:l},180:{name:"mdisn",type:h},181:{name:"mdisi",type:l},182:{name:"mdisp",type:c},183:{name:"mdispl",type:l},184:{name:"debug",type:h},185:{name:"tpubid",type:l},186:{name:"scp",type:c},187:{name:"sii",type:u},188:{name:"csiid",type:h},189:{name:"ft",type:l},190:{name:"mfril",type:u},191:{name:"mvecpmil",type:u},192:{name:"mfrtbil",type:u},193:{name:"mdisil",type:u},194:{name:"subu",type:l},195:{name:"rid",type:h},196:{name:"muid",type:h},197:{name:"gdprven",type:p},198:{name:"gdprpur",type:p}},t=t.substring(2,t.length-1),t=t.replace(/_/g,"/"),t=t.replace(/-/g,"+"),this.bis=new a.default(t),this.bis.readInt(16);for(var s={};;){var o=this.bis.readInt(8);if(this.bis.isEof())break;if(this.dastKeys.hasOwnProperty(o)){var y,_=this.dastKeys[o];if(_.type==u&&(y=this.bis.readLong()),_.type==h){try{var b=this.decodeBerLength()}catch(e){n.push("key:"+o+",\n\t\t\t\t\t "+e);continue}if(y="",b==-1){var w=this.bis.readByte();0==w&&(y="ENTER_PLACEMENT_ID_HERE")}else y=this.bis.read7bitString(b)}_.type==l&&(y=this.bis.readInt()),_.type==m&&(y=this.bis.readInt(4)),_.type==c&&(y=this.bis.readDouble()),_.type==d&&(y=this.bis.readByte(),y>127&&(y-=256)),_.type==g&&(y=this.bis.readByte()),_.type==p&&(y=this.bis.readBool()),_.type==v&&(y=this.bis.readShort(),y>32767&&(y-=65536)),_.type==f&&(y=this.bis.readFloat()),s[_.name]=y}else n.push("missing key:"+o+" in dastDecoder")}this.results=s,n.length>0&&i.set("dastDecoderError",n)}}return s(e,[{key:"fetchResults",value:function(){return this.results}},{key:"decodeBerLength",value:function(){var e=this.bis.readByte();if(255==e)return-1;if(128==(128&e)){if(e&=127,0==e)throw"Indefinite length not supported";if(e>4)throw"Encoding too long";for(var t=0,i=0;i<e;i++)t=(t<<8)+(255&this.bis.readByte());return t>1e3&&(t=1e3),t}return e>1e3&&(e=1e3),e}}]),e}();t.default=y},function(e,t){"use strict";e.exports={schemaValidationError:101,timeout:304,mediaFileNotSupported:403,undefinedError:900,generalVpaidError:901,noAdsMatcher:"no_fill|no ad|no video|no vast|nofill",codesMatcher:"101|301|302|303|304|402|900|901"}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(5),d=r(a),l=i(1),u=n(l),c=i(11),h=r(c),p=i(10),f=r(p),v=function(){function e(t,i,n){s(this,e),this.parameters=t,this.store=i,this.debugTracker=new d.default("OpportunityManager"),this.store.get("usopsla")&&this.store.get("oppsula")?this.oppsAggregator=this.store.get("oppsula"):this.oppsAggregator=this.store.get("oppsAggregator"),this.isOppsulaRegisterAPI=this.oppsAggregator&&this.oppsAggregator.registerCallback,this._sentOpps={},this._oppsToSendOnlyOnce=[1,41,21,22,23,24,70],this._isPaused=!1,this.vpaidLog=n,this.billableEvents=this.store.get("bllblevt").split(",")}return o(e,[{key:"alreadySent",value:function(e,t){return!(!this._sentOpps[e.sequenceId]||!this._sentOpps[e.sequenceId][e.lineItemId])&&this._sentOpps[e.sequenceId][e.lineItemId].indexOf(t)!=-1}},{key:"send",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e){if(this._isPaused)return void this.debugTracker.info("OpportunityPixel","[tag-"+(1*e.waterfallTagId+1)+"] Disgarded sending '"+t);if(this._oppsToSendOnlyOnce.indexOf(t)==-1||!this.alreadySent(e,t)){this._sentOpps[e.sequenceId]=this._sentOpps[e.sequenceId]||{},this._sentOpps[e.sequenceId][e.lineItemId]=this._sentOpps[e.sequenceId][e.lineItemId]||[],this._sentOpps[e.sequenceId][e.lineItemId].push(t),this.debugTracker.info("OpportunityPixel","[tag-"+(1*e.waterfallTagId+1)+"] Sending '"+t,{color:"#6ef936"});var r=e.lineItemStats,s=this.store.get("pstn")||1,o=e.vidDast||e.dast,a=(new Date).getTime()-e.created,d=""+this.store.get("ab_test")+u.addAbTests(e),l=[{key:"st",value:u.getStreamType(e.rollType)},{key:"rs",value:e.sequenceId},{key:"os",value:1*e.waterfallTagId+1},{key:"tms",value:Math.floor((new Date).getTime()/1e3)},{key:"d",value:a},{key:"rst",value:t},{key:"dast",value:o},{key:"pstn",value:s},{key:"dp",value:u.crc32(e.dp)},{key:"mob",value:u.boolToInt(this.store.get("isMobile"))},{key:"vstt",value:u.boolToInt(!document.hidden)},{key:"unv",value:this.store.get("unit_version")},{key:"unt",value:u.crc32(this.store.get("unit_type"))},{key:"abt",value:d},{key:"frd",value:this.store.get("fdScore")},{key:"agl",value:this.store.get("preset.level")},{key:"rp",value:e.vpaidWrapperData&&e.vpaidWrapperData.vastPrice},{key:"mty",value:e.vpaidWrapperData&&e.vpaidWrapperData.mediatype},{key:"fv_t",value:r&&r.tries},{key:"fv_c",value:r&&r.conversions},{key:"fv_f",value:r&&r.fails},{key:"fv_fr",value:r&&r.failsRow},{key:"awr",value:this.store.get("performance.dtsvrRoundTripAverageDuration")},{key:"pm",value:this.store.get("performance.performanceMeasurment")},{key:"dbg",value:e.vpaidWrapperData.debugData||this.store.get("debugStr")},{key:"su",value:this.store.get("subUnitType")},{key:"pdast",value:i}];for(var c in n)"vidCurrentTime"!==c&&l.push({key:c,value:n[c]});var h=this,p=u.filterUndefinededValues(l,"value"),v=p.concat(this._delayedParams(e)),m=u.flattenKeys(v),g=function(e,i){h.oppFireSuccess(e,i,t)},y=function(e,i){h.oppFireFailure(e,i,t)};if(this.oppsAggregator&&!this._isBillableEvent(t))this._reportOppToKibana(m,t,n.vidCurrentTime),this.oppsAggregator.send(m);else{var _=this.store.get("opps_base_path")||creativeConfig.CM_DOMAIN;this.url=""+u.setUrlPrefix(_)+(/.*\/$/g.test(_)?"":"/")+"OpportunityServlet?rst="+t,this.postHeaders=this.store.get("psthdrs")||"application/json",(0,f.default)(this.url,u.stringify([m]),g,y,void 0,!1,!1,5e3,this.postHeaders,!1)}}}}},{key:"oppFireSuccess",value:function(e,t,i){"0"!==e&&u.logToBI(this.vpaidLog,"billableEventsTracking",{opp:i,type:"serverError",xhrErrors:t},!1,!1)}},{key:"oppFireFailure",value:function(e,t,i){u.logToBI(this.vpaidLog,"billableEventsTracking",{opp:i,type:"sendingError",url:t,error:e},!1,!1)}},{key:"_reportOppToKibana",value:function(e,t,i){var n={rstStr:u.getObjectKeyByValue(h.default,t)};i&&this._isQuartileOpportunity(t)&&(n.vidCurrentTime=i),u.logToBI(this.vpaidLog,"Opps",Object.assign({},e,n))}},{key:"_isQuartileOpportunity",value:function(e){return e>=21&&e<=25}},{key:"_flattenParams",value:function(e){return e.map(function(e){return e.key+"="+e.value})}},{key:"_flattenKeys",value:function(e){var t={};return e.forEach(function(e,i,n){t[e.key]=e.value}),t}},{key:"_getBaseUrl",value:function(e){var t=this.parameters,i=this.store.get("opps_base_path")||t.CM_DOMAIN,n=u.setUrlPrefix(i)+(/.*\/$/g.test(i)?"":"/")+"OpportunityServlet?";return n+="&auc-dast="+t.AUC_DAST,n+="&sts="+t.STS,n+="&wp="+t.WP,n+="&vpd="+(e.pubId||t.VPD),n+="&vptd="+(e.tagId||t.VPTD),n+="&vmt="+((e.isRon?1:0)||t.VMT||0),n+="&pv="+(this.store.get("player_version")||999),n+="&pt="+u.crc32(this.store.get("ab_test")||999),n+="&w="+this.store.get("width"),n+="&h="+this.store.get("height")}},{key:"_delayedParams",value:function(e){var t=this.parameters,i=[];return i.push({key:"auc-dast",value:t.AUC_DAST}),i.push({key:"sts",value:t.STS}),i.push({key:"wp",value:t.WP}),i.push({key:"vpd",value:e.pubId||t.VPD}),i.push({key:"vptd",value:e.tagId||t.VPTD}),i.push({key:"vmt",value:(e.isRon?1:0)||t.VMT||0}),i.push({key:"pv",value:this.store.get("player_version")||999}),i.push({key:"pt",value:u.crc32(this.store.get("ab_test")||999)}),i.push({key:"w",value:u.roundNumericValue(this.store.get("width")).toString()}),i.push({key:"h",value:u.roundNumericValue(this.store.get("height")).toString()}),i}},{key:"destroy",value:function(){this.debugTracker=void 0,this.store=void 0,this.oppsAggregator=void 0,this.billableEvents=void 0}},{key:"pause",value:function(){this._isPaused=!0}},{key:"unpause",value:function(){this._isPaused=!1}},{key:"_isBillableEvent",value:function(e){return this.billableEvents.indexOf(""+e)>-1}},{key:"isRegisterAvailable",value:function(e,t,i){this.isOppsulaRegisterAPI&&(i?this.oppsAggregator.registerCallback(e,t):this.oppsAggregator.unRegisterCallback(e,t))}}]),e}();t.default=v},function(e,t){"use strict";e.exports={VastData:"VastData",ParserError:"parserError",NetworkFail:"networkFail"}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),a=n(o),d={undefinedIframeSrc:"undefinedIframeSrc",event_AdImpression:"conversion",event_SoundViolation:"soundViolation",adStartTimeout:"adStartTimeout",AutoKill:"auto_kill",AdStopADTO:"before_startAd_timeout",queueTrimmed:"queueTrimmed",adPlayTimeout:"adPlayTimeout",queueExpired:"removed_from_queue",tagError:"tagError",vastFilterdByRegex:"vast_blacklisted",event_AdLoaded:"adLoaded",fetchVastXhr:"fetchVastXhr",fetchVastFallToXhr:"fetchVastFallToXhr",vpaidTimeout_AdLoaded:"adload_timeout",creatingVpaidHandler:"initVpaid",createdVpaidHandler:"before_adload",creatingVpaidHandlerError:"creatingVpaidHandlerError",networkError:"networkError",adUnitLoadFailed:"vpaid_unit_failed",adloadedTimeout:"adload_timeout",adImpressionTimeout:"adImpressionTimeout",playerClosed:"playerClosed",idleMode:"idleMode",hijackAttempt:"vpaid_blacklisted_url"},l=["conversion","soundViolation","timeout","bfRon","adPlayTimeout","vast_blacklisted","tagError","queueTrimmed","before_startAd_timeout","auto_kill","vpaidTimeout","creatingVpaidHandlerError","networkError","vpaid_unit_failed","adload_timeout","adImpressionTimeout","idleMode","vpaid_blacklisted_url","removed_from_queue"],u={NoMediaFiles:"empty_vast",event_AdError:"ad_error",vastxhrerror_noflash:"vast_fetch_fail",WrapperError:"wrapper_error",ParsingError:"xml_parsing_error",NoMediaFileAfterSort:"unsupported_mediafile"},c={BfRon:!0},h={difa:"idfa",aid:"appId",aname:"appName"},p=1e4,f=function(){function e(t,i){var n=this;r(this,e),this.tag=t,this.store=i,this.created=Date.now(),this.dataChanged=!1,this.friendlyVideoUrl=!1,this.iframesDetector=this.store.get("iframesDetector");var s=this.store.get("dast"),o="";s&&(o=s.cicmp);var d=this.store.get("subUnitType");this.sessionStarted=this.store.get("session_started")||this.created,this.data={_id:a.generateGuid(10),player_id:this.store.get("player_id"),tag:t,isMobile:t.isMobile,created:(new Date).toISOString(),timeSinceSessionStarted:this.created-this.sessionStarted,dp:t.dp,status:"new",statuses:["new"],itemScore:-1,fullPageUrl:this.store.get("fullPageUrl"),documentVisible:!document.hidden,oneAuction:this.store.get("mltads"),su:void 0!=d?d:-99999,redId:this.store.get("red_id")||"na",displayLineItem:o,updatesCount:0,serverSideDataSaver:this.store.get("serverSideDataSaver")||"na",clientSideDataSaver:this.store.get("clientSideDataSaver")||"na",dataSaver:this.store.get("dataSaver"),taboolaVpaid:this.store.get("istblvpd"),hasDsm:!!this.store.get("dsm"),hasVpaidAnalytics:!!this.store.get("analyticsFuncString"),isAmp:this.store.get("isAmp"),isCPCV:t.isCPCV,isPrivateBrowsing:this.store.get("isPrivateBrowsing")||"na",frameType:this.store.get("frameType")||-1},Object.assign(this.data,this._getDastData()),this.isReportDb=!1,this.dtor=!1,this._dataModified=!0,this.updatingInterval=setInterval(function(){n._dataModified&&n._sendData()},p)}return s(e,[{key:"_getDastData",value:function(){var e=this.store.get("dast")||{},t={},i=!1;for(var n in h){var r=e[n];if(r){var s=h[n];t[s]=r,i=!0}}return t.inApp=i,this.store.set("isInApp",i),t}},{key:"push",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this.data){if(e.indexOf("AdError")>-1||"event_SoundViolation"===e)this._addStatus(this._prettyErrorStatus(e,t));else if(d.hasOwnProperty(e)&&"conversion"!==this.data.status)this._addStatus(d[e]);else if(c.hasOwnProperty(e)){var r="is"+e;this.data[r]=!0}if(n){var s=Date.now(),o=s-this.created;t.time=o}if(this._dataChanged(),!i&&this.data.hasOwnProperty(e))return Array.isArray(this.data[e])||(this.data[e]=[this.data[e]]),this.data[e].push(t),void(this.data[e].length>3&&this.data[e].splice(0,1));this.data[e]=t,l.indexOf(this.data.status)!==-1&&this._setDpStats()}}},{key:"_dataChanged",value:function(){this._dataModified=!0}},{key:"_sendData",value:function(){this._collectDataFromVpaidAnalytics(),this.data&&this.data.updatesCount++,a.reportDb("VpaidLog",this.data,this.store),this._dataModified=!1}},{key:"_collectDataFromVpaidAnalytics",value:function(){try{if(this.getVpaidAnalyticsReport){var e=this.getVpaidAnalyticsReport();e.realTotalRequestsCounter=e.totalRequestsCounter,this._wrappersCount&&(e.totalRequestsCounter+=this._wrappersCount,e.wrappersCount=this._wrappersCount);var t=this.iframesDetector.detect(e.iframes,this.friendlyVideoUrl);e.totalRequestsCounter+=this.iframesDetector.calculateWeightsByIframeType(t),e.totalRequestsCounter-=e.iframes.length,this.push("vpaidAnalytics",e,!0),this.push("vpaidIframesDetection",t,!0)}}catch(e){this.push("vpaidAnalyticsCollectFail",{ex:e})}}},{key:"_prettyErrorStatus",value:function(e,t){var i=t.errType?t.errType:e;return u.hasOwnProperty(i)?u[i]:"error_"+i}},{key:"_setDpStats",value:function(){if(!this.isDPStatusSet&&!this.store.get("static_schedule")){var e=Date.now();if(this.data.dtor=!0,this.data.timeFromLastPlayFromQueue=e-this.store.get("playFromQueue"),this.data.timeFromLastPlayFromQueueFound=e-this.store.get("playFromQueueFound"),this.isDPStatusSet=!0,this._incrStats(".tries"),"conversion"===this.data.status){this._incrStats(".conversions"),this.store.set(this.tag.dp+".failsRow",0);var t=this.store.get(this.tag.lineItem+".failsRow");this.store.set(this.tag.lineItem+".failsInARowTillConversion",t<0?0:t),this.store.set(this.tag.lineItem+".failsRow",0)}else this._incrStats(".fails"),this.store.get(this.tag.lineItem+".failsRow")<0?this.store.set(this.tag.lineItem+".failsRow",1):this._incrStats(".failsRow");var i=this.store.get(this.tag.dp)||{fails:0,failsRow:0,conversions:0},n=this.store.get(this.tag.lineItem)||{};n.fails||(n.fails=0),n.failsRow||(n.failsRow=0),n.conversions||(n.conversions=0),i.lineItems=i.lineItems||[],i.lineItems.indexOf(this.tag.lineItem)===-1&&i.lineItems.push(this.tag.lineItem),this.data.lineItemLog=n,this.data.dpLog=i,this.data.conversionsCount=this.store.get("conversionsCount"),this.data.unit={width:this.store.get("width"),height:this.store.get("height")};var r=this.store.get("lineItems")||[];r.indexOf(this.tag.lineItem)===-1&&(r.push(this.tag.lineItem),this.store.set("lineItems",r)),this.store.set(this.tag.lineItem,n)}}},{key:"_incrStats",value:function(e){this.store.incr(this.tag.dp+e),this.store.incr(this.tag.lineItem+e)}},{key:"saveToDb",value:function(){if(this.data){this._collectDataFromVpaidAnalytics(),this._setDpStats();var e;try{e=cmTag.utils.getLoopTime()}catch(e){}e&&(this.data.loopTime=e),this._reportDb()}}},{key:"_reportDb",value:function(){this.isReportDb||(this.data.updatesCount++,a.reportDb("VpaidLog",this.data,this.store),this.tag=null,this.data=null,this.store=null,this.isReportDb=!0,this._dataModified=!1,clearInterval(this.updatingInterval))}},{key:"_addStatus",value:function(e){var t=this;l.indexOf(this.data.status)===-1&&(this.data.status=e,this.data.statuses.push(e),"conversion"===e&&setTimeout(function(){t._sendData()},2e3))}},{key:"toString",value:function(){return a.stringify(this.data,4)}},{key:"setVastWrapperCount",value:function(e){this._wrappersCount=e}}]),e}();t.default=f},function(e,t){"use strict";e.exports=function(){return{adimpression:[],impression:[],aderror:[],error:[],adclickthru:[],clickthru:[],adclickthrough:[],clickthrough:[],adclicktracking:[],clicktracking:[],adoloaded:[],loaded:[],adstarted:[],started:[],adstopped:[],stopped:[],adskipped:[],skipped:[],adskippablestatechange:[],skippablestatechange:[],adsizechange:[],sizechange:[],adlinearchange:[],linearchange:[],addurationchange:[],durationchange:[],adexpandedchange:[],expandedchange:[],advolumechange:[],volumechange:[],advideostart:[],start:[],advideofirstquartile:[],firstquartile:[],advideomidpoint:[],midpoint:[],advideothirdquartile:[],thirdquartile:[],advideocomplete:[],complete:[],adinteraction:[],interaction:[],aduseracceptinvitation:[],acceptinvitation:[],aduserminimize:[],minimize:[],aduserclose:[],close:[],adpaused:[],paused:[],pause:[],adplaying:[],playing:[],resume:[],adlog:[],log:[],adfound:[],admute:[],mute:[],adunmute:[],unmute:[],adfullscreen:[],fullscreen:[],creativeview:[],progress:[],viewability:[],viewable50precent1sec:[],fullyviewable1sec:[]}}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},u=i(5),c=r(u),h=i(12),p=r(h),f=i(15),v=r(f),m=i(1),g=n(m),y=i(35),_=r(y),b=i(43),w=function(e){function t(e,i,n){s(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,e.tag));return r.vpaidLog=i,r.store=n,r.stopped=!1,r.target=e.slot,r.video=e.videoSlot,r.mediaFiles=e.vpaidFiles,r.mediaUrl,r.debugTracker=new c.default("JsVpaid"),r.baseUrl=r.store.get("base_url"),r._onError=e.onError,r.vpaidEvents=Object.assign({},p.default),r.beacon=new v.default(r),r.volume=0,r.isMuted=!0,r.pauseVideoProtection=r.store.get("pusvidprtctn"),r.vpaidResourcesHandler=e.vpaidResourcesHandler,r.playerDAST=e.playerDAST,r.adSettings=e.adSettings,r.vpaidInit={},r.secureMediaFile=g.shouldSecureWrapperAndMediaFile(n),r.tag=e.tag,r.logVpaidTextElements=r.store.get("lgvpdtxtelmnts"),r.countdownRegex=r.store.get("cntdwnrgx"),r.countdownRegex&&(r.countdownRegex=new RegExp(r.countdownRegex,"ig")),r.store.on("stop",function(){r.stopAd()}),r.minValidVideoDuration=r.store.get("mnvlddrtn"),r}return a(t,e),d(t,[{key:"initAd",value:function(e,t,i,n,r,s){var o=this.mediaFiles[0];this.secureMediaFile&&(g.logToBI(this.vpaidLog,"shouldSecureUrl",{replacedProtocol:o.url.indexOf("http:")>-1},!1,!1),o.url=o.url.replace("http:","https:")),this.playerDAST.set({vbr:o.bitrate,vwd:o.width,vht:o.height,ot:o.originalType,st:o.subType}),this.mediaUrl=o.url,this.debugTracker.info("Loading","Iframe was loaded!"),this._shouldHideTarget()&&(this.target.style.display="none");var a=new b(this.target,this.video,{extraOptions:{zIndex:"1"}},null,this.store);this.vpaid=a,this.vpaidInit={width:e,height:t,viewMode:i,bitRate:n,creativeData:r,environmentVars:s},a.loadAdUnit(this.mediaUrl,this._onLoadAdUnit.bind(this))}},{key:"handshakeVersion",value:function(e){return"2.0"}},{key:"resizeAd",value:function(e,t,i,n){this.stopped||(this.target.style.width=e+"px",this.target.style.height=t+"px",this.target.setAttribute("width",e),this.target.setAttribute("height",t),this._safeCall("resizeAd",[e,t,i]),this._resizeAd([e,t,n]))}},{key:"stopAd",value:function(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"pauseAd",value:function(){var e=this;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pauseAd",this).call(this);var i=function(){};(this.pauseVideoProtection||this.adRestarted)&&(i=function(){!e.stopped&&e.video&&(g.logToBI(e.vpaidLog,"pauseAdProtection",{paused:e.video.paused,adRestarted:e.adRestarted}),e.video.paused||e.video.pause())}),this.video.resumeInvoked=!1,this._safeCall("pauseAd",[i])}},{key:"resumeAd",value:function(e){var i=this;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resumeAd",this).call(this);var n=function(){};e&&(n=function(){i.video.play()}),this.video.resumeInvoked=!0,this._safeCall("resumeAd",[n])}},{key:"skipAd",value:function(){this._safeCall("skipAd",[])}},{key:"startAd",value:function(){this._safeCall("startAd",[])}},{key:"expandAd",value:function(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function(){this._safeCall("collapseAd",[])}},{key:"restartAd",value:function(e,t){if(!this.stopped)if(this.clickThruUrl=t,""===this._getVideoSrc(this.video)){if(!e)return;this.video.src=e,this._bindedOnRestartVideoLoad=this._onRestartVideoLoad.bind(this),this.video.addEventListener("canplay",this._bindedOnRestartVideoLoad),this.video.load()}else this._onRestartVideoLoad()}},{key:"subscribe",value:function(e,t){this.vpaidEvents[t]&&e&&this.beacon.addEventListener(t,e)}},{key:"unsubscribe",value:function(e,t){this.vpaidEvents[t]&&e&&this.beacon.removeEventListener(t,e)}},{key:"getAdWidth",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function(){return this._safeCall("getAdHeight",[])}},{key:"getAdSkippableRemainingTime",value:function(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function(e){return this._safeCall("getAdRemainingTime",[e])}},{key:"getAdDuration",value:function(e){return this._safeCall("getAdDuration",[e])}},{key:"getAdSkippableState",value:function(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function(e){return this._safeCall("getAdVolume",[e])}},{key:"getAdIcons",value:function(e){this._safeCall("getAdIcons",[e])}},{key:"getAdCompanions",value:function(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function(){return this._safeCall("getAdLinear",[])}},{key:"setAdVolume",value:function(e){var t=this;this.volume=e,this.video.muted=this.isMuted=0===this.volume,this._safeCall("setAdVolume",[e,function(){t.adRestarted&&(t.video.volume=e,t.video.muted=0===e)}])}},{key:"isReplayable",value:function(){return this.video&&""!==this._getVideoSrc(this.video)}},{key:"getDOMContainer",value:function(){return this.target}},{key:"checkUnfriendlyIframe",value:function(){var e=g.getDeepestIframe(this.target),t="";try{return e&&e.contentDocument,!1}catch(i){return t=e.src,g.logToBI(this.vpaidLog,"unfriendlyIframe",{src:t}),!0}}},{key:"getVideoUrl",value:function(){if(this.stopped)return"";var e=this.getActiveVideoElement();return e?this._getVideoSrc(e):""}},{key:"getVPAIDVideoElement",value:function(){return this._activeVideoElement||null}},{key:"logVideoUrl",value:function(){var e=this.getVideoUrl();e&&(g.logToBI(this.vpaidLog,"jsVpaidVideoUrl",{videoUrl:e}),this.vpaidLog.friendlyVideoUrl=!0)}},{key:"toggleIframeContentDisplay",value:function(e){try{var t="none";"hide"===e?t="hidden":"show"===e&&(t="visible"),this.adUnit._iframe.contentWindow.document.body.style.visibility=t}catch(e){g.logToBI(this.vpaidLog,"toggleIframeContentDisplayFail",{ex:e})}}},{key:"setCompletionOnAdStoppedTimeout",value:function(){var e=this,t=this.tag.getValueByKey("cmpltonstpdms");t>0&&(this.completionOnAdStoppedTimeout||(this.completionOnAdStoppedTimeout=setTimeout(function(){e.stopped||e.beacon.dispatchEvent(e.vpaidEvents.AdStopped)},t)))}},{key:"handleVpaidContent",value:function(){var e=this;this.adUnit._iframe&&(this.logVpaidTextElements||this.countdownRegex)&&setTimeout(function(){e.vpaidTextElements={},e._getAndHandleVpaidContent(e.adUnit._iframe),Object.keys(e.vpaidTextElements).length>0&&g.logToBI(e.vpaidLog,"vpaidTextElements",e.vpaidTextElements)},1)}},{key:"onAfterStop",value:function(){}},{key:"removeClickableTarget",value:function(){}},{key:"_onLoadAdUnit",value:function(e,t){try{if(this.stopped)return;if(e)return void this._onLoadAdUnitError(e);g.logToBI(this.vpaidLog,"loadVPAIDJSScript",{scriptLoaded:!0}),this.adUnit=t,this.store.get("imapihok")&&this._hookIMA(),this._bindIframe(t),this._bindAdUnitEvents(t),t.handshakeVersion("2.0",this._onHandshake.bind(this)),this._handleCompleteOnAdStopped()}catch(e){g.logToBI(this.vpaidLog,"loadVPAIDJSScriptErr",{err:e.message})}}},{key:"_onLoadAdUnitError",value:function(e){g.logToBI(this.vpaidLog,"loadVPAIDJSScript",{scriptLoadedError:!0}),this.store&&this.store.get("aduntldflbfruntld")?this._onError(e,"adUnitLoadFailed"):this._onError()}},{key:"_onHandshake",value:function(){this.adUnit.initAd(this.vpaidInit.width,this.vpaidInit.height,this.vpaidInit.viewMode,-1,this.vpaidInit.creativeData,{})}},{key:"_handleCompleteOnAdStopped",value:function(){var e=this.store.get("cmpltonstpddmn");e&&e.length>0&&this.mediaUrl.search(new RegExp(e.join("|"),"i"))!=-1&&(this.completeOnAdStop=!0)}},{key:"_bindIframe",value:function(e){var t=e._iframe;this.vpaidResourcesHandler.inject(t,this),this._onBindIframe(t),this._loadAdditionalScripts()}},{key:"_bindAdUnitEvents",value:function(e){var t=this;for(var i in this.vpaidEvents)!function(i){e.subscribe(i,function(e){t._allEventsHandler(i,e)})}(i)}},{key:"_allEventsHandler",value:function(e,t){if(!this.stopped){if(this._shouldHideTarget()&&"block"!==this.target.style.display&&(this.target.style.display="block"),e===this.vpaidEvents.AdStopped)this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout);else if(e===this.vpaidEvents.AdLoaded)this.adLoaded=!0;else if(e===this.vpaidEvents.AdImpression&&(this._onAdImpression(),!this._dispatchAdImpression()))return;this.beacon.dispatchEvent(e,t)}}},{key:"_onAdImpression",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onAdImpression",this).call(this);var e=this.video.src;e&&g.logToBI(this.vpaidLog,"videoUrl",{url:e}),this.pauseVideoProtection&&this.video&&this.video.protectPause(),this._registerToTickingEvent()}},{key:"_dispatchAdImpression",value:function(){return!0}},{key:"_safeCall",value:function(e,t){if(!this.stopped&&this.adUnit){"resizeAd"===e&&this._resizeAd(t);try{return this.adUnit[e].apply(this.adUnit,t)}catch(i){return g.logToBI(this.vpaidLog,"initJsError",{err:i.message,funcName:e,args:t,stack:i.stack}),this._onSafeCallAdError(i),!1}}}},{key:"_resizeAd",value:function(e,t,i,n){}},{key:"_onSafeCallAdError",value:function(e){}},{key:"_getVideoSrc",value:function(e){if(!this.stopped)return e.getSrc?e.getSrc():e.src||e.currentSrc||""}},{key:"_stopAd",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stopAd",this).call(this),this.stopped||(this.adUnit&&this._destroyAdUnit(),this._bindedOnTicking&&(this.video.removeEventListener("ticking",this._bindedOnTicking),this._bindedOnTicking=void 0),this.stopped=!0,this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this.iframe=this.vpaid=this.imaApi=this.callIMAApi=this.adUnit=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=this.beacon=this._onSwitchFromCanvasToVideo=this.vpaidLog=this.store=this.tag=this.registerAnalyticsToVpaidLog=void 0,this.onAfterStop())}},{key:"_destroyAdUnit",value:function(){if(this.vpaidResourcesHandler.destroy(this.adUnit._iframe),this.adUnit._iframe&&this.adUnit._iframe.contentWindow&&this.additionalScripts&&this.additionalScripts.length>0)try{for(var e=0;e<this.additionalScripts.length;e++)this.adUnit._iframe.contentDocument.head.removeChild(this.additionalScripts[e]);this.onIframeEvent=void 0}catch(e){}this.adUnit._destroy()}},{key:"_onRestartVideoLoad",value:function(){var e=this;this.adRestarted=!0,this._bindedOnRestartVideoLoad&&(this.video.removeEventListener("canplay",this._bindedOnRestartVideoLoad),this._bindedOnRestartVideoLoad=void 0),this.video.currentTime=0,this._resizeVideotoParentSize(),this.video.play();var t=function(){e.clickThruUrl&&e.beacon.dispatchEvent(e.vpaidEvents.AdClickThru,{url:e.clickThruUrl,playerHandles:!0})},i=function i(){e.video.removeEventListener("ended",i),e.video.removeEventListener("click",t),e._allEventsHandler(e.vpaidEvents.AdStopped,{}),e._allEventsHandler(e.vpaidEvents.AdVideoComplete,{})};this.video.addEventListener("ended",i),this.video.addEventListener("click",t)}},{key:"_resizeVideotoParentSize",value:function(){this.video.style.width=this.target.style.width,this.video.style.height=this.target.style.height}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"_getActiveVideoInIframes",value:function(e){var t=this,i=null;if(!e||0===e.length)return i;try{g.DOMIterator(e[0],"iframe",function(e){e.forEach(function(e){i||(t.minValidVideoDuration?e.duration&&e.duration>t.minValidVideoDuration&&(i=e):i=e)})},"video",this.store.get("debug"))}catch(e){}return i}},{key:"_getAndHandleVpaidContent",value:function(e){try{for(var t=e.contentWindow.document.body.getElementsByTagName("*")||[],i=0;i<t.length;i++){var n=t[i],r=n.nodeName.toLowerCase();if("script"!==r)if("iframe"===r)this._getAndHandleVpaidContent(n);else{
var s=n.textContent?n.textContent.trim():"";s&&this._logVpaidTextElements(n,r,s)}}}catch(e){}}},{key:"_logVpaidTextElements",value:function(e,t,i){this.logVpaidTextElements&&(this.vpaidTextElements[t]=this.vpaidTextElements[t]||[],this.vpaidTextElements[t].push({id:e.id,className:e.className,text:i}))}},{key:"_loadAdditionalScripts",value:function(){if(this.adSettings&&this.adSettings.hasOwnProperty("adtnlscrpts")&&this.adSettings.adtnlscrpts){this.additionalScripts=[],this.onIframeEvent=this._onIframeEvent.bind(this);try{for(var e=0;e<this.adSettings.adtnlscrpts.length;e++){var t=this.adUnit._iframe.contentDocument.createElement("script");t.src=this.adSettings.adtnlscrpts[e].src,t.type="text/javascript",t.onload=this.adSettings.adtnlscrpts[e].clbk.bind(this),this.adUnit._iframe.contentDocument.head.appendChild(t),this.additionalScripts.push(t)}}catch(e){}}}},{key:"_onIframeEvent",value:function(e){if(!this.stopped&&this._shouldListenToIframeEvents()){if(!this.adSettings.ifrmevts.hasOwnProperty(e.name)||!this.vpaidEvents.hasOwnProperty(this.adSettings.ifrmevts[e.name]))return;this._allEventsHandler(this.adSettings.ifrmevts[e.name],{})}}},{key:"_shouldListenToIframeEvents",value:function(){return this.adSettings&&this.adSettings.hasOwnProperty("ifrmevts")&&this.adSettings.ifrmevts}},{key:"_onAdError",value:function(){}},{key:"_shouldHideTarget",value:function(){return this.adSettings.hasOwnProperty("hdtrgt")&&this.adSettings.hdtrgt}},{key:"_onTicking",value:function(e){this.beacon.dispatchEvent(this.vpaidEvents.TimeUpdated,e.data)}},{key:"_registerToTickingEvent",value:function(){var e=this.tag.getValueByKey("vdtck")||0;e>0&&(this._bindedOnTicking=this._onTicking.bind(this),this.video.addEventListener("ticking",this._bindedOnTicking),this.video.registerTickingEvents(e))}},{key:"getActiveVideoElement",value:function(){if(!this.stopped)return this._activeVideoElement?this._activeVideoElement:this._getVideoSrc(this.video)?(this._activeVideoElement=this.video,g.logToBI(this.vpaidLog,"jsVpaidVideo",{videoType:"local"}),this._activeVideoElement):(this._activeVideoElement=this._getActiveVideoInIframes(this.target.querySelectorAll("iframe")),this._activeVideoElement?g.logToBI(this.vpaidLog,"jsVpaidVideo",{videoType:"friendlyIframe"}):g.logToBI(this.vpaidLog,"jsVpaidVideo",{videoType:"unfriendlyIframe"}),this._activeVideoElement)}}]),t}(_.default);t.default=w},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},u=i(15),c=r(u),h=i(5),p=(r(h),i(12)),f=r(p),v=i(1),m=n(v),g=i(70),y=r(g),_=i(35),b=r(_),w=function(e){function t(e,i,n){s(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,e.tag));return r.vpaidLog=i,r.store=n,r.stopped=!1,r.target=e.slot,r.video=e.videoSlot,r.mediaFiles=e.vpaidFiles,r.mediaFile,r.mediaUrl,r.playerWidth=0,r.playerhHeight=0,r.adVolume=0,r.skipTime=60,r.eventsToFire={adLoaded:!1,adImpression:!1},r.adPaused=!0,r.playerReady=!1,r.videoLength=0,r.beacon=new c.default(r),r.vpaidEvents=Object.assign({},f.default),r._createBindedCallback(),r.playerDAST=e.playerDAST,r.tag=e.tag,e.trackingPixels.progress.length>0&&(r.progressEvents=e.trackingPixels.progress),r.store.on("stop",function(){r.stopAd()}),r}return a(t,e),d(t,[{key:"subscribe",value:function(e,t){this.vpaidEvents[t]&&this.beacon.addEventListener(t,e)}},{key:"unsubscribe",value:function(e,t){this.vpaidEvents[t]&&void 0!==e&&this.beacon.removeEventListener(t,e)}},{key:"handshakeVersion",value:function(){return"1.1"}},{key:"initAd",value:function(e,t,i,n,r,s){this.stopped||(this.resizeAd(e,t,i),this._prepareVideoTag(),this._prepareInteractiveAd(r))}},{key:"_prepareInteractiveAd",value:function(e){var t=this;if(e.AdParameters){var i=JSON.parse(e.AdParameters);i.hasOwnProperty("interactive_ads")&&(this.interactiveAds=new y.default(i.interactive_ads,this.target,this.vpaidLog,this.store),this.interactiveAds.on("interactiveAdClicked",function(e){m.logToBI(t.vpaidLog,"interactiveAdClicked",e,!1,!1),t.beacon.dispatchEvent(t.vpaidEvents.AdClickThru,e)}))}}},{key:"resizeAd",value:function(e,t,i,n){this.stopped||(this.playerWidth=parseInt(e),this.playerhHeight=parseInt(t),this.video.style.width=this.playerWidth+"px",this.target.style.width=this.playerWidth+"px",this.video.style.height=this.playerhHeight+"px",this.target.style.height=this.playerhHeight+"px",this.video.setAttribute("width",this.playerWidth),this.target.setAttribute("width",this.playerWidth),this.video.setAttribute("height",this.playerhHeight),this.target.setAttribute("height",this.playerhHeight),this._resizeAd(this.playerWidth,this.playerhHeight,i,n))}},{key:"startAd",value:function(){this._bindedOnPlay(),this.startAdFired=!0}},{key:"pauseAd",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pauseAd",this).call(this),this.stopped||this.video.pause()}},{key:"resumeAd",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resumeAd",this).call(this),this.stopped||(this._sendAdPlayingOnProgress=!0,this.video.play())}},{key:"stopAd",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stopAd",this).call(this),this.stopped||(this.stopped=!0,this.video.destroy(),this._disconnectFromVideoTag(),this.interactiveAds&&this.interactiveAds.destroy(),this.vpaidLog=this.store=this.mediaFiles=this.target=this.beacon=this.video=this._onError=this._onSwitchFromCanvasToVideo=this.isReplayable=this.eventsToFire=this.progressEvents=this.interactiveAds=void 0,setTimeout(this.onAfterStop,50))}},{key:"restartAd",value:function(){var e=this;if(!this.stopped){var t=function t(){e.video.removeEventListener("ended",t),e._onComplete()};this.video.addEventListener("ended",t)}}},{key:"skipAd",value:function(){this.stopped||this.getAdSkippableState()&&this.stopAd()}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"getAdVolume",value:function(e){e&&e(null,this.adVolume)}},{key:"getAdDuration",value:function(){return this.video.duration||this.videoLength}},{key:"getAdSkippableState",value:function(){return 0==this.getAdSkippableRemainingTime()}},{key:"getAdSkippableRemainingTime",value:function(){var e=this.getAdRemainingTime()-this.skipTime;return e>0?e:0}},{key:"getAdRemainingTime",value:function(){return this.stopped?0:this.video.remainingTime}},{key:"getAdWidth",value:function(){return this.playerWidth}},{key:"getAdHeight",value:function(){return this.playerhHeight}},{key:"getAdIcons",value:function(){return[]}},{key:"getAdCompanions",value:function(){return[]}},{key:"getAdExpanded",value:function(){return!0}},{key:"getAdLinear",value:function(){return!0}},{key:"setAdVolume",value:function(e){this.stopped||(this.video.volume=this.adVolume=parseFloat(e)<=1?e:parseInt(e)/100,this.video.muted=0==e)}},{key:"_prepareVideoTag",value:function(){this.stopped||(this.video.removeAttribute("controls"),this._connectToVideoTag(),this._loadVideoTagSources())}},{key:"_connectToVideoTag",value:function(){this.stopped||(this.video.addEventListener("canplay",this._bindedOnCanPlay,!0),this.video.addEventListener("play",this._bindedOnPlay,!0),this.video.addEventListener("playing",this._bindedOnPlaying,!0),this.video.addEventListener("pause",this._bindedOnPause,!0),this.video.addEventListener("ended",this._bindedOnComplete,!0),this.video.addEventListener("error",this._bindedOnPlayerError,!0),this.video.addEventListener("click",this._bindedOnClickThru,!0),this.video.addEventListener("volumechange",this._bindedOnVolumeChange,!0),this.video.addEventListener("timeupdate",this._bindedOnTimeUpdate,!0),this.video.addEventListener("ticking",this._bindedOnTicking,!0),this.video.addEventListener("firstQuartile",this._bindedOnProgress,!0),this.video.addEventListener("midpoint",this._bindedOnProgress,!0),this.video.addEventListener("thirdQuartile",this._bindedOnProgress,!0),this.video.addEventListener("timeProgress",this._bindedOnProgress,!0),this.video.addEventListener("durationchange",this._bindedOnDurationChange,!0),this.video.addEventListener("waiting",this._bindedOnWaiting,!0))}},{key:"_disconnectFromVideoTag",value:function(){this.video.removeEventListener("canplay",this._bindedOnCanPlay,!0),this.video.removeEventListener("play",this._bindedOnPlay,!0),this.video.removeEventListener("playing",this._bindedOnPlaying,!0),this.video.removeEventListener("pause",this._bindedOnPause,!0),this.video.removeEventListener("ended",this._bindedOnComplete,!0),this.video.removeEventListener("error",this._bindedOnPlayerError,!0),this.video.removeEventListener("click",this._bindedOnClickThru,!0),this.video.removeEventListener("volumechange",this._bindedOnVolumeChange,!0),this.video.removeEventListener("timeupdate",this._bindedOnTimeUpdate,!0),this.video.removeEventListener("ticking",this._bindedOnTicking,!0),this.video.removeEventListener("firstQuartile",this._bindedOnProgress,!0),this.video.removeEventListener("midpoint",this._bindedOnProgress,!0),this.video.removeEventListener("thirdQuartile",this._bindedOnProgress,!0),this.video.removeEventListener("timeProgress",this._bindedOnProgress,!0),this.video.removeEventListener("durationchange",this._bindedOnDurationChange,!0),this.video.removeEventListener("waiting",this._bindedOnWaiting,!0),this._bindedOnCanPlay=this._bindedOnPlay=this._bindedOnPause=this._bindedOnComplete=this._bindedOnPlayerError=this._bindedOnVolumeChange=this._bindedOnTimeUpdate=this._bindedOnTicking=this._bindedOnProgress=this._bindedOnDurationChange=this._bindedOnWaiting=this._bindedOnPlaying=this._bindedOnPlaying=this._bindedOnClickThru=void 0}},{key:"_loadVideoTagSources",value:function(){this.stopped||(this.playingMediaFile=this.video.appendVideoSources(this.mediaFiles),this.playingMediaFile&&(this.mediaUrl=this.playingMediaFile.mediaUrl,this.playerDAST.set({vu:this.playingMediaFile.mediaUrl,vbr:this.playingMediaFile.bitrate,vwd:this.playingMediaFile.width,vht:this.playingMediaFile.height,ot:this.playingMediaFile.originalType,st:this.playingMediaFile.subType})))}},{key:"_createBindedCallback",value:function(){this._bindedOnCanPlay=this._onCanPlay.bind(this),this._bindedOnPause=this._onPause.bind(this),this._bindedOnComplete=this._onComplete.bind(this),this._bindedOnPlayerError=this._onPlayerError.bind(this),this._bindedOnVolumeChange=this._onVolumeChange.bind(this),this._bindedOnTimeUpdate=this._onTimeUpdate.bind(this),this._bindedOnTicking=this._onTicking.bind(this),this._bindedOnProgress=this._onProgress.bind(this),this._bindedOnDurationChange=this._onDurationChange.bind(this),this._bindedOnWaiting=this._onWaiting.bind(this),this._bindedOnPlay=this._onPlay.bind(this),this._bindedOnPlaying=this._onPlaying.bind(this),this._bindedOnClickThru=this._onClickThru.bind(this)}},{key:"_onCanPlay",value:function(){this.stopped||this.video.forceCanvas||(this.videoLength=this.video.duration,m.logToBI(this.vpaidLog,"canplay",{videoCanPlay:!0}),this.logVideoBuffer("Canplay"),this.playerReady||(this.playerReady=!0,this._fireAdLoaded(),this.adPaused||this._fireAdImpression()))}},{key:"_onPlay",value:function(e,t){this.stopped||(this.adPaused?(this.adPaused=!1,this._setInteractiveAdsIsPaused(),e&&setTimeout(function(){this._fireAdImpression()}.bind(this),t)):this._sendAdPlayingOnProgress=!0)}},{key:"_onPlaying",value:function(e){this._conditionalDispatchAdPlaying()}},{key:"_conditionalDispatchAdPlaying",value:function(){this._sendAdPlayingOnProgress&&(this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),this._sendAdPlayingOnProgress=!1)}},{key:"_onPause",value:function(){this.stopped||(this.adPaused=!0,parseInt(this.video.currentTime)<parseInt(this.video.duration)&&this.beacon.dispatchEvent(this.vpaidEvents.AdPaused),this._setInteractiveAdsIsPaused())}},{key:"_onComplete",value:function(){this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoComplete),this.beacon&&!this.stayAlive&&this.beacon.dispatchEvent(this.vpaidEvents.AdStopped))}},{key:"_onPlayerError",value:function(){this.stopped||--this.video.relevantSources>0||this.beacon.dispatchEvent(this.vpaidEvents.AdError)}},{key:"_onVolumeChange",value:function(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{volume:this.video.volume})}},{key:"_onTimeUpdate",value:function(){this.stopped||(this.videoLength=this.getAdDuration(),this.videoLength&&(this._conditionalDispatchAdPlaying(),this.interactiveAds&&this.interactiveAds.onTimeupdate(this.video.currentTime)))}},{key:"_onTicking",value:function(e){this.beacon.dispatchEvent(this.vpaidEvents.TimeUpdated,e.data)}},{key:"_onDurationChange",value:function(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdDurationChange)}},{key:"_onWaiting",value:function(){m.logToBI(this.vpaidLog,"waiting",{videoCurrentTime:this.video.currentTime})}},{key:"_onClickThru",value:function(e){e?(this._sendAdPlayingOnProgress=!0,this.video.play()):(this.beacon.dispatchEvent(this.vpaidEvents.AdClickThru,{playerHandles:!0}),this.video.pause())}},{key:"_registerToProgressEvent",value:function(){this.progressEvents&&this.video.registerProgressEvents(this.progressEvents)}},{key:"_registerToTickingEvent",value:function(){var e=this.tag.getValueByKey("vdtck")||0;e>0&&this.video.registerTickingEvents(e)}},{key:"_setInteractiveAdsIsPaused",value:function(){this.interactiveAds&&this.interactiveAds.setIsPaused(this.adPaused)}},{key:"_fireAdLoaded",value:function(){this.eventsToFire.adLoaded||this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded),this.eventsToFire.adLoaded=!0}},{key:"_fireAdImpression",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_fireAdImpression",this).call(this),this.stopped||this.eventsToFire.adImpression||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this.eventsToFire.adImpression=!0,this.adPaused=!1,this._registerToProgressEvent(),this._registerToTickingEvent(),this._setInteractiveAdsIsPaused())}},{key:"_onProgress",value:function(e){"firstQuartile"===e.type?this.beacon.dispatchEvent(this.vpaidEvents.AdVideoFirstQuartile):"midpoint"===e.type?this.beacon.dispatchEvent(this.vpaidEvents.AdVideoMidpoint):"thirdQuartile"===e.type?this.beacon.dispatchEvent(this.vpaidEvents.AdVideoThirdQuartile):"timeProgress"===e.type&&this._onTimeProgressEvent(e.data)}},{key:"_onTimeProgressEvent",value:function(e){for(var t=0;t<this.progressEvents.length;t++)if(!this.progressEvents[t].fired){var i=this.progressEvents[t].offset<=("time"===this.progressEvents[t].offsetType?e.time:e.pre);i&&(this.progressEvents[t].fired=!0,this.beacon.dispatchEvent(this.vpaidEvents.Progress,this.progressEvents[t]),this.progressEvents.splice(t,1))}}},{key:"getDOMContainer",value:function(){return this.target}},{key:"getVideoUrl",value:function(){return this.stopped?"":this.video.getSrc()}},{key:"dontDie",value:function(){this.stayAlive=!0}},{key:"onAfterStop",value:function(){}},{key:"removeClickableTarget",value:function(){}},{key:"logVideoBuffer",value:function(e){void 0!==this.video.bufferSize&&m.logToBI(this.vpaidLog,"videoBuffer",{status:e,buffered:this.video.bufferSize},!1,!1)}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"_resizeAd",value:function(e,t,i,n){}},{key:"getActiveVideoElement",value:function(){return this.video}}]),t}(b.default);t.default=w},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(6),d=.03,l=50,u=function(e){function t(e,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.watchVideoInterval=e.get("wtchvdointrvl"),s.unitPredictorsInterval=e.get("rprtvidsttsintrvl"),s.newCompletionByVideoProgress=e.get("q5byprgrss"),s.isMobile=e.get("isMobile")||!1,s.timeoutLengthToAdCompletion=i.getValueByKey((s.isMobile?"mbl":"dsk")+"tmouttoadcmpltn"),s.newCompletionByVideoProgressFired=!1,s.isVForceActive=e.get("vForce"),s.reportWatchTimeInterval=i.getValueByKey("wtchprgrssopp"),s.isDirectDemand=i.isDirectDemand,s.bufferingEventsToReport=i.getValueByKey("rprtbuffrng"),s.bufferingDetected=!1,s.lastPlayPos=0,s.bufferingCounter=0,s}return s(t,e),o(t,[{key:"resumeAd",value:function(){this.stopped||this.activeVideoElement&&this.watchVideoInterval&&this.activeVideoElement.currentTime&&this.activeVideoElement.duration&&(this.emit("activeAdCurrentTime",{currentTime:this.activeVideoElement.currentTime.toFixed(3),duration:this.activeVideoElement.duration.toFixed(3)}),this.watchActiveVideoElement())}},{key:"pauseAd",value:function(){this.activeVideoElement&&this.watchVideoInterval&&this.unwatchActiveVideoElement()}},{key:"stopAd",value:function(){this.stopped||(this.stopped=!0,this.activeVideoElement&&this.watchVideoInterval&&this.unwatchActiveVideoElement())}},{key:"_fireAdImpression",value:function(){this._onAdImpression()}},{key:"_onAdImpression",value:function(){this.stopped||(this.activeVideoElement=this.getActiveVideoElement(),!this.isVForceActive&&this.activeVideoElement&&this.watchVideoInterval&&this.watchActiveVideoElement())}},{key:"watchActiveVideoElement",value:function(){this._sampleVideoCurrentTimeIntervalId||(this._sampleVideoCurrentTimeIntervalId=setInterval(this._sampleVideoCurrentTimeHandler.bind(this),l))}},{key:"unwatchActiveVideoElement",value:function(){this._sampleVideoCurrentTimeIntervalId&&(clearInterval(this._sampleVideoCurrentTimeIntervalId),this._sampleVideoCurrentTimeIntervalId=void 0)}},{key:"_sampleVideoCurrentTimeHandler",value:function(){this.reportCurrentTimeToUnitPredictors(),this.testNewCompletion(),this.reportWatchTime(),this.checkBuffering()}},{key:"reportCurrentTimeToUnitPredictors",value:function(){if(this.unitPredictorsInterval&&this.activeVideoElement.currentTime&&this.activeVideoElement.duration){var e=Math.floor(1e3*this.activeVideoElement.currentTime/this.unitPredictorsInterval);e&&this._currentIntervalMultiplier!==e&&(this._currentIntervalMultiplier=e,this.emit("activeAdCurrentTime",{currentTime:this.activeVideoElement.currentTime.toFixed(3),duration:this.activeVideoElement.duration.toFixed(3)}))}}},{key:"testNewCompletion",value:function(){this.newCompletionByVideoProgress&&!this.newCompletionByVideoProgressFired&&1e3*this.activeVideoElement.currentTime>this.timeoutLengthToAdCompletion&&(this.emit("newCompletion"),this.newCompletionByVideoProgressFired=!0)}},{key:"checkBuffering",value:function(){if(this.bufferingEventsToReport&&this.bufferingCounter<this.bufferingEventsToReport){var e=this.activeVideoElement.currentTime;this.bufferingDetected?e>this.lastPlayPos+d&&(this.bufferingDetected=!1,this.emit("bufferingEnded"),this.bufferingCounter++):e<this.lastPlayPos+d&&(this.bufferingDetected=!0,this.emit("buffering")),this.lastPlayPos=e}}},{key:"reportWatchTime",value:function(){if(this.reportWatchTimeInterval&&this.isDirectDemand){var e=Math.floor(this.activeVideoElement.currentTime);e>0&&this._currentTimeFloored!==e&&e%this.reportWatchTimeInterval===0&&(this._currentTimeFloored=e,this.emit("watchProgress",{currentTime:e}))}}},{key:"getActiveVideoElementDuration",value:function(){var e=this.activeVideoElement?this.activeVideoElement.duration:null;return e}}]),t}(a.EventEmitter);t.default=u},function(e,t,i){"use strict";function n(){try{Promise===s&&(Promise=r)}catch(e){}return s}var r;"undefined"!=typeof Promise&&(r=Promise);var s=i(112)();s.noConflict=n,e.exports=s},function(e,t,i){"use strict";e.exports=function(e){function t(t,i,a){return function(d){var l=a._boundValue();e:for(var u=0;u<t.length;++u){var c=t[u];if(c===Error||null!=c&&c.prototype instanceof Error){if(d instanceof c)return s(i).call(l,d)}else if("function"==typeof c){var h=s(c).call(l,d);if(h===o)return h;if(h)return s(i).call(l,d)}else if(n.isObject(d)){for(var p=r(c),f=0;f<p.length;++f){var v=p[f];if(c[v]!=d[v])continue e}return s(i).call(l,d)}}return e}}var n=i(3),r=i(8).keys,s=n.tryCatch,o=n.errorObj;return t}},function(e,t,i){"use strict";function n(e){return e instanceof Error&&u.getPrototypeOf(e)===Error.prototype}function r(e){var t;if(n(e)){t=new l(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var i=u.keys(e),r=0;r<i.length;++r){var s=i[r];c.test(s)||(t[s]=e[s])}return t}return o.markAsOriginatingFromRejection(e),e}function s(e,t){return function(i,n){if(null!==e){if(i){var s=r(a(i));e._attachExtraTrace(s),e._reject(s)}else if(t){for(var o=arguments.length,d=new Array(Math.max(o-1,0)),l=1;l<o;++l)d[l-1]=arguments[l];e._fulfill(d)}else e._fulfill(n);e=null}}}var o=i(3),a=o.maybeWrapAsError,d=i(7),l=d.OperationalError,u=i(8),c=/^(?:name|message|stack|cause)$/;e.exports=s},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(t){var i=e,n=i.lib,r=n.WordArray,s=n.Hasher,o=i.algo,a=[],d=[];!function(){function e(e){for(var i=t.sqrt(e),n=2;n<=i;n++)if(!(e%n))return!1;return!0}function i(e){return 4294967296*(e-(0|e))|0}for(var n=2,r=0;r<64;)e(n)&&(r<8&&(a[r]=i(t.pow(n,.5))),d[r]=i(t.pow(n,1/3)),r++),n++}();var l=[],u=o.SHA256=s.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],u=i[5],c=i[6],h=i[7],p=0;p<64;p++){if(p<16)l[p]=0|e[t+p];else{var f=l[p-15],v=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=l[p-2],g=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[p]=v+l[p-7]+g+l[p-16]}var y=a&u^~a&c,_=n&r^n&s^r&s,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),w=(a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25),k=h+w+y+d[p]+l[p],A=b+_;h=c,c=u,u=a,a=o+k|0,o=s,s=r,r=n,n=k+A|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+o|0,i[4]=i[4]+a|0,i[5]=i[5]+u|0,i[6]=i[6]+c|0,i[7]=i[7]+h|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return i[r>>>5]|=128<<24-r%32,i[(r+64>>>9<<4)+14]=t.floor(n/4294967296),i[(r+64>>>9<<4)+15]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});i.SHA256=s._createHelper(u),i.HmacSHA256=s._createHmacHelper(u)}(Math),e.SHA256})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(19))}(this,function(e){return function(){function t(){return o.create.apply(o,arguments)}var i=e,n=i.lib,r=n.Hasher,s=i.x64,o=s.Word,a=s.WordArray,d=i.algo,l=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=t()}();var c=d.SHA512=r.extend({_doReset:function(){this._hash=new a.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],d=i[5],c=i[6],h=i[7],p=n.high,f=n.low,v=r.high,m=r.low,g=s.high,y=s.low,_=o.high,b=o.low,w=a.high,k=a.low,A=d.high,T=d.low,C=c.high,E=c.low,P=h.high,S=h.low,V=p,x=f,I=v,O=m,D=g,M=y,R=_,F=b,L=w,B=k,j=A,H=T,U=C,N=E,W=P,z=S,q=0;q<80;q++){var G=u[q];if(q<16)var K=G.high=0|e[t+2*q],Q=G.low=0|e[t+2*q+1];else{var X=u[q-15],Y=X.high,$=X.low,J=(Y>>>1|$<<31)^(Y>>>8|$<<24)^Y>>>7,Z=($>>>1|Y<<31)^($>>>8|Y<<24)^($>>>7|Y<<25),ee=u[q-2],te=ee.high,ie=ee.low,ne=(te>>>19|ie<<13)^(te<<3|ie>>>29)^te>>>6,re=(ie>>>19|te<<13)^(ie<<3|te>>>29)^(ie>>>6|te<<26),se=u[q-7],oe=se.high,ae=se.low,de=u[q-16],le=de.high,ue=de.low,Q=Z+ae,K=J+oe+(Q>>>0<Z>>>0?1:0),Q=Q+re,K=K+ne+(Q>>>0<re>>>0?1:0),Q=Q+ue,K=K+le+(Q>>>0<ue>>>0?1:0);G.high=K,G.low=Q}var ce=L&j^~L&U,he=B&H^~B&N,pe=V&I^V&D^I&D,fe=x&O^x&M^O&M,ve=(V>>>28|x<<4)^(V<<30|x>>>2)^(V<<25|x>>>7),me=(x>>>28|V<<4)^(x<<30|V>>>2)^(x<<25|V>>>7),ge=(L>>>14|B<<18)^(L>>>18|B<<14)^(L<<23|B>>>9),ye=(B>>>14|L<<18)^(B>>>18|L<<14)^(B<<23|L>>>9),_e=l[q],be=_e.high,we=_e.low,ke=z+ye,Ae=W+ge+(ke>>>0<z>>>0?1:0),ke=ke+he,Ae=Ae+ce+(ke>>>0<he>>>0?1:0),ke=ke+we,Ae=Ae+be+(ke>>>0<we>>>0?1:0),ke=ke+Q,Ae=Ae+K+(ke>>>0<Q>>>0?1:0),Te=me+fe,Ce=ve+pe+(Te>>>0<me>>>0?1:0);W=U,z=N,U=j,N=H,j=L,H=B,B=F+ke|0,L=R+Ae+(B>>>0<F>>>0?1:0)|0,R=D,F=M,D=I,M=O,I=V,O=x,x=ke+Te|0,V=Ae+Ce+(x>>>0<ke>>>0?1:0)|0}f=n.low=f+x,n.high=p+V+(f>>>0<x>>>0?1:0),m=r.low=m+O,r.high=v+I+(m>>>0<O>>>0?1:0),y=s.low=y+M,s.high=g+D+(y>>>0<M>>>0?1:0),b=o.low=b+F,o.high=_+R+(b>>>0<F>>>0?1:0),k=a.low=k+B,a.high=w+L+(k>>>0<B>>>0?1:0),T=d.low=T+H,d.high=A+j+(T>>>0<H>>>0?1:0),E=c.low=E+N,c.high=C+U+(E>>>0<N>>>0?1:0),S=h.low=S+z,h.high=P+W+(S>>>0<z>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[(n+128>>>10<<5)+30]=Math.floor(i/4294967296),t[(n+128>>>10<<5)+31]=i,e.sigBytes=4*t.length,this._process();var r=this._hash.toX32();return r},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});i.SHA512=r._createHelper(c),i.HmacSHA512=r._createHmacHelper(c)}(),e.SHA512})},function(e,t){"use strict";function i(e,t,i){}function n(e,t,i){Object.defineProperty(e,t,{writable:!1,configurable:!1,value:i})}var r=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],s=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"],o=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"],a=["setAdVolume"];i.prototype.handshakeVersion=function(e,t){},i.prototype.initAd=function(e,t,i,n,r,s,o){},i.prototype.startAd=function(e){},i.prototype.stopAd=function(e){},i.prototype.skipAd=function(e){},i.prototype.resizeAd=function(e,t,i,n){},i.prototype.pauseAd=function(e){},i.prototype.resumeAd=function(e){},i.prototype.expandAd=function(e){},i.prototype.collapseAd=function(e){},i.prototype.subscribe=function(e,t,i){},i.prototype.unsubscribe=function(e,t){},i.prototype.getAdLinear=function(e){},i.prototype.getAdWidth=function(e){},i.prototype.getAdHeight=function(e){},i.prototype.getAdExpanded=function(e){},i.prototype.getAdSkippableState=function(e){},i.prototype.getAdRemainingTime=function(e){},i.prototype.getAdDuration=function(e){},i.prototype.getAdVolume=function(e){},i.prototype.getAdCompanions=function(e){},i.prototype.getAdIcons=function(e){},i.prototype.setAdVolume=function(e,t){},n(i,"METHODS",r),n(i,"GETTERS",o),n(i,"SETTERS",a),n(i,"EVENTS",s);var d=r.filter(function(e){return["skipAd"].indexOf(e)===-1});n(i,"checkVPAIDInterface",function(e){var t=d.every(function(t){return"function"==typeof e[t]});return t}),e.exports=i},function(e,t,i){"use strict";function n(e,t,i,n){this._isValid=u(e),this._isValid&&(this._creative=e,this._el=t,this._videoEl=i,this._iframe=n,this._subscribers=new l,c.setFullSizeStyle(t),r.call(this))}function r(){if(f.forEach(function(e){this._creative.subscribe(o.bind(this,e),e)}.bind(this)),this._creative.subscribe(s.bind(this),p),this._videoEl){var e=this._iframe.contentDocument.documentElement,t=this._videoEl;e.addEventListener("click",function(i){i.target===e&&t.click()})}}function s(e,t,i){this._subscribers.triggerSync(p,{url:e,id:t,playerHandles:i})}function o(e){this._subscribers.trigger(e,Array.prototype.slice.call(arguments).slice(1))}function a(e,t,i,n){e?e(i,n):i&&t.trigger(h,i)}var d=i(41),l=i(44),u=d.checkVPAIDInterface,c=i(23),h=(d.METHODS,"AdError"),p="AdClickThru",f=d.EVENTS.filter(function(e){return e!=p});n.prototype=Object.create(d.prototype),n.prototype.isValidVPAIDAd=function(){return this._isValid},d.METHODS.forEach(function(e){var t=["subscribe","unsubscribe","initAd"];t.indexOf(e)===-1&&(n.prototype[e]=function(){var t=d.prototype[e].length,i=Array.prototype.slice.call(arguments),n=t===i.length?i.pop():void 0;setTimeout(function(){var t,r=null;try{t=this._creative[e].apply(this._creative,i)}catch(e){r=e}a(n,this._subscribers,r,t);
}.bind(this),0)})}),n.prototype.initAd=function(e,t,i,n,r,s,o){r=r||{},s=c.extend({slot:this._el,videoSlot:this._videoEl},s||{}),setTimeout(function(){var d;try{this._creative.initAd(e,t,i,n,r,s)}catch(e){d=e}a(o,this._subscribers,d)}.bind(this),0)},n.prototype.subscribe=function(e,t,i){this._subscribers.subscribe(t,e,i)},n.prototype.unsubscribe=function(e,t){this._subscribers.unsubscribe(t,e)},n.prototype.on=n.prototype.subscribe,n.prototype.off=n.prototype.unsubscribe,d.GETTERS.forEach(function(e){n.prototype[e]=function(t){setTimeout(function(){var i,n=null;try{i=this._creative[e]()}catch(e){n=e}a(t,this._subscribers,n,i)}.bind(this),0)}}),n.prototype.setAdVolume=function(e,t){setTimeout(function(){var i,n=null;try{this._creative.setAdVolume(e),i=this._creative.getAdVolume()}catch(e){}a(t,this._subscribers,n,i)}.bind(this),0)},n.prototype._destroy=function(){this.stopAd(),this._subscribers.unsubscribeAll()},e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n,r){i=i||{},this._id=p(),this._destroyed=!1,this.store=r,this._frameContainer=h.createElementInEl(e,"div"),this._frameContainer.style.position="initial",this._videoEl=t,this._vpaidOptions=n||{timeout:1e4},this._templateConfig={template:i.template||v,extraOptions:i.extraOptions||{}}}function r(e){var t=this[e];t&&(t.remove&&t.remove(),delete this[e])}function s(){a.call(this),delete this._adUnit}function o(){a.call(this),l.call(this)}function a(){r.call(this,"_frame"),d.call(this)}function d(){this._onLoad&&(window.removeEventListener("message",this._onLoad),h.clearCallbackTimeout(this._onLoad),delete this._onLoad)}function l(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function u(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function c(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var h=i(23),p=h.unique("vpaidIframe"),f=i(42),v='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"></script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');setTimeout(function () {try { if (window.top.onTaboolaVpaidJSVpaidIframeLoaded) { window.top.onTaboolaVpaidJSVpaidIframeLoaded(\'{"data":{"event": "ready", "id": "{{iframeID}}"}, "origin": "{{origin}}"}\'); } } catch (e) {}}, 100);</script></body></html>',m="AdStopped";n.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,o.call(this))},n.prototype.isDestroyed=function(){return this._destroyed},n.prototype.loadAdUnit=function(e,t){function i(e){if(l&&"string"==typeof e&&(e=JSON.parse(e)),e.origin===c()){var i;if(l&&"string"!=typeof e)i=e.data;else try{i=JSON.parse(e.data)}catch(e){i={}}if(i.id===r.getID()){var n,o,a;if(r._frame.contentWindow?(a=r._frame.contentWindow.getVPAIDAd,o=h.validate("function"==typeof a,"the ad didn't return a function to create an ad")):o="the iframe is not anymore in the DOM tree",!o){var u=r._frame.contentWindow.document.querySelector(".ad-element");n=new f(a(),u,r._videoEl,r._frame),n.subscribe(m,s.bind(r)),o=h.validate(n.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")}r._adUnit=n,d.call(r),t(o,o?null:n);try{l&&(window.top.onTaboolaVpaidJSVpaidIframeLoaded=void 0)}catch(e){}return!0}}}function n(){t("timeout",null)}u.call(this),o.call(this);var r=this,a=h.createIframeWithContent(this._frameContainer,this._templateConfig.template,h.extend({iframeURL_JS:e,iframeID:this.getID(),origin:c()},this._templateConfig.extraOptions));this.store.get("msnifrmsrchk")&&(a._src=a.src,Object.defineProperty(a,"src",{get:function(){return a._src},set:function(e){}})),this._frame=a,this._onLoad=h.callbackTimeout(this._vpaidOptions.timeout,i.bind(this),n.bind(this));var l=this.store.get("istblvpd");if(l)try{window.top.onTaboolaVpaidJSVpaidIframeLoaded=this._onLoad}catch(e){}window.addEventListener("message",this._onLoad)},n.prototype.unloadAdUnit=function(){o.call(this)},n.prototype.getID=function(){return this._id},e.exports=n},function(e,t){"use strict";function i(){this._subscribers={}}function n(e,t){setTimeout(function(){e.handler.call(e.context,t)},0)}i.prototype.subscribe=function(e,t,i){this.isHandlerAttached(e,t)||this.get(t).push({handler:e,context:i,eventName:t})},i.prototype.unsubscribe=function(e,t){this._subscribers[t]=this.get(t).filter(function(t){return"*"!==e&&e!==t.handler})},i.prototype.unsubscribeAll=function(){this._subscribers={}},i.prototype.trigger=function(e,t){for(var i=this.get(e),r=0;r<i.length;r++)n(i[r],t)},i.prototype.triggerSync=function(e,t){var i=this.get(e);i.forEach(function(e){e.handler.call(e.context,t)})},i.prototype.get=function(e){return this._subscribers[e]||(this._subscribers[e]=[]),this._subscribers[e]||[]},i.prototype.isHandlerAttached=function(e,t){return this.get(t).some(function(t){return e===t.handler})},e.exports=i},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.decodedData=atob(t),this.nextBits=0,this.numBitsRemaining=0,this.isEndOfStream=!1,this.pointerInDecodedData=0}return n(e,[{key:"getNextByte",value:function(){return this.pointerInDecodedData===this.decodedData.length?-1:this.decodedData.charCodeAt(this.pointerInDecodedData++)}},{key:"read",value:function(){if(this.isEndOfStream)return-1;if(0===this.numBitsRemaining){if(this.nextBits=this.getNextByte(),this.nextBits===-1)return this.isEndOfStream=!0,-1;this.numBitsRemaining=8}return this.numBitsRemaining--,this.nextBits>>7-this.numBitsRemaining&1}},{key:"isEof",value:function(){return this.isEndOfStream||0==this.numBitsRemaining&&this.pointerInDecodedData==this.decodedData.length}},{key:"readChar",value:function(){for(var e=0,t=0;t<7;t++){var i=this.read();e|=i<<t}return String.fromCharCode(e)}},{key:"readByte",value:function(){for(var e=0,t=0;t<8;t++){var i=this.read();e|=i<<t}return e}},{key:"read7bitString",value:function(e){for(var t="",i=0;i<e;i++)t+=this.readChar();return t}},{key:"read8bitString",value:function(e){for(var t="",i=0;i<e;i++)t+=String.fromCharCode(this.readByte());return t}},{key:"readBytes",value:function(e){for(var t=new ArrayBuffer(e),i=0;i<e;i++)t[i]=this.readByte();return t}},{key:"readInt",value:function(e){if(void 0!==e){for(var t=0,i=0;i<e;i++){var n=this.read();t|=n<<i}return t}for(var r=0,i=3;i>=0;i--)r+=this.readByte(),i>0&&(r<<=8);return r}},{key:"readLong",value:function(){for(var e=0,t=7;t>=0;t--)e+=this.readByte(),t>0&&(e<<=8);return e}},{key:"readShort",value:function(){for(var e=0,t=1;t>=0;t--)e+=this.readByte(),t>0&&(e<<=8);return e}},{key:"readFloat",value:function(){for(var e=new ArrayBuffer(4),t=new DataView(e),i=0;i<4;i++)t.setUint8(i,this.readByte());var n=t.getFloat32(0);return n}},{key:"readDouble",value:function(){for(var e=new ArrayBuffer(8),t=new DataView(e),i=0;i<8;i++)t.setUint8(i,this.readByte());var n=t.getFloat64(0);return n}},{key:"readBool",value:function(){return this.read()>0}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),a=n(o),d=i(17),l=(i(126),1e4),u=function(){function e(t){var i=this;r(this,e),this.store=t;var n=this.store.get("comp");0!==Object.keys(n).length&&(d.init(this.store.data),d.get("competitors-detection",this.store.get("cmpdtctv"),function(e){i.competitorsDetection=new e(n),i.competitorsDetection.startDetection(),i.logCompetitorsData=i._logCompetitorsData.bind(i),i.logInterval=setInterval(i.logCompetitorsData,l)}))}return s(e,[{key:"_logCompetitorsData",value:function(){this.stopped||a.reportByIndex("player_options","competitors",{_id:a.generateGuid(10),type:"competitors",competitors:a.encodeData(this.competitorsDetection.get()),player_id:this.store.get("player_id"),isMobile:this.store.get("isMobile")},this.store)}},{key:"destroy",value:function(){this.competitorsDetection&&(this._logCompetitorsData(),this.competitorsDetection.destroy()),this.competitorsDetection=this.logCompetitorsData=this.store=void 0,this.logInterval=clearTimeout(this.logInterval),this.stopped=!0}}]),e}();t.default=u},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.store=t,this.effectiveTypes={"slow-2g":1,"2g":2,"3g":3,"4g":4},this.types={bluetooth:1,cellular:2,ethernet:3,none:4,wifi:5,wimax:6,other:7,unknown:8},this.navigatorConnection={},this._detectConnectionType()}return n(e,[{key:"_detectConnectionType",value:function(){var e=this,t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(t){var i=function(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection,i=t.effectiveType||"",n=t.type||"";e.navigatorConnection={browserSupport:!0,downlink:t.downlink||0,effectiveType:i,type:n,effectiveTypeId:e.effectiveTypes.hasOwnProperty(i)?e.effectiveTypes[i]:0,typeId:e.types.hasOwnProperty(n)?e.types[n]:0,rtt:t.rtt||0,saveData:t.saveData||!1},e.store.set("navigatorConnection",e.navigatorConnection),e.store.emit("navigatorConnectionChange",e.navigatorConnection)};t.onchange=i,i()}else this.navigatorConnection={browserSupport:!1},this.store.set("navigatorConnection",this.navigatorConnection)}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(51),d=r(a),l=i(11),u=r(l),c=i(1),h=n(c),p=i(18),f=n(p),v=function(){function e(t,i){s(this,e),this._store=t,this._intervalDuration=this._store.get("kpitrvldrt"),this._numOfSamplesPerMeasurment=this._store.get("prfsmpmsnt"),this._durationOfSamplePerMeasurment=this._store.get("prfsmitrvpmsnt"),this._playerOpportunityManager=i,this.dataSaverUrl=this._store.get("dtsvrurl"),this._addListeners(),this._startLoopTimeInterval(),this._measure(),this._runFirstMeasurmentCycle()}return o(e,[{key:"_addListeners",value:function(){this._store.once("stop",this._onStop.bind(this)),this._store.once("beforeunload",this._onBeforeunload.bind(this))}},{key:"_startLoopTimeInterval",value:function(){var e=this._store.get("msrkpifctr")||100;if(e=Math.min(100,e),1===e||h.getRandomInt(0,e)===e){var t=h.normalizeMilliseconds(this._store.get("msrkpiintvl")||15);this._loopInterval=setInterval(this._sendLoopKpiPixel.bind(this),t)}}},{key:"_sendLoopKpiPixel",value:function(){var e=h.createPixelParams(f.KPI,this._store);e.kpipm=this._store.get("performance.performanceMeasurment"),e.kpinw=this._store.get("performance.wfRoundTripAverageDuration"),h.sendPixel(e,this._store)}},{key:"_measure",value:function(){var e=this;this._running=!0,this._runSampling("first_kpi"),this.intervalMeasureId=setInterval(function(){e._runSampling("last_kpi")},this._intervalDuration)}},{key:"_runSampling",value:function(e){var t=this,i=new d.default;i.runEventLoopSampling(this._numOfSamplesPerMeasurment,this._durationOfSamplePerMeasurment).then(function(n){t._store.set(e,n),t._saveData(n),i.cleanResources()}),this._measureDataSaverRoundtripDuration()}},{key:"_measureDataSaverRoundtripDuration",value:function(){var e=this;if(this.dataSaverUrl){var t=(new Date).getTime(),i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&e._store.set("performance.dtsvrRoundTripAverageDuration",(new Date).getTime()-t)},i.open("GET",this.dataSaverUrl,!0),i.send(null)}}},{key:"_sendOpp",value:function(e){this._playerOpportunityManager.send(e)}},{key:"_runFirstMeasurmentCycle",value:function(){var e=this,t=new d.default;t.runOneEventLoopSampling().then(function(t){e._saveData(t),e._sendOpp(u.default.firstWfMeasurment)})}},{key:"_saveData",value:function(e){this._store.set("performance.wfRoundTripAverageDuration",this._store.get("waterfall_data.average_duration")),this._store.set("performance.performanceMeasurment",Math.round(e))}},{key:"_onBeforeunload",value:function(){this._destroy()}},{key:"_onStop",value:function(){this._destroy()}},{key:"_destroy",value:function(){this._running&&(clearInterval(this.intervalMeasureId),clearInterval(this._loopInterval),this._running=!1,this._saveData(this._store.get("last_kpi")),this._sendOpp(u.default.playerClosedMeasurment))}}]),e}();t.default=v},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t,n){i(this,e),this.parent=t,this.getAdSkippableRemainingTime=this.build_vpaid_get_controller(t,"getAdSkippableRemainingTime",-1),this.getAdLinear=this.build_vpaid_get_controller(t,"getAdLinear",!0),this.getAdWidth=this.build_vpaid_get_controller(t,"getAdWidth",0,"width"),this.getAdHeight=this.build_vpaid_get_controller(t,"getAdHeight",0,"height"),this.getAdExpanded=this.build_vpaid_get_controller(t,"getAdExpanded",!0),this.getAdSkippableState=this.build_vpaid_get_controller(t,"getAdSkippableState",!0),this.getAdRemainingTime=this.build_vpaid_get_controller(t,"getAdRemainingTime",-1),this.getAdDuration=this.build_vpaid_get_controller(t,"getAdDuration",-1),this.getAdCompanions=this.build_vpaid_get_controller(t,"getAdCompanions",[]),this.getAdIcons=this.build_vpaid_get_controller(t,"getAdIcons",[]),this.pauseAd=this.build_vpaid_set_controller(t,"pauseAd"),this.resumeAd=this.build_vpaid_set_controller(t,"resumeAd"),this.expandAd=this.build_vpaid_set_controller(t,"expandAd"),this.collapseAd=this.build_vpaid_set_controller(t,"collapseAd"),this.skipAd=this.build_vpaid_set_controller(t,"skipAd"),this.stopAd=this.build_vpaid_set_controller(t,"stopAd"),this.store=n,this.isMultiAdsActive=this.store.get("mltads")}return n(e,[{key:"startAd",value:function(){this.parent.vpaidHandler.startAd()}},{key:"getAdVolume",value:function(){if(!this.isMultiAdsActive){var e=this.parent.volume();return e}}},{key:"setAdVolume",value:function(e,t){this.isMultiAdsActive||this.store.get("forceMute")&&e>0||(this.parent.volume(e),this.parent.runningVpaid&&this.parent.runningVpaid.vpaid&&this.parent.runningVpaid.vpaid.setAdVolume(e))}},{key:"resizeAd",value:function(e,t,i){if(!this.isMultiAdsActive)return!!this.parent.runningVpaid&&this.parent.runningVpaid.resize(e,t,i)}},{key:"muteAd",value:function(){}},{key:"unmuteAd",value:function(){}},{key:"setParam",value:function(e,t){return this.store(e,t)}},{key:"getParam",value:function(e){return this.store(e)}},{key:"build_vpaid_set_controller",value:function(e,t){var i=function t(){return!!e.scheduleMaster.gotVpaid&&!!e.scheduleMaster.runningVpaid.vpaid[t.type]&&e.scheduleMaster.vpaid[t.type]()};return i.proxy=e,i.type=t,i}},{key:"build_vpaid_get_controller",value:function(e,t,i,n){var r=function t(){return e.scheduleMaster.gotVpaid?e.scheduleMaster.vpaid[t.type]():t.default_value_key&&void 0!=e.options[t.default_value_key]?e.options[t.default_value_key]:t.default_value};return r.proxy=e,r.default_value=i,n?r.default_value_key=n:r.default_value_key=void 0,r.type=t,r}},{key:"gotVpaid",get:function(){return!!(this.parent&&this.parent.scheduleMaster&&this.parent.scheduleMaster.gotVpaid)}},{key:"gotAd",get:function(){return!(!this.gotVpaid||!this.parent.scheduleMaster.runningVpaid.adPlaying)}}]),e}();t.default=r,r.prototype.getAdSkippableRemainingTime=r.prototype.build_vpaid_get_controller(parent,"getAdSkippableRemainingTime",-1)},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e){function t(){if(this.isMobile){var e=this.store.get("forcecnvsmpg"),t=this.store.get("useapforcntnt");!e||t||this.fallbackToCanvasFired||this.playerOpportunityManager.send(S.default.fallBackCanvas)}}var i=this;this.overrideWindowMethods=function(){Object.assign=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}};var n=b.parseUserAgent(),r=void 0==Object.assign||!b.isNativeCode(Object.assign);r&&this.overrideWindowMethods(),this.status="loading",this.videoLength=0,this.ga_set=!1,this.video=void 0,this.repeatCount=0,this.schedule={},this.playerIsClosed=!1,this.options=(0,h.getDefaults)(e);var s=Object.assign((0,h.getUnitParams)(),e.dplayerSettings);this.options=Object.assign({},this.options,s);var o=new f.default(this.options);this.store=o;var d=b.createPixelParams(N.playerDisplayImpression,this.store);b.sendPixel(d),this.store.set("player_id",Date.now()+"_"+b.generateGuid(30)),this.store.set("fullPageUrl",window.location.href),this.store.set("forcePause",!1),this.store.set("forceMute",!1),this.store.set("dataSaverDetected",!1),this.store.set("conversionsCount",0),this.store.set("failsCount",0),this.store.set("getAdData.count",0),this.store.set("playerAspectRatio",this.options.aspect_ratio),this.store.set("noplrcntr",this.store.get("noplrcntr")&&this.store.get("isMultiVpaidUnit")),this.store.set("isAmp",window.TRC&&window.TRC.isAMP),W.init(this.store.data),W.get("video-element",this.store.get("vdelv"),function(e){i.store.set("videoElement",e)}),c.default.prototype.debugLevels=this.store.get("debugLevels")||"",this.logConnectionType=function(e){var t="unknown",i={1:"dialup",2:"wired",3:"wifi",4:"mobile",5:"satellite"};e&&(t=i.hasOwnProperty(e)?i[e]:e.toString()),this.store.set("connectionType",{type:t})},this._preventAutoplay=!this.store.get("isMobile")&&this.store.get("prvaupl")&&n&&n.browser&&n.browser.name&&"firefox"==n.browser.name.toLowerCase();var u={};try{var p=new T.default(e.auc_dast,this.store);u=p.fetchResults(),u&&(u.sesid&&this.store.set("sessionId",u.sesid),this.logConnectionType(u.ct))}catch(e){this.store.set("dastDecoderError",b.stringify(e))}this.store.set("dast",u),u.hasOwnProperty("abt")&&(this.store.set("dast_AbTest",u.abt),this.store.set("abTest",this.store.get("abTest")?this.store.get("abTest")+"|"+u.abt:u.abt));var v=void 0;this.store.get("dtctcmp")&&b.getRandomInt(0,100)<this.store.get("dtctcmpfctr")&&(v=new M.default(this.store));var g=(new F.default(this.store),this.store.get("isMobile")),_=this.store.get("measureKPI");(g||_)&&(this.playerOpportunityManager=new x.default(this.store)),this.store.get("base_url")&&0!==this.store.get("base_url").length||(this.store.set("original_base_url","empty"),this.store.set("href",window.location.href),this.store.set("base_url","//www.cmbestsrv.com")),this.resourceLoader=new E.default(this.store),this.store.get("loadrsrc")&&this.resourceLoader.loadCSSResources(),this.connectionTypeDetector=new B.default(this.store),this.store.get("dtctprvtbrwsng")&&(this.privateBrowsingDetector=new H.default(this.store)),this.store.set("queueLength",0),this.store.set("vpaidReadyCount",0),this.store.set("document.visible",!document.hidden),b.reportByIndex("player_options","ctor1",{type:"debug",message:"ctor1",options:this.store.data},this.store),o.set("ads_playing",0),o.set("ads_started",0),o.set("total_impressions",0),this.dependenciesLoader=new O.default(this.store),_&&(this.KPIsRecorder=new k.default(this.store,this.playerOpportunityManager)),this.options.schedule&&this.options.schedule.length&&this.options.schedule[0].ad_parameters&&this.options.schedule[0].ad_parameters.length>2&&o.set("static_schedule",this.options.schedule),this.overrideNonNativeFunctions=function(){var e=this.store.get("ovrdnonntvfnclst");if(Object.keys(e).length>0){var t=document.createElement("iframe");t.style.width=0,t.style.height=0,t.style.visibility="hidden",t.style.display="none",document.body.appendChild(t);for(var i in e)b.isNativeCode(window[i])||(window[i]=e[i](t))}},this.overrideNonNativeFunctions(),this.isMobile=this.store.get("isMobile"),t.call(this),this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit");var w=this;window.addEventListener("beforeunload",function(e){i.store.emit("beforeunload")}),this.store.on("AdImpression",function(){w.killAfterXWithNoConversion()}),this.playerStatus="content",this.store.on("AdPlayerVisible",function(){if(!this.playerIsClosed){this.playerStatus="ad";var e={playerState:this.playerStatus,isVisible:!1};this.VideoControls&&(this.isMobile?this.VideoControls.setState(e):(this.wasContentPausedBeforeAd=this.VideoControls.getValueFromControlsState("isPaused"),e.isPaused=!1,this.VideoControls.setState(e),this.runningVpaid&&(this.runningVpaid.vpaid.vpaidHandler.setPaused(!1),this.runningVpaid.vpaid.vpaidHandler.volume(this.VideoControls.getValueFromControlsState("volume")))),this.store.emit("playerStatusChanged",this.playerStatus))}}.bind(this)),this.store.on("AdPlayerHidden",function(){if(!this.playerIsClosed){this.playerStatus="content";var e={playerState:this.playerStatus,isVisible:!0};this.VideoControls&&(this.isMobile?(this.volume(0),this.VideoControls.setState(e)):(e.isPaused=this.wasContentPausedBeforeAd,this.VideoControls.setState(e),this.volume(this.VideoControls.getValueFromControlsState("volume"))),this.store.emit("playerStatusChanged",this.playerStatus))}}.bind(this)),this.playContentAfterFirstAd=function(){this.playContentBeforeAds||(this.playContentBeforeAds=!0,this.video.autoplay=!1,this._appendCotnentMediaFiles(this.video),this.target.appendChild(this.video),!this.isMobile||this.hasAutoPlay&&!this.store.get("dataSaver")||this._switchToCanvas(this.video,!0),this._shouldUseVideoControls()&&this.addVideoControls())},this.store.once("playContentAfterFirstAd",this.playContentAfterFirstAd.bind(this)),this.debugTracker=new c.default("OvaMediaPlayer"),this.debugTracker.info("unit-version: "+this.store.get("unit_loader_version")+", player-version: "+this.store.get("player_version"),this.store,{color:"#D15EFF"}),this.seek=function(e){if(!this._isAdState()&&this.video.currentTime!==e)try{if(void 0==e)return this.video.currentTime;if(isNaN(parseFloat(e)))return;this.video.currentTime=parseFloat(e)}catch(e){return 0}},this.killAfterXWithNoConversion=function(){var e=this.store.get("kaxwnc");e&&(this.kaxwnc&&clearTimeout(this.kaxwnc),this.kaxwnc=setTimeout(function(){w.closeCleanPlayer("killAfterXWithNoConversion")},e))},this.killAfterXWithNoConversion(),this.play=function(){if(!this.store.get("forcePause"))return this._isAdState()?void this.vpaidHandler.vpaid.manager.play():void this.video.play()},this.pause=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.pause():(this.store.emit("contentPaused"),void this.video.pause())},this.resume=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.play():(this.store.emit("contentResumed"),void("paused"==this.status&&this.video.play()))},this.stop=function(){try{if("stopped"==this.status||this._isAdState())return;this.status="stopping",this.video.pause(),this.seek(0),this.status="stopped",this.options.onPlayerStop(this)}catch(e){}},this.resize=function(e,t,i){this.vpaidManager&&this.vpaidManager.resize(e,t);var n=0,r=0,s=0;try{(void 0==e||isNaN(parseInt(e)))&&(e=!1),(void 0==t||isNaN(parseInt(t)))&&(t=!1),e||t||(this.debugTracker.error("resize","No `height` or `width` specified!"),e=this.store.get("width"),t=this.store.get("height")),t&&e?(this.options.height=t+"",this.options.width=e+"",this.setVideoSize(this.options.width.search(/px$/g)>-1?this.options.width:this.options.width+"px",this.options.height.search(/px$/g)>-1?this.options.height:this.options.height+"px")):(i&&i.split(":").length>1&&(this.options.aspect_ratio=i),e?(this.options.height=!1,this.options.width=e+"",s=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0],n=this.options.width.search(/px$/g)>-1?this.options.width:parseFloat(this.options.width)+"px",r=Math.floor(parseFloat(n)*s)+"px",this.setVideoSize(n,r)):(this.options.width=!1,this.options.height=t+"",s=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1],r=this.options.height.search(/px$/g)>-1?this.options.height:parseFloat(this.options.height)+"px",n=Math.floor(parseFloat(r)*s)+"px",this.setVideoSize(n,r)))}catch(e){this.debugTracker.error("resize","Resizing component failed!")}},this.setVideoSize=function(e,t){this.isMultiVpaidUnit||(this.store.get("noplrcntr")||(this.target.style.width=e,this.target.style.height=t,this.target.setAttribute("width",parseInt(e)),this.target.setAttribute("height",parseInt(t))),this.video.style.width=e,this.video.style.height=t,this.video.setAttribute("width",parseInt(e)),this.video.setAttribute("height",parseInt(t))),this.scheduleMaster.runningVpaid&&!this.scheduleMaster.runningVpaid.finished&&this.scheduleMaster.runningVpaid.resize(parseInt(e),parseInt(t))},this.handleTarget=function(e){var t;return t=this.store.get("noplrcntr")?document.querySelector(e):"string"==typeof e?document.getElementById(e):e},this.stringToSeconds=function(e){for(var t=e.split(":"),i=[],n=0;n<t.length;n++)i.push(isNaN(parseInt(t[n]))?0:parseInt(t[n]));var r=0;switch(i.length){case 1:r=parseInt(e);break;case 2:r=60*parseInt(i[0])+parseInt(i[1]);break;case 3:r=3600*parseInt(i[1])+60*parseInt(i[1])+parseInt(i[2])}return r},this.secondsToString=function(e){e=Math.floor(e);var t=(e-e%3600)/3600;t=t<10?"0"+t:t,e-=3600*t;var i=(e-e%60)/60;return i=i<10?"0"+i:i,e-=60*i,e=e<10?"0"+e:e,(t>0?t+":":"")+i+":"+e},this.generateId=function(){for(var e="vpaid-"+Math.floor(65536*(1+Math.random()));document.getElementById(e);)e="vpaid-"+Math.floor(1e5*Math.random());return e},this.ova=new a.default(this,this.store),this.initVpaidManager=function(){this.vpaidManager=new y.default(this.store,this)},this.store.on("closePlayer",function(){i.closePlayer()}),this.initScheduleMaster=function(){this.scheduleMaster=new l.default(this,this.store),this.store.get("vForce")&&this.scheduleMaster.disable()},this.initScheduleMaster(),this.handlePlayerPause=function(){if(!this.playerIsClosed)switch(this.status){case"loading-play":case"playing":this.status="paused",this.options.onPlayerPause(this);break;default:return}},this.handlePlayerPlay=function(){if(!this.playerIsClosed)switch(this.status){case"loading":this.status="loading-play";break;case"ended":this.status="playing",window.setTimeout(function(){!this.playerIsClosed&&this.options._onPlayerRepeat&&this.options._onPlayerRepeat()}.bind(this),0),window.setTimeout(function(){!this.playerIsClosed&&this.options._onPlayerRepeat&&this.options._onPlayerRepeat()}.bind(this),0),window.setTimeout(function(){!this.playerIsClosed&&this.options.onPlayerPlay&&this.options.onPlayerPlay()}.bind(this),0);break;case"loading-play":case"stopped":case"paused":this.status="playing",window.setTimeout(function(){!this.playerIsClosed&&this.options.onPlayerResume&&this.options.onPlayerResume()}.bind(this),0);break;default:return}},this._onPlayerRepeat=function(){this.repeatCount++},this.handleOnCanPlay=function(){if(!this.playerIsClosed)switch(this.status){case"loading-play":this.status="playing",this.createSchedule(),window.setTimeout(function(){this.onPlayerReadyRun(),this.options.onPlayerReady()}.bind(this),0),window.setTimeout(function(){this.options.onPlayerPlay()}.bind(this),0);break;case"loading":this.createSchedule(),window.setTimeout(function(){this.onPlayerReadyRun(),this.options.onPlayerReady()}.bind(this),0);break;default:return}},this.handlePlayerEnd=function(){if(!this.playerIsClosed)switch(this.store.emit("contentChanged"),this.status){case"playing":window.setTimeout(function(){this.options.onPlayerPause()}.bind(this),0);case"paused":this.status="ended",this.options.repeat?window.setTimeout(function(e){e.play()}.bind(this,this.video),0):(this.options.onPlayerComplete(this),this.options.onPlayerStop(this));break;default:return}},this.handlePlayerSeeked=function(e){this.playerIsClosed||window.setTimeout(function(){this.options.onPlayerSeek()}.bind(this),0)},this.handlePlayerError=function(e){this.status="stopping",this.video.pause(),this.status="loading",this.options.onPlayerError(this,e)},this.handlePlayerVolume=function(){this.debugTracker.info("Event","Player Volume Was Changed!")},this.muteToggle=function(){this.options.mute?this.unMute():this.mute()},this.mute=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.mute():(this.video.muted=this.options.mute=!0,this.vpaidManager&&this.vpaidManager.mute(),void this.volume(0))},this.unMute=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.unmute():(this.video.muted=this.options.mute=!1,this.vpaidManager&&this.vpaidManager.unmute(this.options.volume>1?this.options.volume/100:this.options.volume),void this.volume(this.options.volumeBeforeMute))},this.volume=function(e){if("stopped"!=this.status&&!(this.store.get("forceMute")&&e>0)){if(this.vpaidManager&&this.vpaidManager.volume(e),void 0==e)return this._getCurrentVolume();if(!(this.options.videoControlsForceMute&&e>0))return 0===e&&0!=this.options.volume&&(this.options.volumeBeforeMute=this.options.volume),this.options.volume=e,e=e>1?e/100:e,0==e?(this.video.muted=this.options.mute=!0,this.video.volume=0):(this.video.muted=this.options.mute=!1,this.video.volume=e),w.store.set("volume",e),this.VideoControls&&this.VideoControls.setState({volume:e}),e}},this._getCurrentVolume=function(){return this._isAdState()?this.vpaidHandler.vpaid.manager.getCurrentWorkingVpaidVolume():this.options.volume},this.onPlayerReadyRun=function(){var e=this.onPlayerReadyActions.length;if(0!=e){for(var t=0;t<e;t++)this.onPlayerReadyActions[t].apply(this,[]);this.onPlayerReadyActions=new Array}},this.onPlayerReadyActions=new Array,this.attachEventsToVideo=function(e){var t=this,i=this,n=function e(t){e.player.handlePlayerSeeked(t)};n.player=this,e.addEventListener("seeked",n,!0);var r=function e(){e.player.handleOnCanPlay()};r.player=this,e.addEventListener("canplay",r,!0);var s=function e(){e.player.handlePlayerPlay()};s.player=this,e.addEventListener("play",s,!0);var o=function e(){e.player.handlePlayerPause()};o.player=this,e.addEventListener("pause",o,!0);var a=function e(){e.player.handlePlayerEnd()};a.player=this,e.addEventListener("ended",a,!0);var d=function(e){i.isMobile||i.handlePlayerError(e)};d.player=this;var i=this;
e.addEventListener("error",d,!0),e.addEventListener("click",function(){0===e.currentTime&&this.store.get("dataSaverDetected")&&(e.play(),i.VideoControls&&i.VideoControls.setState({isPaused:!1}))}),this.contentInterval=setInterval(function(){var e=i.video.currentTime,n=i.video.duration;t.store.set("contentTime",e),t.store.set("contentDuration",n)},5e3)},this._switchToCanvas=function(e,t){var i=this;if(!e&&(this.fallbackToCanvasFired||this.playerOpportunityManager.send(S.default.fallBackCanvas),this._shouldPlayContent())){var n=this,r=function(){n.video.destroy(),n.store.set("sncad",!0)},s="";this.video.src?s=this.video.src:this.options.files.map(function(e){if(!s){if(/\.mpg$/.test(e.url)||/\.mpeg$/.test(e.url))return;s=e.url}}),this.video.addEventListener("canvasError",r),this.video.addEventListener("canvasRemoved",this._onNewVidCreated.bind(this)),setTimeout(function(){i.video._vidSetAttr("src",""),setTimeout(function(){i.video.forceCanvas&&(i.video.setAttribute("src",s),i.video.style.display="none",t||i.handleOnCanPlay())},2e3)},2)}},this.createMediaPlayer=function(){var t=this;this.store.get("noplrcntr")||(this.target.className+=" vpaid-player-container",this.isMultiVpaidUnit&&b.addClass(this.target,"multi-vpaids"));var i=b.createVideoElement(this.store,{target:this.target,onAutoplayDetected:function(e){setTimeout(function(){t._switchToCanvas(e)})},additionalCss:{position:"absolute",zIndex:102}});if(this.playerTag=i,i.id=this.generateId(),i.className=this.options.video_class_name,this.isMultiVpaidUnit&&b.addClass(i,"multi-vpaids"),i.style.cssText="position: relative; z-index:99; cursor:pointer; display:block",i.setAttribute("playsinline",""),i.setAttribute("muted",""),this._preventAutoplay||i.setAttribute("autoplay",""),this.isMobile&&!i.forceCanvas&&"iOS"===n.os.name&&(i.removeAttribute("autoplay",""),i.setAttribute("muted",""),i.muted=!0),this.attachEventsToVideo(i),this.isMultiVpaidUnit)if(this.options.height||this.options.width)if(this.options.height&&this.options.width)i.style.height=this.options.height.search(/px$/g)>-1?this.options.height:this.options.height+"px",i.style.width=this.options.width.search(/px$/g)>-1?this.options.width:this.options.width+"px";else if(this.options.width){var r=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0];i.style.width=this.options.width.search(/px$/g)>-1?this.options.width:parseFloat(this.options.width)+"px",i.style.height=Math.floor(parseFloat(i.style.width)*r)+"px"}else{var s=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1];i.style.height=this.options.height.search(/px$/g)>-1?this.options.height:parseFloat(this.options.height)+"px",i.style.width=Math.floor(parseFloat(i.style.height)*s)+"px"}else this.debugTracker.error("createMediaPlayer","No `height` or `width` specified!");i.muted=!0,i.setAttribute("width",parseFloat(i.style.width)+""),i.setAttribute("height",parseFloat(i.style.height)+""),i.setAttribute("playsinline","");var o=this;setTimeout(function(){try{o.handleOnCanPlay()}catch(e){}},200),this.options.repeat&&(i.playerRepeat=!0),this.options.image&&i.setAttribute("poster",this.options.image),i=this._appendCotnentMediaFiles(i),this._shouldPlayContent()&&this.target.appendChild(i),this.video=i,this.store.get("noplrcntr")||(this.target.id="_cm-css-reset"),this.isMobile&&!this.hasAutoPlay||(i.volume=this.options.volume/100);var a=this._shouldUseVideoControls();this.store.set("useVideoControls",!0),a&&this._shouldPlayContent()&&this.addVideoControls(),this.volume(this.options.mute?0:this.options.volume),this.setVideoSize(e.width+"px",e.height+"px"),this.VideoControls&&this.VideoControls.setState({playerState:this.playerStatus})},this._shouldUseVideoControls=function(){return!this.isMobile&&(this.options.controls||this.store.get("ad_controls"))||this.isMobile&&this.options.controls},this._appendCotnentMediaFiles=function(e){try{if(this._shouldPlayContent())for(var t=0;t<this.options.files.length;t++){var i=this.options.files[t];if(!/\.mpg$/.test(i.url)&&!/\.mpeg$/.test(i.url))if(!this.isMobile||this.hasAutoPlay&&!this.store.get("dataSaver")){var n=document.createElement("source");n.setAttribute("type",i.type),n.src=i.url,e.name||(e.name=i.name?i.name:i.url),e.appendChild(n)}else e.src=i.url}}catch(e){this.debugTracker.error("createMediaPlayer","Files array supplied is corrupted or malformed!")}return e},this.playContentBeforeAds=this.store.get("plcntbfrads"),this._shouldPlayContent=function(){return this.store.get("vForce")?this.store.get("cntonvfrc"):this.playContentBeforeAds},this._onNewVidCreated=function(e){this.video.parentElement.removeChild(this.video),this.video=e.data.videoElement,this.canvas=!1,this.VideoControls&&(this.VideoControls.setCanvas(this.canvas),this.VideoControls.setVideo(this.video))},this.addVideoControls=function(){this.VideoControls=new m.default(this.video,this.store,this.target,"content"),this.canvas&&this.VideoControls.setCanvas(this.canvas),this.store.on("videoControlsVolume",this._onVideoControlVolumeChanged.bind(this)),this.store.on("volumeBeforeMuteChanged",this._onVideoControlsVolumeBeforeMuteChanged.bind(this)),this.isMobile||(this.store.on("videoControlsMute",this._onVideoControlMuteChanged.bind(this)),this.store.on("videoControlsPause",this._onVideoControlPauseChanged.bind(this)),this.store.on("videoProgressBar",this._onVideoProgressBarChanged.bind(this)))},this._onVideoControlsVolumeBeforeMuteChanged=function(e){this.options.volumeBeforeMute=e},this._isAdState=function(){return"ad"===this.playerStatus},this._onVideoControlMuteChanged=function(e){this.options.videoControlsForceMute=e,this.store.set("forceMute",e),e?this.mute():this.unMute()},this._onVideoControlVolumeChanged=function(e){this.options.videoControlsForceMute=!1,this.store.set("forceMute",0===e),this.volume(e)},this._onVideoControlPauseChanged=function(e){this.store.set("forcePause",e),e?this.pause():this.video.currentTime===this.video.duration?this.play():this.resume()},this._onVideoProgressBarChanged=function(e){if(!this._isAdState()){var t=Math.floor(e*this.video.duration);this.store.emit("videoProgressBarTransition",this.video.duration,t),this.video.currentTime=t}},this.onVpaidCreated=function(e){this.runningVpaid=e,this.vpaidHandler=e}.bind(this),this.store.on("vpaidHandlerCreated",this.onVpaidCreated),this.ga={sendGaMessage:function(){}};var w=this;if(this.createGA=function(){},this.removeGA=function(){this.ga_set},this.convertPreMidPostToTime=function(e,t){var t=Math.round(t),i={},n=this.options.schedule_auto,r=void 0;if(r=e["pre-roll"].length>0?e["pre-roll"][0]:e["mid-roll"].length>0?e["mid-roll"][0]:e["post-roll"].length>0?e["post-roll"][0]:void 0,void 0==r)return this.debugTracker.error("PreMidPostToTime","Error creating automatic schedule!Pleace check the schedule preset!"),{};i["00:00"]=r;var s=[];e["mid-roll"].length>0?s=e["mid-roll"]:e["post-roll"].length>0?s=e["post-roll"]:s.push(r);var o=void 0;for(o=e["post-roll"].length>0?e["post-roll"][0]:s[0];n<t;){var a=this.secondsToString(n),d=s.shift();s.push(d),n+=this.options.schedule_auto,n>t&&(d=o),i[a]=d}return i},this.createSchedule=function(){if(!this.scheduleCreated&&!this.store.get("vForce")){this.scheduleCreated=!0,this.videoLength=this.video.duration,this.videoLength=this.videoLength||120;var e=this.options.schedule,t={},i=this.options.schedule_auto;0===this.options.schedule_auto&&(this.options.schedule_auto=1);for(var n=0;n<e.length;n++){var r=e[n];if(this.options.schedule_auto)t[r.roll_type]||(t[r.roll_type]=[]),t[r.roll_type].push(r);else for(var s=0;s<r.positions.length;s++)!t[r.positions[s]]&&this.videoLength-this.options.min_vpaid_run_time>this.stringToSeconds(r.positions[s])&&(t[r.positions[s]]=r)}this.options.schedule_auto&&(t["pre-roll"]||(t["pre-roll"]=[]),t["mid-roll"]||(t["mid-roll"]=[]),t["post-roll"]||(t["post-roll"]=[]),t=this.convertPreMidPostToTime(t,this.videoLength)),this.options.schedule_auto=i,this.scheduleMaster.schedule=t,this.store.set("contentSchedule",t),this.scheduleMaster.start()}},this.setVideoFile=function(e,t,i){for(;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);t?this.video.setAttribute("poster",t):this.video.removeAttribute("poster"),i?(this.status="loading",this._preventAutoplay||this.video.setAttribute("autoplay","true")):this.video.removeAttribute("autoplay");try{if(this.canvas)e.length&&(this.video.src=e[0].url,this.video.play());else{this.video.removeAttribute("src");for(var n=0;n<e.length;n++){var r=e[n],s=document.createElement("source");s.setAttribute("type",r.type),s.src=r.url,this.video.name||(this.video.name=r.name?r.name:r.url),this.video.appendChild(s)}this.video.load()}}catch(e){this.debugTracker.error("setVideoFile","Error creating video sources!")}},this._onVpaidClosed=function(){},this._pausePlayer=function(){this.scheduleMaster.stop(!0),this.seek(0),this.stop(),this.store.emit("pausePlayer")},this.closePlayer=function(){this._onVpaidClosed=this.closeCleanPlayer.bind(this,"_onVpaidClosed"),this.options.onPlayerClose(this),this.scheduleMaster.stop()},this.closeCleanPlayer=function(e){var t=this;this.store.set("playerClosed",!0),setTimeout(function(){if(e=e||"none",t.store.emit("stop","close:"+e),!t.playerIsClosed){if(clearInterval(t.contentInterval),t.vpaidManager&&t.vpaidManager.stop(),t.VideoControls&&t.VideoControls.destroy(),t.dependenciesLoader&&t.dependenciesLoader.destroy(),t.playerIsClosed=!0,t._onVpaidClosed=function(){},t.stop(),t.removeGA(),!t.store.get("noplrcntr"))for(;t.target.childNodes.length;)t.target.removeChild(t.target.childNodes[0]);t.competitionDetector&&t.competitionDetector.destroy(),t.onPlayerReadyActions=t.debugTracker=t.video=t.schedule=t.ova=t.ga=t.scheduleMaster=t.KPIsRecorder=t.VideoControls=void 0,t.options=t.target=void 0}},0)},this.target=this.handleTarget(e.target_id),!this.target||!this.target.appendChild)return void this.debugTracker.error("Constructor","No player target!Can't build player in ["+this.target+"]... aborting!");this.store.set("can_opt_out",this.store.get("can_opt_out")||null!==this.target.parentElement.querySelector("#_cm-opt-out-view")),this.options.htmlVideoSupport?this.createMediaPlayer():(this.debugTracker.error("Constructor","Browser does not support <video> Tag!Nothing to do, aborting..."),this.options.onPlayerLoadError(this)),this.store.get("base_url"),this.set=function(e,t){this.store.set(e,t)},this.get=function(e){return this.store.get(e)},this.on=function(e,t){this.store.on(e,t)},this.off=function(e,t){this.store.removeListener(e,t)},this.getVpaidLogs=function(){return this.vpaidManager?this.vpaidManager.getVpaidLogs():this.scheduleMaster?this.scheduleMaster.getVpaidLogs():void 0},this.startWaterfall=function(){try{this.scheduleMaster.vpaid.waterfallManager.start()}catch(e){return!1}return!0},this.stopWaterfall=function(){try{this.scheduleMaster.vpaid.waterfallManager.stop()}catch(e){return!1}return!0},this.emit=function(e,t){e&&this.store.emit(e,t)};var A=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;A&&setTimeout(function(){w.handleOnCanPlay()},500),this.store.get("vForce")&&this.initVpaidManager(),this.getAd=function(e){if(this.vpaidManager)return this.vpaidManager.getAd(e)},this.startIdleMode=function(){this.store.set("isIdleMode",!0)},this.stopIdleMode=function(){this.store.set("isIdleMode",!1)},this.startWf=function(){this.store.emit("startWf")},this.getPlayerDAST=function(){return this._isAdState()?this.vpaidHandler.vpaid.manager.getPlayerDAST():""},this.dropAds=function(e){this.vpaidHandler.vpaid.manager.cleanQueue(this.store.get("queue_size")||10,e),this.vpaidHandler.vpaid.waterfallManager.dropAds(e)},this.setDebugData=function(e){this.store.set("debugStr",e)},this.addWfParameter=function(e,t){this.vpaidHandler.vpaid.waterfallManager.addWfParameter(e,t)},this.updateWfParameter=function(e,t){this.vpaidHandler.vpaid.waterfallManager.updateWfParameter(e,t)},this.removeWfParameter=function(e){this.vpaidHandler.vpaid.waterfallManager.removeWfParameter(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=i(49),a=r(o),d=i(53),l=r(d),u=i(5),c=r(u),h=i(62),p=i(55),f=r(p),v=i(25),m=r(v),g=i(57),y=r(g),_=i(1),b=n(_),w=i(48),k=r(w),A=i(27),T=r(A),C=i(52),E=r(C),P=i(11),S=r(P),V=i(77),x=r(V),I=i(61),O=r(I),D=i(46),M=r(D),R=i(56),F=r(R),L=i(47),B=r(L),j=i(63),H=r(j),U=i(18),N=n(U),W=i(17);i(157),window.OvaMediaPlayer=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(54),a=n(o),d=i(36),l=n(d),u=function(){function e(){r(this,e),this._stopwatchs=[]}return s(e,[{key:"startSampling",value:function(){var e=new a.default;return this._stopwatchs.push(e),e.start(),this._stopwatchs.length-1}},{key:"stopSampling",value:function(e){this._stopwatchs[e].stop()}},{key:"getDuration",value:function(e){return this._stopwatchs[e].duration()}},{key:"runOneEventLoopSampling",value:function(){var e=this;return new l.default(function(t){var i=e.startSampling();setTimeout(function(){e.stopSampling(i),t(e.getDuration(i))},0)})}},{key:"runEventLoopSampling",value:function(e,t){var i=this;return new l.default(function(n){var r=[],s=0,o=setInterval(function(){s<e?(r.push(i.runOneEventLoopSampling()),s++):(clearInterval(o),l.default.all(r).then(function(e){var t=e.reduce(function(e,t){return Math.max(e,t)},0);n(t)}))},t)})}},{key:"cleanResources",value:function(){this._stopwatchs.length=0}}]),e}();t.default=u},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.store=t,this.baseUrl=this.store.get("base_url"),this.playerVersion=this.store.get("full_player_version"),this.deployFolder="/vpaid/vPlayer/player/v",this.filename=this.store.get("plyrcss"),this.playerCssUrl=""+this.baseUrl+this.deployFolder+this.playerVersion+"/assets/"+this.filename+".css"}return n(e,[{key:"loadCSSResources",value:function(){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=this.playerCssUrl,document.head.appendChild(e)}},{key:"loadExternalResource",value:function(e,t){var i=document.createElement("script");i.src=e,i.type="text/javascript",i.async=!0,i.onload=function(e){document.head.removeChild(i),t&&t(e)},document.head.appendChild(i)}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(26),a=n(o),d=i(5),l=(n(d),500),u=function(){function e(t,i){r(this,e),this.schedule={},this.parent=t,this.savedTime=-1,this.runningVpaid=!1,this.runningVpaidTagData={},this.runTimeId=0,this.bug_feature=t.options.bug_feature,this.vpaidCount=0,this._firstImpression=!1,this.minTimeBetweenRuns=5e3,this.store=i,this.lastEndedPlayedVpaid=-1e6,this.timeBetweenAds=this.store.get("schedule_auto"),this.store.on("stop",this.stop.bind(this)),this.useNewScheduler=this.store.get("evtbsschdl"),this.useNewScheduler&&(this._bindedLoop2=this._loop2.bind(this),this._bindedOnVpaidReady=this._onVpaidReady.bind(this),this._bindedOnVpaidEnded=this._onVpaidEnded.bind(this),this.loop2Ticker=setInterval(this._bindedLoop2,l))}return s(e,[{key:"stop",value:function(){this.stopped=!0,window.clearTimeout(this.runTimeId),this.runningVpaid&&!this.runningVpaid.finished?(this.runningVpaid.stop(),this.savedTime=-1,this.parent=void 0,this.runningVpaid=void 0,this.schedule=void 0):(this.parent,this.savedTime=-1,this.parent=void 0,this.runningVpaid=void 0,this.schedule=void 0),this.useNewScheduler&&(this.store.removeListener("vpaidReady",this._bindedOnVpaidReady),this.store.removeListener("vpaidEnded",this._bindedOnVpaidEnded),clearInterval(this.loop2Ticker))}},{key:"stopVpaid",value:function(){this.runningVpaid&&!this.runningVpaid.finished&&this.runningVpaid.stop()}},{key:"start",value:function(){window.clearTimeout(this.runTimeId),this.useNewScheduler?(this.vpaidToRun={vpaid:this.schedule["00:00"],time:"00:00"},this.store.on("vpaidReady",this._bindedOnVpaidReady),this.store.on("vpaidEnded",this._bindedOnVpaidEnded),this._bindedLoop2()):this._loop()}},{key:"disable",value:function(){this.isDisabled=!0}},{key:"_onVpaidReady",value:function(e){this._loop2()}},{key:"_onVpaidEnded",value:function(e){e.hadImpression&&(this.lastEndedPlayedVpaid=Date.now()),this._loop2()}},{key:"_loop2",value:function(){if(!this.stopped&&!this.store.get("playerClosed")&&!this.isDisabled&&0===this.store.get("ads_started")){var e=Date.now()-this.lastEndedPlayedVpaid;e>=1e3*this.timeBetweenAds&&this.runVpaid(this.vpaidToRun.vpaid,this.vpaidToRun.time)}}},{key:"_loop",value:function(){if(!this.isDisabled){window.clearTimeout(this.runTimeId);var e=this,t=Math.floor(this.parent.video.currentTime);if(this._isContentPaused()&&(t=NaN),1===this.timeBetweenAds||t!=this.savedTime&&!isNaN(t)&&"repeating"!=this.parent.status){this.savedTime>t&&(this.savedTime=-1);var i=(new Date).getTime();if(i-this.lastRun<this.minTimeBetweenRuns)return void(e.runTimeId=window.setTimeout(function(){e._loop()},1e3));isNaN(this.savedTime)&&(this.savedTime=0);var n=this.savedTime+1;n>t&&(n=t);for(var r={vpaid:!1,time:0};n<=t;){var s=this.parent.secondsToString(n);this.schedule[s]&&(r.vpaid=this.schedule[s],r.time=s),n++}if(r.vpaid){window.lastRun=Date.now();var o=this.runVpaid(r.vpaid,r.time);o&&(this.lastRun=i)}this.savedTime=t}e.runTimeId=window.setTimeout(function(t){e._loop()},700)}}},{key:"_isContentPaused",value:function(){return this.parent.canvas?"PAUSED"===this.parent.canvas.status:this.parent.video&&this.parent.video.paused}},{key:"runVpaid",value:function(e,t){return this.runningVpaidTagData=e,this.vpaidCount++,e.vpaidCount=this.vpaidCount,this.runningVpaid?this.runningVpaid.run():(this.runningVpaid=new a.default({isFirstImpression:this.isFirstImpression,vpaidTag:e,uid:t,parent:this.parent,isPreRoll:"00:00"===t&&0===this.vpaidCount},this.parent.options,this.store),!0)}},{key:"_checkFirstImpression",value:function(){var e=!this._firstImpression;return this._firstImpression=!0,e}},{key:"getTagData",value:function(){return!!this.gotVpaid&&this.runningVpaidTagData}},{key:"getVpaidLogs",value:function(){if(this.runningVpaid)return this.runningVpaid.getVpaidLogs()}},{key:"isFirstImpression",get:function(){return this._checkFirstImpression.bind(this)}},{key:"tagVolume",set:function(e){this.runningVpaidTagData.volume=e}},{key:"vpaid",get:function(){return this.gotVpaid?this.runningVpaid.vpaid:{}}},{key:"gotVpaid",get:function(){return!(!this.runningVpaid||this.runningVpaid.finished||!this.runningVpaid.vpaidCreated)}}]),e}();t.default=u},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(){i(this,e),this._startTime=0,this._stopTime=0,this._now=window.performance?window.performance.now.bind(window.performance):Date.now.bind(Date)}return n(e,[{key:"now",value:function(){return parseInt(this._now())}},{key:"start",value:function(){this._startTime=this.now()}},{key:"stop",value:function(){this._stopTime=this.now()}},{key:"reset",value:function(){this._stopTime=this._startTime=0}},{key:"duration",value:function(){if(this._startTime&&this._stopTime)return this._stopTime-this._startTime;throw"You did not use the stopwatch as expected!"}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(6),l=i(1),u=n(l),c=function(e){function t(e){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i._maxListeners=100,i.data={},Object.assign(i.data,e);var n="10.4.9";i.data.full_player_version=n,n=n.replace(/\./g,""),n=parseInt(n),i.data.debugLevels=e.debug?e.debug:"",i.data.debug=e.debug.indexOf("*")!=-1,i.data.player_version=n;var o="",a="",d="";try{a=e.unit_name,o=e.abTest,d=e.unit_main_version}catch(e){}return i.data.ab_test=o,i.data.unit_type=a,i.data.unit_version=d,i.data.session_started=Date.now(),window.cmTag&&window.cmTag.config&&window.cmTag.config.contentClickUrl&&(i.data.contentClickUrl=window.cmTag.config.contentClickUrl),i.set("ua",u.parseUserAgent()),i}return o(t,e),a(t,[{key:"incr",value:function(e){h.exists(e,this.data)||h.set(e,0,this.data);var t=h.get(e,!0,this.data)||0;if("number"==typeof t)return h.set(e,t+1,this.data),h.get(e,!1,this.data)}},{key:"decr",value:function(e){var t=h.get(e,!1,this.data);if("number"==typeof t)return h.set(e,t-1,this.data),h.get(e,!1,this.data)}},{key:"get",value:function(e){return e=e.toString(),e.indexOf(".")===-1?this.data[e]:h.get(e,!1,this.data)}},{key:"getByTech",value:function(e,t){var i=this.get("dsm")||{};return i&&i.hasOwnProperty(t)&&i[t].hasOwnProperty(e)?i[t][e]:null}},{key:"getByAdInline",value:function(e){var t=this.get("dsm")||{},i=Object.keys(t);if(i.length>0)for(var n=new RegExp(Object.keys(t).join("|"),"gi"),r=0;r<e.length;r++){var s=e[r],o=s.as&&s.as.match(n)||s.at&&s.at.match(n);if(o&&o.length>0)return t[o[0].toLowerCase()]}return this.get("adstngs")}},{key:"getLatestVersion",value:function(e){e=e.toString();var t=e+"_latest",i=this.get(t);if(void 0!==i)return i;var n=new RegExp(e+"[v]*\\d+$"),r={value:void 0,version:0};for(var s in this.data)if(n.exec(s)){var o=parseInt(s.match(/\d+$/)[0]);(!r.value||r.version<o)&&this.data[s]&&(r.version=o,r.value=this.data[s])}else 0===r.version&&s===e&&(r.value=this.data[s]);return this.set(t,r),r}},{key:"set",value:function(e,t){e=e.toString(),h.set(e,t,this.data)}},{key:"getWfData",value:function(){var e=this.get("dsm")||{},t=[];for(var i in e)/^\d+$/.test(i)&&e[i]&&e[i].hasOwnProperty("ftchVst")&&t.push({id:i,fv:e[i].ftchVst});return t}}]),t}(d.EventEmitter);t.default=c;var h=function(){var e=function(e,t,i){for(var n,r=i||data,s=0;r&&(n=e[s]);s++)r=n in r?r[n]:t?r[n]={}:void 0;return r};return{set:function(t,i,n){var r=t.split("."),s=r.pop(),o=e(r,!0,n);return o&&s?o[s]=i:void 0},get:function(t,i,n){return e(t.split("."),i,n)},exists:function(e,t){return void 0!==this.get(e,!1,t)}}}()},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),a=n(o),d=i(17),l=(i(156),function(){function e(t){var i=this;r(this,e),this.store=t,this.isMobile=this.store.get("isMobile"),d.init(this.store.data),d.get("video-autoplay-detector",this.store.get("vidautoplydtctv"),function(e){i.autoPlayDetector=new e(i.handleAutoPlayData.bind(i),{isMobile:i.isMobile,timeout:1e3})})}return s(e,[{key:"handleAutoPlayData",value:function(e){this.logToElastic(e),this.writeToStore(e)}},{key:"logToElastic",value:function(e){a.reportByIndex("player_options","autoplayDetector",{_id:a.generateGuid(10),type:"autoplayDetector",autoplayDetectorResponse:e,currentHasAutoPlay:this.store.get("hasAutoPlay"),isMobile:this.store.get("isMobile"),player_id:this.store.get("player_id")},this.store)}},{key:"writeToStore",value:function(e){this.store.set("autoplayDetectorResponse",e)}}]),e}());t.default=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(26),a=n(o),d=0,l=function(){function e(t,i){r(this,e),this.store=t,this.parent=i,this.initVpaid(),this.hadFirstImpression=!1}return s(e,[{key:"initVpaid",value:function(){var e=this.getVpaidTag(),t={"00:00":e,"00:01":e};this.store.set("contentSchedule",t),this.store.set("autoplay_on_pre_roll",!1),this.vpaidHandler=new a.default({isFirstImpression:this.isFirstImpression,vpaidTag:e,uid:d++,parent:this.parent},this.parent.options,this.store),this.vpaidHandler.runWaterfall("vforceInit")}},{key:"getVpaidTag",value:function(){var e=this.store.get("schedule"),t={};return e.forEach(function(e){e&&"pre-roll"===e.roll_type&&(t=e)}),t}},{key:"isFirstImpression",value:function(){return!this.hadFirstImpression&&(this.hadFirstImpression=!0,!0)}},{key:"getVpaidLogs",value:function(){if(this.vpaidHandler)return this.vpaidHandler.getVpaidLogs()}},{key:"getAd",value:function(e){return this.vpaidHandler.getAd(e)}},{key:"stop",value:function(){this.vpaidHandler&&!this.vpaidHandler.finished?this.vpaidHandler.stop():this.parent&&this.parent._onVpaidClosed(),this.vpaidHandler=void 0,this.schedule=void 0,this.parent=void 0,this.savedTime=-1}},{key:"pause",value:function(){this.vpaidHandler.pause()}},{key:"resume",value:function(){this.vpaidHandler.resume()}},{key:"volume",value:function(e){this.vpaidHandler.volume(e)}},{key:"mute",value:function(){this.volume(0)}},{key:"unmute",value:function(e){this.volume(e)}},{key:"resize",value:function(e,t,i){this.vpaidHandler.resize(e,t,i)}}]),e}();t.default=l},function(e,t){"use strict";var i=i||{};i.dSettings={wirewax:{adtnlscrpts:[{src:"//edge-player.wirewax.com/ww4release/javascripts/wirewax-iframe-api.js",clbk:function(){try{this.adUnit.unsubscribe(this.vpaidEvents.AdImpression,"*"),this.adUnit.unsubscribe(this.vpaidEvents.AdVideoComplete,"*");for(var e in this.adUnit._iframe.contentWindow.wirewax.events.listeners)this.adUnit._iframe.contentWindow.wirewax.addEventListener(this.adUnit._iframe.contentWindow.wirewax.events.listeners[e],this.onIframeEvent)}catch(e){}}}],ifrmevts:{playerReady:"AdImpression",videoEnd:"AdVideoComplete"},hdtrgt:!0,wtfradpsdbfrrsmad:!0,prvnterlyadimpopp:!0},"the trade desk":{extwnprc:!0,wnprcfld:"wp"},dbm:{extwnprc:!0,wnprcfld:"pr"}},window.TRC=window.TRC||{},window.TRC.dsm=window.TRC.dsm||{},window.TRC.dsm[176]=i.dSettings},function(e,t){"use strict";var i='function startProtection(o){window.ReportHijackAttempt=window.ReportHijackAttempt||function(){};var e="%%%TEMP%%%",r=new RegExp(e.map(function(e){try{return atob(e)}catch(t){return e}}).join("|"),"i"),n="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&";function p(t){return!!e.length&&r.test(t)}function i(t,e){(new Image).src=n+(new Date).getTime(),window.ReportHijackAttempt(t,e)}function c(e){var r=function(){try{e.removeEventListener("load",r);var t=e.contentWindow.document.createElement("script");t.type="text/javascript",e.contentWindow.hjkFunc=t.innerHTML=window.hjkFunc,e.contentWindow.document.head.appendChild(t)}catch(t){}};e.addEventListener("load",r)}function s(t){if(t.src)return t.src;if(t.childNodes.length)for(var e=0;e<t.childNodes.length;e++)if(t.childNodes[e]&&t.childNodes[e].src)return t.childNodes[e].src;return t.outerHTML}try{!function(){for(var t=document.scripts||[],e=0;e<t.length;e++)t[e].src&&p(t[e].src);var r=document.querySelectorAll("iframe")||[];for(e=0;e<r.length;e++)if(p(r[e].src)){i(r[e].src,!0);break}}(),HTMLIFrameElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLIFrameElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,"src")),Object.defineProperty(HTMLIFrameElement.prototype,"src",{get:function(){return this._src},set:function(t){p(t)?i(t,!1):(c(this),this._src=t)}})),HTMLIFrameElement.prototype.hasOwnProperty("_setAttribute")||(HTMLIFrameElement.prototype._setAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(t,e){"src"==t.toLowerCase()&&p(e)?i(e,!1):(c(this),this._setAttribute(t,e))}),HTMLElement.prototype.hasOwnProperty("_insertBefore")||(HTMLElement.prototype._insertBefore=HTMLElement.prototype.insertBefore,HTMLElement.prototype.insertBefore=function(t,e){if(!p(t.outerHTML))return this._insertBefore(t,e);i(s(t),!1)}),HTMLElement.prototype.hasOwnProperty("_appendChild")||(HTMLElement.prototype._appendChild=HTMLElement.prototype.appendChild,HTMLElement.prototype.appendChild=function(t){if(!p(t.outerHTML))return this._appendChild(t);i(s(t),!1)}),HTMLScriptElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLScriptElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src")),Object.defineProperty(HTMLScriptElement.prototype,"src",{get:function(){return this._src},set:function(t){p(t)?i(t,!1):this._src=t}})),HTMLScriptElement.prototype.hasOwnProperty("_setAttribute")||(HTMLScriptElement.prototype._setAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(t,e){"src"==t.toLowerCase()&&p(e)?i(e,!1):this._setAttribute(t,e)}),HTMLObjectElement.prototype._scrollIntoView=HTMLObjectElement.prototype.scrollIntoView,HTMLObjectElement.prototype.scrollIntoView=function(){return!1},HTMLDivElement.prototype._scrollIntoView=HTMLDivElement.prototype.scrollIntoView,HTMLDivElement.prototype.scrollIntoView=function(){return!1},XMLHttpRequest.prototype.hasOwnProperty("_open")||(XMLHttpRequest.prototype._open=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(t,e,r,o,n){p(e)?i(e,!1):this._open.apply(this,arguments)}),HTMLElement.prototype._click=HTMLElement.prototype.click,HTMLElement.prototype.click=function(){this.hasAttribute("download")||this._click()},o||(window.onerror=function(){return!0}),function(){if(!o){console=console||{};for(var t=function(){},e=["debug","error","info","log","warn"],r=0;r<e.length;r++)console[e[r]]&&(console[e[r]]=t)}}()}catch(t){}}startProtection("%%%IS_DEBUG%%%");';
try{HijackResponse(i)}catch(e){}window.TRC=window.TRC||{},window.TRC.hjk=window.TRC.hjk||{},window.TRC.hjk[223]=i},function(e,t){"use strict";var i="!function(){if((window.ignoreGetVpaidAd||'function'==typeof window.getVPAIDAd)&&function(){try{return window.self!==window.top}catch(e){return!0}}()){function e(){for(var e=document.scripts||[],t=[],r=0;r<e.length;r++)t.push(e[r].src);return t}function t(e){for(var t=document.querySelectorAll('iframe'),r=[],i=0;i<t.length;i++)r.push(t[i].src),t[i].src&&'undefined'===t[i].src.substr(0,9)&&e&&e(url);return r}function r(r,i,o){var n=window._vaThis||this;if(window._vaThis){var s=e(),a=t(n._onUndefinedRelativeIframeSrcError);n.scripts=n.scripts.concat(s),n.iframes=n.iframes.concat(a),n.firstCount+=a.length+s.length}else n.data={},n.XHRUrls=[],n.XHRResponses=[],n.iframes=t(n._onUndefinedRelativeIframeSrcError),n.scripts=e(),n.firstCount=n.iframes.length+n.scripts.length,n.timeoutLength=o.timeout||3e3,n.callback=i,n.adImpressionEvent='AdImpression',n.networkCallCounter=0,n.maxNetworkCalls=o.maxNetworkCalls||!1,n.networkCallsLimitExceeded=!1,n.latencies=[],n.iframesWeights={gen:8,ggl:4,pxls:2},n.isVideoUrlPublic=void 0,n.requestId=0,n.requestStartTimes={},Object.defineProperty(n,'AnalyticsData',{get:function(){return n.data},enumerable:!0,configurable:!1}),r&&n.subscribeToAdImpression(r);if(o&&(o.withXHR&&window.XMLHttpRequest&&this.createXMLHTTPHook(),o.withIframes&&void 0!==window.HTMLIFrameElement&&this.createIframesSrcHook(o),o.withScripts&&void 0!==window.HTMLScriptElement&&this.createScriptsSrcHook(),o.timeout&&(n.timeoutLength=o.timeout),o.iframesWeights))for(var c in o.iframesWeights)n.iframesWeights[c]=o.iframesWeights[c];window.destroyAnalyticsReporter=function(){n.data=n.XHRUrls=n.XHRResponses=n.iframes=n.scripts=n.timeoutLength=n.iframesWeights=n.requestStartTimes=void 0,window.getVpaidAnalyticsReport=window.destroyAnalyticsReporter=window.onNetworkCallsLimitExceeded=window.setIsVideoUrlPublic=void 0,window.AnalyticsReporter=void 0},window.getVpaidAnalyticsReport=function(){var t=window._vaThis||this,r=[],i={scripts:t.scripts.length>0?t.scripts.slice():e(),XHRUrls:t.XHRUrls.slice(),iframes:t.iframes.slice()};for(var o in i)r=r.concat(i[o]);i.totalRequests=r,i.totalRequestsCounter=r.length,i.firstCount=t.firstCount,i.latencies=t.latencies.slice();var n=i.latencies.reduce(function(e,t){return e+t},0);return i.averageLatency=i.latencies.length?n/i.latencies.length:0,i.averageIntLatency=parseInt(i.averageLatency),i}.bind(n),window.setIsVideoUrlPublic=function(e){(window._vaThis||this).isVideoUrlPublic=e}.bind(n)}r.prototype.subscribeToAdImpression=function(e){var t=window._vaThis||this;e.subscribe(function(){t.adImpFired=!0,setTimeout(function(){t.sendData()},t.timeoutLength)},t.adImpressionEvent,t)},r.prototype.sendData=function(){var e=window._vaThis||this;e.collectData(e.adImpressionEvent),e.callback(e.adImpressionEvent,e.AnalyticsData)},r.prototype.collectData=function(t){var r=window._vaThis||this,i={};i.eventName=t,i.scripts=r.scripts.length>0?r.scripts.slice():e(),i.XHRUrls=r.XHRUrls.slice(),i.XHRResponses=r.XHRResponses.slice(),i.iframes=r.iframes.slice(),r.data[t]=i},r.prototype.onUrlHooked=function(e,t,r){var i=window._vaThis||this;i[e].push(t),r._id=i.requestId++,i.requestStartTimes[r._id]=Date.now();var o=function(){i.requestStartTimes.hasOwnProperty(this._id)&&(i.latencies.push(Date.now()-i.requestStartTimes[this._id]),delete i.requestStartTimes[this._id]),this.removeEventListener('load',o)}.bind(r);r.addEventListener('load',o),'iframes'!==e||void 0===i.isVideoUrlPublic?i.networkCallCounter++:i.networkCallCounter+=i.getIframeWeight(t),i.isMaxNetworkCallsLimitExceeded()&&i.onNetworkCallsLimitExceeded()},r.prototype.getIframeWeight=function(e){var t=window._vaThis||this;return e.indexOf('imasdk')?t.iframesWeights.ggl:t.isVideoUrlPublic?t.iframesWeights.pxls:t.iframesWeights.gen},r.prototype.createXMLHTTPHook=function(){var e=window._vaThis||this;window.XMLHttpRequest.prototype._vaOpen=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(t,r,i,o,n){return e.onUrlHooked('XHRUrls',r,this),this.addEventListener('load',function(){e.XHRResponses.push('load: '+this.responseText)}),window.XMLHttpRequest.prototype._vaOpen.apply(this,arguments)}},r.prototype.createIframesSrcHook=function(e){var t=window._vaThis||this;Object.defineProperty(HTMLIFrameElement.prototype,'_vaSrc',Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'src'));var r=function(r,i){if(t.onUrlHooked('iframes',r,i),r&&'undefined'===r.substr(0,9)&&t._onUndefinedRelativeIframeSrcError(r),e.deepIframes){var o=function(){try{i.removeEventListener('load',o),i.contentWindow.ignoreGetVpaidAd=!0,i.contentWindow._vaThis=t;var r=i.contentWindow.document.createElement('script');r.innerText=t.vpaidAnalyticsFunc,i.contentWindow.document.head.appendChild(r),new i.contentWindow.AnalyticsReporter(null,function(){},e)}catch(e){}};i.addEventListener('load',o)}};Object.defineProperty(HTMLIFrameElement.prototype,'src',{get:function(){return this._vaSrc},set:function(e){r(e,this),this._vaSrc=e}}),HTMLIFrameElement.prototype._vaSetAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(e,t){'src'===e&&r(t,this),this._vaSetAttribute(e,t)}},r.prototype.createScriptsSrcHook=function(){var e=window._vaThis||this;Object.defineProperty(HTMLScriptElement.prototype,'_vaSrc',Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,'src')),Object.defineProperty(HTMLScriptElement.prototype,'src',{get:function(){return this._vaSrc},set:function(t){e.onUrlHooked('scripts',t,this),this._vaSrc=t}}),HTMLScriptElement.prototype._vaSetAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(t,r){'src'===t&&e.onUrlHooked('scripts',r,this),this._vaSetAttribute(t,r)}},r.prototype.unHook=function(){var e=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'_vaSrc'),t=Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,'_vaSrc');e&&(Object.defineProperty(HTMLIFrameElement.prototype,'src',e),HTMLIFrameElement.prototype.setAttribute=HTMLIFrameElement.prototype._vaSetAttribute),t&&(Object.defineProperty(HTMLIFrameElement.prototype,'src',t),HTMLScriptElement.prototype.setAttribute=HTMLScriptElement.prototype._vaSetAttribute),window.XMLHttpRequest.prototype._vaOpen&&(window.XMLHttpRequest.prototype.open=window.XMLHttpRequest.prototype._vaOpen)},r.prototype.onNetworkCallsLimitExceeded=function(){var e=window._vaThis||this;e.networkCallsLimitExceeded||(e.adImpFired||e.unHook(),e.networkCallsLimitExceeded=!0,e.sendData(),window.onNetworkCallsLimitExceeded())},r.prototype.isMaxNetworkCallsLimitExceeded=function(){var e=window._vaThis||this;return e.networkCallsLimitExceeded||e.maxNetworkCalls&&e.networkCallCounter>=e.maxNetworkCalls},window.AnalyticsReporter=r}}();";try{VpaidAnalytics(i)}catch(e){}window.TRC=window.TRC||{},window.TRC.vpaidAnalytics=window.TRC.vpaidAnalytics||{},window.TRC.vpaidAnalytics[31]=i},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(71),d=r(a),l=i(1),u=n(l),c=i(58),h=(n(c),i(59)),p=(n(h),i(60)),f=(n(p),i(24)),v=r(f),m=i(17),g=function(){function e(t){s(this,e),this.ServiceLoader=m,this.ServiceLoader.init(t.data),this.store=t,this.baseUrl=this.store.get("base_url"),this.JSONPHandler=new d.default(this.baseUrl),this.dependenciesProperties=v.default,this._loadVpaidResources()}return o(e,[{key:"_loadResource",value:function(e,t,i){var n=this;if(!this.stopped){var r=function(i){n.stopped||(n.store.get(e.storeDataKey)||n.store.set(e.storeDataKey,i),t&&t(i))},s=function(){if(!n.stopped){var t=n.store.get(e.jsonpCallbackName);return t?void n.JSONPHandler.load(e.path,t,function(e){e?r(e):i&&i()}):void(i&&i())}};this.ServiceLoader.get(e.serviceKey,e.version,r,s)}}},{key:"_loadScript",value:function(e,t){if(!this.stopped){var i=document.createElement("script"),n=document.getElementsByTagName("script")[0];i.src=this.baseUrl+this.store.get(e.storePathKey),n.parentNode.insertBefore(i,n),i.onload=function(){t&&t()}}}},{key:"_loadHJK",value:function(e){var t=this;e=Object.assign(e,this.dependenciesProperties.hjk),this._loadResource(e,function(i){i=t._replaceResourcePlaceholders(i),t.store.set(e.storeDataKey,i)})}},{key:"_loadVpaidAnalytics",value:function(e){e=Object.assign(e,this.dependenciesProperties.vpaidAnalytics),this._loadResource(e)}},{key:"_loadVpaidCrawler",value:function(e){var t=this;e=Object.assign(e,this.dependenciesProperties.vpaidCrawler),this._loadResource(e,function(i){i=t._replaceResourcePlaceholders(i),t.store.set(e.storeDataKey,i)},this._loadHJKAndAnalytics.bind(this))}},{key:"_loadVpaidResources",value:function(){this.stopped||(this._loadVpaidCrawlerResources(),this._loadDSM())}},{key:"_loadVpaidCrawlerResources",value:function(){if(!this.stopped){var e=this._getCleanResourceVersionAndPath(this.dependenciesProperties.vpaidCrawler.storePathKey,this.dependenciesProperties.vpaidCrawler.versionRegex);this._canLoadResourceFromObj(e)?this._loadVpaidCrawler(e):this._loadHJKAndAnalytics()}}},{key:"_loadHJKAndAnalytics",value:function(){var e=this._getCleanResourceVersionAndPath(this.dependenciesProperties.hjk.storePathKey,this.dependenciesProperties.hjk.versionRegex);this._canLoadResourceFromObj(e)&&this._loadHJK(e);var t=this._getCleanResourceVersionAndPath(this.dependenciesProperties.vpaidAnalytics.storePathKey,this.dependenciesProperties.vpaidAnalytics.versionRegex);this._canLoadResourceFromObj(t)&&this._loadVpaidAnalytics(t)}},{key:"_loadDSM",value:function(){var e=this,t=this._getCleanResourceVersionAndPath(this.dependenciesProperties.dsm.storePathKey,this.dependenciesProperties.dsm.versionRegex);this._canLoadResourceFromObj(t)&&(t=Object.assign(t,this.dependenciesProperties.dsm),this._loadResource(t,this._loadScript.bind(this,t,function(){e.store.set(e.dependenciesProperties.dsm.storeDataKey,cmTag.dSettings)})))}},{key:"_canLoadResourceFromObj",value:function(e){return e&&e.version&&e.path}},{key:"_getCleanResourceVersionAndPath",value:function(e,t){var i=this._getVersionObj(e);return i?{version:this._extractResourceVersion(i,t),path:i.value}:null}},{key:"_getVersionObj",value:function(e){var t=this.store.getLatestVersion(e);return t&&t.value?t:""}},{key:"_extractResourceVersion",value:function(e,t){var i=e.value.match(t);return!i||i.length<2?"":i[1]}},{key:"_replaceResourcePlaceholders",value:function(e){if(!this.stopped){var t=this.store.get("hjkbldomsencdd");return t&&0!==t.length||(t=this.store.get("hjkbldoms")),e.replace('"%%%TEMP%%%"',u.stringify(t)).replace('"%%%IS_DEBUG%%%"',this.store.get("debug"))}}},{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this.ServiceLoader=this.JSONPHandler=this.store=this.dependenciesProperties=void 0)}}]),e}();t.default=g},function(e,t){"use strict";function i(e){var t={domain:window.location.hostname,cirf:"",referrer:document.referrer?document.referrer.split("//")[1]:window.location.hostname,vertical:"default",auc_dast:"0",title:"",description:"",keywords:"",default_ad_parameters:"",files:[],image:!1,target_id:"",height:!1,width:!1,controls:!0,aspect_ratio:"16:9",repeat:!0,mute:!1,oid:0,default_ad_timeout:30,volume:0,video_class_name:"video-js vjs-default-skin",schedule:[],schedule_auto:1,min_vpaid_run_time:4,debug:[],htmlVideoSupport:function(){return!!document.createElement("video").canPlayType}(),ga_factor:1,fire99:!0,ad_controls:!1,time_between_waterfall:10,tmbtwfs:function(e,t,i,n){return i.get("time_between_waterfall")},mntmbtwfsf:function(e,t,i,n){return i.get("mintimwf")},mintimwf:5e3,mntmbtwfs:5,mxtmbtwfs:900,queue_size:6,max_ready_vpaid:3,waterfall_watermark:0,base_url:"//vidstat.taboola.com",wf_path:"VideoBidRequestHandlerServlet",run_wf_when_empty:!0,kaxwnc:18e5,pstflrs:!0,pvpd:"javascript",pvidtp:"",sncad:!1,blkflshjs:!0,altmot:6e4,adimptmot:0,prtctv2:"/vpaid/hjk.214.js",hjkclb:"HijackResponse",jsnoflshdtct:!1,qsrtscr:function(e,t){return 100*t.alfrox},psthdrs:"text/plain",rstmrai:!0,vstprxy:!1,pxyurl:"http://vid.mikysrv.com/fetch?url=",global_ad_timeout:18e4,mprdct:void 0,uscnvsmpg:!0,forcecnvsmpg:!1,gtvid2:"//mpg.taboola.com/getts?url",cnvsldrt:5,mpgclrslv:["gcdn.2mdn.net"],dsu:"/vpaid/ds/117/dsm.js",run_wf_on_init:!0,useapforcntnt:!1,wf_dynmc_ps:!0,sprssviderr:!1,vForce:!1,get_ad_timeout_seconds:10,wf_manual:!1,disctxt:"By Taboola",httpsOverride:!0,usscrtgurl:!1,evtbsschdl:!0,timbtopps:2e3,cmbopps:!0,anltcsurlv4:"",anltcsurlv5:"",anltcsclb:"VpaidAnalytics",anltcsOptions:{withXHR:!0,withIframes:!0,withScripts:!0,maxNetworkCalls:0,timeout:3e3,deepIframes:!0},moat:!1,measureKPI:!1,prfsmpmsnt:5,prfsmitrvpmsnt:1500,kpitrvldrt:15e3,msrkpifctr:0,msrkpiintvl:15,moatPartnerCode:"taboolajsvideo2446883476",sndvltopp:!0,novdtrm:!1,dcdvdurl:!1,firstWaterfallNoaop:0,mxlifls:0,kbnul:"//vidanalytics.taboola.com",frcmtfrms:!0,frcvlm:!1,pxlnotsmtp:!1,cntonvfrc:!0,mxemptwf:0,dtsvrurl:"//vidutils.taboola.com",mltads:!1,erlyai:!1,frcadvlmtrvl:1e3,dbncadvltm:50,stpfrcvlevnt:"AdVideoFirstQuartile",imapihok:!1,trmrdyvpaid:!0,dfltvlm:.4,usstrckisyn:!1,dlywf:!1,adto:3e5,vakll:3e5,ovrtgbydc:!1,strgprvdrttl:6048e5,frstlk:!1,pusvidprtctn:!1,encwfrs:!1,dsktmouttoadcmpltn:0,mbltmouttoadcmpltn:0,loadrsrc:!1,wfv:1,aderrbfradlddopactv:!0,isMultiVpaidUnit:!1,hdeadsplypusbtn:!0,isIdleMode:!1,mttst:"",mxntwrkclls:80,rplvpdactv:!1,rvfctr:0,dnapmxvl:0,usopsla:!0,opslavrsn:"1.3.6",mcrsrvcsnmspc:"trc",bllblevt:"1,25,21,22,23,24",ifrmswghts:{gen:15,ggl:6,pxls:30},dskVidMuted:!0,ovrdnonntvfnclst:{},fkadchcs:!1,istblvpd:!1,mtdhkactv:!1,addprld:!0,blckbrngtofrnt:!1,tglifrmcntndsplyactv:!1,cmpltonstpddmn:["innovid.com"],cmpltonstpdms:0,aduntldflbfruntld:!1,adwrprstoplrdst:!0,bckflldlyms:1e4,mxbckflldlyitms:0,bfprty:0,lgvpdtxtelmnts:!1,shwadmtebtn:!0,wtfradpsdbfrrsmad:!1,mtfctr:0,noplrcntr:!1,plyrcss:"player",vpdcntrcstmcss:"",flbktovdo:!0,dsbgl:!0,cntdwnrgx:"",msnifrmsrchk:!0,prvaupl:!0,stpvpdonudfndsrc:!0,sprtnnvidvpd:!0,adxcrdgtadtmt:5e3,adtnladxsprtdszs:[],stpvpdonrltvsrc:!1,rvfrquesttsemttr:!0,cntgtad:!0,dftgprc:void 0,scrmf:!0,hjkbldoms:[],rtryonfl:!1,hjkbldomsencdd:[],cpcvcmpgntps:[14,17],cstmdltps:{tags:7,dCPM:9,externalCPCV:14,internalCPCV:17},dtctcmp:!1,dtctcmpfctr:0,comp:{},cmpdtctv:"1.0.0",vidautoplydtctv:"1.0.0",drpbletps:["singleAd","adjacencyAd"],rplcpxlmcrplchldr:!0,erronopp:!0,dtctprvtbrwsng:!0,vdelv:"2.0.1",plcntbfrads:!0,sndvptmrst:!1,frwferrpxls:0,hdtrgt:!1,spprtvrtclvd:!0,prvnterlyadimpopp:!1,untetrk:["viewability","viewable50precent1sec","fullyviewable1sec"],vdtck:0,htsptdflt:{pos:"bottom-left",txtclr:"white",mrgn:20,lbl:""},frwfpssbckrpxl:0,sndmoatcstmmatdta:{aucDast:!0,vidDast:!0,abTest:!0,impressionId:!0,pdast:!0},wtchvdointrvl:1e3,rprtvidsttsintrvl:1e3,q5byprgrss:!0,mnvlddrtn:.1,frgtadpxls:100,frmltplpxls:["AdPaused","AdClickThru","AdPlaying"],rprtbuffrng:0,wtchprgrssopp:0,mblmdiadrctdmnd:!1,vidfkadldt:2e3,onPlayerReady:function(e){},onPlayerLoadError:function(e){},onPlayerError:function(e){},onPlayerPlay:function(e){},onPlayerStop:function(e){},onPlayerClose:function(e){},onPlayerPause:function(e){},onPlayerResume:function(e){},onPlayerSeek:function(e){},onPlayerRepeat:function(e){},onPlayerComplete:function(e){},onAdLoadError:function(e,t){},onAdError:function(e,t){},onAdStopped:function(e,t){},onAdImpression:function(e,t){},onAdVideoStart:function(e,t){},onAdVideoEnd:function(e,t){},onAdClick:function(e,t,i){}};for(var i in t)void 0==e[i]&&(e[i]=t[i]);e.description||(e.description=e.title),e.keywords||(e.keywords=e.title),parseFloat(e.width)||parseFloat(e.height)||(e.width="377",e.height="314");var n=parseInt(100*Math.random())+1<=e.ron_percent;return e.tagDefault={ad_controls:e.ad_controls,url:"",pubid:"",tagid:"",vidlength:"",video_url:e.files[0],title:e.title,cirf:e.cirf,description:e.description,keywords:e.keywords,ad_parameters:e.default_ad_parameters,muted:e.mute?1:0,auc_dast:e.auc_dast,referrer:e.referrer,domain:e.domain,vertical:e.vertical,roll_type:"mid-roll",oid:e.oid,ad_timeout:e.default_ad_timeout,rs:"1",st:"1",sts:"1",type:"wf",noaop:"10",sortOrderType:0,mfp:4,afbp:e.use_flash_bypass,isRon:n,isvideo:0,mindur:1,maxdur:e.default_ad_timeout,minbr:1,maxbr:1e4,plmd:0,defaultTagTimeout:30,totaltimeout:60,use_as_is:!1,skip_vast:!1},e}function n(){var e={};try{e=window.cmTag.config}catch(e){return{}}var t={};for(var i in e)if(0===i.indexOf("player.settings.")){var n=i.substr(16,i.length-16);t[n]=r(e[i])}return t}function r(e){var t=/^\d+$/.test(e);if(t)return parseInt(e);var i=/^true$|^false$/g.test(e);return i?"true"===e||e===!0:e}Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaults=i,t.getUnitParams=n},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){var n=this;i(this,e),this.store=t,this.ua=this.store.get("ua"),this.browser=this.ua.browser.name,this.browserMajorVersion=parseInt(this.ua.browser.major),this._detectPrivateMode(function(e){n.store.set("isPrivateBrowsing","undefined"==typeof e?"cannot detect":e?"private":"not private")})}return n(e,[{key:"_detectPrivateMode",value:function(e){var t;if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){t=!1},function(e){t=!0});else if(window.indexedDB&&"Firefox"===this.browser){var i;try{i=window.indexedDB.open("test")}catch(e){t=!0}"undefined"==typeof t&&this._retry(function(){return"done"===i.readyState},function(e){e||(t=!i.result)})}else if(this._isIE10OrLater()){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if("Safari"===this.browser)if(this.browserMajorVersion<11)try{localStorage.length?t=!1:(localStorage.x=1,localStorage.removeItem("x"),t=!1)}catch(e){t=!!navigator.cookieEnabled}else try{window.openDatabase(null,null,null,null),t=!1}catch(e){t=!0}this._retry(function(){return"undefined"!=typeof t},function(i){e(t)})}},{key:"_isIE10OrLater",value:function(){return"IE"===this.browser&&this.browserMajorVersion>=10||"Edge"===this.browser}},{key:"_retry",value:function(e,t){var i=0,n=50,r=!1,s=window.setInterval(function(){e()&&(window.clearInterval(s),t(r)),i++>n&&(window.clearInterval(s),r=!0,t(r))},10)}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(15),d=n(a),l=i(10),u=(n(l),i(72)),c=n(u),h=i(5),p=n(h),f=i(84),v=n(f),m=i(12),g=n(m),y=i(67),_=n(y),b=i(17),w=(i(153),0),k=function(){function e(t,i,n){r(this,e),this.vpaidHandler=i,this.store=n,this.vpaidCount=1,this.version="VPAID-1.0.0",this.VPAIDversion="1.1",this.debugTracker=new p.default(this.version),this.beacon=new d.default(this),this.vpaidParameters=this._defaultVpaidParameters,this.config=this._defaultVpaidConfig;var s={};this._createIframesDetector(),this.store.get("mltads")&&this.store.on("resizeVpaidWrapper",this._onResizeAd.bind(this));for(var o in t)s[o.toUpperCase()]=t[o];this.config.creatives=Object.assign({},this._defaultVpaidParameters,s),this.store.get("cmbopps")&&this.store.get("usopsla")&&this._loadOppsula(),this.manager=!1,this._initWaterfall();for(var a in this.vpaidEvents)this.beacon.addEventListener(this.vpaidEvents[a],this._runEventFunction.bind(this));this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,""),this.store.emit("mainVpaidCreated",this.config)}return o(e,[{key:"_createIframesDetector",value:function(){this.store.set("iframesDetector",new _.default(this.store.get("ifrmswghts")))}},{key:"setVpaidId",value:function(e){this.version="["+e.wfIndex+"_"+e.dp+"]"}},{key:"_loadOppsula",value:function(){var e=this;b.init(this.store.data),b.get("oppsula",this.store.get("opslavrsn"),function(t){e.store.set("ms_data",{opps_base_path:e.store.get("opps_base_path")||e.config.creatives.CM_DOMAIN});var i=new t(e.store.get("unit_model"),e.store);e.store.set("oppsula",i),e.store.emit("oppsulaCreated",i)},function(){e.debugTracker.error("Load Oppsula","Error while loading from service loader")})}},{key:"_onResizeAd",value:function(e){this.config&&(this.config.width=e.width,this.config.height=e.height)}},{key:"trigger",value:function(e,t){this.vpaidHandler.emit(e,t)}},{key:"runWaterfall",value:function(e){this.waterfallManager.runWaterfall(e)}},{key:"getVpaidReadyCount",value:function(){return this.manager.getVpaidReadyCount()}},{key:"_initWaterfall",value:function(){this.waterfallManager=new v.default(this.store),this.config.creativeData=this._getCreativeData(this.config),this.waterfallManager.init(this.config.creatives,this.config.creativeData.AdParameters),this.waterfallManager.SetWaterfallError(this._waterfallError.bind(this)),this.waterfallManager.SetWaterfallSuccess(this._waterfallSuccess.bind(this));var e=this;this.waterfallManager.SetShouldRun(function(){var t=this.store.get("max_ready_vpaid")||2,i=this.store.get("waterfall_watermark")||0;return!e.manager||e.manager.getVpaidReadyCount()+i<t})}},{key:"_getSlot",value:function(e){var t=!1;switch("undefined"==typeof e?"undefined":s(e)){case"string":document.getElementById(e)&&(t=document.getElementById(e));break;case"object":e.style&&e.tagName&&(t=e);break;default:this.debugTracker.error("initAd","Bad slot in 'environmentVars'")}return t}},{key:"_getCreativeData",value:function(e){var t=!1;switch("undefined"==typeof e?"undefined":s(e)){case"object":Object.keys(e).length>0&&(t=!0);break;case"string":if(e.length>0)try{e=new Function("return "+e+";")(),t=!0}catch(e){}}if(t){for(var i in this.config.creatives)(void 0==e[i]||this.config.protectedCreatives.indexOf(i)>-1)&&(e[i]=this.config.creatives[i]);e.AdParameters&&(e.AdParameters=this._handleAdParams(e.AdParameters))}return e}},{key:"_handleAdParams",value:function(e){var t={};switch("undefined"==typeof e?"undefined":s(e)){case"object":Object.keys(e).length>0&&(t=e);break;case"string":if(e.length>0)try{t=new Function("return "+e+";")()}catch(e){}}return t}},{key:"_dataFromUrl",value:function(e){var t=e.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=t.length)return this.debugTracker.warn("dataFromUrl","Bad source parameter!"),this.vpaidParameters;var i=t[1].split(/\?|&/gi);for(var n in i)if(i[n]){var r=i[n].split(/=(.+)?/gi,2);if(2==r.length){var s=r[0].replace(/\-/gi,"_").toUpperCase();if(void 0!=this.vpaidParameters[s])switch(s){case"ISVIDEO":case"PLMD":case"MINDUR":case"MAXDUR":case"MINBR":case"MAXBR":case"VPD":case"VPTD":case"RS":case"ST":case"PLAYER_WIDTH":case"PLAYER_HEIGHT":case"PUBID":case"STS":case"MFP":case"ADTO":case"B2B":case"VMT":case"SORTORDERTYPE":case"TAGID":case"VIDLENGTH":case"DEFAULTTAGTIMEOUT":case"TOTALTIMEOUT":this.vpaidParameters[s]=isNaN(parseInt(r[1]))?0:parseInt(r[1]);break;case"MUTED":case"AFBP":case"DEBUG":case"PAUSE_ON_START":switch(r[1]){case"1":case"true":case"TRUE":this.vpaidParameters[s]=!0;break;case"0":case"false":case"FALSE":this.vpaidParameters[s]=!1}break;case"WP":case"SERVICE":case"PV":case"PT":case"SDID":break;default:this.vpaidParameters[s]=r[1]}else this.debugTracker.warn("dataFromUrl","Parameter '"+r[0]+"' is not supported!")}}return this.vpaidParameters}},{key:"_runEventFunction",value:function(e){this["on"+e.type]&&this["on"+e.type](e)}},{key:"_waterfallError",value:function(e){w||(w=!0)}},{key:"_waterfallSuccess",value:function(e,t){this.manager&&(this.config.waterfall=e,this.manager.fillSchedule(e,t))}},{key:"_onManagerStopped",value:function(){this.beacon.dispatchEvent(this.vpaidEvents.AdStopped)}},{key:"getTime",value:function(){var e=new Date;return e.getTime()}},{key:"initAd",value:function(e,t,i,n,r,s){this.config.inited||(this.config.target=this._getSlot(s.slot),this.config.target&&(this.config.videoSlotControls=this.store.get("ad_controls"),this.config.videoSlotCanAutoPlay=!0,this.config.width=parseInt(e),this.config.height=parseInt(t),this.config.bitrate=n,this.config.viewMode=i,this.config.creatives.PLAYER_WIDTH=this.config.width,this.config.creatives.PLAYER_HEIGHT=this.config.height,this.config.creativeData=this._getCreativeData(r),this.config.inited=!0,this.manager||(this.manager=new c.default(this,this.store)),this.manager.onStop=this._onManagerStopped.bind(this),this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,"")))}},{key:"subscribe",value:function(e,t){return this.beacon?void(this.vpaidEvents[t]&&this.beacon.addEventListener(t,e)):void this.debugTracker.error("subscribe"," Null ConvertVpaidMain::Beacon ")}},{key:"unsubscribe",value:function(e,t){if(this.vpaidEvents[t]){if(void 0==e)return;this.beacon.removeEventListener(t,e)}}},{key:"handshakeVersion",value:function(e){return this.VPAIDversion}},{key:"startAd",value:function(e){this.manager.playFromQueue(e),this.config.started=!0}},{key:"fire99",value:function(e,t){this.manager&&this.manager.fire99({waterfallTagId:e,dast:t})}},{key:"resizeAd",value:function(e,t,i){this.config.width=e,this.config.height=t,this.config.viewMode=i,this.manager&&this.manager.resizeAd(e,t,i)}},{key:"stopAd",value:function(){this.manager?this.manager.stop():this.beacon.dispatchEvent(this.vpaidEvents.AdStopped)}},{key:"setAdVolume",value:function(e){if(!this.store.get("isMobile"))return e=e>1?e/100:e,!isNaN(parseFloat(e))&&void(this.manager&&!this.store.get("isMobile")&&this.manager.setAdVolume(e))}},{key:"getAdVolume",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdVolume",[],0):0}},{key:"getAdLinear",value:function(){return!this.manager||this.manager.callWorkingVpaid("getAdLinear",[],!0)}},{key:"getAdWidth",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdWidth",[],this.config.width):this.config.width}},{key:"getAdHeight",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdHeight",[],this.config.height):this.config.height}},{key:"getAdExpanded",value:function(){return!this.manager||this.manager.callWorkingVpaid("getAdExpanded",[],!0)}},{key:"getAdSkippableState",value:function(){return!!this.manager&&this.manager.callWorkingVpaid("getAdSkippableState",[],!1)}},{key:"getAdSkippableRemainingTime",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdSkippableRemainingTime",[],-1):-1}},{key:"getAdRemainingTime",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdRemainingTime",[],-1):-1}},{key:"getAdDuration",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdDuration",[],-1):-1}},{key:"getAdCompanions",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdCompanions",[],[]):[]}},{key:"getAdIcons",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdIcons",[],[]):[]}},{key:"pauseAd",value:function(){this.manager&&this.manager.callWorkingVpaid("pauseAd",[],!0)}},{key:"resumeAd",value:function(){this.manager&&this.manager.callWorkingVpaid("resumeAd",[],!0)}},{key:"expandAd",value:function(){this.manager&&this.manager.callWorkingVpaid("expandAd",[],!0)}},{key:"collapseAd",value:function(){this.manager&&this.manager.callWorkingVpaid("collapseAd",[],!0)}},{key:"skipAd",value:function(){this.manager&&this.manager.callWorkingVpaid("skipAd",[],!0)}},{key:"getVpaidLogs",value:function(){if(this.manager)return this.manager.getVpaidLogs()}},{key:"getAd",value:function(e){if(this.manager)return this.manager.getAd(e)}},{key:"onAdLoaded",value:function(){}},{key:"onAdStarted",value:function(){}},{key:"onAdStopped",value:function(){}},{key:"onAdSkipped",value:function(){}},{key:"onAdSkippableStateChange",value:function(){}},{key:"onAdSizeChange",value:function(){}},{key:"onAdLinearChange",value:function(){}},{key:"onAdDurationChange",value:function(){}},{key:"onAdExpandedChange",value:function(){}},{key:"onAdVolumeChange",value:function(){}},{key:"onAdImpression",value:function(){}},{key:"onAdVideoStart",value:function(){}},{key:"onAdVideoFirstQuartile",value:function(){}},{key:"onAdVideoMidpoint",value:function(){}},{key:"onAdVideoThirdQuartile",value:function(){}},{key:"onAdVideoComplete",value:function(){}},{key:"onAdClickThru",value:function(){}},{key:"onAdInteraction",value:function(){}},{key:"onAdUserAcceptInvitation",value:function(){}},{key:"onAdUserMinimize",value:function(){}},{key:"onAdUserClose",value:function(){}},{key:"onAdPaused",value:function(){}},{key:"onAdPlaying",value:function(){}},{key:"onAdLog",value:function(){}},{key:"onAdError",value:function(){}},{key:"onVpaidSpecial",value:function(){}},{key:"onSonudViolation",value:function(){}},{key:"vpaidEvents",set:function(e){},get:function(){return g.default}},{key:"_defaultVpaidParameters",set:function(e){},get:function(){return{VIEW_MODE:"normal",REFERRER:"",VIDEO_URL:"",DOMAIN:"",PUBID:0,TAGID:0,VPD:0,VPTD:0,AUC_DAST:"",VIDLENGTH:0,KEY_WORDS:"",DESCRIPTION:"",SERVICE:"WhiteLabelBidRequestHandlerServlet",VERTICAL:"",SCHEMA:"vast2-vpaid",TYPE:"application/javascript",PV:this.version,RS:1,ST:1,WP:1,PT:5,CIRF:"",SDID:1,STS:0,CB:"",VOLUME:0,TAG:"",PAGE_URL:"",TIME_STAMP:"",TITLE:"",MFP:4,ISVIDEO:1,PLMD:2,MINDUR:1,MAXDUR:60,MINBR:1,MAXBR:512,AFBP:!1,ADTO:60,B2B:1,VMT:0,SORTORDERTYPE:0,DEFAULTTAGTIMEOUT:30,OID:"",NOAOP:"",TOTALTIMEOUT:60,CM_DOMAIN:"http://exchange.basebanner.com",OFFSET:0,MODE:"paralel",MUTED:!1,DEBUG:!1,PAUSE_ON_START:!1,PLAYER_WIDTH:0,PLAYER_HEIGHT:0}}},{key:"_defaultVpaidConfig",set:function(e){},get:function(){return{waterfall:{},source:this.src,videoSlotCanAutoPlay:!0,videoSlotControls:!1,vpaid_protect_path:!1,running:!1,inited:!1,stopped:!1,started:!1,target:!1,video:!1,bitrate:512,creatives:{},protectedCreatives:["WP","PV","PT","SDID","CM_DOMAIN","SERVICE"]}}}]),e}();t.default=k},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=null,s=function(){function e(t){if(i(this,e),!r){this.costModels={};var n=t.get("cpcvcmpgntps"),s=t.get("cstmdltps");for(var o in s){var a=s[o];this.costModels[a]={costModel:a,type:o,isCPCV:n.indexOf(a)>-1}}r=this}return r}return n(e,[{key:"isCPCV",value:function(e){return this.costModels.hasOwnProperty(e)&&this.costModels[e].isCPCV}}]),e}();t.default=s},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(6),l=i(1),u=n(l),c=function(e){function t(e,i,n){r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.creativeExtensions=e,o.target=i,o.vpaidLog=n,o.stopped=!1,o}return o(t,e),a(t,[{key:"handleExternalScripts",value:function(){if(!this.stopped)for(var e=0;e<this.creativeExtensions.length;e++){var t=this.creativeExtensions[e].attributes.type?this.creativeExtensions[e].attributes.type.toLowerCase():null;t&&(t=t.toLowerCase(),u.logToBI(this.vpaidLog,"creativeExtensions",{type:t,src:this.creativeExtensions[e].element}),"gdn"===t||"ias"===t?this._appendExternalScripts(this.creativeExtensions[e].element):"moat"===t&&this._pushExternalMoatTracker(this.creativeExtensions[e].element))}}},{key:"_appendExternalScripts",value:function(e){for(var t=(new DOMParser).parseFromString(e,"text/html"),i=t.getElementsByTagName("script"),n=0;n<i.length;n++)this.target.appendChild(this._generateScriptElement(i[n]))}},{key:"_generateScriptElement",value:function(e){for(var t=document.createElement("script"),i=0;i<e.attributes.length;i++)t.setAttribute(e.attributes[i].name,e.attributes[i].value);return t.innerHTML=e.innerHTML,t}},{key:"_pushExternalMoatTracker",value:function(e){this.emit("externalMoat",e)}},{key:"destroy",value:function(){this.stopped=!0,this.creativeExtensions=this.target=this.vpaidLog=void 0}}]),t}(d.EventEmitter);t.default=c},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.iframesWeights=t}return n(e,[{key:"detect",value:function(e,t){var i=this,n={};return e.map(function(e){var r=i._detectIframeTypeFromUrl(e,t);n[r]=n[r]||{urls:[],counter:0},n[r].urls.push(e),n[r].counter++}),n}},{key:"_detectIframeTypeFromUrl",value:function(e,t){return e.indexOf("imasdk")>-1?"ggl":t?"pxls":"gen"}},{key:"calculateWeightsByIframeType",value:function(e){var t=0;for(var i in e)t+=this.iframesWeights[i]*e[i].counter;return t}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),a=n(o),d=function(){function e(t,i,n){r(this,e),this.iframe=t,this.channel=void 0,this.sid=void 0,this.store=i,this.vpaidLog=n,this.protocol=this.store.get("httpsOverride")?"https:":window.location.protocol||"http:"}return s(e,[{key:"listenToMessages",value:function(){this.iframe.contentWindow.addEventListener("message",this.onmessage.bind(this))}},{key:"removeMessagesListener",value:function(){this.iframe.contentWindow.removeEventListener("message",this.onmessage.bind(this))}},{key:"onmessage",value:function(e){if(e){var t={};try{t=JSON.parse(e.data.replace("ima://",""))}catch(e){return}"viewabilityMeasurement"!==t.type&&(void 0!==t.channel&&void 0===this.channel&&(this.channel=t.channel),void 0!==t.sid&&"*"!==t.sid&&void 0===this.sid&&(this.sid=t.sid)),void 0!==this.channel&&void 0!==this.sid&&this.removeMessagesListener()}}},{key:"callApi",value:function(e,t){if(this.channel&&this.sid&&this.iframe){var i={name:"adsManager",type:e.replace("Ad",""),sid:this.sid,channel:this.channel};"volume"==e&&(i.data={volume:t});var n="\n                    var ifrms = document.querySelectorAll('iframe');\n\n                    ifrms.forEach(ifrm => {\n                        if (ifrm.src.indexOf('imasdk.googleapis.com') > -1 && ifrm.src.indexOf('bridge') > -1 && (ifrm.src.indexOf('#"+this.sid+"') > -1 || ifrm.src.indexOf('#"+this.channel+"') > -1)) {\n                            ifrm.contentWindow.postMessage('ima://"+a.stringify(i)+"', '"+this.protocol+"//imasdk.googleapis.com');\n                        }\n                    });\n                ";a.injectResource(this.iframe.contentWindow,n)}}}]),e}();t.default=d},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(6),l=i(1),u=n(l),c="hotspot",h=function(e){function t(e,i,n,o){r(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.store=o,a.hotSpotDefaultSettings=a.store.getByLineItem("htsptdflt")||{},a.from=e.fr,a.duration=e.dur,a.to=a.from+a.duration,a.text=e.hasOwnProperty("lbls")&&e.lbls.length>0?e.lbls:e.lbl||a.hotSpotDefaultSettings.lbl,a.positions=(e.pos||a.hotSpotDefaultSettings.pos).split("-"),a.pixel=e.pxl,a.textColor=e.txtclr||a.hotSpotDefaultSettings.txtclr,a.bgColor=e.bgclr,a.clickThruUrl=e.ctu,a.effectStyle=e.efct,a.margins=e.mrgn,a.target=i,a.vpaidLog=n,a.shown=!1,a.removed=!1,a.isPaused=!0,a.stopped=!1,a._createHotSpotPlacement(),a._setTextToHotSpot(),a._positionHotSpot(),a._appendClickEvent(),a.target.appendChild(a.hotSpotWrapper?a.hotSpotWrapper:a.hotSpot),a}return o(t,e),a(t,[{key:"_createHotSpotPlacement",value:function(){this.hotSpot=document.createElement("div"),this.hotSpot.className="interactive-video hide",this._setHotSpotBGColor(),this._setFontSize()}},{key:"_setHotSpotBGColor",value:function(){this.bgclr&&(this.hotSpot.style.backgroundColor=this.bgColor,this.hotSpot.style.border="1px solid "+this.bgColor)}},{key:"_setFontSize",value:function(){this.store.get("height")<150&&(this.hotSpot.style.fontSize="1.5vh")}},{key:"_setTextToHotSpot",value:function(){if("string"==typeof this.text)this.hotSpot.textContent=this.text,this.hotSpot.style.color=this.textColor;else for(var e=0;e<this.text.length;e++){var t=document.createElement("span");t.textContent=this.text[e].lbl+" ",t.style.color=this.text[e].txtclr||this.textColor,t.className="interactive-video-lbls",this.hotSpot.appendChild(t)}}},{key:"_positionHotSpot",value:function(){var e=this._isCenterHotSpot(),t=this.hotSpot;e&&(this._centerHotSpot(),t=this.hotSpotWrapper);for(var i=0;i<this.positions.length;i++)if("center"!==this.positions[i]){var n=this.margins&&void 0!==this.margins[this.positions[i]]?this.margins[this.positions[i]]:this.hotSpotDefaultSettings.mrgn;t.style[this.positions[i]]=n+"px"}}},{key:"_isCenterHotSpot",value:function(){return this.positions.indexOf("center")>-1}},{key:"_centerHotSpot",value:function(){this.hotSpotWrapper=document.createElement("div"),this.hotSpotWrapper.className="interactive-video-wrapper hide",this.hotSpot.className+=" center",this.hotSpotWrapper.appendChild(this.hotSpot)}},{key:"_appendClickEvent",value:function(){var e=this;this.hotSpot.onclick=function(){e.pixel&&((new Image).src=e.pixel),e.emit("clicked",{url:e.clickThruUrl,playerHandles:!0,type:c})}}},{key:"onTimeupdate",value:function(e){e>=this.to?this._hideAndRemove():e>=this.from&&this._show()}},{key:"_show",value:function(){this.shown||(u.logToBI(this.vpaidLog,c,{from:this.from,to:this.to,show:!0},!1,!1),this.shown=!0,this._showElement(this.hotSpot),this._showElement(this.hotSpotWrapper),this.effectStyle&&this._addEffect())}},{key:"_showElement",value:function(e){e&&(e.className=e.className.replace("hide","show"))}},{key:"_addEffect",value:function(){"underline"===this.effectStyle&&this._addUnderlineEffect()}},{key:"_addUnderlineEffect",value:function(){this.effectElement=document.createElement("div"),this.effectElement.className="interactive-video-effect",this.effectElement.style.width="100%",this._isCenterHotSpot()&&this._addUnderlineEffectWrapper(),this._createUnderlineRemoveEffect(),this.hotSpot.appendChild(this.effectElementWrapper?this.effectElementWrapper:this.effectElement)}},{key:"_addUnderlineEffectWrapper",value:function(){var e=this.hotSpot.getClientRects()[0],t=this.target.getClientRects()[0];this.effectElementWrapper=document.createElement("div"),this.effectElementWrapper.className="interactive-video-effect-wrapper",this.effectElementWrapper.style.width=e.width+"px",this.effectElementWrapper.style.marginLeft=e.left-t.left+"px",this.effectElementWrapper.appendChild(this.effectElement)}},{key:"_createUnderlineRemoveEffect",value:function(){if(!this.stopped){if(this.isPaused)return void setTimeout(this._createUnderlineRemoveEffect.bind(this),10*this.duration);var e=parseInt(this.effectElement.style.width);0!==e&&(this.effectElement.style.width=e-1+"%",setTimeout(this._createUnderlineRemoveEffect.bind(this),10*this.duration))}}},{key:"_hideAndRemove",value:function(){this.removed||(u.logToBI(this.vpaidLog,c,{from:this.from,to:this.to,hide:!0},!1,!1),this.removed=!0,this._hideElement(this.hotSpot),this._hideElement(this.hotSpotWrapper),setTimeout(this.destroy.bind(this),500))}},{key:"_hideElement",value:function(e){e&&(e.className=e.className.replace("show","hide"))}},{key:"setIsPaused",value:function(e){this.isPaused=e}},{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this.effectInterval=clearInterval(this.effectInterval),this._removeElement(this.hotSpot),this._removeElement(this.hotSpotWrapper),this._removeElement(this.effectElement),this._removeElement(this.effectElementWrapper),this.text=this.positions=this.target=this.vpaidLog=this.store=void 0,this.emit("removed"))}},{key:"_removeElement",value:function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}}]),t}(d.EventEmitter);t.default={obj:h,type:c}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(69),u=r(l),c=i(6),h=i(1),p=n(h),f=function(e){function t(e,i,n,r){s(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.interactiveAds=[],a.target=i,a.vpaidLog=n,a.store=r,a.stopped=!1,a._createInteractiveAds(e),p.logToBI(a.vpaidLog,"interactiveAds",{obj:p.stringify(e)},!1,!1),a}return a(t,e),d(t,[{key:"_createInteractiveAds",value:function(e){for(var t=0;t<e.length;t++)if(e[t].t===u.default.type){var i=new u.default.obj(e[t],this.target,this.vpaidLog,this.store);this._handleComponentEvents(i),this.interactiveAds.push(i)}}},{key:"_handleComponentEvents",value:function(e){var t=this;e.on("clicked",function(e){t.emit("interactiveAdClicked",e)}),e.on("removed",function(){var i=t.interactiveAds.indexOf(e);i>-1&&t.interactiveAds.splice(i,1)})}},{key:"onTimeupdate",value:function(e){if(!this.stopped)for(var t=0;t<this.interactiveAds.length;t++)this.interactiveAds[t].onTimeupdate(e)}},{key:"setIsPaused",value:function(e){if(!this.stopped)for(var t=0;t<this.interactiveAds.length;t++)this.interactiveAds[t].setIsPaused(e)}},{key:"destroy",value:function(){if(!this.stopped){this.stopped=!0;for(var e=0;e<this.interactiveAds.length;e++)this.interactiveAds[e].destroy(),this.interactiveAds[e]=void 0;this.interactiveAds=this.target=this.vpaidLog=this.store=void 0}}}]),t}(c.EventEmitter);t.default=f},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.baseUrl=t}return n(e,[{key:"load",value:function(e,t,i){e&&e.length&&window.cmTag&&(this._setWindowLoaderObject(),this._registerOnLoaderResponse(t),this._loadScript(e,t,i))}},{key:"_setWindowLoaderObject",value:function(){window.cmTag.cmLoader||(window.cmTag.cmLoader={addLoaderCb:function(e,t){window.cmTag.cmLoader[e]=window.cmTag.cmLoader[e]||{callbacks:[]},window.cmTag.cmLoader[e].callbacks.push(t)}})}},{key:"_registerOnLoaderResponse",value:function(e){window[e]||(window[e]=function(t){window.cmTag.cmLoader[e].callbacks.map(function(e){try{e(t)}catch(e){}})})}},{key:"_loadScript",value:function(e,t,i){window.cmTag.cmLoader.addLoaderCb(t,i);var n=document.createElement("script");n.src=this.baseUrl+e,document.body.appendChild(n)}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(5),d=r(a),l=i(90),u=r(l),c=i(11),h=r(c),p=i(36),f=r(p),v=i(1),m=n(v),g=i(79),y=r(g),_=i(18),b=n(_),w=i(65),k=r(w),A=i(78),T=r(A);f.default.config({cancellation:!0});var C=function(){function e(t,i){var n=this;s(this,e),this.mainVpaid=t,this.store=i,this.time=(new Date).getTime(),this.sequenceId=((new Date).getTime()+"").substring(3,11),this.loops=0,this.stopped=!1,this.started=!1,this.schedule=[],this.timedTimeout=0,this.waterfall={},this.adSlots=1,this.filledSlots=0,this.adIsPlaying=!1,this.debugTracker=new d.default("Manager"),this.supportNonVideoVpaid=this.store.get("sprtnnvidvpd")&&this.store.get("mltads"),this.droppableTypes=this.store.get("drpbletps")||[],this.shouldFireGetAdPixels=m.shouldFirePixels(this.store.get("frgtadpxls")),this.oppsID=h.default,this.queueSize=this.store.get("queue_size")||10,this.isVforce=i.get("vForce"),this.store.on("stop",this.stop.bind(this)),this.store.on("emitQueueStatus",this._emitQueueStatus.bind(this,"queueStatus")),this.queueStatus=new y.default(this.store),this.supportNonVideoVpaid&&(this.nonVideoItem=null,this.store.on("nonVideoItemInWaterfall",this._onNonVideoItemInWaterfall.bind(this))),this.store.get("debug")&&setInterval(function(){n._postMessageSchedule()},1e3),this.dontTrimMp4=this.store.get("novdtrm"),this.maxBackfillDelayItems=this.store.get("mxbckflldlyitms"),this.maxBackfillDelayItems&&(this.backfilldelayTime=this.store.get("bckflldlyms"),this.backfillPriority=this.store.get("bfprty")),this.continueGetAdFlow=this.store.get("cntgtad")}return o(e,[{key:"_postMessageSchedule",value:function(){if(window.cmPlayerDeubg){var e=this.schedule,t=this.store;try{window.cmPlayerDeubg({schedule:e,store:t})}catch(e){console.log(e)}}}},{key:"trigger",value:function(e,t,i){if(this._handleAllEvents({type:e,dispatcher:t}),this.store.emit(e,t),t.working||e===this.mainVpaid.vpaidEvents.AdImpression){var n={type:e,dispatcher:t};e===this.mainVpaid.vpaidEvents.AdImpression&&(n.tag=t.tag),n.vpaidReady=this.getVpaidReadyCount(),n.qsize=this.schedule.length,n.dp=t&&t.tag?t.tag.dp:"na",n.adImpMS=t?t.adImpInMS:0,n.readyInMS=t?t.readyInMS:0,n.loadToImpMS=t?t.adImpInMS-t.readyInMS:0,n.clickThru={url:i?i.url:"",playerHandles:i&&i.playerHandles!==!1},this.mainVpaid.trigger(e,n)}}},{key:"getVpaidReadyCount",value:function(){var e=0;return this.schedule.map(function(t){t&&t.vpaidWrapper&&"ready"===t.vpaidWrapper.status&&e++}),e}},{key:"subscribeToVpaid",value:function(e){this.stopped||e.subscribe(this._handleError.bind(this),this.mainVpaid.vpaidEvents.AdError)}},{key:"_handleAllEvents",value:function(e){var t=this;e.type!==this.mainVpaid.vpaidEvents.AdVideoStart&&e.type!==this.mainVpaid.vpaidEvents.AdImpression&&e.type!==this.mainVpaid.vpaidEvents.AdPlaying||!e.dispatcher.isPlaying||this.trigger("viewAdPlayer",e.dispatcher.tag),e.type===this.mainVpaid.vpaidEvents.AdLoaded&&this.shouldPlayWhenAvialable&&!this.store.get("evtbsschdl")&&(setTimeout(function(){t.playFromQueue(t.shouldPlayWhenAvialable)},2),e.dispatcher?e.dispatcher.tag:{},this.shouldPlayWhenAvialable=!1),e.type===this.mainVpaid.vpaidEvents.AdImpression&&(e.dispatcher.options&&e.dispatcher.options.getAdContext?(e.dispatcher.gotAd=!0,this.debugTracker.info("gotAd",e.dispatcher,{color:"#5EB9FF"}),m.logToBI(e.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:!1}),e.dispatcher.options.getAdContext.getAdCallback(e.dispatcher)):e.dispatcher&&e.dispatcher.vpaidLog&&m.logToBI(e.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:!0}))}},{key:"_runNextAd",value:function(){}},{key:"_handleError",value:function(e){var t=e.dispatcher;this.adIsPlaying&&t.isStarted&&!t.hadImpression&&!this.store.get("evtbsschdl")&&this.playFromQueue()}},{key:"initVpaidInQue",value:function(e){if(!this.stopped)for(var t=this.schedule,i={},n="",r=0;r<t.length;r++)i=t[r],n=r+"-"+i.waterfallTagId,i.vpaidWrapper||(this.maxBackfillDelayItems&&i.priority===this.backfillPriority?i.backfillDelay=setTimeout(this._createVpaidWrapper.bind(this,i,n,e),this.backfilldelayTime):this._createVpaidWrapper(i,n,e))}},{key:"_createVpaidWrapper",value:function(e,t,i){e.backfillDelay&&(e.backfillDelay=window.clearTimeout(e.backfillDelay),e.isBackfillDelayed=!0),e.sequenceId=e.wfIndex,this._updateCostModel(e);var n=this._createQueueItem(e,t,i),r=this;e.vpaidWrapper=n.vpaidWrapper,e.vpaidWrapper.on("vpaidCleaned",function(){r.cleanQueue(r.queueSize),r.continueGetAdFlow&&this.options&&this.adStarted&&!this.hadImpression&&r.getAdFromQueue(this.options),r.queueStatus.onScheduleChange(r.schedule,r.supportNonVideoVpaid&&null!==r.nonVideoItem)}),this.subscribeToVpaid(e.vpaidWrapper)}},{key:"_updateCostModel",value:function(e){var t=new k.default(this.store),i=e.getValueByKey("cstmdl");void 0===i&&(i=e.cstmdl),e.cstmdl=i,e.isCPCV=t.isCPCV(e.cstmdl)}},{key:"_createQueueItem",value:function(e,t,i){var n={tag:e,tagId:t,manager:this,store:this.store,mainVpaid:this.mainVpaid,wflog:i},r=new T.default(n);return r}},{key:"unsubscribeFromVpaid",value:function(e){this.stopped||(e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdError),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdFound),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdStopped),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSkipped),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdImpression),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSkippableStateChange),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSizeChange),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdLinearChange),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdDurationChange),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdExpandedChange),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVolumeChange),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoStart),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoFirstQuartile),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoMidpoint),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoThirdQuartile),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoComplete),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdClickThru),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdInteraction),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserAcceptInvitation),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserMinimize),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserClose),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdPaused),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdPlaying),e.unsubscribe(null,this.mainVpaid.vpaidEvents.AdLog))}},{key:"_shouldDropAd",value:function(e,t){return this.droppableTypes.indexOf(e)>-1&&t.hasOwnProperty(e)&&t[e]}},{key:"cleanQueue",value:function(e,t){var i=this;if(this.schedule.map(function(e,n){if(e&&e.vpaidWrapper&&!e.vpaidWrapper.working){var r=!1,s=null;if("error"===e.vpaidWrapper.status||"stopped"===e.vpaidWrapper.status){r=!0;var o="error"===e.vpaidWrapper.status;s=o?i.oppsID.vastError:i.oppsID.adError}else t&&i._shouldDropAd(t,e)&&!e.vpaidWrapper.hadImpression&&(r=!0,s=i.oppsID.adDropped);r&&(i.queueStatus.onItemRemovedFromQueue(e),e.vpaidWrapper._status=e.vpaidWrapper.status,i.unsubscribeFromVpaid(i.schedule[n].vpaidWrapper),i.schedule[n].vpaidWrapper.stop("cleanExpierd",s),i.schedule[n]&&(i.schedule[n].vpaidWrapper=null),i.schedule[n]=void 0)}}),this.schedule=this.schedule.filter(function(e){return e}),this.schedule=u.default.sort(this.schedule,this.store),this.schedule.length>e){var n=(this.mainVpaid.config.creatives,this.mainVpaid.config.creatives.ADTO||6e4),r=this.store.get("trmrdyvpaid");this.schedule.map(function(t,s){if(i.schedule[s]&&!t.vpaidWrapper.working&&(r||"ready"!==t.vpaidWrapper.status)){var o=Date.now()-i.schedule[s].vpaidWrapper.created;if(t&&(s<i.schedule.length-e||o>n)){i.queueStatus.onItemRemovedFromQueue(t),i.unsubscribeFromVpaid(i.schedule[s].vpaidWrapper);var a=o>n?"queueExpired":"queueTrimmed";if(!i._canTrim(a,t))return;i.schedule[s].vpaidWrapper.stop(a,i.oppsID[a]),i.schedule[s]=void 0}}})}this.schedule=this.schedule.filter(function(e){return e})}},{key:"_canTrim",value:function(e,t){return"queueTrimmed"!==e||!(t.vpaidWrapper&&"mp4"===t.vpaidWrapper.type&&this.dontTrimMp4)}},{key:"fillSchedule",value:function(e,t){this.schedule.length>this.queueSize&&this.cleanQueue(this.queueSize),this.started=!0,this.stopped=!1;var i={},n=0,r=this.mainVpaid.config.creatives;r.ADTO=parseInt(r.ADTO)>1?parseInt(r.ADTO):60,r.ADTO=r.ADTO<1e3?1e3*r.ADTO:r.ADTO,this.adSlots=parseInt(r.B2B)&&parseInt(r.B2B)>1?parseInt(r.B2B):1;var s=0,o=r.DEFAULTTAGTIMEOUT<1e3?1e3*r.DEFAULTTAGTIMEOUT:r.DEFAULTTAGTIMEOUT;for(n=0;n<e.tags.length;n++)this._shouldInsertToQueue(e.tags[n])?(i=e.tags[n],i.active=!1,i.adFound=!1,i.offset=s,i.tagStart=s,i.tagTimeout=o,i.queueNumber=0,i.ADTO=r.ADTO,i.vpaidWrapper=!1,i.tagEnd=1*i.tagStart+1*i.tagTimeout,i.wfStats=e.data,this.store.get("frstlk")&&this._updateItemFirstLook(i),this.schedule.push(i)):t.push("tagResponse_"+n+"_backfillThrown",!0);this._printQueue(this.schedule),this.mainVpaid.setVpaidId(i),this.time=(new Date).getTime(),this.initVpaidInQue(t),this.store.set("queueLength",this.schedule.length),this.store.set("vpaidReadyCount",this.getVpaidReadyCount()),this.queueStatus.onScheduleChange(this.schedule,this.supportNonVideoVpaid&&null!==this.nonVideoItem)}},{key:"_shouldInsertToQueue",value:function(e){return!this.maxBackfillDelayItems||e.priority!==this.backfillPriority||e.priority===this.backfillPriority&&this._getBackfillCount()<this.maxBackfillDelayItems}},{key:"_printQueue",value:function(e){var t=e.map(function(e){return{dp:e.dp,lineItem:e.lineItem,alfrox:e.alfrox,waterfallIndex:e.wfIndex,status:e.vpaidWrapper?e.vpaidWrapper.status:"",videoUrl:e.vpaidWrapper&&e.vpaidWrapper.hadImpression?e.vpaidWrapper.getVideoUrl():""}});this.debugTracker.table(t)}},{key:"_updateItemFirstLook",value:function(e){e.flad&&(this.store.get("first_look_ad_loaded")?(e.flad_delay=e.flad,delete e.flad):this._startFladTimeout(e.flad))}},{key:"_startFladTimeout",value:function(e){this.store.set("first_look_ad_loaded",e),this.fladTimeout=setTimeout(this._onFladTimeout.bind(this),1e3*e)}},{key:"_onFladTimeout",value:function(){for(var e=null,t=0;t<this.schedule.length;t++)if(e=this.schedule[t],e.flad_delay)return e.flad=e.flad_delay,delete e.flad_delay,void this._startFladTimeout(e.flad);this.store.set("first_look_ad_loaded",!1),this.store.emit("fladInactive")}},{key:"stop",value:function(){if(!this.stopped){this.stopped=!0,window.clearTimeout(this.timedTimeout);for(var e=0;e<this.schedule.length;e++)this.schedule[e].backfillDelay?window.clearTimeout(this.schedule[e].backfillDelay):this.schedule[e].vpaidWrapper.stop("playerClosed",this.oppsID.playerClosed);this.nonVideoItem=null}}},{key:"managerEnd",value:function(){}},{key:"playFromQueue",value:function(e){if(!this.store.get("isIdleMode")&&!this.stopped){var t=Date.now();this.store.set("playFromQueue",t);var i=this.getVpaidReadyCount();(0===i||e)&&(this.store.get("vForce")||(this.shouldPlayWhenAvialable=!0)),this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=u.default.sort(this.schedule,this.store));var n=this.mainVpaid.config.creatives.ADTO||6e4;n+=1e4;for(var r=!1,s=this._getItemScores(),o=(this._getItemDps(),this.schedule.length-1);o>=0;o--){var a=this.schedule[o];a&&(this._setItemScores(a,o,s),"ready"!==a.vpaidWrapper.status||a.vpaidWrapper.working||a.vpaidWrapper.isStarted||r||this.store.get("first_look_ad_loaded")&&!a.flad||(this.store.set("playFromQueueFound",t),a.vpaidWrapper.workingVpaid=!0,this.store.set("ad_controls",a.getValueByKey("ad_controls")!==!1),a.vpaidWrapper.working=!0,a.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,r=!0,a.vpaidWrapper.startAd(),m.logToBI(a.vpaidWrapper.vpaidLog,"startFromQ",{score:a.score})))}var d=this.store.get("run_wf_when_empty");d&&0===i&&this.store.emit("playFromEmptyQueue")}}},{key:"bringVpaidToFront",value:function(){for(var e=this.schedule.length-1;e>=0;e--){var t=this.schedule[e];if(t&&t.vpaidWrapper.workingVpaid){t.vpaidWrapper.bringToFront();break}}}},{key:"_getItemScores",value:function(){for(var e=[],t=this.schedule.length-1;t>=0;t--){var i=this.schedule[t];i&&e.push(i.score)}return e}},{key:"_getItemDps",value:function(){for(var e=[],t=this.schedule.length-1;t>=0;t--){var i=this.schedule[t];i&&e.push(i.dp)}return e}},{key:"_setItemScores",value:function(e,t,i){e.vpaidWrapper&&e.vpaidWrapper.vpaidLog&&e.vpaidWrapper.vpaidLog.data&&(e.vpaidWrapper.vpaidLog.data.itemScore=e.score,i&&m.logToBI(e.vpaidWrapper.vpaidLog,"itemScores",{index:t,scores:i},!1,!1))}},{key:"resizeAd",value:function(e,t,i){if(!this.stopped){this.mainVpaid.config.creatives.PLAYER_WIDTH=this.mainVpaid.config.width=parseInt(e),this.mainVpaid.config.creatives.PLAYER_HEIGHT=this.mainVpaid.config.height=parseInt(t),this.mainVpaid.config.creatives.VIEW_MODE=this.mainVpaid.config.viewMode=i;for(var n=0;n<this.schedule.length;n++)this.schedule[n].vpaidWrapper&&!this.schedule[n].vpaidWrapper.stopped&&this.schedule[n].vpaidWrapper.callVpaidMethod("resizeAd",[e,t,i],0)}}},{key:"setAdVolume",value:function(e,t){if(!this.stopped){if(e=e>1?e/100:e,isNaN(parseFloat(e)))return!1;e=parseFloat(e),t||(this.mainVpaid.config.creatives.VOLUME=e),this.mainVpaid.config.creatives.MUTED=0==e;for(var i=0;i<this.schedule.length;i++)this.schedule[i].vpaidWrapper&&!this.schedule[i].vpaidWrapper.stopped&&this.schedule[i].vpaidWrapper.workingVpaid&&this.schedule[i].vpaidWrapper.setAdVolume(e)}}},{key:"callWorkingVpaid",value:function(e,t,i){if(!this.stopped)for(var n=0;n<this.schedule.length;n++){var r=this.schedule[n].vpaidWrapper;if(r&&r.workingVpaid)return r.callVpaidMethod(e,t,i)}}},{key:"getVpaidLogs",value:function(){for(var e=[],t=0;t<this.schedule.length;t++){var i=this.schedule[t];i&&i.vpaidWrapper&&i.vpaidWrapper.vpaidLog&&e.push(i.vpaidWrapper.vpaidLog)}return e}},{key:"getAd",value:function(e){this.store.incr("getAdData.count");var t=this;return this.debugTracker.info("getAd",e?e:"empty getAd",{color:"#5EB9FF"}),this.shouldFireGetAdPixels&&m.sendPixel(m.createPixelParams(b.getAd,this.store)),new f.default(function(i,n,r){e=e||{};var s={getAdCallback:i};e.getAdContext=s,e.getAdRetries=0,e.getAdContext.getAdTimeout=setTimeout(function(){e.getAdContext=void 0,n({name:"error",message:"couldn't find a suitable ad to play"})},1e3*(e.getAdTimeout||t.store.get("get_ad_timeout_seconds"))),t.getAdFromQueue(e),r(function(){t.cancelGetAd(e),this.debugTracker.info("getAd","getAd cancelled!",{color:"#5EB9FF"})}.bind(t))})}},{key:"cancelGetAd",value:function(e){this.store.decr("getAdData.count"),clearTimeout(e.getAdContext.getAdTimeout),e.getAdContext=void 0}},{key:"getAdFromQueue",value:function(e){if(!this.store.get("isIdleMode")&&!this.stopped&&(e=e||{},e&&e.getAdContext&&(!e.requiredViewability||!document.hidden))){this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=u.default.sort(this.schedule,this.store));for(var t=!1,i=this._getItemScores(),n=this.schedule.length-1;n>=0;n--){var r=this.schedule[n];if(this._updateStatusesOnGetAd(r,e),this._setItemScores(r,n,i),this.isViewabilityMatch(r,e)&&this.isAdPropertiesMatch(r,e.adProperties,e.excAdProperties)&&this._canPullItem(r)){this._pullItemFromQueue(r,e),t=!0;break}}var s=this.store.get("run_wf_when_empty");if(s&&0==this.getVpaidReadyCount()&&this.store.emit("playFromEmptyQueue"),!t){if(this._canPullAdxCard(e))return void this._pullAdxCard(e);this.nextAdFromQueue=setTimeout(this.getAdFromQueue.bind(this,e),1e3)}}}},{key:"_canPullItem",value:function(e){return"ready"===e.vpaidWrapper.status&&!e.vpaidWrapper.working&&!e.vpaidWrapper.isStarted&&(!this.store.get("first_look_ad_loaded")||e.flad)}},{key:"_pullAdxCard",value:function(e){this.nonVideoItem.adx=!0,this._pullItemFromQueue(this.nonVideoItem,e)}},{key:"_canPullAdxCard",value:function(e){return e.requiredViewability&&this.nonVideoItem&&this.nonVideoItem.vpaidWrapper&&this._canPullItem(this.nonVideoItem)}},{key:"_pullItemFromQueue",value:function(e,t){e.vpaidWrapper.working=!0,e.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,e.vpaidWrapper.bringToFront(),"mp4"===e.vpaidWrapper.type&&e.vpaidWrapper.vpaidHandler.logVideoBuffer("StartFromQ"),e.vpaidWrapper.startAd(t),m.logToBI(e.vpaidWrapper.vpaidLog,"startFromQ",{score:e.score,adx:e.adx}),clearTimeout(t.getAdContext.getAdTimeout),t.getAdContext.getAdTimeout=void 0,t.getAdRetries++}},{key:"_updateStatusesOnGetAd",value:function(e,t){e.vpaidWrapper&&e.vpaidWrapper.vpaidLog&&!e.vpaidWrapper.gotAd&&e.vpaidWrapper.updateStatusesOnGetAd(t);
}},{key:"isViewabilityMatch",value:function(e,t){return!(!e||!e.vpaidWrapper)&&("undefined"==typeof t.requiredViewability||(t.requiredViewability?e.requiredViewability:!e.requiredViewability))}},{key:"isAdPropertiesMatch",value:function(e,t,i){return this._isAdPropertiesMatch(t,e,!0)&&this._isAdPropertiesMatch(i,e,!1)}},{key:"_isAdPropertiesMatch",value:function(e,t,i){if(e)for(var n in e){var r=this._isPropertyMatch(n,e[n],t);if(r&&!i||!r&&i)return!1}return!0}},{key:"_isPropertyMatch",value:function(e,t,i){for(var n=0;n<t.length;n++)if(i[e]==t[n])return!0;return!1}},{key:"onStop",value:function(){}},{key:"isActivePausedAd",value:function(){for(var e=0;e<this.schedule.length;e++){var t=this.schedule[e];if(t&&t.vpaidWrapper&&t.vpaidWrapper.isPlaying&&!t.vpaidWrapper.isUnPaused)return!0}return!1}},{key:"isWorkingVpaidItem",value:function(e){var t=!1;return this.schedule.map(function(i){i&&i.vpaidWrapper&&i.vpaidWrapper==e&&i.vpaidWrapper.working&&(t=!0)}),t}},{key:"_saveCountersToStore",value:function(e,t,i){!t&&this.store&&i&&this.store.set(e,i)}},{key:"callAllWorkingVpaids",value:function(e){return this.schedule.map(function(t){if(t.vpaidWrapper&&!t.vpaidWrapper.stopped&&t.vpaidWrapper.workingVpaid)return e(t.vpaidWrapper)})}},{key:"mute",value:function(){this.callAllWorkingVpaids(function(e){return e.mute()})}},{key:"unmute",value:function(){this.callAllWorkingVpaids(function(e){return e.unmute()})}},{key:"play",value:function(){this.callAllWorkingVpaids(function(e){return e.resumeAd()})}},{key:"pause",value:function(){this.callAllWorkingVpaids(function(e){return e.pauseAd()})}},{key:"getCurrentWorkingVpaidVolume",value:function(){var e=null;return this.callAllWorkingVpaids(function(t){null===e&&(e=t.getCurrentVolume())}),e||0}},{key:"_emitQueueStatus",value:function(e){this.queueStatus.onScheduleChange(this.schedule,this.supportNonVideoVpaid&&null!==this.nonVideoItem,e)}},{key:"_getBackfillCount",value:function(){var e=this,t=0;return this.schedule.map(function(i){i&&i.priority===e.backfillPriority&&t++}),t}},{key:"_onNonVideoItemInWaterfall",value:function(e){this.stopped||this.nonVideoItem||(this.nonVideoItem=e.item,this.nonVideoItemWflog=e.wflog,this._createVpaidWrapper(this.nonVideoItem,"adx-"+this.nonVideoItem.waterfallTagId,this.nonVideoItemWflog))}},{key:"getPlayerDAST",value:function(){for(var e=this.callAllWorkingVpaids(function(e){return e.playerDAST.get()}),t=0;t<e.length;t++)if(e[t])return e[t];return""}}]),e}();t.default=C},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,i,n,r){var s=document.createElement("script"),o=[];t={adData:{ids:t,duration:i,url:r},dispatchEvent:function(e){this.sendEvent?(o&&(o.push(e),e=o,o=!1),this.sendEvent(e)):o.push(e)}},i="_moatApi"+Math.floor(1e8*Math.random());var a,d;try{a=e.ownerDocument,d=a.defaultView||a.parentWindow}catch(e){a=document,d=window}return d[i]=t,s.type="text/javascript",e&&e.insertBefore(s,e.childNodes[0]||null),s.src="https://z.moatads.com/"+n+"/moatvideo.js#"+i,t}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(1),l=r(d),u=i(12),c=n(u),h=function(){function e(t){s(this,e),this.options=t,this.moatAbTest=this.options.tag.getValueByKey("mttst"),this.moatAbTest&&(this.moatAbTest+="_"),this.moatAbTest=""+this.moatAbTest+(this.options.store.get("unit_type")||"")+(this.options.store.get("isMobile")?"_Mobile":""),this.addCustomData=this.options.tag.getValueByKey("sndmoatcstmmatdta");var i=this._createLevels(),n=this.options.moatTag?new Function(this.options.moatTag):o;this.moatApiReference=n(this.options.container||document.body,i,this.options.duration||0,this.options.moatPartnerCode,this.options.url),l.logToBI(this.options.vpaidLog,"moatTracker",{}),this.events=[c.default.AdLoaded,"startAd",c.default.AdStarted,c.default.AdImpression,c.default.AdVideoStart,c.default.AdClickThru,c.default.AdStopped,c.default.AdPlaying,c.default.AdPaused,c.default.AdVideoFirstQuartile,c.default.AdVideoMidpoint,c.default.AdVideoThirdQuartile,c.default.AdVideoComplete],this.stopped=!1}return a(e,[{key:"_createLevels",value:function(){if(this.options.moatTag)return{};if(!this.options.tag)return{level1:"",level2:"",level3:"",level4:"",slicer1:"",slicer2:""};var e={level1:this.moatAbTest,level2:this.options.tag.advId,level3:this.options.tag.lineItemId,level4:this.options.store.get("domain")||"",slicer1:this.options.url,slicer2:this.options.tag.tagId};if(this.addCustomData.aucDast&&(e.zMoataucdast=this.options.store.get("auc_dast")),this.addCustomData.vidDast&&(e.zMoatdast=this.options.tag.vidDast),this.addCustomData.abTest&&(e.zMoatabt=this.options.store.get("ab_test")),this.addCustomData.impressionId){var t=this.options.store.get("dast");t.hasOwnProperty("cisid")&&(e.zMoatimprid=t.cisid)}return this.addCustomData.pdast&&(e.zMoatpdast=this.options.playerDast),e}},{key:"dispatch",value:function(e){this.stopped||this.events.indexOf(e.type)>-1&&this.moatApiReference.dispatchEvent(e)}},{key:"dispose",value:function(){this.stopped=!0,this.moatApiReference=this.events=this.options=void 0}}]),e}();t.default=h},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(5),d=r(a),l=i(1),u=n(l),c=i(10),h=r(c),p=function(){function e(t,i){s(this,e),this.store=t,this.debugTracker=new d.default("OpportunityAggregator"),this.opps=[];var n=this.store.get("opps_base_path")||i.CM_DOMAIN;this.url=u.setUrlPrefix(n)+(/.*\/$/g.test(n)?"":"/")+"OpportunityServlet",this.postHeaders=this.store.get("psthdrs")||"application/json",this.onFail=this._onFail.bind(this),this.onSuccess=this._onSuccess.bind(this);var r=this._sendTicker.bind(this);setInterval(r,this.store.get("timbtopps")),this.store.on("sendOpps",r),this.store.on("beforeunload",r)}return o(e,[{key:"send",value:function(e){this.opps.push(e)}},{key:"_sendTicker",value:function(){this.opps.length>0&&(0,h.default)(this.url,u.stringify(this.opps),this.onSuccess,this.onFail,void 0,!1,!1,5e3,this.postHeaders,!1),this.opps=[]}},{key:"_onSuccess",value:function(e){}},{key:"_onFail",value:function(e){this.debugTracker.warn("Error Firing Opps",e)}}]),e}();t.default=p},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(5),d=(r(a),i(32)),l=n(d),u=i(88),c=n(u),h=i(1),p=n(h),f=i(12),v=r(f),m=function(){function e(t){s(this,e),this.trackingPixels=Object.assign({},l),this.pixelDataLoaded=!1,this.events=[],this.done=[],this.store=t,this.vpaidEvents=v.default,this.state="",this.clickThruUrl="",this._isPaused=!1,this.buildPixelsRestrictions(),this._isPaused=!1,this.replacePixelMacros=this.store.get("rplcpxlmcrplchldr"),this.fireMultiplePixels=this.store.get("frmltplpxls")||[]}return o(e,[{key:"getState",value:function(){return this.state}},{key:"buildPixelsRestrictions",value:function(){this.pixelsRestrictions={},this.pixelsRestrictions.baseState=this.vpaidEvents.AdVideoThirdQuartile,this.pixelsRestrictions[this.vpaidEvents.AdVideoComplete]=this.vpaidEvents.AdVideoThirdQuartile}},{key:"loadPixelData",value:function(e){this.pixelDataLoaded,this.pixelDataLoaded=!0,this.trackingPixels=e}},{key:"getClickThruUrl",value:function(){if(!this.clickThruUrl)for(var e=["adclickthrough","clickthrough","adclickthru","clickthru"],t=0;t<e.length;t++){var i=e[t];if(this.trackingPixels.hasOwnProperty(i)&&this.trackingPixels[i].length>0){this.clickThruUrl=this.trackingPixels[i][0].pixel;break}}return this.clickThruUrl}},{key:"firePixel",value:function(e,t,i){if(this._isPaused)return!1;if(!this.isValid(e,i))return!1;for(var n=this.getPixels(e,i),r=0;r<n.length;r++)this._sendPixel(n[r].pixel,n[r].method,e,t,i);return this.events.push(e),""===this.state&&e===this.pixelsRestrictions.baseState&&(this.state=this.pixelsRestrictions.baseState),!0}},{key:"_cleanPixelType",value:function(e){return e.toLowerCase().replace(/^advideo|^aduser|^ad/gi,"")}},{key:"_getAllLinkedPixelTypes",value:function(e){e=this._cleanPixelType(e);var t=[];return"clickthrough"===e||"clickthru"===e?t.push("adclicktracking","clicktracking"):("start"===e&&t.push("creativeview"),p.endsWith(e,"ed")&&this._pushLinkedPixelTypesEdEnding(e,t),this._pushLinkedPixelTypes(e,t)),t}},{key:"_pushLinkedPixelTypes",value:function(e,t){t.push(e,"aduser"+e,"advideo"+e,"ad"+e)}},{key:"_pushLinkedPixelTypesEdEnding",value:function(e,t){for(var i=e.charAt(e.length-3)===e.charAt(e.length-4)?3:2,n=0;n<i;n++)e=e.slice(0,-1),this._pushLinkedPixelTypes(e,t)}},{key:"getPixels",value:function(e,t){var i=[];if("progress"!==e.toLowerCase())for(var n=this._getAllLinkedPixelTypes(e),r=0;r<n.length;r++)this.trackingPixels.hasOwnProperty(n[r])&&(i=i.concat(this._checkConcatPixels(this.trackingPixels[n[r]])));else t&&t.hasOwnProperty("eventData")&&t.eventData.hasOwnProperty("pixel")&&t.eventData.pixel&&(i=i.concat(t.eventData));return i}},{key:"_removePixel",value:function(e,t){for(var i=this._getAllLinkedPixelTypes(e),n=0;n<i.length;n++)if(this.trackingPixels.hasOwnProperty(i[n])){var r=this.trackingPixels[i[n]].indexOf(t);r>-1&&this.trackingPixels[i[n]].splice(r,1)}}},{key:"isValid",value:function(e,t){if(!this.pixelsRestrictions.hasOwnProperty(e))return!0;if(e===this.vpaidEvents.AdVideoComplete&&t&&t.newCompletion===!0)return!0;var i=this.pixelsRestrictions[e];return i===this.state&&(this.state=e,!0)}},{key:"destroy",value:function(){this.trackingPixels=this.done=this.events=this.vpaidEvents=this.pixelsRestrictions=this.state=this.clickThruUrl=void 0}},{key:"_checkConcatPixels",value:function(e){return e&&e.length?e:[]}},{key:"_sendPixel",value:function(e,t,i,n,r){if("about:blank"!==e){var s=n?n.data:null;if(c.reportPixel(e,i,s),this.done.indexOf(e)===-1){c.reportCleanPixel(e,i,s);var o=n&&n.tag?n.tag.advId:null;this.fireMultiplePixels.indexOf(i)===-1&&this.done.push(e);try{return e=this._replaceMacros(e,r),o&&(n.tag.getValueByKey("pxlnotsmtp")||(e+=(e.search(/\?/)>-1?"&":"?")+(new Date).getTime())),"img"===t?(new Image).src=e:"js"===t&&this._sendJSPixel(e),!0}catch(e){return!1}}}}},{key:"_sendJSPixel",value:function(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.async=!0,document.body.appendChild(t)}},{key:"_replaceMacros",value:function(e,t){return e=p.replaceMacros(e,this.store),e=this._replaceCachebustingMacro(e),this.replacePixelMacros&&(e=this._replaceErrorMacro(e,t),e=this._replaceTimestampMacro(e),e=this._replaceVideoMacro(e,t),e=this._replaceVideoCurrentTimeMacro(e,t)),e}},{key:"_replaceCachebustingMacro",value:function(e){var t=Date.now().toString(),i=t.substring(5);return e.replace("[CACHEBUSTING]",i)}},{key:"_replaceVideoMacro",value:function(e,t){return e.indexOf("[ASSETURI]")>-1?t&&t.dispatcher&&t.dispatcher.getVideoUrl?e.replace("[ASSETURI]",t.dispatcher.getVideoUrl()):e.replace("[ASSETURI]",""):e}},{key:"_replaceTimestampMacro",value:function(e){return e.indexOf("[TIMESTAMP]")>-1?e.replace("[TIMESTAMP]",(new Date).toISOString()):e}},{key:"_replaceVideoCurrentTimeMacro",value:function(e,t){if(e.indexOf("[CONTENTPLAYHEAD]")>-1)try{if(t&&t.dispatcher&&t.dispatcher.video){var i=t.dispatcher.video.currentTime,n=Math.floor(i/60);n=n>=10?n:"0"+n;var r=Math.floor(i%60);r=r>=10?r:"0"+r;var s=i.toFixed(3).split(".")[1];return e.replace("[CONTENTPLAYHEAD]","00:"+n+":"+r+"."+s)}}catch(t){return e.replace("[CONTENTPLAYHEAD]","")}return e}},{key:"_replaceErrorMacro",value:function(e,t){return e.indexOf("[ERRORCODE]")===-1?e:e.replace("[ERRORCODE]",p.getIABErrorCode(t))}},{key:"pause",value:function(){this._isPaused=!0}},{key:"extractWinningPrice",value:function(e,t){var i=this.getPixels(this.vpaidEvents.AdImpression),n=void 0;if(i.length>0)for(var r=new RegExp(e+"=(.*?)(&|$)","gi"),s=0;s<i.length;s++){var o=r.exec(i[s].pixel);o&&(o.length>1&&o[1]?n={found:!0,price:o[1]}:(n||(n={found:!1}),t&&this._removePixel(this.vpaidEvents.AdImpression,i[s].pixel)))}return n}}]),e}();t.default=m},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.DASTKEYSMAP=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),a=n(o),d=t.DASTKEYSMAP={vastDuration:"vdr",videoElementDuration:"edr",vastWidth:"vwd",videoElementWidth:"ewd",vastHeight:"vht",videoElementHeight:"eht",vastBitrate:"vbr",videoElementUrl:"vu",videoElementType:"vt",vastOriginalType:"ot",vastSubType:"st",effectiveConnectionType:"ect",connectionType:"ct",vasts:"vst",canvas:"cnv",canvasToVideo:"ctv",videoUrlChanged:"vuc",winningPrice:"wp"},l=function(){function e(t){r(this,e),this.store=t,this.hadImpression=!1,this.onNavigatorConnectionChange=this._onNavigatorConnectionChange.bind(this),this.store.on("navigatorConnectionChange",this.onNavigatorConnectionChange);var i=this.store.get("navigatorConnection")||{};this.dast={vdr:void 0,edr:void 0,vwd:void 0,ewd:void 0,vht:void 0,eht:void 0,vbr:void 0,vu:void 0,vt:void 0,ot:void 0,st:void 0,ect:i.effectiveTypeId,ct:i.typeId,vst:[],cnv:!1,ctv:!1,vuc:!1,wp:void 0}}return s(e,[{key:"set",value:function(e){this.stopped||(e.hasOwnProperty("vu")&&""!==e.vu&&(e.vt=this._getVideoTypeFromUrl(e.vu),this.hadImpression&&e.vu!==this.dast.vu&&(this.dast.vuc=!0)),this.dast=Object.assign(this.dast,e))}},{key:"_getVideoTypeFromUrl",value:function(e){var t=void 0,i=e.match(/\.([^\/#?]+)([#?][^\/]*)?$/);return i&&i.length>1&&(t=i[1]),t}},{key:"addWrapper",value:function(e){this.stopped||(e.hasOwnProperty("wu")&&""!==e.wu&&(e.wu=this._getHostnameFromWrapperUrl(e.wu)),this.dast.vst.push(e))}},{key:"_getHostnameFromWrapperUrl",value:function(e){var t=document.createElement("a"),i="";return t.href=e,i=t.hostname,t=null,i}},{key:"_onNavigatorConnectionChange",value:function(e){this.stopped||(this.dast.ect=e.effectiveTypeId,this.dast.ct=e.typeId)}},{key:"get",value:function(){if(!this.stopped)return a.encodeData(this.dast)}},{key:"getByKey",value:function(e){var t=d[e]||e;return this.dast[t]}},{key:"destroy",value:function(){this.stopped=!0,this.store.removeListener("navigatorConnectionChange",this.onNavigatorConnectionChange),this.store=this.onNavigatorConnectionChange=this.dast=void 0}},{key:"onImpression",value:function(){this.hadImpression=!0}},{key:"getWrappers",value:function(){return this.dast.vst}}]),e}();t.default=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(29),a=n(o),d=function(){function e(t){r(this,e),this.store=t,this.data=[],this.useOppsula=this.store.get("usopsla")&&this.store.get("cmbopps"),this.oppsula=this.store.get("oppsula"),this.useOppsula&&!this.oppsula&&this.store.once("oppsulaCreated",this._onOppsulaCreated.bind(this)),this.store.once("waterfallData",this._onWaterfallData.bind(this)),this.store.once("mainVpaidCreated",this._onMainVpaidCreated.bind(this))}return s(e,[{key:"send",value:function(e){this.opportunityManager?this.opportunityManager.send(this._fixedItem,e):this.data.push(e)}},{key:"_sendData",value:function(){var e=this;this.data.forEach(function(t){e.send(t)}),this.data=[]}},{key:"_onWaterfallData",value:function(e){this._fixedItem||(this._fixedItem=e.tags[0],this._createNewPom())}},{key:"_onOppsulaCreated",value:function(e){this.oppsula=e,this._createNewPom()}},{key:"_createNewPom",value:function(){this._fixedItem&&this.config&&(this.useOppsula&&!this.oppsula||this._fixedItem&&this.config&&(this.opportunityManager=new a.default({CM_DOMAIN:this.config.creatives.CM_DOMAIN,AUC_DAST:this.config.creatives.AUC_DAST,sequenceId:this._fixedItem.sequenceId,ST:this.config.creatives.ST,STS:this.config.creatives.STS,SDID:this.config.creatives.SDID,PT:this.config.creatives.PT,PV:this.config.creatives.PV,WP:this.config.creatives.WP,VPD:this.config.creatives.PUBID,VPTD:this.config.creatives.TAGID,VMT:this.config.creatives.VMT},this.store),this._sendData()))}},{key:"_onMainVpaidCreated",value:function(e){this.config=e}}]),e}();t.default=d},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(83),a=n(o),d=i(31),l=n(d),u=i(29),c=n(u),h=i(75),p=n(h),f=i(80),v=n(f),m=function(){function e(t){r(this,e),this.tag=t.tag,this.tagId=t.tagId,this.manager=t.manager,this.store=t.store,this.mainVpaid=t.mainVpaid,this.opportunityManager=t.opportunityManager,this.vpaidLog=t.vpaidLog,this.wflog=t.wflog,this.vpaidLog=this._createVpaidLog(),this.opportunityManager=this._createOpportunityManager(),this.pixelManager=new p.default(this.store),this.vastParser=this._createVastParser(),this.vpaidWrapper=this._createVpaidWrapper()}return s(e,[{key:"_createVpaidWrapper",value:function(){return new a.default({tag:this.tag,creatives:this.mainVpaid.config.creatives,vpaidEvents:this.mainVpaid.vpaidEvents,config:this.mainVpaid.config,tagid:this.tagId,manager:this.manager,wfStats:this.tag.wfStats,mainVpaid:this.mainVpaid,store:this.store,wflog:this.wflog,vpaidLog:this.vpaidLog,opportunityManager:this.opportunityManager,pixelManager:this.pixelManager,vastParser:this.vastParser})}},{key:"_createVpaidLog",value:function(){var e={auctionId:this.tag.auctionId,advId:this.tag.advId,dast:this.tag.dast,price:this.tag.price,queueNumber:this.tag.queueNumber,cpmFloor:this.tag.cpmFloor,dp:this.tag.dp,rollType:this.tag.rollType,lineItem:this.tag.lineItem,unitType:this.store.get("unit_type"),unitVersion:this.store.get("unit_version"),isMobile:this.store.get("isMobile")||!1,rpox:this.tag.rpox,alfrox:this.tag.alfrox,frox:this.tag.frox,waterfallIndex:this.tag.wfIndex,itemType:this.tag.itemType,requiredViewability:this.tag.requiredViewability,requiredViewabilityDrawn:this.tag.requiredViewabilityDrawn,flad:this.tag.flad||this.tag.flad_delay||0,brand:this.tag.brand,priority:this.tag.priority,isCPCV:this.tag.isCPCV,backfillDelayed:!!this.tag.isBackfillDelayed,moatSampling:this.tag.moatSampling,getValueByKey:this.tag.getValueByKey};if(this.tag.crId){var t={stId:this.tag.stId,cmpgnId:this.tag.cmpgnId,itemType:this.tag.itemType};e=Object.assign(e,t)}return new l.default(e,this.store)}},{key:"_createOpportunityManager",value:function(){var e=this.mainVpaid.config.creatives;return new c.default({CM_DOMAIN:e.CM_DOMAIN,AUC_DAST:e.AUC_DAST,sequenceId:this.tag.sequenceId,ST:e.ST,STS:e.STS,SDID:e.SDID,PT:e.PT,PV:e.PV,WP:e.WP,VPD:e.PUBID,VPTD:e.TAGID,VMT:e.VMT},this.store,this.vpaidLog)}},{key:"_createVastParser",value:function(){var e=this.mainVpaid.config;return new v.default({vpaidLog:this.vpaidLog,width:e.width,height:e.height,bitrate:e.bitrate,internalPixel:this.tag.pixel,tag:this.tag},this.store)}}]),e}();t.default=m},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){i(this,e),this.store=t,this.event="queueStatusChanged",this.backfillPriority=this.store.get("mxbckflldlyitms")?this.store.get("bfprty"):void 0,this.previousQueue=[],this._initQueueStatus()}return n(e,[{key:"_initQueueStatus",value:function(){this.queueStatus={requiredViewabilityCount:0,nonRVCount:0,adLoadedCount:0,adxCard:!1,size:0,singleAd:!1,items:[],previousQueue:[]}}},{key:"onItemRemovedFromQueue",value:function(e){var t=this._getItemFromQueue(e);t&&(t=Object.assign({},t),t.vw=e.vpaidWrapper?e.vpaidWrapper.getVpaidStatus():{},this.previousQueue.push(Object.assign({},t)))}},{key:"_getItemFromQueue",value:function(e){for(var t=0;t<this.queueStatus.items.length;t++){var i=this.queueStatus.items[t];if(e.wfIndex===i.seq&&parseInt(e.waterfallTagId)===i.wti)return i}return!1}},{key:"onScheduleChange",value:function(e,t,i){this._initQueueStatus(),this.queueStatus.size=e.length,this.queueStatus.adxCard=t,this.queueStatus.previousQueue=this.previousQueue;for(var n=0;n<e.length;n++){var r=e[n];r.requiredViewability?this.queueStatus.requiredViewabilityCount++:this.queueStatus.nonRVCount++,r.vpaidWrapper.adLoadedFired&&this.queueStatus.adLoadedCount++,r.singleAd&&(this.queueStatus.singleAd=!0),this.queueStatus.items.push(this._getItemStatus(r))}this.emit(i)}},{key:"_getItemStatus",value:function(e){return{aid:e.advId,bf:e.priority===this.backfillPriority,br:e.brand,cmpid:e.campaignId,crid:e.creativeId,cstmdl:e.cstmdl,dp:e.dp,t:e.itemType,li:e.lineItemId,pid:e.pubId,rv:e.requiredViewability,pr:e.vpaidWrapper?e.vpaidWrapper.getPrice(!0):"",sa:e.singleAd,seq:e.wfIndex,wti:parseInt(e.waterfallTagId),vw:e.vpaidWrapper?e.vpaidWrapper.getVpaidStatus():{}}}},{key:"emit",value:function(e){this.store.emit(e||this.event,this.queueStatus)}}]),e}();t.default=r},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(6),u=i(5),c=r(u),h=i(1),p=n(h),f=i(32),v=r(f),m=i(11),g=r(m),y=i(10),_=r(y),b=i(89),w=r(b),k=i(30),A=r(k);window.vpaidId=Date.now()+"-"+parseInt(1e4*Math.random());var T=function(e){function t(e,i){s(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.trackingPixels=(0,v.default)(),n._addExternalEventTrackers(e),n.store=i,n.preferdVpaid=n.store.get("pvpd")||"javascript",n.tag=e.tag,n.preferdVpaid=n.tag.getValueByKey("pvpd")||n.preferdVpaid,n.pvidtp=n.tag.getValueByKey("pvidtp"),n.vpaidLog=e.vpaidLog,n.stopped=!1,n.destroyed=!1,n.debugTracker=new c.default("VastParser"),n.width=parseInt(e.width||n.store.get("width")),n.height=parseInt(e.height||n.store.get("height")),n.bitrate=parseInt(e.bitrate),n.redirCount=0,n.isMobile=n.store.get("isMobile"),n.secureWrapperUrls=p.shouldSecureWrapperAndMediaFile(i),n.fileTypes=["flv","wmv","mp4","webm","ogg","mov"],n.vastUrls=[],n.wrappersCount=0,n.addWrappersToPlayerDAST=n.store.get("adwrprstoplrdst"),n.creativeExtensions=[],n}return a(t,e),d(t,[{key:"_addExternalEventTrackers",value:function(e){var t=this;this._addEventPixel("adimpression",e.internalPixel,void 0,void 0);for(var i=0;i<e.tag.conversionPixels.length;i++)this._addEventPixel("adimpression",e.tag.conversionPixels[i],void 0,void 0);for(var n in e.tag.eventTrackers)(e.tag.eventTrackers[n]||[]).forEach(function(e){t._addEventPixel(n,e.url,void 0,void 0,e.type)})}},{key:"_fetch",value:function(e,t,i,n){var r=this,s=cmTag.$||s;s.ajax({url:e,beforeSend:function(e){i&&(e.withCredentials=!0)},timeout:1e4,complete:function(e,i,n){e.responseText&&t(null,e.responseText)},error:function(i,s,o){return n?t(s):void r._fetch(e,t,!1,!0)}})}},{key:"parseVastFromUrl",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e&&(e=p.trim(e)),e=this._replaceMacros(e),p.logToBI(this.vpaidLog,"parseVastFromUrl",{url:e},!1,!1),this.vastUrls.push(e);var t=this.store.get("vstprxy");return t?this._fetchVastByProxy(e):void this._fetchVastXhr(e)}},{key:"_fetchVastByProxy",value:function(e){var t=this.store.get("pxyurl"),i=t+e;this._fetchVastXhr(i)}},{key:"_fetchVastXhr",value:function(e){var t=this;(0,_.default)(e,"",this._onTagResponse.bind(this),function(){t._onTagResponseError("vastxhrerror_noflash",e)})}},{key:"parseVastFromString",value:function(e){p.logToBI(this.vpaidLog,"parseVastFromString",{xml:e},!1,!1),this._onTagResponse(e)}},{key:"stop",value:function(){this.stopped=!0,this.vpaidLog=null,this.debugTracker=this.trackingPixels=void 0}},{key:"_extractDuration",value:function(e){var t=this._extractTag("duration",e),i=30;return t&&t.length&&t[0].textContent&&(i=parseInt(t[0].textContent.replace("00:00:",""))),i}},{key:"_extractMediaFile",value:function(e,t,i){if(!this.stopped){for(var n=!1,r=!1,s=this._getFilesTemplate(),o={},a=[],d=0;d<e.length;d++){var l=this._getMediaFileType(e[d]);if(l&&l.url){if((0,w.default)(l.url,this.store)){p.logToBI(this.vpaidLog,"badMediaFile",{url:l.url});continue}a.push(l.url)}switch(l.type){case"vpaid":"javascript"==l.subType&&(n&&"javascript"!=n?r=!0:n="javascript",o.javascript=1,s.vpaid.javascript.push(l));break;case"video":n&&"video"!=n?r=!0:n="video",o.video=1,s.videoFiles[l.subType].push(l);break;default:r=!0,s.mixed.push(l)}}var u={flag:r,vpaid:1===o.javascript,video:1===o.video,mixed:s.mixed.length>0};r&&(this.mixedFilesFlag=u.vpaid&&u.video),r&&this.preferdVpaid&&o.hasOwnProperty(this.preferdVpaid)&&(n=this.preferdVpaid),"video"===n&&(s=this.onVideoWrapperMode(s)),a.length&&p.logToBI(this.vpaidLog,"vastMediaFiles",{urls:a},!1,!1),this.storedMediaFiles=s,this.publishParseTagResults(n,s,t,i)}}},{key:"onVideoWrapperMode",value:function(e){for(var t=null,i=0;i<this.fileTypes.length;i++){var n=e.videoFiles[this.fileTypes[i]];t||n.length>0&&n[0].url&&(t=n[0]);var r=this._chooseBestVideoFile(n,this.bitrate,this.width,this.height);r&&r.url&&e.video.push(r)}return 0===e.video.length&&null!==t&&e.video.push(t),this._sortVideos(e.video),e}},{key:"_sortVideos",value:function(e){var t=this;e.length&&this.pvidtp&&(e=e.sort(function(e,i){return e.url.indexOf(t.pvidtp)!=-1?-1:i.url.indexOf(t.pvidtp)!=-1?1:0}))}},{key:"publishParseTagResults",value:function(e,t,i,n){if(!this.stopped){var r=!1;switch(e){case"javascript":t.vpaid.javascript.length>0&&(r=!0);break;case"video":t.video.length>0&&(r=!0)}r?this._onWrapperFound(e,t,i):(this._onVastError("NoMediaFileAfterSort",n,g.default.mediaFileNotSupported),p.logToBI(this.vpaidLog,"noMediaFileAfterSort",{}))}}},{key:"_onWrapperFound",value:function(e,t,i){p.logToBI(this.vpaidLog,"vpiadWrapperFound",{wrapperMode:e},!1,!1);var n={adParams:i,vpaidFiles:t,extra:{duration:this.duration},trackingPixels:this.trackingPixels},r={price:this.price,icons:this.icons,analysis:this.analysis,creativeExtensions:this.creativeExtensions},s={type:e,handlerOptions:n,vastOptions:r};this.emit(A.default.VastData,s)}},{key:"_chooseBestVideoFile",value:function(e,t,i,n){if(this.stopped)return!1;var r=!1,s=this.store.get("isMobile");if(s&&this.tag.isDirectDemand&&this.store.get("mblmdiadrctdmnd")){var o=e.filter(function(e){return e.url.indexOf("MOBILE")>-1});o.length>0&&(e=o)}for(var a=n/i,d=99999999,l=0;l<e.length;l++)e[l].ratioFactor=Math.abs(a-e[l].ratio),e[l].sizeFactor=Math.abs(i-e[l].width)+Math.abs(n-e[l].height),e[l].rateFactor=Math.abs(t-e[l].bitrate),e[l].weight=0,s&&(e[l].rateFactor*=-1,this._isRtmp(e[l].url)&&(e[l].weight=1e6)),e[l].score=100*e[l].ratioFactor+1*e[l].sizeFactor+e[l].rateFactor+e[l].weight,d>e[l].score&&(d=e[l].score,r=e[l]);return r}},{key:"_isRtmp",value:function(e){return 0===e.indexOf("rtmp://")}},{key:"_getFilesTemplate",value:function(){for(var e={video:[],videoFiles:{},vpaid:{flash:[],javascript:[]},mixed:[]},t=0;t<this.fileTypes.length;t++)e.videoFiles[this.fileTypes[t]]=[];return e}},{key:"_getMediaFileType",value:function(e){if(this.stopped)return{};var t={};t.url=e.textContent,t.url&&(t.url=t.url.trim());var i=parseInt(e.getAttribute("bitrate"));t.bitrate=i?i:0;var n=parseInt(e.getAttribute("width"));t.width=n?n:0;var r=parseInt(e.getAttribute("height"));switch(t.height=r?r:0,t.originalType=e.getAttribute("type"),t.originalType){case"video/x-flv":t.type="video",t.subType="flv";break;case"video/x-ms-wmv":t.type="video",t.subType="wmv";break;case"video/mp4":t.type="video",t.subType="mp4";break;case"video/webm":t.type="video",t.subType="webm";break;case"video/ogg":t.type="video",t.subType="ogg";break;case"video/quicktime":var s=this.store.get("ua");"Safari"!==s.browser.name?(t.originalType="video/mp4",t.type="video",t.subType="mp4"):(t.type="video",t.subType="mov");break;case"application/javascript":case"application/x-javascript":case"text/javascript":t.type="vpaid",t.subType="javascript";break;case"application/x-shockwave-flash":t.type="vpaid",t.subType="flash";break;default:p.logToBI(this.vpaidLog,"unknownMediaFileType",{type:t.originalType}),t.type="unknown",t.subType="unknown"}return t.width&&t.height?t.ratio=t.height/t.width:t.ratio="1:1",t}},{key:"_extractTrackingEvents",value:function(e){if(!this.stopped){this._checkForSpecificEvent("impression",e),this._checkForSpecificEvent("error",e),this._checkForSpecificEvent("clickthru",e),this._checkForSpecificEvent("clickthrough",e),this._checkForSpecificEvent("clicktracking",e);var t=this._extractTag("trackingevents",e);if(t.length>0)for(var i=this._extractTag("tracking",t[0]),n=0;n<i.length;n++){var r=i[n].getAttribute("event");if(r)if("progress"===r.toLowerCase()){var s,o=i[n].getAttribute("offset");o&&(s=o.indexOf("%")===-1?"time":"precentage"),this._addEventPixel(r.toLowerCase(),this._extractTagUrl(i[n]),o,s);
}else this._addEventPixel(r.toLowerCase(),this._extractTagUrl(i[n]))}}}},{key:"_extractTagUrl",value:function(e){if(!this.stopped){var t=this._extractTag("url",e),i="";return i=t.length>0?t[0].textContent:e.textContent}}},{key:"_extractTag",value:function(e,t){if(!this.stopped){for(var i=t.childNodes,n=[],r=Array.isArray(e),s=0;s<i.length;s++)if(i[s].tagName){var o=i[s].tagName.toLowerCase(),a=r?e.indexOf(o)>-1:o==e;a?n.push(i[s]):n=n.concat(this._extractTag(e,i[s]))}return n}}},{key:"_extractTagArttibute",value:function(e,t,i){if(!this.stopped){for(var n=t.childNodes,r=[],s=0;s<n.length;s++)if(n[s].tagName){var o=n[s].tagName.toLowerCase();if(o==e){var a=n[s].getAttribute(i);r.push(a)}else r=r.concat(this._extractTagArttibute(e,n[s],i))}return r}}},{key:"_filterVastByRegex",value:function(e){var t=this.tag.getValueByKey("regx");if(!t)return!1;var i=new RegExp(t),n=i.exec(e);return!(!n||!n.length)}},{key:"_onTagResponse",value:function(e,t){if(!this.stopped){if(this.debugTracker.info("Vast was loaded",{vast:e}),p.logToBI(this.vpaidLog,"tagResponse",{response:e,xhrErrors:t},!1,!1),this._filterVastByRegex(e))return p.logToBI(this.vpaidLog,"vastFilterdByRegex",{regex:this.tag.getValueByKey("regx")}),void this._onVastFilterdByRegexError("VastFilterdByRegex",e,g.default.filterVastByRegex);e=p.replaceMacros(e,this.store);var i=this._parseXml(e);if(null==i||this._extractTag(["parsererror"],i).length)return void this._onVastError("ParsingError",e,g.default.vastError);this.vastVersion=this._extractTagArttibute("vast",i,"version").shift()||"1.1",p.logToBI(this.vpaidLog,"vastVersion",{version:this.vastVersion},!1,!1),this.price=this._getPrice(i),this.icons||(this.icons=this._getIcons(i)),this.creativeExtensions=this.creativeExtensions.concat(this._getCreativeExtensions(i)),this.duration=this._extractDuration(i);var n=this._extractTag("mediafiles",i);if(n&&1==n.length&&n[0].childNodes.length){var r=this._extractTag("mediafile",n[0]);0==r.length?(this.debugTracker.error("Vast","No media files!"),this._onVastError("ParsingError",e,g.default.vastError,"noMediaFile")):(this._extractMediaFileAnalysisToPlayerDAST(i),this._extractTrackingEvents(i),this._extractMediaFile(r,this._getAdParameters(i),e))}else{var s=this._extractTag("wrapper",i);1==s.length?(this._extractTrackingEvents(i),this._onWrapper(s[0],e,i)):this._onVastError("NoMediaFiles",e,g.default.emptyVast,"noMediaFilesAndWrapper")}}}},{key:"_extractMediaFileAnalysisToPlayerDAST",value:function(e,t){this.analysis={vr:this.vastVersion};var i=this._extractTag("ad",e).shift();i&&(this.analysis.aid=this._extractAttributeFromTag(i,"id"));var n=this._extractTag("adsystem",e).shift();n&&(this.analysis.as=this._extractTextFromTag(n),p.logToBI(this.vpaidLog,"adSystem",{system:this.analysis.as},!1,!1));var r=this._extractTag("adtitle",e).shift();r&&(this.analysis.at=this._extractTextFromTag(r)),t&&(this.analysis.wu=t)}},{key:"_extractAttributeFromTag",value:function(e,t){return e.getAttribute(t)||""}},{key:"_extractTextFromTag",value:function(e){return e.textContent||""}},{key:"_getPrice",value:function(e){var t=this._extractTag(["price","pricing"],e).shift(),i=0;if(t){var n=t.textContent;try{isNaN(Number(n))&&n.indexOf("DATA")!=-1&&(i=n.replace(/[^0-9.]/g,"")),i=Number(n),i=i.toFixed(3),i=Number(i)}catch(e){i=0}}return i}},{key:"_decodeType",value:function(e){var t=e.attributes,i={};for(var n in t)t[n].value?i[t[n].name]=t[n].value.toLowerCase():null;return i}},{key:"_getCreativeExtensions",value:function(e){for(var t=[],i=this._extractTag(["creativeextension"],e),n=0;n<i.length;n++){var r={};r.element=i[n].textContent.trim(),r.attributes=this._decodeType(i[n]),t.push(r)}return t}},{key:"_getIcons",value:function(e){for(var t=[],i=this._extractTag(["icon"],e),n=0;n<i.length;n++){var r={},s=this._isIconClicksExists(i[n]);s&&(r.clickThroughUrl=this._decodeIconData(i[n],"iconclickthrough").shift()),r.staticresource=this._decodeIconData(i[n],"staticresource").shift(),r.staticresource||(r.htmlresource=this._decodeIconData(i[n],"htmlresource").shift()),!r.htmlresource&&!r.staticresource||s&&!r.clickThroughUrl||(r.iconViewTracking=this._decodeIconData(i[n],"iconviewtracking"),r.clickTracking=this._decodeIconData(i[n],"iconclicktracking"),r.attributes=this._decodeIconAttributes(i[n]),t.push(r))}return t}},{key:"_isIconClicksExists",value:function(e){var t=this._extractTag(["iconclicks"],e).shift(),i=!!t;return i}},{key:"_decodeIconAttributes",value:function(e){var t=e.attributes,i={};for(var n in t)t[n].value?i[t[n].name]=t[n].value.toLowerCase():null,"width"===t[n].name||"height"===t[n].name?i[t[n].name]+="px":null;return i}},{key:"_decodeIconData",value:function(e,t){try{var i=this._extractTag([t],e),n=i.map(function(e){return e.textContent.trim()});return n}catch(e){return this.debugTracker.warn("Vast","decode Icon "+t,e),""}}},{key:"_onWrapper",value:function(e,t,i){if(!this.stopped){this.wrappersCount++;var n=this._extractTag("vastadtagurl",e);if(0==n.length&&(n=this._extractTag("vastadtaguri",e),0==n.length))return this._onVastError("WrapperError",t,g.default.vastWrapperError,"EmptyWrapper");var r=this._extractTagUrl(n[0]);if(!r)return this._onVastError("WrapperError",t,g.default.vastWrapperError,"NoUrl");r=p.replaceMacros(r,this.store),this.secureWrapperUrls&&(r=r.replace("http:","https:")),0===this.redirCount&&p.logToBI(this.vpaidLog,"VastWrapper",{type:"wrapper"}),this.redirCount++,this.addWrappersToPlayerDAST&&this._extractMediaFileAnalysisToPlayerDAST(i,r),this.parseVastFromUrl(r)}}},{key:"_getAdParameters",value:function(e){if(!this.stopped){var t="",i=this._extractTag("adparameters",e);return i.length>0&&i[0].textContent&&(t=i[0].textContent),t}}},{key:"_checkForSpecificEvent",value:function(e,t){if(!this.stopped)for(var i=this._extractTag(e,t),n=0;n<i.length;n++)this._addEventPixel(e,this._extractTagUrl(i[n]))}},{key:"_addEventPixel",value:function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"img";this.stopped||void 0!=this.trackingPixels[e]&&t&&(r=r.toLowerCase(),"progress"===e?i&&n&&this._addProgressPixel(t,i,n,r):this.trackingPixels[e].push({pixel:t,method:r}))}},{key:"_addProgressPixel",value:function(e,t,i,n){try{this.trackingPixels.progress.push({pixel:e,offset:"time"===i?p.hmsmToSecondsOnly(t):parseInt(t.replace("%",""))/100,offsetType:i,fired:!1,method:n})}catch(e){}}},{key:"_parseXml",value:function(e){if(this.stopped)return null;var t=null;if(window.DOMParser)try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=null}else if(window.ActiveXObject)try{t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e)||(t=null)}catch(e){t=null}return t}},{key:"_onTagResponseError",value:function(e,t){this.stopped||(this.debugTracker.error("Vast","Vast url was not loaded!aborting..."),this.emit(A.default.NetworkFail,{type:e}))}},{key:"_onVastError",value:function(e,t,i,n){this.stopped||(this.debugTracker.error("VAST-ERROR",e),p.logToBI(this.vpaidLog,"vastParseError",{reason:n}),this.emit(A.default.ParserError,{type:e,oppsId:i}))}},{key:"_onVastFilterdByRegexError",value:function(e,t,i){this.stopped||(this.debugTracker.error("VAST-ERROR",e),this.emit(A.default.ParserError,{type:e,oppsId:i}))}},{key:"_sampleVastXml",value:function(e){this.stopped}},{key:"destroy",value:function(){this.stopped=!0,this.destroyed=!0,this.vpaidLog=null,this.vastUrls=null,this.tag=null,this.trackingPixels=this.debugTracker=this.fileTypes=void 0,this._onTagResponse=this._onTagResponseError=function(){}}},{key:"_replaceMacros",value:function(e){return e=e.replace(/\[CACHEBUSTER\]/,Date.now())}},{key:"hasMixedFiles",value:function(){return this.mixedFilesFlag===!0}}]),t}(l.EventEmitter);t.default=T},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(6),u=i(24),c=r(u),h=i(1),p=n(h),f=function(e){function t(e,i,n){s(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.store=e,r.tag=i,r.vpaidLog=n,r.vpaidCrawler=e.get(c.default.vpaidCrawler.storeDataKey),r.vpaidCrawler||(r.hjk=e.get(c.default.hjk.storeDataKey),r.vpaidAnalytics=e.get(c.default.vpaidAnalytics.storeDataKey)),r.onVpaidResourceEvent=r._onVpaidResourceEvent.bind(r),r}return a(t,e),d(t,[{key:"inject",value:function(e,t){e&&(this.vpaidCrawler?this._injectVpaidCrawler(e):(p.logToBI(this.vpaidLog,"injectResource",{vpaidCrawler:!1}),this._injectHJK(e),this._injectVpaidAnalytics(e,t)))}},{key:"_injectVpaidCrawler",value:function(e){var t=this._getVpaidAnalyticsOptions();this.vpaidCrawler=this.vpaidCrawler.replace('"%%%ANALYTICS_OPTIONS%%%"',p.stringify(t)),t.deepIframes&&(e.contentWindow.vpaidCrawlerFunc=this.vpaidCrawler),this.onResourceMessage=this._onResourceMessage.bind(this),window.addEventListener("message",this.onResourceMessage),p.injectResource(e.contentWindow,this.vpaidCrawler),this.vpaidLog.getVpaidAnalyticsReport=e.contentWindow.analyticsReporter.getReport,this.setVpaidAnalyticsIsVideoUrlPublic=function(t){e.contentWindow.analyticsReporter.isVideoUrlPublic=t}}},{key:"_onResourceMessage",value:function(e){if(!this.stopped&&e.data&&"resourceEvent"===e.data.type){p.logToBI(this.vpaidLog,"resourceEvent",e.data.eventData,!1,!1);var t=e.data.eventData.event;t.indexOf("malicious")>-1?this._onCrawlerHijackAttempt(t,e.data.eventData):"undefinedIframeSrc"===t?this._onUndefinedRelativeIframeSrcError(e.data.eventData.url):"maxNetworkCalls"===t&&this._onNetworkCallsLimitExceeded()}}},{key:"_injectHJK",value:function(e){return this.hjk?(e.contentWindow.hjkFunc=this.hjk,e.contentWindow.ReportHijackAttempt=this._onHijackAttempt.bind(this),void p.injectResource(e.contentWindow,this.hjk)):void p.logToBI(this.vpaidLog,"injectResource",{hjk:!1})}},{key:"_injectVpaidAnalytics",value:function(e,t){if(!this.vpaidAnalytics)return void p.logToBI(this.vpaidLog,"injectResource",{vpaidAnalytics:!1});var i=this._getVpaidAnalyticsOptions();p.injectResource(e.contentWindow,this.vpaidAnalytics),i.deepIframes&&(e.contentWindow.AnalyticsReporter.prototype.vpaidAnalyticsFunc=this.vpaidAnalytics),e.contentWindow.AnalyticsReporter.prototype._onUndefinedRelativeIframeSrcError=this._onUndefinedRelativeIframeSrcError.bind(this),e.contentWindow.onNetworkCallsLimitExceeded=this._onNetworkCallsLimitExceeded.bind(this),new e.contentWindow.AnalyticsReporter(t,function(){},i),this.vpaidLog.getVpaidAnalyticsReport=e.contentWindow.getVpaidAnalyticsReport,e.contentWindow.setIsVideoUrlPublic&&(this.setVpaidAnalyticsIsVideoUrlPublic=e.contentWindow.setIsVideoUrlPublic)}},{key:"_getVpaidAnalyticsOptions",value:function(){var e=this.store.get("anltcsOptions"),t=this.tag.getValueByKey("mxntwrkclls")||0,i=this.store.get("ifrmswghts");return t&&(e.maxNetworkCalls=t),i&&(e.iframesWeights=i),e}},{key:"_onHijackAttempt",value:function(e,t){this._onCrawlerHijackAttempt("maliciousUrl",{url:e,isEarly:t})}},{key:"_onVpaidResourceEvent",value:function(e,t){this.emit("vpaidResourceEvent",{event:e,data:t})}},{key:"_onCrawlerHijackAttempt",value:function(e,t){t.firePixel="maliciousUrl"===e,this._onVpaidResourceEvent("hijackAttempt",{type:e,data:t})}},{key:"_onUndefinedRelativeIframeSrcError",value:function(e){this._onVpaidResourceEvent("undefinedIframeSrc",{url:e})}},{key:"_onNetworkCallsLimitExceeded",value:function(){this._onVpaidResourceEvent("maxNetworkCalls",{maxNetworkCalls:this.tag.getValueByKey("mxntwrkclls")})}},{key:"destroy",value:function(e){this.stopped||(this.stopped=!0,e&&e.contentWindow&&(this.vpaidCrawler?this._destroyVpaidCrawler(e):this._destroyHJKAndAnalytics(e)))}},{key:"_destroyVpaidCrawler",value:function(e){window.removeEventListener("message",this.onResourceMessage),e.contentWindow.analyticsReporter.destroy(),e.contentWindow.destroyCrawler(),this.vpaidLog.getVpaidAnalyticsReport=null}},{key:"_destroyHJKAndAnalytics",value:function(e){e.contentWindow.ReportHijackAttempt=null,e.contentWindow.destroyAnalyticsReporter&&e.contentWindow.destroyAnalyticsReporter()}}]),t}(l.EventEmitter);t.default=f},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r={new:{id:0,name:"new"},adLoaded:{id:1,name:"adLoaded",timeKey:"ldd"},startAd:{id:2,name:"startAd",timeKey:"st"},adImpression:{id:3,name:"adImpression",timeKey:"imp"},adPlay:{id:4,name:"adPlay",timeKey:"pl"},adError:{id:5,name:"adError",timeKey:"err"},adComplete:{id:6,name:"adComplete",timeKey:"cmp"}},s=function(){function e(){i(this,e),this.statuses=r,this.status=this.statuses.new.id,this.timeBetweenStatuses={},this._startTimer()}return n(e,[{key:"setStatus",value:function(e){this.timeBetweenStatuses[e.name]=this._getTime(),this.status=e.id,this._startTimer()}},{key:"get",value:function(){var e={cs:this._getTime()};for(var t in this.timeBetweenStatuses)e[this.statuses[t].timeKey]=this.timeBetweenStatuses[t];return{st:this.status,ts:e}}},{key:"_startTimer",value:function(){this.time=Date.now()}},{key:"_getTime",value:function(){return Date.now()-this.time}}]),e}();e.exports={Statuses:r,VpaidStatus:s}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(15),u=r(l),c=i(5),h=r(c),p=i(1),f=n(p),v=i(11),m=r(v),g=i(6),y=i(73),_=r(y),b=i(127),w=r(b),k=i(25),A=r(k),T=i(76),C=r(T),E=i(82),P=r(E),S=i(20),V=r(S),x=i(95),I=r(x),O=i(87),D=r(O),M=i(66),R=r(M),F=i(28),L=r(F),B=i(81),j=r(B),H=i(30),U=r(H),N=i(152),W=0,z=0,q=function(e){function t(e){s(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(i.mainVpaid=e.mainVpaid,i.store=e.store,i.wflog=e.wflog,i.wflog&&i.wflog.increaseNumberOfConnectedVpaids(),i.isVForceActive=i.store.get("vForce"),i.created=Date.now(),i.loadedEvent="",i.manager=e.manager,i.clickThoughHandler=new D.default(i.store,i.manager.mainVpaid.vpaidHandler.parent),i.index=++W,i.vpaidWrapperIndex="VpaidWrapper"+i.index,i.tagid=e.tagid,i.tag=e.tag,i.tag.vpaidWrapperData={},i.error="",i.readyInMS=0,i.isMultiAdsActive=i.store.get("mltads"),i.isMultiVpaidUnit=i.store.get("isMultiVpaidUnit"),i.isAdErrorBeforeAdLoadedActive=i.store.get("aderrbfradlddopactv"),i.adLoadedFired=!1,i.hijackFired=!1,i.blockBringToFront=i.isMultiVpaidUnit&&i.store.get("blckbrngtofrnt"),i.toggleIframeContentDisplayActive=i.store.get("tglifrmcntndsplyactv"),i.waitForAdPausedBeforeResumeAd=i.store.get("wtfradpsdbfrrsmad"),i.nonVideoVpaid=i.tag.itemType===V.default.type,i.defaultTagPrice=i.store.get("dftgprc"),i.moatTrackers=[],i.bfPriority=i.store.get("bfprty"),i.isVerticalVideoSupported=i.tag.getValueByKey("spprtvrtclvd"),i.playerDAST=new C.default(i.store),i.vpaidStatuses=P.default.Statuses,i.vpaidStatus=new P.default.VpaidStatus,i.creatives={},i.stayAlive=!1,i.oldStatus="",i.stopReason="",i.config={},i.vast=[],i.iconsPrograms=[],i.isMobile=i.store.get("isMobile")||!1,i.isIOS=!1,i.isMobile){var n=i.store.get("ua");i.isIOS="iOS"===n.os.name}i.timeoutLengthToAdCompletion=i.tag.getValueByKey((i.isMobile?"mbl":"dsk")+"tmouttoadcmpltn"),i.newCompletionByVideoProgress=i.store.get("q5byprgrss"),i.fireNewCompletionPixel=i.timeoutLengthToAdCompletion>0,i.fireNewCompletionPixel&&(i.timeoutLengthToAdCompletion=f.normalizeMilliseconds(i.timeoutLengthToAdCompletion)),i.timeoutToAdCompletion=null,i.timeoutToAdCompletionStartTime=0,i.newCompletionEventFired=!1,i.globalAdTimeout=null,i.globalAdTimeoutStartTime=0,i.globalAdTimeoutLength=i.tag.getValueByKey("global_ad_timeout"),i.globalAdTimeoutLength&&i.globalAdTimeoutLength>0&&(i.globalAdTimeoutLength=f.normalizeMilliseconds(i.globalAdTimeoutLength)),i.store.get("dbncadvltm")?i.setAdVolume=N(i._setAdVolume,i.store.get("dbncadvltm"),{leading:!0}):i.setAdVolume=i._setAdVolume,i.tag.advId&&i._pushUniqueAdvIdsToWaterfallLog(),i.tag.moatSampling=i._decideMoat(),i.tag.isDirectDemand=3===i.tag.advType||4===i.tag.advType,i.pwov=i.tag.pwov,i.vpaidLog=e.vpaidLog,i._copyFromStoreToBi("connectionType",!1);var r=i.store.get("navigatorConnection");if(f.logToBI(i.vpaidLog,"navigatorConnection",{effectiveTypeId:r.effectiveTypeId,typeId:r.typeId},!1,!1),i._wfStats=e.wfStats,i._wfStats.increaseVpaidsCount(),i.oppsID=m.default,i.shouldMuteVid=i.store.get("dskVidMuted")&&!i.store.get("isMobile"),i.opportunityManager=e.opportunityManager,i.vpaidEventToPixelId={},i.vpaidEventToPixelId[i.mainVpaid.vpaidEvents.AdVideoFirstQuartile]=i.oppsID.videoFirstQuartile,i.vpaidEventToPixelId[i.mainVpaid.vpaidEvents.AdVideoMidpoint]=i.oppsID.videoMidpoint,i.vpaidEventToPixelId[i.mainVpaid.vpaidEvents.AdVideoThirdQuartile]=i.oppsID.videoThirdQuartile,i.vpaidEventToPixelId[i.mainVpaid.vpaidEvents.AdVideoComplete]=i.oppsID.videoComplete,i._sendOpp(i.oppsID.tagStarted),i.unloadCallback=function(e){i._sendOpp(i.oppsID.unloadPage)},i.opportunityManager.isRegisterAvailable("unloadCallbacks",i.unloadCallback,!0),i.debugTracker=new h.default(i.vpaidWrapperIndex),i.pixelManager=e.pixelManager,i.vpaidResourcesHandler=new j.default(i.store,i.tag,i.vpaidLog),i.onVpaidResourceEvent=i._onVpaidResourceEvent.bind(i),i.vpaidResourcesHandler.on("vpaidResourceEvent",i.onVpaidResourceEvent),e.creatives)for(var a in e.creatives)i.creatives[a]=e.creatives[a];if(e.config)for(var a in e.config)i.config[a]=e.config[a];return i.adVolume=f.normalizeVolume(parseInt(i.config.VOLUME)?parseInt(i.config.VOLUME):0),i.vpaidEvents=e.vpaidEvents,i.localTarget=i._createLocalTarget(i.config.target),i.vpaidHandlersFactory=new I.default(i.vpaidLog,i.store),i.handlerOptions={applyBypass:!!i.creatives.AFBP,slot:i.localTarget,videoSlotControls:!!i.config.videoSlotControls,videoSlotCanAutoPlay:!!i.config.videoSlotCanAutoPlay,protection:i.config.vpaid_protect_path,tag:i.tag,onReady:i._onHandlerCreated.bind(i),onError:i._onHandlerError.bind(i),onSwitchFromCanvasToVideo:i._onSwitchFromCanvasToVideo.bind(i),playerDAST:i.playerDAST,vpaidResourcesHandler:i.vpaidResourcesHandler,extra:{}},i.nonVideoVpaid?(i._createNonVideoVpaid(),o(i)):(i.store.get("vpdcntrcstmcss")&&((i.adTarget||i.localTarget).style.cssText+=i.store.get("vpdcntrcstmcss")),i.isIOS&&(i.clickableTarget=i._createClickableTarget(i.localTarget)),i.localVideo=i._createLocalVideo(i.localTarget),i.handlerOptions.videoSlot=i.localVideo,i.handlerOptions.clickableTarget=i.clickableTarget||null,i.beacon=new u.default(i),i.parser=e.vastParser,i._createBindedFuncitons(),i._registerToVastParserEvents(),i.adFoundDispatched=!1,i.vpaidHandler=!1,i.stopped=!1,i._startParser(),i.isVForceActive=i.store.get("vForce")||!1,f.logToBI(i.vpaidLog,"vForce",{vForceIsActive:i.isVForceActive},!1,!1),i.reportVideoStatusToUnitInterval=i.store.get("rprtvidsttsintrvl"),i._initTimers(),i.store.get("useVideoControls")&&i.tag.getValueByKey("ad_controls")!==!1&&(i.VideoControls=new A.default(i.localVideo,i.store,i.localTarget,"ad",i),i.VideoControls.setVpaidHandler(i),i.VideoControls.setOnSoundChangeCallback(i._onSoundChange.bind(i)),i.VideoControls.once("unmuteClicked",i._sendFirstUnmuteOpp.bind(i))),i.handelsEarlyAI=i.store.get("erlyai"),i._handleDataSaver(),i.store.get("debug")&&i._addCopyToClipboardBtn(),i.isReplayable=!1,i._onGotAdIconsBinded=i._onGotAdIcons.bind(i),i._appendVpaidCSS(),i._sendTimeupdateToWrapper=i.tag.getValueByKey("sndvptmrst"),i._reportBuffering=i.tag.getValueByKey("rprtbuffrng"),i)}return a(t,e),d(t,[{key:"_createBindedFuncitons",value:function(){this.bindedCreateHandler=this._createHandler.bind(this),this.bindedOnParserError=this._onParserError.bind(this),this.bindedOnNetworkError=this._onNetworkError.bind(this),this.bindedOnBuffering=this._onBuffering.bind(this),this.bindedOnBufferingEnd=this._onBufferingEnd.bind(this)}},{key:"_registerToVastParserEvents",value:function(){this.parser.on(U.default.VastData,this.bindedCreateHandler),this.parser.on(U.default.ParserError,this.bindedOnParserError),this.parser.on(U.default.NetworkFail,this.bindedOnNetworkError)}},{key:"_unregisterToVastParserEvents",value:function(){this.parser.removeListener(U.default.VastData,this.bindedCreateHandler),this.parser.removeListener(U.default.ParserError,this.bindedOnParserError),this.parser.removeListener(U.default.NetworkFail,this.bindedOnNetworkError)}},{key:"_decideMoat",value:function(){if(this.store.get("isInApp")||!this.tag.getValueByKey("moat"))return!1;if(this.store.get("moat"))return!0;var e=this.tag.getValueByKey("mtfctr");return void 0===e||f.getRandomInt(0,100)<=e}},{key:"_createNonVideoVpaid",value:function(){this.beacon=new u.default(this),this.vpaidHandler=!1,this.stopped=!1,this.isVForceActive=this.store.get("vForce")||!1,this.isReplayable=!1,this._createHandler({type:"adx",handlerOptions:this.handlerOptions})}},{key:"_addCopyToClipboardBtn",value:function(){var e=this,t=document.createElement("div");t.className="playerSaveButton",t.style.zIndex=z+10,t.innerHTML="SAVE",this.localVideo.parentElement.appendChild(t),t.addEventListener("click",function(){(0,w.default)(e.vpaidLog.toString())})}},{key:"_startParser",value:function(){this.parser.stopped||(this.tag.vast?this.parser.parseVastFromString(this.tag.vast):this.parser.parseVastFromUrl(this.tag.url))}},{key:"_initTimers",value:function(){this._waitForEvent(this.vpaidEvents.AdLoaded,this.tag.getValueByKey("altmot")||this.tag.ADTO,this._onAdLoadedEvent.bind(this),this._onAdLoadedTimeout.bind(this)),this._setTimers()}},{key:"_setTimers",value:function(){var e=this._initTimersStart?Date.now()-this._initTimersStart:0;this._initTimersStart=Date.now(),this._initTillAdstartTimeout(e),this._initAutoKillTimeOut(e)}},{key:"_initTillAdstartTimeout",value:function(e){var t=this;this.tillAdstartTimeout&&clearTimeout(this.tillAdstartTimeout);var i=this.type&&this.store.getByTech("adto",this.type)||this.tag.getValueByKey("adto")||this.tag.ADTO;i-=e,i>0&&(this.tillAdstartTimeout=setTimeout(function(){f.logToBI(t.vpaidLog,"AdStopADTO",{}),t.error="adto",t._firePixel("AdError",{eventData:{iabErrorCode:L.default.timeout}}),t.stop(t.error,t.oppsID.adtoTimeout)},i))}},{key:"_initAutoKillTimeOut",value:function(e){var t=this;this.autoKill&&clearTimeout(this.autoKill);var i=this.type&&this.store.getByTech("vakll",this.type)||this.tag.getValueByKey("vakll")||9e4;i-=e,i>0&&(this.autoKill=setTimeout(function(){f.logToBI(t.vpaidLog,"AutoKill",{timeout:i}),t.error="autoKill",t.beacon.dispatchEvent(t.vpaidEvents.AdVideoComplete,t),t._firePixel("AdError",{eventData:{iabErrorCode:L.default.timeout}}),t.stop(t.error,t.oppsID.globalTimeout)},i))}},{key:"_killTimers",value:function(){if(clearTimeout(this.autoKill),clearTimeout(this.tillAdstartTimeout),clearTimeout(this.adloadedTimeout),this.pendingEvents)for(var e in this.pendingEvents)this.pendingEvents[e].timeoutId!=-1&&clearTimeout(this.pendingEvents[e].timeoutId);this.pendingEvents={}}},{key:"_createClickableTarget",value:function(e){if(!this.stopped){var t=document.createElement("div"),i=this.store.get("width"),n=this.store.get("height");return t.className="cm-ad-click-target",t.style.cssText="width: "+i+"px; height: "+n+"px; cursor: pointer; position: absolute; top: 0px; left: 0px;",t.style.display="",t.setAttribute("width",i),t.setAttribute("height",n),e.appendChild(t),t}}},{key:"_createLocalVideo",value:function(e){var t=this;if(!this.stopped){var i=this.store.get("width"),n=this.store.get("height"),r=this._createVideoElement(e);return r.className="cm-ad-player",r.style.cssText="width: "+i+"px; height: "+n+"px;",r.style.display="",r.volume=0,this.shouldMuteVid&&(r.muted=!0),r.setAttribute("width",i),r.setAttribute("height",n),this.isMobile&&(r.muted=!0,r.setAttribute("muted","")),r.addEventListener("timeupdate",function(e){t._onTimeupdate(r)}),this.config.videoSlotControls&&r.removeAttribute("controls"),this.store.get("addprld")&&r.setAttribute("preload","auto"),e.appendChild(r),r}}},{key:"_createVideoElement",value:function(e){var t=this;return f.createVideoElement(this.store,{target:e,onAutoplayDetected:function(e){e||t.playerDAST.set({cnv:!0})}},"ad",f.logToBI.bind(this,this.vpaidLog))}},{key:"_createLocalTarget",value:function(e){if(!this.stopped){var t=document.createElement("div");return this.store.get("noplrcntr")&&(t.id="_cm-css-reset"),t=this._styleElement(t,e),this._createAdTargetElement(t),e.appendChild(this.adTarget?this.adTarget:t),t}}},{key:"_styleElement",value:function(e,t){return this.store.get("noplrcntr")||(e.style.cssText=t.style.cssText),e.style.position="absolute",e.style.overflow="hidden",e.style.top="0",e.style.height="0",e.style.left="0",e.style.zIndex="1",e.style.background="transparent",this.store.get("noplrcntr")?e.className=this.vpaidWrapperIndex:e.className=(t.className?t.className:"")+" "+this.vpaidWrapperIndex,this.isMultiAdsActive&&e.className.indexOf("_cm-video-ad")<0&&(e.className="_cm-video-ad "+e.className),e}},{key:"_createAdTargetElement",value:function(e){(this.isMultiVpaidUnit||this.isMultiAdsActive)&&(f.removeClass(e,"multi-vpaids"),this.adTarget=document.createElement("div"),this.adTarget.className="_cm-ad",this.adTarget.id="_cm-css-reset",this.adTarget.appendChild(e))}},{key:"_onHandlerError",value:function(e,t){f.logToBI(this.vpaidLog,"earlyError",{errMsg:e}),this.loadedEvent||(this.status="error",this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdError,e),"adUnitLoadFailed"===t&&(f.logToBI(this.vpaidLog,"adUnitLoadFailed",{errMsg:e}),this._firePixel("AdError",{eventData:{iabErrorCode:L.default.timeout}}),this.stop("adUnitLoadFailed",m.default.adUnitLoadFailed))))}},{key:"_onHandlerCreated",value:function(){this.stopped||(f.logToBI(this.vpaidLog,"createdVpaidHandler",{}),this._connectToVpaidHandler(),this.vpaidHandler.handshakeVersion("2.0"),f.logToBI(this.vpaidLog,"initAd",{}),this.VideoControls&&this.vpaidHandler.canvas&&this.VideoControls.setCanvas(this.vpaidHandler.canvas),this.vpaidHandler.initAd(this.config.width,this.config.height,this.config.viewMode,this.config.bitrate,{AdParameters:this.creatives.AdParameters},{slot:this.localTarget,videoSlot:this.localVideo,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay}))}},{key:"_connectToVpaidHandler",value:function(){if(!this.stopped)for(var e in this.vpaidEvents)this.vpaidHandler.subscribe(this._handleVpaidEvents.bind(this,this.vpaidEvents[e]),this.vpaidEvents[e])}},{key:"_adLoadedHandler",value:function(e){var t=this;if(!this.stopped){if(this.adLoadedFired=!0,this.loadedEvent=this.loadedEvent+" "+e,this.readyInMS=Date.now()-this.created,this.debugTracker.info("Ad loaded now => pause it srcEvent",e),this._sendOpp(m.default.adLoaded),this.vpaidStatus.setStatus(this.vpaidStatuses.adLoaded),this.isMobile&&this.vpaidHandler.canvas&&(this.muted=!0),this.status="ready",this.isUnPaused=!0,this.store.emit("vpaidReady",this),this.asyncAdimpression=this.tag.getValueByKey("asyncAdimpression"),this.asyncAdimpression){var i=this.tag.getValueByKey("aaViewability")?"unit::viewability":"unit::conversion";f.logToBI(this.vpaidLog,"asyncAdimpression",{event:i}),this.on(i,function(){f.logToBI(t.vpaidLog,"asyncAdimpressionEvent",{event:i}),t.onAsyncAdmpression()})}this.setAdVolume(this.adVolume),this.adFoundDispatched=!0,this.vpaidHandler.checkUnfriendlyIframe&&(this.isUnfriendlyIframe=this.vpaidHandler.checkUnfriendlyIframe()),this.type&&"javascript"==this.type&&this.logVpaidFamily(),this.vpaidResourcesHandler&&this.vpaidResourcesHandler.setVpaidAnalyticsIsVideoUrlPublic&&this.vpaidResourcesHandler.setVpaidAnalyticsIsVideoUrlPublic(""!==this.getVideoUrl());var n=this.store.get("rvfrquesttsemttr");"any"!==n&&this.tag.requiredViewability!==n||this.store.emit("emitQueueStatus")}}},{key:"startAd",value:function(e){var t=this;this.adStarted=!0,this.setAdVolume(this.adVolume),this._startForceAdVolumeInterval(),this.options=Object.assign(e||{},this.store.get("getAdData")),this.isStarted=!0,this.store.incr("ads_started"),this._sendOpp(this.oppsID.startAd),this.vpaidStatus.setStatus(this.vpaidStatuses.startAd),this._dispatchToMoat("startAd"),f.logToBI(this.vpaidLog,"adOptions",{count:this.options.count,getAdRetries:this.options.getAdRetries,requiredViewability:this.options.requiredViewability},!1,!1),f.logToBI(this.vpaidLog,"startAd",{}),this.earlyAdImpression||this._waitForEvent(this.vpaidEvents.AdImpression,this.store.get("adimptmot"),this._onAdImpressionEvent.bind(this),this._onAdImpressionTimeout.bind(this)),this.isUnPaused?this.vpaidHandler.startAd():this.vpaidHandler.resumeAd(),clearTimeout(this.tillAdstartTimeout),this.working=!0,this.earlyAdImpression&&setTimeout(function(){t._onAdImpression()},500),this.vpaidHandler.on("activeAdCurrentTime",function(e){t.emit("activeAdCurrentTime",e)}),this.newCompletionByVideoProgress&&this.vpaidHandler.on("newCompletion",function(){t._newCompletionHandler("timerEnded")}),this.tag.getValueByKey("wtchprgrssopp")&&this.tag.isDirectDemand&&this.vpaidHandler.on("watchProgress",function(e){t._onVpaidTimeupdated(e.currentTime)}),this._reportBuffering&&(this.vpaidHandler.on("buffering",this.bindedOnBuffering),this.vpaidHandler.on("bufferingEnded",this.bindedOnBufferingEnd))}},{key:"_startForceAdVolumeInterval",value:function(){var e=this;if(!this.isMobile&&!this.nonVideoVpaid){var t=this.store.get("frcadvlmtrvl");if(!this.setAdVolumeInterval&&t>0){var i=this.store.get("stpfrcvlevnt")||this.vpaidEvents.AdVideoFirstQuartile;this.vpaidHandler.subscribe(function(){e._stopForceAdVolumeInterval()},i),this.setAdVolumeInterval=setInterval(function(){e.vpaidHandler&&!e.vpaidHandler.stopped?e.setAdVolume(e.adVolume):clearInterval(e.setAdVolumeInterval)},t)}}}},{key:"_stopForceAdVolumeInterval",value:function(){this.isMobile||(clearInterval(this.setAdVolumeInterval),this.setAdVolumeInterval=0)}},{key:"restartAd",value:function(){var e=this;this.isReplayable&&(this.opportunityManager.unpause(),this._sendOpp(this.oppsID.replayAd),this.opportunityManager.pause(),this.pixelManager.pause(),this.working=this.isStarted=this.adStarted=!0,this.store.incr("ads_started"),
this._setClickThroughData(),this.vpaidHandler.restartAd(this.getVideoUrl(),this.clickThruUrl),setTimeout(function(){e.bringToFront()}))}},{key:"isReplayableVpaid",value:function(){return this.isVForceActive&&this.tag.getValueByKey("rplvpdactv")&&this.vpaidHandler&&this.vpaidHandler.isReplayable()}},{key:"dontDie",value:function(){this.stayAlive=!0,this.vpaidHandler&&this.vpaidHandler.dontDie&&this.vpaidHandler.dontDie(),this._killTimers()}},{key:"_handleStopped",value:function(e){this.moveToBack(),this.stop(e.type,e.oppType),this.working=!1}},{key:"pauseAd",value:function(){this.stopped||(this.waitForAdPausedBeforeResumeAd&&(this.isUnPaused&&(this.adPausedFired=!1),this.resumeOnAdPaused&&(this.resumeOnAdPaused=!1)),this.pauseAdStartTime=Date.now(),this.working=!1,this.vpaidHandler.pauseAd(),this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout())}},{key:"resumeAd",value:function(){if(!this.stopped&&(this.isMultiAdsActive||!this.store.get("forcePause"))){if(this.waitForAdPausedBeforeResumeAd&&!this.adPausedFired)return void(this.resumeOnAdPaused=!0);this.resumeOnAdPaused=!1,this.working=!0,this.vpaidHandler.resumeAd(),this.isMultiVpaidUnit&&(this.isVerticalVideoSupported&&this.isVertical||this.resizeAd(this.store.get("width"),this.store.get("height"))),this.VideoControls&&!this.workingVpaid&&(this.VideoControls.resetAdControls(),this.isMobile&&this.store.emit("playerStatusChanged","ad")),this.store.set("ad_controls",this.tag.getValueByKey("ad_controls")!==!1),this.workingVpaid=!0,this.isVForceActive&&!this.nonVideoVpaid&&(this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout(),this.vpaidHandler&&this.vpaidHandler.handleVpaidContent&&this.vpaidHandler.handleVpaidContent()),this._reportVideoProgress()}}},{key:"_reportVideoProgress",value:function(){var e=this;this.isVideoProgressingInterval||(this.videoProgressing=!0,this.isVideoProgressingInterval=setInterval(function(){e.vpaidHandler.getAdRemainingTime(function(t,i){if(e.isUnPaused){var n=!1;i=parseInt(i),!e.lastRemainingTime||i<e.lastRemainingTime?(e.lastRemainingTime=i,n=!e.videoProgressing):n=e.videoProgressing,n&&(e.videoProgressing=!e.videoProgressing,f.logToBI(e.vpaidLog,"videoProgress",{progress:e.videoProgressing,reaminingTime:i},!1,!1))}})},1e3))}},{key:"_setGlobalAdTimeout",value:function(){var e=this;this.globalAdTimeoutLength&&this.globalAdTimeoutLength>0&&!this.globalAdTimeout&&(this.globalAdTimeoutStartTime=Date.now(),this.globalAdTimeout=setTimeout(function(){e.stopped||e.stop("global_ad_timeout",e.oppsID.globalAdTimeout)},this.globalAdTimeoutLength))}},{key:"_pauseGlobalAdTimeout",value:function(){this.globalAdTimeout&&(this.globalAdTimeout=clearTimeout(this.globalAdTimeout),this.globalAdTimeoutLength-=Date.now()-this.globalAdTimeoutStartTime)}},{key:"_setTimeoutToAdCompletion",value:function(){var e=this,t=this.newCompletionByVideoProgress&&null!=this.vpaidHandler.activeVideoElement;!this.timeoutToAdCompletion&&this.timeoutLengthToAdCompletion>0&&!this.newCompletionEventFired&&!t&&(this.timeoutToAdCompletionStartTime=Date.now(),this.timeoutToAdCompletion=setTimeout(function(){e.stopped||e._newCompletionHandler("timerEnded")},this.timeoutLengthToAdCompletion))}},{key:"_pauseAdTimeoutToCompletion",value:function(){this.timeoutToAdCompletion&&(this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this.timeoutLengthToAdCompletion-=Date.now()-this.timeoutToAdCompletionStartTime)}},{key:"_fireNewCompletionEvent",value:function(){this.newCompletionEventFired||(this._sendOpp(this.oppsID.newCompletion),this.vpaidStatus.setStatus(this.vpaidStatuses.adComplete),this.newCompletionEventFired=!0)}},{key:"getVideoUrl",value:function(){return this.videoUrl||(this.videoUrl=this.vpaidHandler.getVideoUrl?this.vpaidHandler.getVideoUrl():""),this.videoUrl}},{key:"_setVideoDataToPlayerDAST",value:function(){var e={vu:this.getVideoUrl()},t=this.localVideo;this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement&&(t=this.vpaidHandler.getVPAIDVideoElement()||t),t&&(e.edr=t.duration,e.ewd=parseInt(t.videoWidth),e.eht=parseInt(t.videoHeight)),this.playerDAST.set(e)}},{key:"_logVideoUrlCounter",value:function(){var e=this.getVideoUrl();e||(e="na");var t=this.store.get("videoUrlsCounter")||{};t[e]=t.hasOwnProperty(e)?++t[e]:1,f.logToBI(this.vpaidLog,"videoUrlCounter",{videoUrl:e,counter:t[e]},!1,!1);var i=Object.keys(t);f.logToBI(this.vpaidLog,"sessionUniqueVideoUrls",{counter:i.length,urls:i},!0,!1),this.store.set("videoUrlsCounter",t)}},{key:"_dispatchToMoat",value:function(e,t){if(t!==!1)for(var i=0;i<this.moatTrackers.length;i++)this.moatTrackers[i].dispatch({type:e,adVolume:this.adVolume})}},{key:"_handleVpaidEvents",value:function(e,t){var i=this;if(this.vpaidEvents){if("javascript"===this.type&&(this.tag.getValueByKey("cmpltonstpd")||this._getAdSettingValue("cmpltonstpd")||this.vpaidHandler.completeOnAdStop)){if(e===this.vpaidEvents.AdVideoComplete)return void(this.vpaidHandler&&this.vpaidHandler.setCompletionOnAdStoppedTimeout&&this.vpaidHandler.setCompletionOnAdStoppedTimeout());e===this.vpaidEvents.AdStopped&&(e=this.vpaidEvents.AdVideoComplete)}!this.isFirstVpaidEvent&&this.vpaidHandler._getMediaUrl()&&(this.isFirstVpaidEvent=!0,f.logToBI(this.vpaidLog,"mediaUrl",{url:this.vpaidHandler._getMediaUrl()},!1,!1),this._checkIfGoogle());var n=!0;if(!this.stopped){var r=this._firePixel(e,t);switch(e!==this.vpaidEvents.TimeUpdated&&this.debugTracker.info("VpaidHandler-event",e),this._dispatchToMoat(e,r),this._onEvent(e),e){case this.vpaidEvents.AdLoaded:if(this._adLoadedHandler(e),this.vpaidLog.getVpaidAnalyticsReport){var s=this.vpaidLog.getVpaidAnalyticsReport();f.logToBI(this.vpaidLog,"vpaidAnalyticsUntilAdloaded",s)}this.vpaidHandler.getAdIcons&&this.vpaidHandler.getAdIcons(this._onGotAdIconsBinded);break;case this.vpaidEvents.AdImpression:if(this.store.emit("playContentAfterFirstAd"),this._setVideoDataToPlayerDAST(),n=this._onAdImpression(e),this._pushConversionDataToWaterfallLog(),this._logVideoUrlCounter(),this.earlyAdImpression)return;this.isVForceActive||(this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout(),this.vpaidHandler&&this.vpaidHandler.handleVpaidContent&&this.vpaidHandler.handleVpaidContent());break;case this.vpaidEvents.AdVideoStart:this.setAdVolume(this.adVolume),this.adFoundDispatched||(this.adFoundDispatched=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdFound)),this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart);break;case this.vpaidEvents.AdSkipped:this.adStoppedHandler(e),this._handleStopped({type:e,oppType:this.oppsID.adSkiped});break;case this.vpaidEvents.AdStopped:this.adStoppedHandler(e),this._handleStopped({type:e});break;case this.vpaidEvents.AdLog:this.debugTracker.info("VpaidHandler-Log",arguments);break;case this.vpaidEvents.AdError:this.vpaidStatus.setStatus(this.vpaidStatuses.adError);var o=this.oppsID.adError;this.isAdErrorBeforeAdLoadedActive&&!this.adLoadedFired&&(o=this.oppsID.adErrorBeforeLoad),"video"===this.type?this.stop("Mp4AdError",o):this.stop("AdError",o,t);break;case this.vpaidEvents.SoundViolation:this.store.get("sndvltopp")&&!this.alreadySentSoundViolation&&(this.alreadySentSoundViolation=!0,this._sendOpp(this.oppsID.soundViolation));break;case this.vpaidEvents.AdPaused:this.pauseAdStartTime=void 0,this.adPausedFired=!0,this.waitForAdPausedBeforeResumeAd&&this.resumeOnAdPaused&&this.resumeAd();case this.vpaidEvents.AdClickThru:t=this._adClickThroughData(t),this.isUnPaused=!1,this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout();break;case this.vpaidEvents.AdPlaying:this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout(),this._fireAdPlaying();case this.vpaidEvents.AdStarted:case this.vpaidEvents.AdVideoStart:this.isUnPaused=!0;break;case this.vpaidEvents.AdVideoFirstQuartile:this.beacon.dispatchEvent(e);break;case this.vpaidEvents.AdVolumeChange:this.isMobile&&t&&t.eventData&&t.eventData.volume&&(this.adVolume=f.normalizeVolume(t.eventData.volume));break;case this.vpaidEvents.TimeUpdated:f.logToBI(this.vpaidLog,"videoTicking",{time:t.eventData.time}),this._onVpaidTimeupdated(t.eventData.time);break;default:this.beacon.dispatchEvent(e)}this.emit(e,{type:e,data:t});var a=this.nonVideoVpaid?0:this.localVideo.currentTime,d=["AdDurationChange","AdSizeChange","AdLinearChange","AdLog","AdSkippableStateChange","AdExpandedChange","AdInteraction","AdUserClose","AdSkipped","Progress","AdVolumeChange"];if(d.indexOf(e)===-1&&f.logToBI(this.vpaidLog,"event_"+e,{isViewable:!document.hidden,vidCurrentime:a,eventDataStr:t?f.stringify(t.eventData):null}),r&&this.vpaidEventToPixelId.hasOwnProperty(e)&&this.hadImpression&&this._sendOpp(this.vpaidEventToPixelId[e]),this.vpaidEvents)if(e===this.vpaidEvents.AdClickThru)this.clickThruUrl=t&&t.eventData?t.eventData.url:"",this.clickThoughHandler.invokeClick(t.eventData);else if(e==this.vpaidEvents.AdVideoComplete){if(this.adCompleted=!0,this._newCompletionHandler(this.vpaidEvents.AdVideoComplete,r),this.tag.singleAd&&!this.isVForceActive&&this.store.emit("closePlayer"),this.stayAlive)return this.globalAdTimeout&&(this.globalAdTimeout=clearTimeout(this.globalAdTimeout)),void this.emit("end");this.vpaidHandler.stopAd(),setTimeout(function(){i.working=!1,i.workingVpaid=!1,i.stop("AdVideoComplete"),i.status="stopped"},2)}this.manager&&n&&this.manager.trigger(e,this,t?t.eventData:null)}}}},{key:"_onVpaidTimeupdated",value:function(e){this._sendOpp(this.oppsID.vpaidProgress,{sdid:e})}},{key:"_onGotAdIcons",value:function(e,t){f.logToBI(this.vpaidLog,"ad_choices",{vpaid:{error:e,result:t}},!1,!1)}},{key:"_newCompletionHandler",value:function(e,t){if(!this.newCompletionEventFired&&(this.timeoutToAdCompletion||this.fireNewCompletionPixel||this.newCompletionByVideoProgress)){if(this.timeoutToAdCompletion&&(this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion)),this._validateNewCompletionFiring(e,t))return void this._fireNewCompletionEvent();f.logToBI(this.vpaidLog,"fireNewCompletionPrevented",{reason:e},!1,!1)}}},{key:"_validateNewCompletionFiring",value:function(e,t){return e===this.vpaidEvents.AdVideoComplete?t&&this.opportunityManager.alreadySent(this.tag,this.oppsID.videoComplete):"timerEnded"===e&&this.opportunityManager.alreadySent(this.tag,this.oppsID.videoFirstQuartile)}},{key:"_setClickThroughData",value:function(){this.clickThruUrl=this.clickThruUrl||this.pixelManager.getClickThruUrl()}},{key:"_adClickThroughData",value:function(e){if(e&&e.eventData&&e.eventData.url)return e;var t=this.pixelManager.getClickThruUrl();if(t){var i={url:t};e?e.eventData=Object.assign(e.eventData||{},i):e={eventData:i}}return e}},{key:"_checkIfGoogle",value:function(){var e=this.localTarget.querySelector("iframe");if(e){var t=f.domIframeIterator(e,this.store.get("debug"));for(this.isGoogleIframe=!1;!this.isGoogleIframe&&t.hasNext();)this._isGoogleIframe(t.current)&&(this.isGoogleIframe=!0)}}},{key:"_isGoogleIframe",value:function(e){return e&&e.src.indexOf("imasdk.googleapis.com")>-1&&e.src.indexOf("bridge")>-1}},{key:"_onAdImpression",value:function(){var e=!0,t=this.store.get("rstmrai");if(this.fireViewTracking&&this.fireViewTracking(),t&&this._killTimers(),!this.adStarted&&this.handelsEarlyAI)return this.earlyAdImpression=!0,this.isVForceActive&&this.pauseAd(),this.isUnPaused=!1,f.logToBI(this.vpaidLog,"earlyAdImpression",{early:!0}),clearTimeout(this.tillAdstartTimeout),!(this.tag.getValueByKey("prvnterlyadimpopp")||this.adSettings&&this.adSettings.prvnterlyadimpopp||(this._fireAdImpression(),1));if(this.hadImpression)e=!1;else{var i=this.store.get("conversionsCount")+1;this.store.set("conversionsCount",i),f.logToBI(this.vpaidLog,"success",{count:i},!0,!1),this.setAdVolume(this.adVolume),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this._fireAdImpression(),this.adImpInMS=Date.now()-this.created,this.hadImpression=!0,this._wfStats.increaseSuccess(),this.vpaidHandler&&this.vpaidHandler.logVideoUrl&&this.vpaidHandler.logVideoUrl(),this.vpaidHandler&&!this.vpaidHandler.activeVideoElement&&this._sendOpp(this.oppsID.unfriendlyVideo),this.isReplayable=this.isReplayableVpaid(),f.logToBI(this.vpaidLog,"restartAd",{isReplayable:this.isReplayable},!1,!1),this.playerDAST.onImpression()}return this.earlyAdImpression&&this.manager&&this.manager.trigger("AdImpression",this,null),e}},{key:"_firePixel",value:function(e,t){return!!("AdVideoComplete"===e&&!this.hadImpression||e===this.vpaidEvents.AdImpression&&this.hadImpression||this.asyncAdimpression)||this.pixelManager.firePixel(e,this.vpaidLog,t)}},{key:"_fireAdImpression",value:function(e){this.adimpFired||(this.asyncAdimpression&&!e||(f.logToBI(this.vpaidLog,"fireAsyncAdimpression",{end:!0}),this._sendOpp(this.oppsID.tagImpression),this.pixelManager.firePixel(this.vpaidEvents.AdImpression,this.vpaidLog),this.adimpFired=!0),this.vpaidStatus.setStatus(this.vpaidStatuses.adImpression))}},{key:"_fireAdPlaying",value:function(){!this.adPlayingFired&&this.hadImpression&&this.workingVpaid&&(this.adPlayingFired=!0,this._sendOpp(this.oppsID.adPlaying),this.vpaidStatus.setStatus(this.vpaidStatuses.adPlay))}},{key:"onAsyncAdmpression",value:function(){f.logToBI(this.vpaidLog,"fireAsyncAdimpression",{start:!0}),this._fireAdImpression(!0)}},{key:"adStoppedHandler",value:function(e){var t=this;this.stop(),setTimeout(function(){t._cleanVpaid()},1e4)}},{key:"_setAdVolume",value:function(e,t){this.stopped||this.nonVideoVpaid||(e=f.normalizeVolume(e),this.adVolume=e,this.shouldMuteVid&&(this.localVideo.volume=e,this.localVideo.muted=0===e),this.adVolume>0&&this.setAdVolumeInterval&&this._stopForceAdVolumeInterval(),this.store.get("frcmtfrms")&&this._setVolumeInIframes(this.localTarget.getElementsByTagName("iframe"),e),this.vpaidHandler&&(this.vpaidHandler.setAdVolume(e,t),this.vpaidHandler.callIMAApi&&this.vpaidHandler.callIMAApi("volume",e)))}},{key:"_setVolumeInIframes",value:function(e,t){var i=this;f.DOMIterator(e[0],"iframe",function(e){e.forEach(function(e){i._overideVolumeInIframe(e),e.setAttribute("tbvol",t),e.volume=t,i.shouldMuteVid&&(e.muted=0===t)})},"video",this.store.get("debug"))}},{key:"_overideVolumeInIframe",value:function(e){if(!e||!e.sv){var t=this;e.sv=!0,e.addEventListener("volumechange",function(){e.volume!==parseFloat(this.getAttribute("tbvol"))?(e.volume=0,t.beacon.dispatchEvent(t.vpaidEvents.SoundViolation,{})):e.volume=t.adVolume})}}},{key:"_onParserError",value:function(e){this.stopped||(this.status="error",this.error=e.type||"",this.isPlaying=!1,f.logToBI(this.vpaidLog,"AdError",{errType:e.type,handlerType:e.handlerType,isPraserError:!0}),this.parser&&this.parser.trackingPixels&&this.pixelManager.loadPixelData(this.parser.trackingPixels),this.stop(this.error,e.oppsId))}},{key:"_onNetworkError",value:function(e){this.stopped||(this.status="error",this.error=e?"xhrStatuses_"+e:"",this.isPlaying=!1,this.stop(this.error,m.default.networkError))}},{key:"_updateAdVideoDurationOnVideoControls",value:function(e){this.VideoControls&&this.VideoControls.setState({vidDuration:e,vidCurrentTime:0})}},{key:"_getMediaType",value:function(){return"video"===this.type?1:"javascript"===this.type?2:"adx"===this.type?5:void 0}},{key:"_createHandler",value:function(e){if(!this.stopped)return this.setVastPrice(e.vastOptions.price),this.setVastIcons(e.vastOptions.icons),this.setExternalScripts(e.vastOptions.creativeExtensions),this.playerDAST.set({vdr:e.handlerOptions.extra.duration}),this.playerDAST.addWrapper(e.vastOptions.analysis),this.handlerOptions.adParams=e.handlerOptions.adParams,this.handlerOptions.vpaidFiles=e.handlerOptions.vpaidFiles,this.handlerOptions.extra.duration=e.handlerOptions.extra.duration,this.handlerOptions.trackingPixels=e.handlerOptions.trackingPixels,this.nonVideoVpaid||(this.vpaidLog.setVastWrapperCount(this.parser.wrappersCount),this._setTimers(),this.creatives.AdParameters=this.handlerOptions.adParams,this.handlerOptions.adSettings=this._getAdSettings(),this.adSettings&&this.adSettings.hasOwnProperty("wtfradpsdbfrrsmad")&&this.adSettings.wtfradpsdbfrrsmad===!0&&(this.waitForAdPausedBeforeResumeAd=!0)),this.vpaidHandler=this.vpaidHandlersFactory.create(e.type,this.handlerOptions),this.vpaidHandler?void(this.nonVideoVpaid||(this.type=e.type,this.tag.vpaidWrapperData.mediatype=this._getMediaType(),this.debugTracker.info("ParserResponded["+this.type+"-"+(this.isMobile?"mob":"desk")+"]",this.handlerOptions.vpaidFiles),this.pixelManager.loadPixelData(this.handlerOptions.trackingPixels),this._setClickThroughData(),this._updateAdVideoDurationOnVideoControls(this.handlerOptions.extra.duration),this.vpaidHandler.removeClickableTarget(),this._createMoatTracker())):void this._onParserError({type:"handlerCreatingFail",handlerType:e.type,oppsId:this.oppsID.mediaFileNotSupported})}},{key:"_createMoatTracker",value:function(e){var t=this.moatTrackersCreativeExtensions||[];this.tag.moatSampling&&t.push(void 0);for(var i=0;i<t.length;i++)this.moatTrackers.push(new _.default({moatTag:t[i],container:this.vpaidHandler.getDOMContainer(),tag:this.tag,moatPartnerCode:this.tag.getValueByKey("moatPartnerCode"),duration:this.vpaidHandler.getAdDuration(),url:this.vpaidHandler.mediaFiles[0].url,store:this.store,vpaidLog:this.vpaidLog,playerDast:this.playerDAST.get()}));this._extractWinningPrice()}},{key:"_getAdSettings",value:function(e){return this.adSettings=this.store.getByAdInline(this.playerDAST.getWrappers())||{},Object.keys(this.adSettings).length>0&&f.logToBI(this.vpaidLog,"adSettings",this.adSettings,!0,!1),this.adSettings}},{key:"_cleanIframe",value:function(){var e=this.localTarget.querySelectorAll("iframe");this._clearIframe(e&&e.length?e[0]:null)}},{key:"_cleanVpaid",value:function(){if(!(this.clean||this.stayAlive&&this.isReplayable)){this.clean=!0,this.vpaidLog&&(this.vpaidLog.saveToDb(),this.vpaidLog.getVpaidAnalyticsReport=void 0),this.wflog&&(this.wflog.complete(),this.wflog=void 0),this.pixelManager&&this.pixelManager.destroy(),this.beacon&&(this.beacon.listEvents(),this.beacon.destroy()),this.localTarget&&(this.localVideo&&this.localVideo.parentElement&&this.localTarget.removeChild(this.localVideo),this._cleanIframe(),this.localTarget.parentNode.removeChild(this.localTarget)),this.adTarget&&this.adTarget.parentNode&&this.adTarget.parentNode.removeChild(this.adTarget),this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this.globalAdTimeout=clearTimeout(this.globalAdTimeout),this._killTimers(),this.nonVideoVpaid||(this._unregisterToVastParserEvents(),this.parser.destroy()),this._reportBuffering&&this.vpaidHandler&&(this.vpaidHandler.removeListener("buffering",this.bindedOnBuffering),this.vpaidHandler.removeListener("bufferingEnded",this.bindedOnBufferingEnd));for(var e=0;e<this.moatTrackers.length;e++)this.moatTrackers[e].dispose();this.creativeExtensionsHandler&&(this.creativeExtensionsHandler.removeListener("externalMoat",this.pushExternalMoatTracker),this.creativeExtensionsHandler.destroy()),this.status="stopped",this.working=!1,this.VideoControls&&this.VideoControls.destroy(),this.playerDAST&&this.playerDAST.destroy(),this.vpaidHandlersFactory&&this.vpaidHandlersFactory.destroy(),this.store&&(this._bindedOnAdLoadVideoThrottleDelayEnd&&(this.store.removeListener(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this._bindedOnAdLoadVideoThrottleDelayEnd=void 0),this._bindedOnRemovedFromVideoThrottleListeners&&(this.store.removeListener(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners),this._bindedOnRemovedFromVideoThrottleListeners=void 0)),this.isVideoProgressingInterval&&(this.isVideoProgressingInterval=clearInterval(this.isVideoProgressingInterval)),this.creatives=this.vpaidLog=this.parser=this.debugTracker=this.manager=this.tag=this.vast=this.beacon=this.pixelManager=this.config=this.vpaidEvents=this.localTarget=this.vpaidHandler=this.store=this._wfStats=this.localVideo=this.VideoControls=this.adSettings=this.creativeExtensionsHandler=this.moatTrackers=this.moatTrackersCreativeExtensions=void 0,this.isPlaying=!1,window.setTimeout(this.onAfterStop,0),this.emit("vpaidCleaned")}}},{key:"_clearIframe",value:function(e){e&&(f.DOMIterator(e,"iframe",function(e){var t=cmTag.$;e.forEach(function(e){t(e).remove()})},"*",this.store.get("debug")),e&&e.parentNode.removeChild(e))}},{key:"bringToFront",value:function(){if(this.localTarget&&!this.blockBringToFront){var e=this.store.get("height");this.localTarget.style.display="block",this.localTarget.style.height=e+"px";var t=z++ +99;this.localTarget.style.zIndex=t,this.clickableTarget&&(this.clickableTarget.style.zIndex=t),this.vpaidHandler&&(this.vpaidHandler.zIndex=t),this.VideoControls&&this.VideoControls.setState({isVisible:!0}),this.toggleIframeContentDisplay("hide")}}},{key:"moveToBack",value:function(){this.localTarget&&(this.localTarget.style.zIndex=0,this.clickableTarget&&(this.clickableTarget.style.zIndex=0))}},{key:"subscribe",value:function(e,t){this.stopped||this.vpaidEvents[t]&&this.beacon.addEventListener(t,e)}},{key:"unsubscribe",value:function(e,t){this.vpaidEvents&&this.vpaidEvents[t]&&this.beacon.removeEventListener(t,e)}},{key:"stop",value:function(e,t,i){var n=this;if(!e&&this.pixelManager.getState()===this.vpaidEvents.AdVideoThirdQuartile&&!this.adCompleted)return f.logToBI(this.vpaidLog,"earlyAdStopped",{early:!0},!0,!1),void this._handleVpaidEvents(this.vpaidEvents.AdVideoComplete,{});if(!("global_ad_timeout"!==e&&"undefinedIframeSrc"!==e&&this.stayAlive&&this.isReplayable||this.stopped)){if(this.opportunityManager.isRegisterAvailable("unloadCallbacks",this.unloadCallback,!1),e&&"hijackAttempt"!==e&&(i&&i.eventData?f.logToBI(this.vpaidLog,e,{eventDataStr:f.stringify(i.eventData),status:this.status}):f.logToBI(this.vpaidLog,e,{status:this.status})),this._stopForceAdVolumeInterval(),!this.hadImpression){var r=this.store.get("failsCount")+1;this.store.set("failsCount",r),f.logToBI(this.vpaidLog,"fails",{count:r},!0,!1)}this._wfStats&&(this.hadImpression||this._wfStats.increaseFailure(),f.logToBI(this.vpaidLog,"wfStats",{data:this._wfStats.getData()},!1,!1)),this.isStarted&&this.store.decr("ads_started"),this.stopReason=e,this.oldStatus+=this.status,this.isPlaying=!1,void 0!==t&&this._sendOpp(t,i),"NoMediaFileAfterSort"===e&&t===this.oppsID.mediaFileNotSupported&&this._firePixel("AdError",{eventData:{iabErrorCode:L.default.mediaFileNotSupported}}),"playerClosed"===e&&this.hadImpression&&this.pixelManager.firePixel("close",this.vpaidLog,{}),this.stopped=!0,this.vpaidHandler&&(this.vpaidHandler.onAfterStop=this._cleanVpaid.bind(this),this.vpaidHandler.stopAd()),this.emit("end"),this.store.emit("vpaidEnded",this),setTimeout(function(){n._cleanVpaid()},2),"global_ad_timeout"===e&&(this.isReplayable=!1,this.isVForceActive||this.store.emit("hideAdPlayer"))}}},{key:"callVpaidMethod",value:function(e,t,i){if(!this.stopped){if(this.vpaidHandler&&this.vpaidHandler.callIMAApi&&("pauseAd"!=e&&"resumeAd"!=e||this.vpaidHandler.callIMAApi(e)),"resizeAd"!==e&&f.logToBI(this.vpaidLog,"vpaidApi_"+e,{}),"setAdVolume"==e&&(this.adVolume=f.normalizeVolume(t[0])),"pauseAd"==e&&(this.isUnPaused=!1),"resizeAd"==e&&this._resizeContainers(t[0],t[1],t[2]),!this.vpaidHandler||!this.vpaidHandler[e])return i;try{return this.vpaidHandler[e].apply(this.vpaidHandler,t)}catch(e){return i}}}},{key:"_resizeContainers",value:function(e,t,i){this.localVideo.style.width=e+"px",this.localVideo.style.height=t+"px",this.localVideo.setAttribute("width",e),this.localVideo.setAttribute("height",t),this.localTarget.style.width=e+"px",this.localTarget.style.height=t+"px",this.localTarget.setAttribute("width",e),this.localTarget.setAttribute("height",t)}},{key:"onAfterStop",value:function(){}},{key:"_hijackAttempt",value:function(e,t){if("maliciousUrl"===e){if(!this.hijackFired){this.hijackFired=!0,t.firePixel&&(this._fireHJKPixel(51591248,""),this._fireHJKPixel(31542217,this.tag.dast)),f.logToBI(this.vpaidLog,"hijackAttempt",{type:"url",badUrl:t.url,earlyHijack:!!t.isEarly&&t.isEarly},!1,!1);var i=this.store.get("hjkstp")!==!1;i&&this.stop("hijackAttempt",m.default.hijackAttempt)}}else"maliciousAction"===e&&(this._sendOpp(this.oppsID.blockedActionByHijack),f.logToBI(this.vpaidLog,"hijackAttempt",{type:"action",action:t.action}))}},{key:"_fireHJKPixel",value:function(e,t){var i={cijs:0,ttype:5,pix:e,dast:t,cb:(new Date).getTime()};i=Object.assign(i,f.createPixelBaseUrlParams(this.store)),f.sendPixel(i,this.store)}},{key:"_onVpaidResourceEvent",value:function(e){"hijackAttempt"===e.event?this._hijackAttempt(e.data.type,e.data.data):"undefinedIframeSrc"===e.event?(f.logToBI(this.vpaidLog,"undefinedRelativeIframeSrcError",{url:e.data.url}),this.store.get("stpvpdonudfndsrc")&&this.stop("undefinedIframeSrc",m.default.networkError)):"maxNetworkCalls"===e.event&&(f.logToBI(this.vpaidLog,"vpaidAnalyticsCallLimit",{adImpression:this.adimpFired,limitExceeded:!0,maxNetworkCalls:e.data.maxNetworkCalls}),this.adimpFired||this.stop("networkCallsLimitExceeded",m.default.maxNetworkCalls))}},{key:"fire99",value:function(){this._sendOpp(this.oppsID.firstImpression)}},{key:"_onEvent",value:function(e,t){if(this.pendingEvents&&this.pendingEvents.hasOwnProperty(e)){var i=this.pendingEvents[e];i.timeoutId!=-1&&clearTimeout(i.timeoutId),i.cb&&"function"==typeof i.cb&&i.cb(t),delete this.pendingEvents[e]}}},{key:"_waitForEvent",value:function(e,t,i,n){var r=function(){},s=-1,o=this;t>0&&n&&"function"==typeof n&&(s=setTimeout(function(){f.logToBI(this.vpaidLog,"vpaidTimeout_"+e,{}),n(),delete o.pendingEvents[e],s=null,i=r,n=r}.bind(this),t)),this.pendingEvents||(this.pendingEvents={}),this.pendingEvents[e]={cb:i,timeoutId:s}}},{key:"_onAdLoadedTimeout",value:function(){this.error="adloadedTimeout",this._firePixel("AdError",{eventData:{iabErrorCode:L.default.timeout}}),this.stop(this.error,this.oppsID.adloadedTimeout)}},{key:"_onAdLoadedEvent",value:function(){}},{key:"_onAdImpressionTimeout",value:function(){this.error="adImpressionTimeout",this.stop(this.error)}},{key:"_onAdImpressionEvent",value:function(){}},{key:"setVastPrice",value:function(e){this.tag.vpaidWrapperData.vastPrice=e,e>0&&f.logToBI(this.vpaidLog,"vastPrice",{value:e})}},{key:"setExternalScripts",value:function(e){0!==e.length&&(this.pushExternalMoatTracker=this._pushExternalMoatTracker.bind(this),this.creativeExtensionsHandler=new R.default(e,this.localTarget,this.vpaidLog),this.creativeExtensionsHandler.on("externalMoat",this.pushExternalMoatTracker),this.creativeExtensionsHandler.handleExternalScripts())}},{key:"_pushExternalMoatTracker",value:function(e){this.moatTrackersCreativeExtensions=this.moatTrackersCreativeExtensions||[],this.moatTrackersCreativeExtensions.push(e)}},{key:"setVastIcons",value:function(e){var t=this.tag.getValueByKey("fkadchcs");t?(this.hasAdChoices=!0,f.logToBI(this.vpaidLog,"ad_choices",{fakeAdChoices:!0})):(this.tag.vpaidWrapperData.icons=e,this.hasAdChoices=e.length,this.hasAdChoices&&this._addAdChoiceDiv(e))}},{key:"_addAdChoiceDiv",value:function(e){f.logToBI(this.vpaidLog,"ad_choices",{vast:!0});var t=!0,i=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;if(o.attributes.program&&this.iconsPrograms.indexOf(o.attributes.program)===-1){this.iconsPrograms.push(o.attributes.program);var a=document.createElement("div");a.className="_cm-ad-choices-player",a.style.zIndex=1,o.attributes.xPosition&&(a.style.left="initial",a.style[o.attributes.xPosition]="13px"),o.attributes.yPosition&&(a.style.top="initial",a.style[o.attributes.yPosition]="16px");var d=document.createElement("a");if(o.clickThroughUrl&&(d.href=o.clickThroughUrl),d.onclick=this._appendOnClick(o),d.target="_blank",d.className="_cm-ad-choices-player-anchor",d.style.width=o.attributes.width||"19px",d.style.height=o.attributes.height||"15px",o.staticresource?d.style.background="#fff url("+o.staticresource+") no-repeat center center":o.htmlresource&&(d.innerHTML+=o.htmlresource),o.iconViewTracking.length){var l=o.iconViewTracking;this.fireViewTracking=function(){setTimeout(function(e){var t=!0,i=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;(new Image).src=o}}catch(e){i=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw n}}},5e3,l)}}a.appendChild(d),this.localVideo.parentElement.appendChild(a)}}}catch(e){i=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw n}}}},{key:"_appendOnClick",value:function(e){return function(){var t=!0,i=!1,n=void 0;try{for(var r,s=e.clickTracking[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;(new Image).src=o}}catch(e){i=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw n}}}}},{key:"_copyFromStoreToBi",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.store.get(e)&&f.logToBI(this.vpaidLog,e,this.store.get(e),!1,t)}},{key:"_handleDataSaver",value:function(){this.isMobile&&!this.vpaidHandler.canvas&&this.store.get("dataSaverDetected")&&(this.isUnPaused=!1,f.logToBI(this.vpaidLog,"dataSaverDetected",{value:!0}))}},{key:"mute",value:function(){this.stopped||(this.vpaidHandler.video&&this.vpaidHandler.video.muteButtonClicked&&this.adVolume>0&&this.vpaidHandler.video.muteButtonClicked(),this.adVolume=0,this.VideoControls&&this.VideoControls.setState({isMuted:!0}))}},{key:"unmute",value:function(){if(!this.stopped&&(this.vpaidHandler.video&&this.vpaidHandler.video.muteButtonClicked&&0===this.adVolume&&this.vpaidHandler.video.muteButtonClicked(),this.adVolume=f.normalizeVolume(this.store.get("dfltvlm")),this.VideoControls)){if(this.store.get("forceMute"))return void(this.adVolume=0);this.VideoControls.setState({isMuted:!1}),this.adVolume=f.normalizeVolume(this.VideoControls.getValueFromControlsState("volume"))}}},{key:"updateStatusesOnGetAd",value:function(e){f.logToBI(this.vpaidLog,"statusesOnGetAd",{status:this.status,hadImpression:!!this.hadImpression,isStarted:!!this.isStarted,requiredViewability:e.requiredViewability})}},{key:"logVpaidFamily",value:function(){var e=[],t=[];if(this.vpaidHandler.adUnit._iframe&&this.vpaidHandler.adUnit._iframe.contentWindow)for(var i=this.vpaidHandler.adUnit._iframe.contentWindow.document.scripts,n=0;n<i.length;n++)if(i[n].src.indexOf("z.moatads.com")>-1&&i[n].src.split("/").length>4&&e.push(i[n].src.split("/")[3]),i[n].src.indexOf("sc.iasds01.com")>-1){var r=i[n].src.match(/EntityId=([^&]*)/);2===r.length&&t.push("ias-"+r[1])}var s=""+this.tag.dp+(e.length>0?e.join("_"):"")+(t.length>0?t.join("_"):"")+(this.isGoogleIframe?"_ggl":"")+(this.isUnfriendlyIframe?"_ui":"");s!==this.tag.dp&&f.logToBI(this.vpaidLog,"vpaidFamily",{family:s})}},{key:"resizeAd",value:function(e,t,i){if(!this.stopped)try{(void 0==e||isNaN(parseInt(e)))&&(e=!1),(void 0==t||isNaN(parseInt(t)))&&(t=!1);var n=0,r=0;if(!e&&!t)return void this.debugTracker.error("resize","No `height` or `width` specified!");if(t&&e)r=this._convertSizeFromNumberToPixels(t),n=this._convertSizeFromNumberToPixels(e);else{var s;i=i&&i.split(":").length>1?i:this.store.get("playerAspectRatio");var o=i.split(":");e?(s=parseInt(o[1])/parseInt(o[0]),n=this._convertSizeFromNumberToPixels(e),r=this._convertSizeFromNumberToPixels(Math.floor(parseFloat(n)*s))):(s=parseInt(o[0])/parseInt(o[1]),r=this._convertSizeFromNumberToPixels(t),n=this._convertSizeFromNumberToPixels(Math.floor(parseFloat(r)*s)))}if(n&&r){var a=parseFloat(n),d=parseFloat(r);this.localTarget.style.width=n,this.localTarget.style.height=r,this.localTarget.setAttribute("width",a),this.localTarget.setAttribute("height",d),this.nonVideoVpaid||(this.localVideo.style.width=n,this.localVideo.style.height=r,this.localVideo.setAttribute("width",a),this.localVideo.setAttribute("height",d)),this.clickableTarget&&(this.clickableTarget.style.width=n,this.clickableTarget.style.height=r,this.clickableTarget.setAttribute("width",a),this.clickableTarget.setAttribute("height",d)),this.isMultiAdsActive&&(!this.isVerticalVideoSupported||d<a?(this.store.set("width",a.toString()),this.store.set("height",d.toString()),this.store.emit("resizeVpaidWrapper",{
width:a,height:d})):this.isVertical=!0),this.isVForceActive&&this.vpaidHandler.resizeAd(a,d,this.config.viewMode||"normal",i)}this.blockBringToFront&&(this.blockBringToFront=!1,this.bringToFront())}catch(e){this.debugTracker.error("resize","Resizing component failed!")}}},{key:"_convertSizeFromNumberToPixels",value:function(e){var t=e+"";return t.search(/px$/g)<0&&(t+="px"),t}},{key:"getCurrentVolume",value:function(){return this.VideoControls?this.VideoControls.getValueFromControlsState("volume"):this.adVolume}},{key:"_onSoundChange",value:function(e){this.vpaidHandler&&this.vpaidHandler.onMuteChanged&&this.vpaidHandler.onMuteChanged(e)}},{key:"_pushConversionDataToWaterfallLog",value:function(){if(this.wflog){var e=this.getVideoUrl();if(e){var t=this.store.get("wfLogUniqueVideoUrls_"+this.wflog.index)||[];t.indexOf(e)<0&&(t.push(e),this.wflog.push("uniqueVideoUrlsCounter",t.length),this.store.set("wfLogUniqueVideoUrls_"+this.wflog.index,t))}this.wflog.push("wfConversionsCounter",this.wflog.get("wfConversionsCounter",0)+1),this.wflog.sendDataOnConversion()}}},{key:"_pushUniqueAdvIdsToWaterfallLog",value:function(){if(this.wflog){var e=this.store.get("wfLogUniqueAdvIds_"+this.wflog.index)||[];e.indexOf(this.tag.advId)<0&&(e.push(this.tag.advId),this.wflog.push("uniqueAdvIdsCounter",e.length),this.store.set("wfLogUniqueAdvIds_"+this.wflog.index,e))}}},{key:"_appendVpaidCSS",value:function(){var e=this.tag.getValueByKey("vpdcss"),t=[];if(void 0!==e){for(var i in e){var n=null;if(n=this.localTarget.className.indexOf(i)>-1?this.localTarget:this.localTarget.querySelectorAll(i)[0])for(var r in e[i])n.style[r]=e[i][r];else t.push("No element matching "+i)}f.logToBI(this.vpaidLog,"appendVpaidCSS",{success:0===t.length,style:f.stringify(e),errors:t.join(",")})}}},{key:"toggleIframeContentDisplay",value:function(e){!this.stopped&&this.isMultiVpaidUnit&&this.toggleIframeContentDisplayActive&&this.vpaidHandler.toggleIframeContentDisplay&&this.vpaidHandler.toggleIframeContentDisplay(e)}},{key:"_sendOpp",value:function(e,t){if(!this.stopped&&this.opportunityManager){var i={};if(this.store.get("erronopp"))switch(e){case this.oppsID.adError:case this.oppsID.adErrorBeforeLoad:i.sdid=f.getIABErrorCode(t);break;case this.oppsID.adUnitLoadFailed:case this.oppsID.adloadedTimeout:case this.oppsID.adtoTimeout:case this.oppsID.globalTimeout:i.sdid=L.default.timeout;break;case this.oppsID.emptyVast:i.sdid=L.default.schemaValidationError;break;case this.oppsID.mediaFileNotSupported:i.sdid=L.default.mediaFileNotSupported}e===this.oppsID.vpaidProgress&&(i.sdid=t.sdid),i.vidCurrentTime=this.localVideo?this.localVideo.currentTime:void 0,this.opportunityManager.send(this.tag,e,this.playerDAST.get(),i)}}},{key:"getAdDuration",value:function(){var e=this;isNaN(this.localVideo.duration)?this.vpaidHandler&&this.vpaidHandler.getAdDuration(function(t,i){e._setVideoControlsDuration(i)}):this._setVideoControlsDuration(this.localVideo.duration)}},{key:"_setVideoControlsDuration",value:function(e){this.VideoControls&&this.VideoControls.setState({vidDuration:e})}},{key:"registerToVPAIDVideoTimeupdateEvent",value:function(){var e=this;if(this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement){var t=this.vpaidHandler.getVPAIDVideoElement();null!==t&&t.addEventListener("timeupdate",function(i){e._onTimeupdate(t)})}}},{key:"_onTimeupdate",value:function(e){this.workingVpaid&&e.currentTime>0&&this.VideoControls&&this.VideoControls.setState({preventAdTicker:!0,vidDuration:e.duration,vidCurrentTime:e.currentTime})}},{key:"_onSwitchFromCanvasToVideo",value:function(e){var t=this;e&&e.addEventListener("timeupdate",function(i){t._onTimeupdate(e)})}},{key:"getVpaidStatus",value:function(){return this.vpaidStatus.get()}},{key:"_sendFirstUnmuteOpp",value:function(){this._sendOpp(this.oppsID.adUnmuted)}},{key:"getPrice",value:function(e){var t=this.tag.vpaidWrapperData&&this.tag.vpaidWrapperData.vastPrice?this.tag.vpaidWrapperData.vastPrice:this.tag.price;return t||void 0!==this.defaultTagPrice?e?f.encodeText(t):t:""}},{key:"_getAdSettingValue",value:function(e){return this.adSettings&&this.adSettings.hasOwnProperty(e)?this.adSettings[e]:void 0}},{key:"_extractWinningPrice",value:function(){if(this._getAdSettingValue("extwnprc")){var e=this._getAdSettingValue("wnprcfld"),t=this._getAdSettingValue("blkemptywp"),i=this.pixelManager.extractWinningPrice(e,t);i&&(f.logToBI(this.vpaidLog,"winningPrice",i,!1,!1),this.playerDAST.set({wp:i}))}}},{key:"getVpaidData",value:function(e){return this.stopped?{}:(this.tag.nas&&(this.tag.nas.isClickable=void 0!==this.tag.nas.isClickable?this.tag.nas.isClickable:this._isNativeAdSettingsClickable()),{adjacency:this.tag.adjacencyAd,advId:this.tag.advId,backfill:this.tag.priority===this.bfPriority,brand:this.tag.brand,campaignId:this.tag.campaignId,costModel:this.tag.cstmdl,cpcv:this.tag.isCPCV,creativeId:this.tag.creativeId,dp:this.tag.dp,itemType:this.tag.itemType,lineItem:this.tag.lineItemId,nonVideoVpaid:this.nonVideoVpaid,price:this.getPrice(e),pubId:this.tag.pubId,replayable:this.isReplayable,rv:this.tag.requiredViewability,singleAd:this.tag.singleAd,vpaidStatus:this.vpaidStatus.get(),wfSequence:this.tag.sequenceId,wfTagId:this.tag.wfIndex,adNativeSettings:this.tag.nas,adWidth:this.playerDAST.getByKey(T.DASTKEYSMAP.vastWidth),adHeight:this.playerDAST.getByKey(T.DASTKEYSMAP.vastHeight),supportVerticalVideo:this.isVerticalVideoSupported,vastClickThruLink:this.clickThruUrl,eventTrackers:this._getUnitEventTrackers(),supportVideoCurrentTimeEvents:!(!this.vpaidHandler||!this.vpaidHandler.activeVideoElement),duration:this.vpaidHandler&&this.vpaidHandler.activeVideoElement?this.vpaidHandler.getActiveVideoElementDuration():null})}},{key:"_isNativeAdSettingsClickable",value:function(){var e=this.tag.nas.link||this.clickThruUrl;return void 0!==e&&""!==e}},{key:"_getUnitEventTrackers",value:function(){var e=this,t=this.store.get("untetrk")||[],i={};return t.forEach(function(t){var n=e.pixelManager.getPixels(t);n.length>0&&(i[t]=n)}),i}},{key:"setDebugData",value:function(e){this.stopped||(this.tag.vpaidWrapperData.debugData=e)}},{key:"_onBuffering",value:function(){this._sendOpp(this.oppsID.buffering)}},{key:"_onBufferingEnd",value:function(){this._sendOpp(this.oppsID.bufferingEnded)}}]),t}(g.EventEmitter);t.default=q},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(5),d=r(a),l=i(10),u=r(l),c=i(1),h=n(c),p=i(31),f=(r(p),i(86)),v=r(f),m=i(85),g=r(m),y=i(27),_=r(y),b=i(20),w=r(b),k=i(18),A=n(k),T=i(131),C=r(T),E=-1,P=1,S=function(){function e(t){var i=this;s(this,e),this.store=t,this.store.set("waterfallFailsInARow",0),this.store.set("waterfallSuccessesInARow",0),this.store.set("waterfallIndex",P),this.encryptWaterfallResponse=this.store.get("encwfrs"),this.wfv=this.store.get("wfv"),this.requiredViewabilityFactor=this.store.get("rvfctr"),this.dynamicNoaopMaxValue=this.store.get("dnapmxvl"),this.retryOnFail=this.store.get("rtryonfl"),this.defaultTagPrice=this.store.get("dftgprc"),this.queueSize=this.store.get("queue_size")||10,this.wfSequences=[],this.fireWaterfallErrorPixels=h.shouldFirePixels(parseInt(this.store.get("frwferrpxls"))),this.fireEmptyWaterfallPassbackPixel=parseInt(this.store.get("frwfpssbckrpxl"));var n=this.store.get("drpbletps")||[],r=this.store.get("adTypesToDrop")||[];this.adsToDrop={};for(var o=0;o<n.length;o++)this.adsToDrop[n[o]]=r.indexOf(n[o])>-1;this.mimeEnum=[{id:5,mime:"application/javascript",video:!1},{id:8,mime:"video/x-ms-wmv",video:!0},{id:10,mime:"video/mp4",video:!0},{id:11,mime:"video/ogg",video:!0},{id:12,mime:"video/webm",video:!0}],this.creatives={},this.debugTracker=new d.default("WaterfallManager"),this.cachedTags=!1,this.cacheAge=0,this.staticWf=this.store.get("static_schedule"),this.shouldRun=function(){return!0},this._runBindedWaterfallTicker=this._runWaterfallTicker.bind(this),this._roundTripAverageDuration=0,this._roundTripsCount=0,this._initDynamicWfsValues(),this.store.get("wf_manual")||this.startNextWfTimeout(),this.store.on("stop",this._stop.bind(this)),this.store.on("pausePlayer",this._stop.bind(this)),this.store.on("queueStatusChanged",this._onQueueStatusChanged.bind(this));var a=this.store.get("wf_dynmc_ps");a&&(this.store.on("contentPaused",this._stop.bind(this)),this.store.on("contentResumed",this.startNextWfTimeout.bind(this))),this.isFirstRun=!0,this.igonreWfWhenHidden=this.store.get("ignrwfhdn"),this.lineitemMaxFails=this.store.get("mxlifls"),this._registerQueueEvent(),this.maxAllowedEmptyWaterfalls=this.store.get("mxemptwf"),this.store.set("emptyWaterfallsInARow",0),this.supportNonVideoVpaid=this.store.get("sprtnnvidvpd")&&this.store.get("mltads"),this.store.on("startWf",function(){i.store.set("dlywf",!1),i.runWaterfall("startWf")}),this.wfParamsFromUnit={}}return o(e,[{key:"_shouldDelayWaterfall",value:function(){return this.store.get("dlywf")}},{key:"startNextWfTimeout",value:function(){var e=this;this.wfInterval&&clearTimeout(this.wfInterval),this._calcDynamicWfsValues(),this._delayBetweenWfs>0?this.wfInterval=setTimeout(function(){e._runBindedWaterfallTicker()},this._delayBetweenWfs):this.store.emit("closePlayer")}},{key:"_initDynamicWfsValues",value:function(){this.maxTimeBetweenWaterfalls=this.store.get("mxtmbtwfs"),this.minTimeBetweenWaterfalls=this.store.get("mntmbtwfs"),this.defaultTimeBetweenWaterfalls=this.store.get("time_between_waterfall"),this.timeBetweenWfFunc=this.store.get("tmbtwfs"),"function"!=typeof this.timeBetweenWfFunc&&(this.timeBetweenWfFunc=void 0),this.minTimeBetweenWfFunc=this.store.get("mntmbtwfsf"),"function"!=typeof this.minTimeBetweenWfFunc&&(this.minTimeBetweenWfFunc=void 0),this.defaultMinTimeBetweenWf=this.store.get("mintimwf")||5e3,this.store.set("dynamicWf.lastDelayBetweenWfs",-1),this.store.set("dynamicWf.currentDelayBetweenWfs",-1),this._calcDynamicWfsValues()}},{key:"_calcDynamicWfsValues",value:function(){this._delayBetweenWfs=1e3*this._calcDelayBetweenWf(),this._delayBetweenWfs>0&&(this._minTimeBetweenWf=this._calcMinDelayBetweenWfs()),this._saveDynamicWfsValues()}},{key:"_calcDelayBetweenWf",value:function(){var e=E;if(this.timeBetweenWfFunc)try{e=this.timeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(t){e=this.defaultTimeBetweenWaterfalls}return e>this.maxTimeBetweenWaterfalls?e=E:e<this.minTimeBetweenWaterfalls&&(e=this.minTimeBetweenWaterfalls),e}},{key:"_calcMinDelayBetweenWfs",value:function(){var e=this.defaultMinTimeBetweenWf;if(this.minTimeBetweenWfFunc)try{e=this.minTimeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(t){e=this.defaultMinTimeBetweenWf}return e}},{key:"_saveDynamicWfsValues",value:function(){this.store.set("dynamicWf.lastDelayBetweenWfs",this.store.get("dynamicWf.currentDelayBetweenWfs")),this.store.set("dynamicWf.currentDelayBetweenWfs",this._delayBetweenWfs)}},{key:"_registerQueueEvent",value:function(){var e=this.store.get("run_wf_when_empty");e&&this.store.on("playFromEmptyQueue",this.runWaterfall.bind(this,"queueEmpty"))}},{key:"_isInIdleMode",value:function(){return this.store.get("isIdleMode")}},{key:"_runWaterfallTicker",value:function(){this.startNextWfTimeout(),this.runWaterfall("interval")}},{key:"init",value:function(e,t){this.creatives=e,this.store.set("creatives",e),this.adParams=t,this.supportNonVideoVpaid&&w.default.selectValidSize(this.store),this._shouldRunWaterfallOnInit()&&this.runWaterfall("run_wf_on_init")}},{key:"_shouldRunWaterfallOnInit",value:function(){return this.store.get("run_wf_on_init")}},{key:"_serveStaticWf",value:function(e){this._getRollType();var t=0;"mid-roll"==this.currentRollType?t=1:"post-roll"==this.currentRollType&&(t=2);var i=new Function("try { return "+this.staticWf[t].ad_parameters+";} catch(e){}")();this._handleWaterfallSuccess(h.stringify(i.waterfall),e)}},{key:"runWaterfall",value:function(e){var t=this;if(!this.passedMaxEmptyWaterfalls()&&!this.store.get("first_look")&&("function"!=typeof this.shouldRun||this.shouldRun())&&!this._shouldDelayWaterfall()&&!this._isInIdleMode()){var i=this,n=(new Date).getTime(),r=this.lastRun?n-this.lastRun:this._minTimeBetweenWf;if(!(r<this._minTimeBetweenWf)){this.lastRun=n;var s=new v.default(this.store);if(this.staticWf)return void setTimeout(function(){t._serveStaticWf(s)},20);1===P&&h.reportByIndex("player_waterfall","firstwf",{type:"debug",message:"firstwf",fullPageUrl:this.store.get("fullPageUrl"),player_id:this.store.get("player_id")},this.store);var o=this.store.get("pstflrs")===!0,a=this.store.get("psthdrs")||"application/json";this.lastRun=n,s.requestTime=Date.now(),s.ignoredLineitems=[],s.push("reason",e),s.push("waterfallIndex",P),s.push("sinceLastWf",r),s.push("queueLength",this.store.get("queueLength")),s.push("vpaidReadyCount",this.store.get("vpaidReadyCount")),s.push("vpaidPendingCount",this.store.get("queueLength")-this.store.get("vpaidReadyCount")),s.push("failsInARow",this.store.get("waterfallFailsInARow")),s.push("successesInARow",this.store.get("waterfallSuccessesInARow")),s.push("lastDelayBetweenWfs",this.store.get("dynamicWf.lastDelayBetweenWfs")),s.push("currentDelayBetweenWfs",this.store.get("dynamicWf.currentDelayBetweenWfs")),s.push("emptyWaterfallsInARow",this.store.get("emptyWaterfallsInARow")),s.push("maxAllowedEmptyWaterfalls",this.maxAllowedEmptyWaterfalls),s.push("encryptedResponse",this.encryptWaterfallResponse),s.push("waterfallVersion",this.wfv),s.push("navigatorConnection",this.store.get("navigatorConnection"));var d=function(e,t){i._handleWaterfallError(e,s,t)},l=function(e,t,n){i._handleWaterfallSuccess(e,s,n)},c=this._generateWaterfallUrl(this.creatives,this._runMimeTypeCheck(),s);s.push("url",c);try{for(var p,f=c.split("?")[1].split("&"),m={},g=0;g<f.length;g++)p=f[g],m[p.split("=")[0]]=p.split("=")[1];s.push("urlParams",m)}catch(e){}if(s.push("noaop",this.isFirstRun?this.store.get("firstWaterfallNoaop"):this.creatives.NOAOP),c){if(this.adParams&&this.adParams.waterfall)window.setTimeout(this._handleWaterfallSuccess.bind(this,h.stringify(this.adParams.waterfall)),0);else{if(!o)return(0,u.default)(c,"",l,d,!0,!0,!0,5e3,a,this.retryOnFail),P++,this.store.set("waterfallIndex",P),void(this.isFirstRun&&(this.isFirstRun=!1));var y=this._buildPostData();s.push("postData",y),(0,u.default)(c,y,l,d,!0,!0,!0,5e3,a,this.retryOnFail),this.isFirstRun&&(this.isFirstRun=!1)}P++,this.store.set("waterfallIndex",P)}}}}},{key:"_buildPostData",value:function(){var e={fv:[]},t=this.store.get("sessionData");t&&(e.sd=t),this.encryptWaterfallResponse&&(e.en=1),e.wfv=this.wfv;var i=this.store.get("subUnitType");void 0!==i&&(e.subu=i);var n=this.store.get("lineItems")||[];if(n.length>0){var r=this;n.map(function(t){var i=r.store.get(t);e.fv.push({li:t,f:i.fails,fr:i.failsRow,c:i.conversions,t:i.tries})})}var s=this.store.getWfData();e.adv=s,!this.sentCookiesData&&this.store.get("EP_PLAYER")&&(e.ls=this.store.get("EP_PLAYER"),this.sentCookiesData=!0);var o=this.store.get("navigatorConnection")||{};e.cdl=o.downlink||0,e.cet=o.effectiveTypeId||0,e.ct=o.typeId||0,e.crt=o.rtt||0,e.csd=o.saveData===!0?1:0,e.q=this.queueStatus?this.queueStatus.items:[],e.qs=this.queueStatus?this.queueStatus.size:0,e.pq=this.queueStatus?this.queueStatus.prevItems:[],e.drp=btoa(h.stringify(this._getAdTypesToDrop()));var a=h.stringify(e);return a}},{key:"_getAdTypesToDrop",value:function(){var e=[];for(var t in this.adsToDrop)this.adsToDrop[t]&&e.push(t);return e}},{key:"_runMimeTypeCheck",value:function(){var e=document.createElement("video"),t=[];t.push(5);for(var i=0;i<this.mimeEnum.length;i++){var n=this.mimeEnum[i];n.video&&e.canPlayType(n.mime)&&t.push(n.id)}return e=void 0,t}},{key:"passedMaxEmptyWaterfalls",value:function(){return!!this.maxAllowedEmptyWaterfalls&&this.store.get("emptyWaterfallsInARow")>this.maxAllowedEmptyWaterfalls}},{key:"_sendWaterfallResponsePixel",value:function(e){if(this.fireWaterfallErrorPixels){var t=h.createPixelParams(e,this.store);h.sendPixel(t)}}},{key:"_handleWaterfallSuccess",value:function(e,t,i){if(this.store.incr("emptyWaterfallsInARow"),!this.igonreWfWhenHidden){if(this._addRoundTripDuration(),!e)return this.debugTracker.info("runWaterfall","Empty Waterfall!"),this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),this._handleWaterfallError("empty-response",t,i),void this._sendWaterfallResponsePixel(A.emptyWFResponse);this.encryptWaterfallResponse&&(e=this._decodeText(e));var n=new Function("try { return "+e+";} catch(e){}")();if(!(n&&n.tags&&n.tags.length)){var r=n&&n.tags?"Failed to decode empty server response":"Failed to decode server response!";return this.debugTracker.warn("runWaterfall",r),this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),this._handleWaterfallError("no-tags",t,i),void this._sendWaterfallResponsePixel(A.noTagsInWFResponse)}this.store.set("emptyWaterfallsInARow",0),this.debugTracker.info("Waterfall number "+(t.index+1)+" received",n.tags,{color:"#D15EFF"}),this.store.set("sessionData",n.sd),n&&n.pixel_piggies&&this._firePiggies(n.pixel_piggies);var s=[],o=!1;for(var a in n.tags){var d=n.tags[a];if(d.url||d.vast){var l=d.t===w.default.type;if(d.score=-1,d.waterfallTagId=a,d.created=(new Date).getTime(),d.dp=(d.lp&&d.lp.length>0&&d.lp[0]?d.lp[0]:"").replace(/http:\/\/|.com|https:\/\/|.com/g,"")||"na",d.dpFull=d.lp&&d.lp.length>0?d.lp[0]:"na",d.conversionPixels=d.conversionPixels||[],d.ts=Date.now(),d.wfIndex=t?t.get("waterfallIndex",-1):P,d.url=d.url?h.replaceMacros(d.url,this.store,l):"",d.vast=d.vast?h.replaceMacros(d.vast,this.store):"",d.pixel=d.pixel?this._getPixel(d.pixel):"",d.eventTrackers=d.etrk?d.etrk:{},d.brand=d.brand||"",d.dsm=d.dsm||{},d.getValueByKey=function(e,t){return this.dsm.hasOwnProperty(t)?this.dsm[t]:e.get(t)}.bind(d,this.store),d.rollType=this.currentRollType,d.pubId=this.pubid,d.tagId=this.tagid,d.isRon=this.isRon,d.cstmdl=d.cstmdl||-1,d.singleAd=1===d.sa,d.adjacencyAd=1===d.adjac,this._shouldDropAd(d))continue;void 0!==this.defaultTagPrice&&(d.price=d.price||this.defaultTagPrice);var u=d.pixel.match("cirid=([^&]*)");if(u&&u.length&&(d.cirid=u[1]),d.dast=d.pixel?this._getDastFromPixel(d.pixel):"",d.vidDast=d.pixel?this._getVidDastFromPixel(d.pixel):"",d.campaignId=this._getCampaignId(d.vidDast),d.lineItem=d.lineItemId||this._getDastVal(d.dast,"cicmp"),d.lineItem=d.lineItem.toString(),d.url&&0===d.url.indexOf("http:")&&h.shouldSecureWfUrl(this.store)&&(d.url=d.url.replace("http:","https:")),this._overrideParamsByDemand(d),this._decodeItemParams(d),this.requiredViewabilityFactor>0&&!d.requiredViewability&&(d.requiredViewability=this._drawRequiredViewabilityByFactor(d)),l){o=!0,t.push("tagResponse_adx",h.flattenObject(d)),d.wfStats=new g.default(this.store,P),this.store.emit("nonVideoItemInWaterfall",{item:d,wflog:t});continue}this._ignoreLineitem(d.lineItem)?(t.ignoredLineitems.push(d.lineItem),t.push("ignoreLineitems",t.ignoredLineitems),this.store.get(d.lineItem+".failsRow")?this.store.incr(d.lineItem+".failsRow"):this.store.set(d.lineItem+".failsRow",1)):s.push(d),this.store.get(d.lineItem)||this.store.set(d.lineItem,{failsRow:0,tries:0,conversions:0,fails:0}),d.lineItemStats=h.deepClone(this.store.get(d.lineItem))}}s.length>0?(this._pushTagsResponseToWaterfallLog(t,s),n.tags=s,n.data=new g.default(this.store,P),this.onWaterfallSuccess(n,t),t&&(t.push("duration",Date.now()-t.requestTime),t.push("response",e),t.push("tagsCount",s.length),t.push("success",!0),this._sendWfLog(t)),this.store.emit("waterfallData",n),this._logRetry(t,i,!0)):o||(this.debugTracker.error("runWaterfall","Failed to get any tags!"),this._handleWaterfallError("no-clean-tags",t,i))}}},{key:"_handlePassbackTrigger",value:function(e){1===e.get("waterfallIndex")&&(this.store.emit("emptyFirstWaterfall"),e.push("emptyFirstWaterfallPassback",!0),this._sendEmptyFirstWaterfallPassbackPixel())}},{key:"_sendEmptyFirstWaterfallPassbackPixel",value:function(){this.fireEmptyWaterfallPassbackPixel&&h.sendPixel(h.createPixelParams(A.passbackOnEmptyFirstWF,this.store))}},{key:"_shouldDropAd",value:function(e){for(var t in this.adsToDrop)if(this.adsToDrop[t]&&e.hasOwnProperty(t)&&e[t])return!0;return!1}},{key:"_logRetry",value:function(e,t,i){if(e&&t){var n=t.indexOf("rt=1")>-1;if(!n)return;var r=t.match(/prst=(.*?)(&|$)/);e.push("retry",!0),e.push("statusBeforeRetry",r&&r.length>1?r[1]:"0"),e.push("successOnRetry",i)}}},{key:"_drawRequiredViewabilityByFactor",value:function(e){var t=!!(h.getRandomInt(0,100)<=this.requiredViewabilityFactor&&e&&e.brand);return t&&(e.requiredViewabilityDrawn=!0),t}},{key:"_pushTagsResponseToWaterfallLog",value:function(e,t){e&&t.map(function(t,i){var n=Object.assign({},t);e.push("tagResponse_"+i,h.flattenObject(n))})}},{key:"_overrideParamsByDemand",value:function(e){this.store.get("ovrtgbydc")&&(e=Object.assign(e,e.getValueByKey("ovrdtag")))}},{key:"_sendWfLog",value:function(e){var t={wfRoundTripAverageDuration:this.store.get("performance.wfRoundTripAverageDuration"),performanceMeasurment:this.store.get("performance.performanceMeasurment")};e.push("performance",t),e.push("conversionsCount",this.store.get("conversionsCount")),e.push("unit",{width:this.store.get("width"),height:this.store.get("height")}),this.store.get("vForce")&&e.push("getAdData",this.store.get("getAdData"))}},{key:"_addRoundTripDuration",value:function(){var e=Date.now()-this.lastRun;this._roundTripAverageDuration=parseInt((this._roundTripAverageDuration*this._roundTripsCount+e)/(this._roundTripsCount+1)),this.store.set("waterfall_data.last_duration",e),this.store.set("waterfall_data.average_duration",this._roundTripAverageDuration),this._roundTripsCount++}},{key:"_ignoreLineitem",value:function(e){if(this.lineitemMaxFails>0){var t=this.store.get(e),i=t?t.failsRow:-1;return i>this.lineitemMaxFails}return!1}},{key:"_getVidDastFromPixel",value:function(e){var t=e.match('vid-dast=([^&|"]*)');return t&&t.length?t[1]:""}},{key:"_decodeItemParams",value:function(e){e.rpox=this._decodeValue(e.rpox),e.alfrox=this._decodeValue(e.alfrox),e.frox=this._decodeValue(e.frox),e.ex&&(e.crId=e.ex.ecrid,e.stId=e.ex.s,e.cmpgnId=e.ex.ecid,e.ex.b&&(e.brand=this.encryptWaterfallResponse?e.ex.b:this._decodeText(e.ex.b))),e.itemType=e.t}},{key:"_decodeValue",value:function(e){return this.encryptWaterfallResponse?e:(2530^e)/1e3}},{key:"_decodeText",value:function(e){for(var t,i=C.default.enc.Base64.parse(e),n=i.toString(C.default.enc.Utf8),r="",s="PlAyER",o=0;o<n.length;o++){t=o%s.length;var a=n[o].charCodeAt(0).toString(10),d=s[t].charCodeAt(0).toString(10),l=String.fromCharCode(a^d);r+=l}return r}},{key:"_firePiggies",value:function(e){var t=this.store.get("fire_piggies");if(t&&!(P>=5))for(var i=0;i<e.length;i++){var n=e[i];if(n.url){var r=h.setUrlPrefix(n.url);try{(new Image).src=r}catch(e){this.debugTracker.error("_fireIframePig - Malformed url!",e)}}}}},{key:"_fireIframePig",value:function(e){var t=document.createElement("iframe");t.src=e,t.style.display="none";var i=document.getElementsByTagName("body")[0];i||(i=document.getElementsByTagName("html")[0]),i||(i=document.getElementsByTagName("div")[0]),i?i.appendChild(t):this.debugTracker.warn("_fireIframePig","Failed to fire piggies.")}},{key:"_handleWaterfallError",value:function(e,t,i){this.store.incr("emptyWaterfallsInARow"),this._addRoundTripDuration(),t&&(this._logRetry(t,i,!1),t.push("duration",Date.now()-t.requestTime),t.push("error",e),t.push("success",!1),this._sendWfLog(t)),this.onWaterfallError(e),this._handlePassbackTrigger(t)}},{key:"_decideNoap",value:function(e){var t;if(this.isFirstRun)t=this.store.get("firstWaterfallNoaop");else if(this.dynamicNoaopMaxValue>0){var i=this.store.get("max_ready_vpaid")||0,n=this.store.get("vpaidReadyCount")||0;t=Math.min(this.dynamicNoaopMaxValue,i-n)}else t=e;return t||e}},{key:"_generateWaterfallUrl",value:function(e,t,i){var n=this.store.get("wf_base_path")||e.CM_DOMAIN;n+=/.*\/$/g.test(n)?"":"/",n=h.setUrlPrefix(n);var r={},s=!document.hidden,o=this._getRollType();if(!o)return"";var a=(new Date).getTimezoneOffset();a*=-1;var d=e.SORTORDERTYPE,l=this.store.get("ab_test"),u=this.store.get("mprdct");r.oid=e.OID,r.width=e.PLAYER_WIDTH||e["PLAYER-WIDTH"],r.height=e.PLAYER_HEIGHT||e["PLAYER-HEIGHT"],r.pubid=this.pubid||e.PUBID,r.tagid=this.tagid||e.TAGID,r.crid=this.store.get("creativeId")||"",r.noaop=this._decideNoap(e.NOAOP),r.sortOrderType=d,r.cb=(new Date).getTime(),r.mimes=t.join(","),r.isvideo=e.ISVIDEO,r.plmd=e.PLMD,r.mindur=e.MINDUR,r.maxdur=e.MAXDUR,r.minbr=e.MINBR,r.maxbr=e.MAXBR,r.st=h.getStreamType(o.roll_type),r.seq=P,r.pv=this.store.get("player_version")||999,r.pt=h.crc32(l||999),r.tz=a,r.viewable=s,r.ddast=this.store.get("auc_dast"),r.proto="2,3,5,6",this.store.get("dtagid")&&(r.dtagid=this.store.get("dtagid")),this.store.get("dpubid")&&(r.dpubid=this.store.get("dpubid")),l&&(r.abtst=l),"undefined"!=typeof u&&(r.mPre=u),r.encoded=1;var c=this.store.get("pstn")||1;r.pstn=c,e.CIRF&&(r.cirf=encodeURIComponent(decodeURIComponent(e.CIRF))),r.callback="",this.encryptWaterfallResponse&&(r.en=1),r.wfv=this.wfv,r.cdb=this.store.get("cdb")||"",r.gdprApplies=this.store.get("gdprApplies")||!1,r.amp=this.store.get("isAmp")?"1":"0",r.qsz=this.queueSize,r.ft=this.store.get("frameType"),r.pb="yes"===this.store.get("isPrivateBrowsing")?"1":"0",r=Object.keys(Object.assign(r,this.wfParamsFromUnit)).map(function(e){return e+"="+r[e]});var p=this.store.get("wf_xrta");p&&r.push(p);var f=this.store.get("wf_path")||e.SERVICE;return window.lastWfUrl=n+f+"?"+r.join("&"),this.wfSequences.indexOf(P)>-1&&i.push("duplicateSequence",P),this.wfSequences.push(P),n+f+"?"+r.join("&")}},{key:"_getPixel",value:function(e){var t=e.split(/<script.*?src="(.*?)"/g);if(1==t.length){if(t=e.split(/<script.*?src='(.*?)'/g),t[1])return t[1].replace(/^http(s:|:)/g,"")}else if(t[1])return t[1].replace(/^http(s:|:)/g,"");return e.replace(/^http(s:|:)/g,"")}},{key:"_getDastFromPixel",value:function(e){var t=e.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=t.length)return"";var i=t[1].split(/\?|&/gi);for(var n in i)if(i[n]){var r=i[n].split(/=(.+)?/gi,2);if(2==r.length&&"dast"==r[0])return r[1]}return""}},{key:"onWaterfallError",value:function(){}},{key:"onWaterfallSuccess",value:function(){}},{key:"SetWaterfallError",value:function(e){this.onWaterfallError=e}},{key:"SetWaterfallSuccess",value:function(e){this.onWaterfallSuccess=e}},{key:"SetShouldRun",value:function(e){this.shouldRun=e||function(){}}},{key:"GetCounter",value:function(){return P}},{key:"_getRollType",value:function(){var e,t=this.store.get("contentSchedule")||{},i=null,n=Object.keys(t)||[];return 1===P?(e=n[0],i=t[e]):n.length>0&&(e=n[1],i=t[e]),this.currentRollType=i?i.roll_type:"",this.pubid=i?i.pubid:0,this.tagid=i?i.tagid:0,i}},{key:"_getDastVal",value:function(e,t){var i="";try{i=atob(e)}catch(e){return}var n=i.match(t+"=([^&]*)");return n&&n.length>1?n[1]:""}},{key:"_stop",value:function(){clearTimeout(this.wfInterval)}},{key:"start",value:function(){this.startNextWfTimeout()}},{key:"stop",value:function(){this._stop()}},{key:"_getCampaignId",value:function(e){try{var t=new _.default(e,this.store),i=t.fetchResults();return i&&i.cipid?i.cipid:-1}catch(e){return-1}}},{key:"_onQueueStatusChanged",value:function(e){var t=function(e){var t=Object.assign({},e);return t.aid=t.cstmdl=t.dp=t.pid=void 0,""===t.br&&(t.br=void 0),t};this.queueStatus={size:e.size,prevItems:e.previousQueue.map(t),items:e.items.map(t)}}},{key:"dropAds",value:function(e){this.adsToDrop.hasOwnProperty(e)&&!this.adsToDrop[e]&&(this.adsToDrop[e]=!0)}},{key:"addWfParameter",value:function(e,t){void 0!==t&&(this.wfParamsFromUnit[e]=encodeURIComponent(t))}},{key:"updateWfParameter",value:function(e,t){this.addWfParameter(e,t)}},{key:"removeWfParameter",value:function(e){this.wfParamsFromUnit[e]&&(this.wfParamsFromUnit[e]=void 0,delete this.wfParamsFromUnit[e])}}]),e}();t.default=S},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),a=n(o),d=function(){function e(t,i){r(this,e),this.id=Date.now()+"_"+a.generateGuid(20),this.index=i,this.store=t,this.vpaidsCount=0,this.reportedVpaidsCount=0,this.success=0,this.fails=0,this.isSuccessed=!1}return s(e,[{key:"increaseVpaidsCount",value:function(){this.vpaidsCount++}},{key:"increaseSuccess",value:function(){this.success++,this._update()}},{key:"increaseFailure",value:function(){this.fails++,this._update()}},{key:"_update",value:function(){this.reportedVpaidsCount++,this.isSuccessed||(1===this.success?(this.store.incr("waterfallSuccessesInARow"),this.store.set("waterfallFailsInARow",0),this.isSuccessed=!0):this.reportedVpaidsCount===this.vpaidsCount&&(this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0)))}},{key:"getData",value:function(){return{id:this.id,index:this.index,allVpaidsReported:this.vpaidsCount===this.reportedVpaidsCount,wf_sr:this.store.get("waterfallSuccessesInARow"),wf_fr:this.store.get("waterfallFailsInARow")}}}]),e}();t.default=d},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(1),d=n(a),l=0,u=1e4,c=function(){function e(t){var i=this;r(this,e),this.index=l++,this.numberOfConnectedVpaids=0,this.dataChanged=!0,this.store=t,this.created=Date.now(),this.data={_id:d.generateGuid(10),player_id:this.store.get("player_id"),isMobile:this.store.get("isMobile"),created:(new Date).toISOString(),unitType:this.store.get("unit_type"),fullPageUrl:this.store.get("fullPageUrl"),updatesCount:0,taboolaVpaid:this.store.get("istblvpd")},this.sendDataInterval=setInterval(function(){i.dataChanged&&i._sendData()},u)}return o(e,[{key:"push",value:function(e,t){this.data.hasOwnProperty(e)&&!this._hasValueChanged(this.data,e,t)||(this.dataChanged=!0),this.data[e]=t}},{key:"_hasValueChanged",value:function(e,t,i){if("object"!==("undefined"==typeof i?"undefined":s(i)))return e[t]!==i;if(Array.isArray(i)){for(var n=0;n<i.length;n++)if(e[t].indexOf(i[n])<0)return!0;return!1}for(var r in i)if(this._hasValueChanged(this.data[t],r,i[r]))return!0;return!1}},{key:"get",value:function(e,t){return this.data.hasOwnProperty(e)?this.data[e]:t}},{key:"_sendData",value:function(){this.data&&(this.data.updatesCount++,
d.reportByIndex("player_waterfall","WfLog",this.data,this.store),this.dataChanged=!1)}},{key:"sendDataOnConversion",value:function(){var e=this;setTimeout(function(){e._sendData()},2e3)}},{key:"increaseNumberOfConnectedVpaids",value:function(){this.numberOfConnectedVpaids++}},{key:"complete",value:function(){0==--this.numberOfConnectedVpaids&&(this._sendData(),this.data=this.store=void 0,this.sendDataInterval=clearInterval(this.sendDataInterval))}}]),e}();t.default=c},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(1),d=r(a),l=i(5),u=n(l),c=void 0,h=function(){function e(t,i){return s(this,e),c?c:(this.debugTracker=new u.default("ClickThroughHandler"),this.store=t,this.ovaMediaPlayer=i,this.isMultiAdsActive=this.store.get("mltads"),void(c=this))}return o(e,[{key:"invokeClick",value:function(e){this.isMultiAdsActive||this.store.set("forcePause",!1),e&&e.url&&(e.playerHandles&&e.url&&this._openClickThroughUrl(e.url),this.ovaMediaPlayer.options.onAdClick(this.ovaMediaPlayer,this,e.url))}},{key:"_openClickThroughUrl",value:function(e){return this.debugTracker.info("Opening Url","Opening url: "+e),e=d.replaceMacros(e,this.store),this.store.get("isInApp")&&window.taboolaMobile&&window.taboolaMobile.getSupportedFeatures&&window.taboolaMobile.getSupportedFeatures().VideoClick?void window.taboolaBridge.emit("videoClick",e):void window.open(e)}}]),e}();t.default=h},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e,t,i){u.indexOf(e)>-1||u.push(e)}function s(e,t,i){u.indexOf(e)>-1||u.push(e)}function o(e){var t=l.crc32(e);u.indexOf(t)>-1||c.push(e)}function a(e,t,i,n){var r=l.crc32(e),s=r+":"+t;return h.indexOf(s)>-1?void l.reportByIndex("player_waterfall","doubleOppsPerVidDast",{crcVidDast:r,oppsID:t,tagItem:l.stringify(i)},n):void h.push(s)}Object.defineProperty(t,"__esModule",{value:!0}),t.reportOppsPerVidDastDuplications=t.reportCleanPixel=t.reportVast=t.reportPixel=void 0;var d=i(1),l=n(d),u=[],c=[],h=[];t.reportPixel=r,t.reportVast=o,t.reportCleanPixel=s,t.reportOppsPerVidDastDuplications=a},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.get("dsm")||{},r=n.bl||[],s=i.concat(r),o=!1;return s.map(function(t){t.indexOf(e)!==-1&&(o=!0)}),o};var i=[".rtbauction.com","video.leadzu.com"]},function(e,t){"use strict";function i(e,t){function i(e,i){var r=n(e,t),s=n(i,t);return r>s?1:-1}var r=e.sort(i);return r}function n(e,t){var i=0,n=s(e.wfIndex),o=s(e.waterfallTagId),a=s(e.cpmFloor),d=s(e.fillrate),l=e.getValueByKey("scoreBoost")||0,u=r(e.type)||1,c={wg:n,wi:o,fr:d,cf:a,mt:u,advb:l};e.scoreSummary=c;var i=1,h=t.get("qsrtscr");if(h&&"function"==typeof h)try{i=h(c,e,t)}catch(e){i=999999}return e.score=i,i}function r(e){return"flash"===e?1:"javascript"===e?2:3}function s(e){return e=e||0,parseInt(e)}e.exports={sort:i}},function(t,i,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},c=n(33),h=s(c),p=n(68),f=s(p),v=n(1),m=r(v),g=function(t){function i(e,t,n){o(this,i);var r=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t,n));return r._initVpaid(e),setTimeout(e.onReady,2),r}return d(i,t),l(i,[{key:"resumeAd",value:function(){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"resumeAd",this).call(this,this.adRestarted)}},{key:"setAdVolume",value:function(e){this.store.get("frcvlm")&&(this.video.volume=e,this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{dispatcher:this})),u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setAdVolume",this).call(this,e)}},{key:"onMuteChanged",value:function(e){this.isMuted=e}},{key:"_initVpaid",value:function(e){this.pauseVideoProtection=this.store.get("pusvidprtctn"),this.adLoaded=!1,this.callIMAApi=void 0}},{key:"_hookIMA",value:function(){this.imaApi=new f.default(this.adUnit._iframe,this.store,this.vpaidLog),this.imaApi.listenToMessages(),this.callIMAApi=this.imaApi.callApi.bind(this.imaApi)}},{key:"_onBindIframe",value:function(e){this._soundProtection(this.video),this._blockDOMObjectInWin(e.contentWindow)}},{key:"_soundProtection",value:function(e){var t=this;e.addEventListener("volumechange",function(){t.adLoaded&&t.isMuted&&0!=e.volume&&t.beacon.dispatchEvent(t.vpaidEvents.SoundViolation,{vol:e.volume}),e.volume!==t.volume&&(m.logToBI(this.vpaidLog,"soundProtection",{selfSound:t.volume,videoSound:e.volume}),e.volume=t.volume)})}},{key:"_blockDOMObjectInWin",value:function(e){var t="window.navigator.__defineGetter__('plugins', function () { return []; });",i="\n        "+(this.store.get("jsnoflshdtct")?t:"")+'\n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "_data",\n            Object.getOwnPropertyDescriptor(\n                HTMLObjectElement.prototype,\n                "data"\n            )\n        );\n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "data", {\n                set : function(val){\n                    console.log(\'HTMLObjectElement block\');\n                    return;\n                }\n            }\n        );';try{m.injectResource(e,i)}catch(e){console.log(e)}}},{key:"_onSafeCallAdError",value:function(t){this._onAdError(e)}}]),i}(h.default);i.default=g},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},u=i(33),c=r(u),h=i(1),p=n(h),f=function(e){function t(e,i,n){s(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n));return r._initVpaid(e),setTimeout(e.onReady,2),r}return a(t,e),d(t,[{key:"resumeAd",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resumeAd",this).call(this,this.video.useResumeCallback&&this.video.useResumeCallback()||this.adRestarted)}},{key:"startAd",value:function(){this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.emitStartAd&&this.video.emitStartAd(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startAd",this).call(this)}},{key:"setAdVolume",value:function(e,i){this.video.mutedChangeByUserGesture=i,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setAdVolume",this).call(this,e)}},{key:"isReplayable",value:function(){return this.video&&!this.video.forceCanvas&&""!==this._getVideoSrc(this.video)}},{key:"removeClickableTarget",value:function(){this.isIOS&&this.clickableTarget&&this.clickableTarget.parentNode.removeChild(this.clickableTarget)}},{key:"_initVpaid",value:function(e){this.pauseVideoProtection=this.store.get("pusvidprtctn")&&!this.isCanvasMpeg,this.store.get("sprssviderr")&&this.video.supressErrorEvents();var t=this.store.get("ua");this.isIOS="iOS"===t.os.name,this.clickableTarget=e.clickableTarget,this.video.muted=!0,this.video.setAttribute("playsinline",""),this.useCanvasMpeg=this.store.get("uscnvsmpg")||!1,this.hasAutoPlay=!this.video.forceCanvas||!1,this.isCanvasMpeg=this._decideCanvas()||this.video.forceCavnas,this.canvasReady=!1,this.isCanvasMpeg&&this._initCanvas(e),p.logToBI(this.vpaidLog,"vpaidInit",{hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg||!1,forceCavnas:this.store.get("forcecnvsmpg"),autoplayDetectorResponse:this.store.get("autoplayDetectorResponse")})}},{key:"_decideCanvas",value:function(){if(!this.store.get("uscnvsmpg"))return!1;var e=this.store.get("dsm")||{},t=e.mobAp||[],i=this.tag.advId;if(t.indexOf(i)>-1)return p.logToBI(this.vpaidLog,"canvasOptOutByAdvId",{advId:i}),!1;var n=this.store.get("forcecnvsmpg")||!1;return this.useCanvasMpeg&&!this.hasAutoPlay||n}},{key:"_initCanvas",value:function(e){var t=this;this.playerDAST.set({cnv:!0}),this._onSwitchFromCanvasToVideo=e.onSwitchFromCanvasToVideo,this.video.addEventListener("canvasReady",function(){}),this.video.addEventListener("canvasPlay",function(){t.beacon.dispatchEvent(t.vpaidEvents.AdStarted)}),this.video.addEventListener("canvasRemoved",function(e){t.playerDAST.set({ctv:!0}),t.newVidCreated=!0,p.logToBI(t.vpaidLog,"canvasToVideo",{newVidCreated:!0}),e.data.videoElement.addEventListener("ended",function(){t.beacon.dispatchEvent(t.vpaidEvents.AdVideoComplete)}),t._onSwitchFromCanvasToVideo&&t._onSwitchFromCanvasToVideo(e.data.videoElement)}),this.video.addEventListener("canvasEnded",function(){t._allEventsHandler(t.vpaidEvents.AdVideoComplete,[])})}},{key:"_onBindIframe",value:function(e){this._unmuteHook()}},{key:"_unmuteHook",value:function(){this.store.get("mtdhkactv")&&this.video.hookMutedProperty()}},{key:"_onAdImpression",value:function(){var e=this;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onAdImpression",this).call(this),this.canvasLoadedOnImpression=!0,this._isCanvasLoaded()||(this.canvasLoadedOnImpression=!1,this.video.addEventListener("canvasReady",function(){e.beacon.dispatchEvent(e.vpaidEvents.AdImpression,[])}))}},{key:"_isCanvasLoaded",value:function(){return!this.video.forceCanvas||this.video.isCanvasLoaded&&this.video.isCanvasLoaded()}},{key:"_dispatchAdImpression",value:function(){return this.canvasLoadedOnImpression}},{key:"_resizeAd",value:function(e){this.stopped||this.video.resize&&this.video.resize(e)}},{key:"_stopAd",value:function(){this.stopped||(this.video.destroy(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_stopAd",this).call(this))}}]),t}(c.default);t.default=f},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},l=i(34),u=n(l),c=function(e){function t(e,i,n){r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n));return window.setTimeout(e.onReady,0),o}return o(t,e),a(t,[{key:"startAd",value:function(){this.video.play(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startAd",this).call(this)}},{key:"_onCanPlay",value:function(){this.playerReady||this.video.pause(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onCanPlay",this).call(this)}},{key:"_onPlay",value:function(){this.startAdFired&&d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onPlay",this).call(this,this.playerReady,200)}},{key:"_onClickThru",value:function(){this.stopped||(this.store.set("forcePause",!1),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onClickThru",this).call(this,this.adPaused))}},{key:"isReplayable",value:function(){return!0}},{key:"dontDie",value:function(){this.stayAlive=!0}}]),t}(u.default);t.default=c},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},u=i(34),c=r(u),h=i(1),p=n(h),f=function(e){function t(e,i,n){s(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n));return r._initVpaid(e),window.setTimeout(e.onReady,0),r}return a(t,e),d(t,[{key:"resizeAd",value:function(e,i,n,r){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resizeAd",this).call(this,e,i,n,r),this.video.resize&&this.video.resize(e,i,r)}},{key:"stopAd",value:function(){this.stopped||(this.timeUpdateInterval=clearTimeout(this.timeUpdateInterval),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stopAd",this).call(this))}},{key:"_createBindedCallback",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createBindedCallback",this).call(this),this._bindedOnPlaying=this._onPlaying.bind(this)}},{key:"_prepareVideoTag",value:function(){this.stopped||(this.video.muted=!0,this.video.setAttribute("playsinline",""),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_prepareVideoTag",this).call(this))}},{key:"_connectToVideoTag",value:function(){this.stopped||(l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_connectToVideoTag",this).call(this),this.video.addEventListener("playing",this._bindedOnPlaying,!0),this.isIOS&&this.clickableTarget&&this.clickableTarget.addEventListener("click",this._bindedOnClickThru,!0))}},{key:"_disconnectFromVideoTag",value:function(){this.video.removeEventListener("playing",this._bindedOnPlaying,!0),this.isIOS&&this.clickableTarget&&this.clickableTarget.removeEventListener("click",this._bindedOnClickThru,!0)}},{key:"_loadVideoTagSources",value:function(){this.stopped||(this._sortMediaFiles(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_loadVideoTagSources",this).call(this))}},{key:"_onPlaying",value:function(){this.stopped||(this.eventsToFire.adImpression&&(this.adPaused=!1,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_setInteractiveAdsIsPaused",this).call(this)),p.logToBI(this.vpaidLog,"videoPlaying",{vidCurrentTime:this.video.currentTime}))}},{key:"_onPlay",value:function(){var e=this;if(!this.stopped){if(!this.video.forceCanvas&&this.store.get("dataSaverDetected")||this.video.play(),this.startAdFired)return this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),!0;this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onPlay",this).call(this,!0,2e3),this.timeUpdateInterval=setInterval(function(){e.stopped||e._onTimeUpdate()},250)}}},{key:"_onPlayerError",value:function(){this.isCanvasMpeg||l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onPlayerError",this).call(this)}},{key:"_onClickThru",value:function(){if(event.preventDefault(),event.stopPropagation(),!this.stopped){if(this.isIOS){var e=(new Date).getTime();if(null!==this.lastClickTime&&e-this.lastClickTime<=100)return;this.lastClickTime=e}l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onClickThru",this).call(this,this.adPaused||this.store.get("dataSaverDetected")&&0===this.video.currentTime)}}},{key:"isReplayable",value:function(){return!this.video.forceCanvas}},{key:"_initVpaid",value:function(e){var i=this,n=this.store.get("ua");this.videoLength=e.extra.duration||30,this.clickableTarget=e.clickableTarget||null,this.useCanvasMpeg=this.store.get("uscnvsmpg")||!1,this.hasAutoPlay=!this.video.forceCanvas||!1,this.tag=e.tag,this.isCanvasMpeg=this._decideCanvas()||this.video.forceCavnas,this.lastClickTime=null,this.isIOS="iOS"===n.os.name,this.isCanvasMpeg?(this.playerDAST.set({cnv:!0}),this._onSwitchFromCanvasToVideo=e.onSwitchFromCanvasToVideo,this.video.addEventListener("canvasReady",function(){i.stopped||i._fireAdLoaded()}),this.video.addEventListener("canvasRemoved",function(e){i.playerDAST.set({ctv:!0}),p.logToBI(i.vpaidLog,"canvasToVideo",{newVidCreated:!0}),i.adPaused=i.video.paused,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_setInteractiveAdsIsPaused",i).call(i),i._onSwitchFromCanvasToVideo&&i._onSwitchFromCanvasToVideo(e.data.videoElement)})):setTimeout(this._fireAdLoaded.bind(this),this.tag.getValueByKey("vidfkadldt")),p.logToBI(this.vpaidLog,"vpaidInit",{hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg||!1,forceCavnas:this.store.get("forcecnvsmpg")})}},{key:"_decideCanvas",value:function(){if(!this.store.get("uscnvsmpg"))return!1;var e=this.store.get("dsm")||{},t=e.mobAp||[],i=this.tag.advId;if(t.indexOf(i)>-1)return p.logToBI(this.vpaidLog,"canvasOptOutByAdvId",{advId:i}),!1;var n=this.store.get("forcecnvsmpg")||!1;return this.useCanvasMpeg&&!this.hasAutoPlay||n}},{key:"_sortMediaFiles",value:function(){var e=this.playerWidth;this.mediaFiles.sort(function(t,i){var n=Math.abs(e-t.width),r=Math.abs(e-i.width);return n-r}).sort(function(e,t){return e.bitRate-t.bitRate})}},{key:"_resizeAd",value:function(e,t){this.newVidCreated&&this.newVid&&(this.newVid.style.width=e+"px",this.newVid.style.height=t+"px")}}]),t}(c.default);t.default=f},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(93),d=r(a),l=i(94),u=r(l),c=i(91),h=r(c),p=i(92),f=r(p),v=i(20),m=r(v),g=i(1),y=n(g),_=function(){function e(t,i){s(this,e),this.vpaidLog=t,this.store=i,this.isMobile=this.store.get("isMobile"),this.handlers={video:{handlerType:"VideoVpaid"+(this.isMobile?"Mobile":""),handler:this.isMobile?u.default:d.default,filterVpaidFiles:function(e){return e.vpaidFiles.video}},javascript:{handlerType:"JsVpaid"+(this.isMobile?"Mobile":""),handler:this.isMobile?f.default:h.default,filterVpaidFiles:function(e){return e.vpaidFiles.vpaid.javascript}},adx:{handlerType:"Adx",handler:m.default.vpaid}}}return o(e,[{key:"create",value:function(e,t){if(!this.stopped){if(!this.handlers.hasOwnProperty(e))return y.logToBI(this.vpaidLog,"creatingVpaidHandler",{error:"typeNotFound",type:e}),null;var i=this.handlers[e].handler;return this.handlers[e].hasOwnProperty("filterVpaidFiles")&&(t.vpaidFiles=this.handlers[e].filterVpaidFiles(t)),y.logToBI(this.vpaidLog,"creatingVpaidHandler",{type:this.handlers[e].handlerType}),new i(t,this.vpaidLog,this.store)}}},{key:"destroy",value:function(){this.stopped=!0,this.vpaidLog=this.store=this.handlers=void 0}}]),e}();t.default=_},function(e,t){"use strict";e.exports=function(e){function t(e){var t=new i(e),n=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),n}var i=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},function(e,t,i){(function(t){"use strict";function n(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=u}function r(e,t,i){this._lateQueue.push(e,t,i),this._queueTick()}function s(e,t,i){this._normalQueue.push(e,t,i),this._queueTick()}function o(e){this._normalQueue._pushOne(e),this._queueTick()}function a(e){for(;e.length()>0;)d(e)}function d(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var i=e.shift(),n=e.shift();t.call(i,n)}}var l;try{throw new Error}catch(e){l=e}var u=i(119),c=i(116),h=i(3);n.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},n.prototype.hasCustomScheduler=function(){return this._customScheduler},n.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},n.prototype.disableTrampolineIfNecessary=function(){h.hasDevTools&&(this._trampolineEnabled=!1)},n.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},n.prototype.fatalError=function(e,i){i?(t.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),t.exit(2)):this.throwLater(e)},n.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},h.hasDevTools?(n.prototype.invokeLater=function(e,t,i){this._trampolineEnabled?r.call(this,e,t,i):this._schedule(function(){setTimeout(function(){e.call(t,i)},100)})},n.prototype.invoke=function(e,t,i){this._trampolineEnabled?s.call(this,e,t,i):this._schedule(function(){e.call(t,i)})},n.prototype.settlePromises=function(e){this._trampolineEnabled?o.call(this,e):this._schedule(function(){e._settlePromises()})}):(n.prototype.invokeLater=r,n.prototype.invoke=s,n.prototype.settlePromises=o),n.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},n.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},n.prototype._reset=function(){this._isTickUsed=!1},e.exports=n,e.exports.firstLineError=l}).call(t,i(16))},function(e,t){"use strict";e.exports=function(e,t,i,n){var r=!1,s=function(e,t){this._reject(t)},o=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(s,s,null,this,e)},a=function(e,t){0===(50397184&this._bitField)&&this._resolveCallback(t.target)},d=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(s){r||(r=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var l=i(s),u=new e(t);u._propagateFrom(this,1);var c=this._target();if(u._setBoundTo(l),l instanceof e){var h={promiseRejectionQueued:!1,promise:u,target:c,bindingPromise:l};c._then(t,o,void 0,u,h),l._then(a,d,void 0,u,h),u._setOnCancel(l)}else u._resolveCallback(c);return u},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=this._bitField&-2097153},e.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},e.bind=function(t,i){return e.resolve(i).bind(t)}}},function(e,t,i){"use strict";var n=Object.create;if(n){var r=n(null),s=n(null);r[" size"]=s[" size"]=0}e.exports=function(e){function t(t,i){var n;if(null!=t&&(n=t[i]),"function"!=typeof n){var r="Object "+u.classString(t)+" has no method '"+u.toString(i)+"'";throw new e.TypeError(r)}return n}function n(e){var i=this.pop(),n=t(e,i);return n.apply(e,this)}function o(e){return e[this]}function a(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}var d,l,u=i(3),c=u.canEvaluate,h=u.isIdentifier,p=function(e){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,e))(t)},f=function(e){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",e))},v=function(e,t,i){var n=i[e];if("function"!=typeof n){if(!h(e))return null;if(n=t(e),i[e]=n,i[" size"]++,i[" size"]>512){for(var r=Object.keys(i),s=0;s<256;++s)delete i[r[s]];i[" size"]=r.length-256}}return n};d=function(e){return v(e,p,r)},l=function(e){return v(e,f,s)},e.prototype.call=function(e){for(var t=arguments.length,i=new Array(Math.max(t-1,0)),r=1;r<t;++r)i[r-1]=arguments[r];if(c){var s=d(e);if(null!==s)return this._then(s,void 0,void 0,i,void 0)}return i.push(e),this._then(n,void 0,void 0,i,void 0)},e.prototype.get=function(e){var t,i="number"==typeof e;if(i)t=a;else if(c){var n=l(e);t=null!==n?n:o}else t=o;return this._then(t,void 0,void 0,e,void 0)}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r){var s=i(3),o=s.tryCatch,a=s.errorObj,d=e._async;e.prototype.break=e.prototype.cancel=function(){if(!r.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var i=e._cancellationParent;if(null==i||!i._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=i}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),d.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(s.isArray(e))for(var i=0;i<e.length;++i)this._doInvokeOnCancel(e[i],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=o(e).call(this._boundValue());n===a&&(this._attachExtraTrace(n.e),d.throwLater(n.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),d.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},function(e,t){"use strict";e.exports=function(e){function t(){this._trace=new t.CapturedTrace(n())}function i(){if(r)return new t}function n(){var e=s.length-1;if(e>=0)return s[e]}var r=!1,s=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,s.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=s.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=i,t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var i=e.prototype._pushContext,s=e.prototype._popContext,o=e._peekContext,a=e.prototype._peekContext,d=e.prototype._promiseCreated;
t.deactivateLongStackTraces=function(){e.prototype._pushContext=i,e.prototype._popContext=s,e._peekContext=o,e.prototype._peekContext=a,e.prototype._promiseCreated=d,r=!1},r=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=n,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},function(e,t,i){(function(t){"use strict";e.exports=function(e,n){function r(e,t){return{promise:t}}function s(){return!1}function o(e,t,i){var n=this;try{e(t,i,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+H.toString(e));n._attachCancellationCallback(e)})}catch(e){return e}}function a(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?H.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function d(){return this._onCancelField}function l(e){this._onCancelField=e}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function c(e,t){if(0!==(1&t)){this._cancellationParent=e;var i=e._branchesRemainingToCancel;void 0===i&&(i=0),e._branchesRemainingToCancel=i+1}0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function h(e,t){0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function p(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function f(){this._trace=new D(this._peekContext())}function v(e,t){if(N(e)){var i=this._trace;if(void 0!==i&&t&&(i=i._parent),void 0!==i)i.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=C(e);H.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),H.notEnumerableProp(e,"__stackCleaned__",!0)}}}function m(){this._trace=void 0}function g(e,t,i,n,r){if(void 0===e&&null!==t&&J){if(void 0!==r&&r._returnedNonUndefined())return;if(0===(65535&n._bitField))return;i&&(i+=" ");var s="",o="";if(t._trace){for(var a=t._trace.stack.split("\n"),d=A(a),l=d.length-1;l>=0;--l){var u=d[l];if(!z.test(u)){var c=u.match(q);c&&(s="at "+c[1]+":"+c[2]+":"+c[3]+" ");break}}if(d.length>0)for(var h=d[0],l=0;l<a.length;++l)if(a[l]===h){l>0&&(o="\n"+a[l-1]);break}}var p="a promise was created in a "+i+"handler "+s+"but was not returned from it, see http://goo.gl/rRqMUw"+o;n._warn(p,!0,t)}}function y(e,t){var i=e+" is deprecated and will be removed in a future version.";return t&&(i+=" Use "+t+" instead."),_(i)}function _(t,i,n){if(de.warnings){var r,s=new j(t);if(i)n._attachExtraTrace(s);else if(de.longStackTraces&&(r=e._peekContext()))r.attachExtraTrace(s);else{var o=C(s);s.stack=o.message+"\n"+o.stack.join("\n")}ne("warning",s)||E(s,"",!0)}}function b(e,t){for(var i=0;i<t.length-1;++i)t[i].push("From previous event:"),t[i]=t[i].join("\n");return i<t.length&&(t[i]=t[i].join("\n")),e+"\n"+t.join("\n")}function w(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function k(e){for(var t=e[0],i=1;i<e.length;++i){for(var n=e[i],r=t.length-1,s=t[r],o=-1,a=n.length-1;a>=0;--a)if(n[a]===s){o=a;break}for(var a=o;a>=0;--a){var d=n[a];if(t[r]!==d)break;t.pop(),r--}t=n}}function A(e){for(var t=[],i=0;i<e.length;++i){var n=e[i],r="    (No stack trace)"===n||G.test(n),s=r&&se(n);r&&!s&&(Q&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function T(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),i=0;i<t.length;++i){var n=t[i];if("    (No stack trace)"===n||G.test(n))break}return i>0&&"SyntaxError"!=e.name&&(t=t.slice(i)),t}function C(e){var t=e.stack,i=e.toString();return t="string"==typeof t&&t.length>0?T(e):["    (No stack trace)"],{message:i,stack:"SyntaxError"==e.name?t:A(t)}}function E(e,t,i){if("undefined"!=typeof console){var n;if(H.isObject(e)){var r=e.stack;n=t+K(r,e)}else n=t+String(e);"function"==typeof F?F(n,i):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}}function P(e,t,i,n){var r=!1;try{"function"==typeof t&&(r=!0,"rejectionHandled"===e?t(n):t(i,n))}catch(e){B.throwLater(e)}"unhandledRejection"===e?ne(e,i,n)||r||E(i,"Unhandled rejection "):ne(e,n)}function S(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():H.toString(e);var i=/\[object [a-zA-Z0-9$_]+\]/;if(i.test(t))try{var n=JSON.stringify(e);t=n}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+V(t)+">, no stack trace)"}function V(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function x(){return"function"==typeof ae}function I(e){var t=e.match(oe);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function O(e,t){if(x()){for(var i,n,r=(e.stack||"").split("\n"),s=(t.stack||"").split("\n"),o=-1,a=-1,d=0;d<r.length;++d){var l=I(r[d]);if(l){i=l.fileName,o=l.line;break}}for(var d=0;d<s.length;++d){var l=I(s[d]);if(l){n=l.fileName,a=l.line;break}}o<0||a<0||!i||!n||i!==n||o>=a||(se=function(e){if(W.test(e))return!0;var t=I(e);return!!(t&&t.fileName===i&&o<=t.line&&t.line<=a)})}}function D(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ae(this,D),t>32&&this.uncycle()}var M,R,F,L=e._getDomain,B=e._async,j=i(7).Warning,H=i(3),U=i(8),N=H.canAttachTrace,W=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,z=/\((?:timers\.js):\d+:\d+\)/,q=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,G=null,K=null,Q=!1,X=!(0==H.env("BLUEBIRD_DEBUG")||!H.env("BLUEBIRD_DEBUG")&&"development"!==H.env("NODE_ENV")),Y=!(0==H.env("BLUEBIRD_WARNINGS")||!X&&!H.env("BLUEBIRD_WARNINGS")),$=!(0==H.env("BLUEBIRD_LONG_STACK_TRACES")||!X&&!H.env("BLUEBIRD_LONG_STACK_TRACES")),J=0!=H.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(Y||!!H.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=e._bitField&-1048577|524288},e.prototype._ensurePossibleRejectionHandled=function(){if(0===(524288&this._bitField)){this._setRejectionIsUnhandled();var e=this;setTimeout(function(){e._notifyUnhandledRejection()},1)}},e.prototype._notifyUnhandledRejectionIsHandled=function(){P("rejectionHandled",M,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),P("unhandledRejection",R,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,i){return _(e,t,i||this)},e.onPossiblyUnhandledRejection=function(e){var t=L();R="function"==typeof e?null===t?e:H.domainBind(t,e):void 0},e.onUnhandledRejectionHandled=function(e){var t=L();M="function"==typeof e?null===t?e:H.domainBind(t,e):void 0};var Z=function(){};e.longStackTraces=function(){if(B.haveItemsQueued()&&!de.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!de.longStackTraces&&x()){var t=e.prototype._captureStackTrace,i=e.prototype._attachExtraTrace,r=e.prototype._dereferenceTrace;de.longStackTraces=!0,Z=function(){if(B.haveItemsQueued()&&!de.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=i,e.prototype._dereferenceTrace=r,n.deactivateLongStackTraces(),B.enableTrampoline(),de.longStackTraces=!1},e.prototype._captureStackTrace=f,e.prototype._attachExtraTrace=v,e.prototype._dereferenceTrace=m,n.activateLongStackTraces(),B.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return de.longStackTraces&&x()};var ee=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return H.global.dispatchEvent(e),function(e,t){var i={detail:t,cancelable:!0};U.defineProperty(i,"promise",{value:t.promise}),U.defineProperty(i,"reason",{value:t.reason});var n=new CustomEvent(e.toLowerCase(),i);return!H.global.dispatchEvent(n)}}if("function"==typeof Event){var e=new Event("CustomEvent");return H.global.dispatchEvent(e),function(e,t){var i=new Event(e.toLowerCase(),{cancelable:!0});return i.detail=t,U.defineProperty(i,"promise",{value:t.promise}),U.defineProperty(i,"reason",{value:t.reason}),!H.global.dispatchEvent(i)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),H.global.dispatchEvent(e),function(e,t){var i=document.createEvent("CustomEvent");return i.initCustomEvent(e.toLowerCase(),!1,!0,t),!H.global.dispatchEvent(i)}}catch(e){}return function(){return!1}}(),te=function(){return H.isNode?function(){return t.emit.apply(t,arguments)}:H.global?function(e){var t="on"+e.toLowerCase(),i=H.global[t];return!!i&&(i.apply(H.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),ie={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(e,t,i){return{promise:t,child:i}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,i){return{reason:t,promise:i}},rejectionHandled:r},ne=function(e){var t=!1;try{t=te.apply(null,arguments)}catch(e){B.throwLater(e),t=!0}var i=!1;try{i=ee(e,ie[e].apply(null,arguments))}catch(e){B.throwLater(e),i=!0}return i||t};e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&Z()),"warnings"in t){var i=t.warnings;de.warnings=!!i,J=de.warnings,H.isObject(i)&&"wForgottenReturn"in i&&(J=!!i.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!de.cancellation){if(B.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=u,e.prototype._propagateFrom=c,e.prototype._onCancel=d,e.prototype._setOnCancel=l,e.prototype._attachCancellationCallback=a,e.prototype._execute=o,re=c,de.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!de.monitoring?(de.monitoring=!0,e.prototype._fireEvent=ne):!t.monitoring&&de.monitoring&&(de.monitoring=!1,e.prototype._fireEvent=s)),e},e.prototype._fireEvent=s,e.prototype._execute=function(e,t,i){try{e(t,i)}catch(e){return e}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var re=h,se=function(){return!1},oe=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;H.inherits(D,Error),n.CapturedTrace=D,D.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],i={},n=0,r=this;void 0!==r;++n)t.push(r),r=r._parent;e=this._length=n;for(var n=e-1;n>=0;--n){var s=t[n].stack;void 0===i[s]&&(i[s]=n)}for(var n=0;n<e;++n){var o=t[n].stack,a=i[o];if(void 0!==a&&a!==n){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var d=n>0?t[n-1]:this;a<e-1?(d._parent=t[a+1],d._parent.uncycle(),d._length=d._parent._length+1):(d._parent=void 0,d._length=1);for(var l=d._length+1,u=n-2;u>=0;--u)t[u]._length=l,l++;return}}}},D.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=C(e),i=t.message,n=[t.stack],r=this;void 0!==r;)n.push(A(r.stack.split("\n"))),r=r._parent;k(n),w(n),H.notEnumerableProp(e,"stack",b(i,n)),H.notEnumerableProp(e,"__stackCleaned__",!0)}};var ae=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():S(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,G=e,K=t;var i=Error.captureStackTrace;return se=function(e){return W.test(e)},function(e,t){Error.stackTraceLimit+=6,i(e,t),Error.stackTraceLimit-=6}}var n=new Error;if("string"==typeof n.stack&&n.stack.split("\n")[0].indexOf("stackDetection@")>=0)return G=/@/,K=t,Q=!0,function(e){e.stack=(new Error).stack};var r;try{throw new Error}catch(e){r="stack"in e}return"stack"in n||!r||"number"!=typeof Error.stackTraceLimit?(K=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?S(t):t.toString()},null):(G=e,K=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(F=function(e){console.warn(e)},H.isNode&&t.stderr.isTTY?F=function(e,t){var i=t?"[33m":"[31m";console.warn(i+e+"[0m\n")}:H.isNode||"string"!=typeof(new Error).stack||(F=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var de={warnings:Y,longStackTraces:!1,cancellation:!1,monitoring:!1};return $&&e.longStackTraces(),{longStackTraces:function(){return de.longStackTraces},warnings:function(){return de.warnings},cancellation:function(){return de.cancellation},monitoring:function(){return de.monitoring},propagateFromFunction:function(){return re},boundValueFunction:function(){return p},checkForgottenReturns:g,setBounds:O,warn:_,deprecated:y,CapturedTrace:D,fireDomEvent:ee,fireGlobalEvent:te}}}).call(t,i(16))},function(e,t){"use strict";e.exports=function(e){function t(){return this.value}function i(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(i){return i instanceof e&&i.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:i},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(i,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,i,void 0,{reason:e},void 0);var t=arguments[1],n=function(){throw t};return this.caught(e,n)},e.prototype.catchReturn=function(i){if(arguments.length<=1)return i instanceof e&&i.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:i},void 0);var n=arguments[1];n instanceof e&&n.suppressUnhandledRejections();var r=function(){return n};return this.caught(i,r)}}},function(e,t){"use strict";e.exports=function(e,t){function i(){return s(this)}function n(e,i){return r(e,i,t,t)}var r=e.reduce,s=e.all;e.prototype.each=function(e){return r(this,e,t,0)._then(i,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,n){return r(e,n,t,0)._then(i,void 0,void 0,e,void 0)},e.mapSeries=n}},function(e,t){"use strict";e.exports=function(e,t){var i=e.map;e.prototype.filter=function(e,n){return i(this,e,n,t)},e.filter=function(e,n,r){return i(e,n,r,t)}}},function(e,t,i){"use strict";e.exports=function(e,t,n){function r(e,t,i){this.promise=e,this.type=t,this.handler=i,this.called=!1,this.cancelPromise=null}function s(e){this.finallyHandler=e}function o(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function a(){return l.call(this,this.promise._target()._settledValue())}function d(e){if(!o(this,e))return h.e=e,h}function l(i){var r=this.promise,l=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?l.call(r._boundValue()):l.call(r._boundValue(),i);if(u===n)return u;if(void 0!==u){r._setReturnedNonUndefined();var p=t(u,r);if(p instanceof e){if(null!=this.cancelPromise){if(p._isCancelled()){var f=new c("late cancellation observer");return r._attachExtraTrace(f),h.e=f,h}p.isPending()&&p._attachCancellationCallback(new s(this))}return p._then(a,d,void 0,this,void 0)}}}return r.isRejected()?(o(this),h.e=i,h):(o(this),i)}var u=i(3),c=e.CancellationError,h=u.errorObj,p=i(37)(n);return r.prototype.isFinallyHandler=function(){return 0===this.type},s.prototype._resultCancelled=function(){o(this.finallyHandler)},e.prototype._passThrough=function(e,t,i,n){return"function"!=typeof e?this.then():this._then(i,n,void 0,new r(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,l,l)},e.prototype.tap=function(e){return this._passThrough(e,1,l)},e.prototype.tapCatch=function(t){var i=arguments.length;if(1===i)return this._passThrough(t,1,void 0,l);var n,r=new Array(i-1),s=0;for(n=0;n<i-1;++n){var o=arguments[n];if(!u.isObject(o))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+u.classString(o)));r[s++]=o}r.length=s;var a=arguments[n];return this._passThrough(p(r,a,this),1,void 0,l)},r}},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s,o){function a(t,i,n){for(var s=0;s<i.length;++s){n._pushContext();var o=p(i[s])(t);if(n._popContext(),o===h){n._pushContext();var a=e.reject(h.e);return n._popContext(),a}var d=r(o,n);if(d instanceof e)return d}return null}function d(t,i,r,s){if(o.cancellation()){var a=new e(n),d=this._finallyPromise=new e(n);this._promise=a.lastly(function(){return d}),a._captureStackTrace(),a._setOnCancel(this)}else{var l=this._promise=new e(n);l._captureStackTrace()}this._stack=s,this._generatorFunction=t,this._receiver=i,this._generator=void 0,this._yieldHandlers="function"==typeof r?[r].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}var l=i(7),u=l.TypeError,c=i(3),h=c.errorObj,p=c.tryCatch,f=[];c.inherits(d,s),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,i="undefined"!=typeof this._generator.return;if(i)this._promise._pushContext(),t=p(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=p(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},d.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=p(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=p(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(t){var i=this._promise;if(t===h)return this._cleanup(),this._cancellationPhase?i.cancel():i._rejectCallback(t.e,!1);var n=t.value;if(t.done===!0)return this._cleanup(),this._cancellationPhase?i.cancel():i._resolveCallback(n);var s=r(n,this._promise);if(!(s instanceof e)&&(s=a(s,this._yieldHandlers,this._promise),null===s))return void this._promiseRejected(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));s=s._target();var o=s._bitField;0===(50397184&o)?(this._yieldedPromise=s,s._proxy(this,null)):0!==(33554432&o)?e._async.invoke(this._promiseFulfilled,this,s._value()):0!==(16777216&o)?e._async.invoke(this._promiseRejected,this,s._reason()):this._promiseCancelled()},e.coroutine=function(e,t){if("function"!=typeof e)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=Object(t).yieldHandler,n=d,r=(new Error).stack;return function(){var t=e.apply(this,arguments),s=new n(void 0,void 0,i,r),o=s.promise();return s._generator=t,s._promiseFulfilled(void 0),o}},e.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new u("expecting a function but got "+c.classString(e));f.push(e)},e.spawn=function(i){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof i)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new d(i,this),r=n.promise();return n._run(e.spawn),r}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s,o){var a,d=i(3),l=d.canEvaluate,u=d.tryCatch,c=d.errorObj;if(l){for(var h=function(e){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,e))},p=function(e){return new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,e))},f=function(t){for(var i=new Array(t),n=0;n<i.length;++n)i[n]="this.p"+(n+1);var r=i.join(" = ")+" = null;",o="var promise;\n"+i.map(function(e){return"                                                         \n\t                promise = "+e+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "}).join("\n"),a=i.join(", "),d="Holder$"+t,l="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return l=l.replace(/\[TheName\]/g,d).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,a).replace(/\[TheProperties\]/g,r).replace(/\[CancellationCode\]/g,o),new Function("tryCatch","errorObj","Promise","async",l)(u,c,e,s)},v=[],m=[],g=[],y=0;y<8;++y)v.push(f(y+1)),m.push(h(y+1)),g.push(p(y+1));a=function(e){this._reject(e)}}e.join=function(){var i,s=arguments.length-1;if(s>0&&"function"==typeof arguments[s]&&(i=arguments[s],s<=8&&l)){var u=new e(r);u._captureStackTrace();for(var c=v[s-1],h=new c(i),p=m,f=0;f<s;++f){var y=n(arguments[f],u);if(y instanceof e){y=y._target();var _=y._bitField;0===(50397184&_)?(y._then(p[f],a,void 0,u,h),g[f](y,h),h.asyncNeeded=!1):0!==(33554432&_)?p[f].call(u,y._value(),h):0!==(16777216&_)?u._reject(y._reason()):u._cancel()}else p[f].call(u,y,h)}if(!u._isFateSealed()){if(h.asyncNeeded){var b=o();null!==b&&(h.fn=d.domainBind(b,h.fn))}u._setAsyncGuaranteed(),u._setOnCancel(h)}return u}for(var w=arguments.length,k=new Array(w),A=0;A<w;++A)k[A]=arguments[A];i&&k.pop();var u=new t(k).promise();return void 0!==i?u.spread(i):u}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s,o){function a(e,t,i,n){this.constructor$(e),this._promise._captureStackTrace();var r=l();this._callback=null===r?t:u.domainBind(r,t),this._preservedValues=n===s?new Array(this.length()):null,this._limit=i,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0)}function d(t,i,r,s){if("function"!=typeof i)return n("expecting a function but got "+u.classString(i));var o=0;if(void 0!==r){if("object"!=typeof r||null===r)return e.reject(new TypeError("options argument must be an object but it is "+u.classString(r)));if("number"!=typeof r.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(r.concurrency)));o=r.concurrency}return o="number"==typeof o&&isFinite(o)&&o>=1?o:0,new a(t,i,o,s).promise()}var l=e._getDomain,u=i(3),c=u.tryCatch,h=u.errorObj,p=e._async;u.inherits(a,t),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,i){var n=this._values,s=this.length(),a=this._preservedValues,d=this._limit;if(i<0){if(i=i*-1-1,n[i]=t,d>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(d>=1&&this._inFlight>=d)return n[i]=t,this._queue.push(i),!1;null!==a&&(a[i]=t);var l=this._promise,u=this._callback,p=l._boundValue();l._pushContext();var f=c(u).call(p,t,i,s),v=l._popContext();if(o.checkForgottenReturns(f,v,null!==a?"Promise.filter":"Promise.map",l),f===h)return this._reject(f.e),!0;var m=r(f,this._promise);if(m instanceof e){m=m._target();var g=m._bitField;if(0===(50397184&g))return d>=1&&this._inFlight++,n[i]=m,m._proxy(this,(i+1)*-1),!1;if(0===(33554432&g))return 0!==(16777216&g)?(this._reject(m._reason()),!0):(this._cancel(),!0);f=m._value()}n[i]=f}var y=++this._totalResolved;return y>=s&&(null!==a?this._filter(n,a):this._resolve(n),!0)},a.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,i=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(i[n],n)}},a.prototype._filter=function(e,t){for(var i=t.length,n=new Array(i),r=0,s=0;s<i;++s)e[s]&&(n[r++]=t[s]);n.length=r,this._resolve(n)},a.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return d(this,e,t,null)},e.map=function(e,t,i,n){return d(e,t,i,n)}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s){var o=i(3),a=o.tryCatch;e.method=function(i){if("function"!=typeof i)throw new e.TypeError("expecting a function but got "+o.classString(i));return function(){var n=new e(t);n._captureStackTrace(),n._pushContext();var r=a(i).apply(this,arguments),o=n._popContext();return s.checkForgottenReturns(r,o,"Promise.method",n),n._resolveFromSyncValue(r),n}},e.attempt=e.try=function(i){if("function"!=typeof i)return r("expecting a function but got "+o.classString(i));var n=new e(t);n._captureStackTrace(),n._pushContext();var d;if(arguments.length>1){s.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],u=arguments[2];d=o.isArray(l)?a(i).apply(u,l):a(i).call(u,l)}else d=a(i)();var c=n._popContext();return s.checkForgottenReturns(d,c,"Promise.try",n),n._resolveFromSyncValue(d),n},e.prototype._resolveFromSyncValue=function(e){e===o.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},function(e,t,i){"use strict";e.exports=function(e){function t(e,t){var i=this;if(!s.isArray(e))return n.call(i,e,t);var r=a(t).apply(i._boundValue(),[null].concat(e));r===d&&o.throwLater(r.e)}function n(e,t){var i=this,n=i._boundValue(),r=void 0===e?a(t).call(n,null):a(t).call(n,null,e);r===d&&o.throwLater(r.e)}function r(e,t){var i=this;if(!e){var n=new Error(e+"");n.cause=e,e=n}var r=a(t).call(i._boundValue(),e);r===d&&o.throwLater(r.e)}var s=i(3),o=e._async,a=s.tryCatch,d=s.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(e,i){if("function"==typeof e){var s=n;void 0!==i&&Object(i).spread&&(s=t),this._then(s,r,void 0,this,e)}return this}}},function(e,t,i){(function(t){"use strict";e.exports=function(){function n(){}function r(e,t){if(null==e||e.constructor!==s)throw new _("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new _("expecting a function but got "+f.classString(t))}function s(e){e!==w&&r(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(e){this.promise._resolveCallback(e)}function a(e){this.promise._rejectCallback(e,!1)}function d(e){var t=new s(w);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var l,u=function(){return new _("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},c=function(){return new s.PromiseInspection(this._target())},h=function(e){return s.reject(new _(e))},p={},f=i(3);l=f.isNode?function(){var e=t.domain;return void 0===e&&(e=null),e}:function(){return null},f.notEnumerableProp(s,"_getDomain",l);var v=i(8),m=i(97),g=new m;v.defineProperty(s,"_async",{value:g});var y=i(7),_=s.TypeError=y.TypeError;s.RangeError=y.RangeError;var b=s.CancellationError=y.CancellationError;s.TimeoutError=y.TimeoutError,s.OperationalError=y.OperationalError,s.RejectionError=y.OperationalError,s.AggregateError=y.AggregateError;var w=function(){},k={},A={},T=i(123)(s,w),C=i(113)(s,w,T,h,n),E=i(101)(s),P=E.create,S=i(102)(s,E),V=(S.CapturedTrace,
i(106)(s,T,A)),x=i(37)(A),I=i(38),O=f.errorObj,D=f.tryCatch;return s.prototype.toString=function(){return"[object Promise]"},s.prototype.caught=s.prototype.catch=function(e){var t=arguments.length;if(t>1){var i,n=new Array(t-1),r=0;for(i=0;i<t-1;++i){var s=arguments[i];if(!f.isObject(s))return h("Catch statement predicate: expecting an object but got "+f.classString(s));n[r++]=s}if(n.length=r,e=arguments[i],"function"!=typeof e)throw new _("The last argument to .catch() must be a function, got "+f.toString(e));return this.then(void 0,x(n,e,this))}return this.then(void 0,e)},s.prototype.reflect=function(){return this._then(c,c,void 0,this,void 0)},s.prototype.then=function(e,t){if(S.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var i=".then() only accepts functions but was passed: "+f.classString(e);arguments.length>1&&(i+=", "+f.classString(t)),this._warn(i)}return this._then(e,t,void 0,void 0,void 0)},s.prototype.done=function(e,t){var i=this._then(e,t,void 0,void 0,void 0);i._setIsFinal()},s.prototype.spread=function(e){return"function"!=typeof e?h("expecting a function but got "+f.classString(e)):this.all()._then(e,void 0,void 0,k,void 0)},s.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},s.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new C(this).promise()},s.prototype.error=function(e){return this.caught(f.originatesFromRejection,e)},s.getNewLibraryCopy=e.exports,s.is=function(e){return e instanceof s},s.fromNode=s.fromCallback=function(e){var t=new s(w);t._captureStackTrace();var i=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=D(e)(I(t,i));return n===O&&t._rejectCallback(n.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},s.all=function(e){return new C(e).promise()},s.cast=function(e){var t=T(e);return t instanceof s||(t=new s(w),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},s.resolve=s.fulfilled=s.cast,s.reject=s.rejected=function(e){var t=new s(w);return t._captureStackTrace(),t._rejectCallback(e,!0),t},s.setScheduler=function(e){if("function"!=typeof e)throw new _("expecting a function but got "+f.classString(e));return g.setScheduler(e)},s.prototype._then=function(e,t,i,n,r){var o=void 0!==r,a=o?r:new s(w),d=this._target(),u=d._bitField;o||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===n&&0!==(2097152&this._bitField)&&(n=0!==(50397184&u)?this._boundValue():d===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var c=l();if(0!==(50397184&u)){var h,p,v=d._settlePromiseCtx;0!==(33554432&u)?(p=d._rejectionHandler0,h=e):0!==(16777216&u)?(p=d._fulfillmentHandler0,h=t,d._unsetRejectionIsUnhandled()):(v=d._settlePromiseLateCancellationObserver,p=new b("late cancellation observer"),d._attachExtraTrace(p),h=t),g.invoke(v,d,{handler:null===c?h:"function"==typeof h&&f.domainBind(c,h),promise:a,receiver:n,value:p})}else d._addCallbacks(e,t,a,n,c);return a},s.prototype._length=function(){return 65535&this._bitField},s.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},s.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},s.prototype._setLength=function(e){this._bitField=this._bitField&-65536|65535&e},s.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},s.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},s.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},s.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},s.prototype._isFinal=function(){return(4194304&this._bitField)>0},s.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},s.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},s.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},s.prototype._setAsyncGuaranteed=function(){g.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},s.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==p)return void 0===t&&this._isBound()?this._boundValue():t},s.prototype._promiseAt=function(e){return this[4*e-4+2]},s.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},s.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},s.prototype._boundValue=function(){},s.prototype._migrateCallback0=function(e){var t=(e._bitField,e._fulfillmentHandler0),i=e._rejectionHandler0,n=e._promise0,r=e._receiverAt(0);void 0===r&&(r=p),this._addCallbacks(t,i,n,r,null)},s.prototype._migrateCallbackAt=function(e,t){var i=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),r=e._promiseAt(t),s=e._receiverAt(t);void 0===s&&(s=p),this._addCallbacks(i,n,r,s,null)},s.prototype._addCallbacks=function(e,t,i,n,r){var s=this._length();if(s>=65531&&(s=0,this._setLength(0)),0===s)this._promise0=i,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=null===r?e:f.domainBind(r,e)),"function"==typeof t&&(this._rejectionHandler0=null===r?t:f.domainBind(r,t));else{var o=4*s-4;this[o+2]=i,this[o+3]=n,"function"==typeof e&&(this[o+0]=null===r?e:f.domainBind(r,e)),"function"==typeof t&&(this[o+1]=null===r?t:f.domainBind(r,t))}return this._setLength(s+1),s},s.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},s.prototype._resolveCallback=function(e,t){if(0===(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var i=T(e,this);if(!(i instanceof s))return this._fulfill(e);t&&this._propagateFrom(i,2);var n=i._target();if(n===this)return void this._reject(u());var r=n._bitField;if(0===(50397184&r)){var o=this._length();o>0&&n._migrateCallback0(this);for(var a=1;a<o;++a)n._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!==(33554432&r))this._fulfill(n._value());else if(0!==(16777216&r))this._reject(n._reason());else{var d=new b("late cancellation observer");n._attachExtraTrace(d),this._reject(d)}}},s.prototype._rejectCallback=function(e,t,i){var n=f.ensureErrorObject(e),r=n===e;if(!r&&!i&&S.warnings()){var s="a promise was rejected with a non-error: "+f.classString(e);this._warn(s,!0)}this._attachExtraTrace(n,!!t&&r),this._reject(e)},s.prototype._resolveFromExecutor=function(e){if(e!==w){var t=this;this._captureStackTrace(),this._pushContext();var i=!0,n=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,i)});i=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)}},s.prototype._settlePromiseFromHandler=function(e,t,i,n){var r=n._bitField;if(0===(65536&r)){n._pushContext();var s;t===k?i&&"number"==typeof i.length?s=D(e).apply(this._boundValue(),i):(s=O,s.e=new _("cannot .spread() a non-array: "+f.classString(i))):s=D(e).call(t,i);var o=n._popContext();r=n._bitField,0===(65536&r)&&(s===A?n._reject(i):s===O?n._rejectCallback(s.e,!1):(S.checkForgottenReturns(s,o,"",n,this),n._resolveCallback(s)))}},s.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},s.prototype._followee=function(){return this._rejectionHandler0},s.prototype._setFollowee=function(e){this._rejectionHandler0=e},s.prototype._settlePromise=function(e,t,i,r){var o=e instanceof s,a=this._bitField,d=0!==(134217728&a);0!==(65536&a)?(o&&e._invokeInternalOnCancel(),i instanceof V&&i.isFinallyHandler()?(i.cancelPromise=e,D(t).call(i,r)===O&&e._reject(O.e)):t===c?e._fulfill(c.call(i)):i instanceof n?i._promiseCancelled(e):o||e instanceof C?e._cancel():i.cancel()):"function"==typeof t?o?(d&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,i,r,e)):t.call(i,r,e):i instanceof n?i._isResolved()||(0!==(33554432&a)?i._promiseFulfilled(r,e):i._promiseRejected(r,e)):o&&(d&&e._setAsyncGuaranteed(),0!==(33554432&a)?e._fulfill(r):e._reject(r))},s.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,i=e.promise,n=e.receiver,r=e.value;"function"==typeof t?i instanceof s?this._settlePromiseFromHandler(t,n,r,i):t.call(n,r,i):i instanceof s&&i._reject(r)},s.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},s.prototype._settlePromise0=function(e,t,i){var n=this._promise0,r=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,r,t)},s.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},s.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var i=u();return this._attachExtraTrace(i),this._reject(i)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!==(134217728&t)?this._settlePromises():g.settlePromises(this),this._dereferenceTrace())}},s.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?g.fatalError(e,f.isNode):void((65535&t)>0?g.settlePromises(this):this._ensurePossibleRejectionHandled())},s.prototype._fulfillPromises=function(e,t){for(var i=1;i<e;i++){var n=this._fulfillmentHandlerAt(i),r=this._promiseAt(i),s=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(r,n,s,t)}},s.prototype._rejectPromises=function(e,t){for(var i=1;i<e;i++){var n=this._rejectionHandlerAt(i),r=this._promiseAt(i),s=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(r,n,s,t)}},s.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!==(16842752&e)){var i=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,i,e),this._rejectPromises(t,i)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},s.prototype._settledValue=function(){var e=this._bitField;return 0!==(33554432&e)?this._rejectionHandler0:0!==(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&v.defineProperty(s.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),s.defer=s.pending=function(){S.deprecated("Promise.defer","new Promise");var e=new s(w);return{promise:e,resolve:o,reject:a}},f.notEnumerableProp(s,"_makeSelfResolutionError",u),i(110)(s,w,T,h,S),i(98)(s,w,T,S),i(100)(s,C,h,S),i(103)(s),i(122)(s),i(108)(s,C,T,w,g,l),s.Promise=s,s.version="3.5.5",i(99)(s),i(107)(s,h,w,T,n,S),i(109)(s,C,h,T,w,S),i(111)(s),i(114)(s,w),i(115)(s,C,T,h),i(117)(s,w,T,h),i(118)(s,C,h,T,w,S),i(120)(s,C,S),i(121)(s,C,h),i(124)(s,w,S),i(125)(s,h,T,P,w,S),i(96)(s),i(104)(s,w),i(105)(s,w),f.toFastProperties(s),f.toFastProperties(s.prototype),d({a:1}),d({b:2}),d({c:3}),d(1),d(function(){}),d(void 0),d(!1),d(new s(w)),S.setBounds(m.firstLineError,f.lastLineError),s}}).call(t,i(16))},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s){function o(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}function a(i){var n=this._promise=new e(t);i instanceof e&&n._propagateFrom(i,3),n._setOnCancel(this),this._values=i,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var d=i(3);return d.isArray,d.inherits(a,s),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(i,s){var a=n(this._values,this._promise);if(a instanceof e){a=a._target();var l=a._bitField;if(this._values=a,0===(50397184&l))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,s);if(0===(33554432&l))return 0!==(16777216&l)?this._reject(a._reason()):this._cancel();a=a._value()}if(a=d.asArray(a),null===a){var u=r("expecting an array or an iterable object but got "+d.classString(a)).reason();return void this._promise._rejectCallback(u,!1)}return 0===a.length?void(s===-5?this._resolveEmptyArray():this._resolve(o(s))):void this._iterate(a)},a.prototype._iterate=function(t){var i=this.getActualLength(t.length);this._length=i,this._values=this.shouldCopyValues()?new Array(i):this._values;for(var r=this._promise,s=!1,o=null,a=0;a<i;++a){var d=n(t[a],r);d instanceof e?(d=d._target(),o=d._bitField):o=null,s?null!==o&&d.suppressUnhandledRejections():null!==o?0===(50397184&o)?(d._proxy(this,a),this._values[a]=d):s=0!==(33554432&o)?this._promiseFulfilled(d._value(),a):0!==(16777216&o)?this._promiseRejected(d._reason(),a):this._promiseCancelled(a):s=this._promiseFulfilled(d,a)}s||r._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},a.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var i=++this._totalResolved;return i>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var i=0;i<t.length;++i)t[i]instanceof e&&t[i].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},function(e,t,i){"use strict";e.exports=function(e,t){function n(e){return!k.test(e)}function r(e){try{return e.__isPromisified__===!0}catch(e){return!1}}function s(e,t,i){var n=p.getDataPropertyOrDefault(e,t+i,b);return!!n&&r(n)}function o(e,t,i){for(var n=0;n<e.length;n+=2){var r=e[n];if(i.test(r))for(var s=r.replace(i,""),o=0;o<e.length;o+=2)if(e[o]===s)throw new y("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function a(e,t,i,n){for(var a=p.inheritedDataKeys(e),d=[],l=0;l<a.length;++l){var u=a[l],c=e[u],h=n===A||A(u,c,e);"function"!=typeof c||r(c)||s(e,u,t)||!n(u,c,e,h)||d.push(u,c)}return o(d,t,i),d}function d(i,n,r,s,o,a){function d(){var r=n;n===h&&(r=this);var s=new e(t);s._captureStackTrace();var o="string"==typeof u&&this!==l?this[u]:i,d=f(s,a);try{o.apply(r,v(arguments,d))}catch(e){s._rejectCallback(m(e),!0,!0)}return s._isFateSealed()||s._setAsyncGuaranteed(),s}var l=function(){return this}(),u=i;return"string"==typeof u&&(i=s),p.notEnumerableProp(d,"__isPromisified__",!0),d}function l(e,t,i,n,r){for(var s=new RegExp(T(t)+"$"),o=a(e,t,s,i),d=0,l=o.length;d<l;d+=2){var u=o[d],c=o[d+1],f=u+t;if(n===V)e[f]=V(u,h,u,c,t,r);else{var v=n(c,function(){return V(u,h,u,c,t,r)});p.notEnumerableProp(v,"__isPromisified__",!0),e[f]=v}}return p.toFastProperties(e),e}function u(e,t,i){return V(e,t,void 0,e,null,i)}var c,h={},p=i(3),f=i(38),v=p.withAppended,m=p.maybeWrapAsError,g=p.canEvaluate,y=i(7).TypeError,_="Async",b={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],k=new RegExp("^(?:"+w.join("|")+")$"),A=function(e){return p.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},T=function(e){return e.replace(/([$])/,"\\$")},C=function(e){for(var t=[e],i=Math.max(0,e-1-3),n=e-1;n>=i;--n)t.push(n);for(var n=e+1;n<=3;++n)t.push(n);return t},E=function(e){return p.filledRange(e,"_arg","")},P=function(e){return p.filledRange(Math.max(e,3),"_arg","")},S=function(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0};c=function(i,n,r,s,o,a){function d(e){var t,i=E(e).join(", "),r=e>0?", ":"";return t=g?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===n?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n",t.replace("{{args}}",i).replace(", ",r)}function l(){for(var e="",t=0;t<c.length;++t)e+="case "+c[t]+":"+d(c[t]);return e+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",g?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}var u=Math.max(0,S(s)-1),c=C(u),g="string"==typeof i||n===h,y="string"==typeof i?"this != null ? this['"+i+"'] : fn":"fn",_="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+a+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",l()).replace("[GetFunctionCode]",y);return _=_.replace("Parameters",P(u)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",_)(e,s,n,v,m,f,p.tryCatch,p.errorObj,p.notEnumerableProp,t)};var V=g?c:d;e.promisify=function(e,t){if("function"!=typeof e)throw new y("expecting a function but got "+p.classString(e));if(r(e))return e;t=Object(t);var i=void 0===t.context?h:t.context,s=!!t.multiArgs,o=u(e,i,s);return p.copyDescriptors(e,o,n),o},e.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new y("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");t=Object(t);var i=!!t.multiArgs,n=t.suffix;"string"!=typeof n&&(n=_);var r=t.filter;"function"!=typeof r&&(r=A);var s=t.promisifier;if("function"!=typeof s&&(s=V),!p.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var o=p.inheritedDataKeys(e),a=0;a<o.length;++a){var d=e[o[a]];"constructor"!==o[a]&&p.isClass(d)&&(l(d.prototype,n,r,s,i),l(d,n,r,s,i))}return l(e,n,r,s,i)}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r){function s(e){var t,i=!1;if(void 0!==a&&e instanceof a)t=c(e),i=!0;else{var n=u.keys(e),r=n.length;t=new Array(2*r);for(var s=0;s<r;++s){var o=n[s];t[s]=e[o],t[s+r]=o}}this.constructor$(t),this._isMap=i,this._init$(void 0,i?-6:-3)}function o(t){var i,o=n(t);return l(o)?(i=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new s(o).promise(),o instanceof e&&i._propagateFrom(o,2),i):r("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,d=i(3),l=d.isObject,u=i(8);"function"==typeof Map&&(a=Map);var c=function(){function e(e,n){this[t]=e,this[t+i]=n,t++}var t=0,i=0;return function(n){i=n.size,t=0;var r=new Array(2*n.size);return n.forEach(e,r),r}}(),h=function(e){for(var t=new a,i=e.length/2|0,n=0;n<i;++n){var r=e[i+n],s=e[n];t.set(r,s)}return t};d.inherits(s,t),s.prototype._init=function(){},s.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var i=++this._totalResolved;if(i>=this._length){var n;if(this._isMap)n=h(this._values);else{n={};for(var r=this.length(),s=0,o=this.length();s<o;++s)n[this._values[s+r]]=this._values[s]}return this._resolve(n),!0}return!1},s.prototype.shouldCopyValues=function(){return!1},s.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return o(this)},e.props=function(e){return o(e)}}},function(e,t){"use strict";function i(e,t,i,n,r){for(var s=0;s<r;++s)i[s+n]=e[s+t],e[s+t]=void 0}function n(e){this._capacity=e,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(e){return this._capacity<e},n.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var i=this._front+t&this._capacity-1;this[i]=e,this._length=t+1},n.prototype.push=function(e,t,i){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(i);var r=this._front+n-3;this._checkCapacity(n);var s=this._capacity-1;this[r+0&s]=e,this[r+1&s]=t,this[r+2&s]=i,this._length=n},n.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,r=this._length,s=n+r&t-1;i(this,0,this,t,s)},e.exports=n},function(e,t,i){"use strict";e.exports=function(e,t,n,r){function s(i,s){var d=n(i);if(d instanceof e)return a(d);if(i=o.asArray(i),null===i)return r("expecting an array or an iterable object but got "+o.classString(i));var l=new e(t);void 0!==s&&l._propagateFrom(s,3);for(var u=l._fulfill,c=l._reject,h=0,p=i.length;h<p;++h){var f=i[h];(void 0!==f||h in i)&&e.cast(f)._then(u,c,void 0,l,null)}return l}var o=i(3),a=function(e){return e.then(function(t){return s(t,e)})};e.race=function(e){return s(e,void 0)},e.prototype.race=function(){return s(this,void 0)}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s,o){function a(t,i,n,r){this.constructor$(t);var o=h();this._fn=null===o?i:p.domainBind(o,i),void 0!==n&&(n=e.resolve(n),n._attachCancellationCallback(this)),this._initialValue=n,this._currentCancellable=null,r===s?this._eachValues=Array(this._length):0===r?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function d(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function l(e,t,i,r){if("function"!=typeof t)return n("expecting a function but got "+p.classString(t));var s=new a(e,t,i,r);return s.promise()}function u(t){this.accum=t,this.array._gotAccum(t);var i=r(this.value,this.array._promise);return i instanceof e?(this.array._currentCancellable=i,i._then(c,void 0,void 0,this,void 0)):c.call(this,i)}function c(t){var i=this.array,n=i._promise,r=f(i._fn);n._pushContext();var s;s=void 0!==i._eachValues?r.call(n._boundValue(),t,this.index,this.length):r.call(n._boundValue(),this.accum,t,this.index,this.length),s instanceof e&&(i._currentCancellable=s);var a=n._popContext();return o.checkForgottenReturns(s,a,void 0!==i._eachValues?"Promise.each":"Promise.reduce",n),s}var h=e._getDomain,p=i(3),f=p.tryCatch;p.inherits(a,t),a.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==s&&this._eachValues.push(e)},a.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},a.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},a.prototype._iterate=function(t){this._values=t;var i,n,r=t.length;if(void 0!==this._initialValue?(i=this._initialValue,n=0):(i=e.resolve(t[0]),n=1),this._currentCancellable=i,!i.isRejected())for(;n<r;++n){var s={accum:null,value:t[n],index:n,length:r,array:this};i=i._then(u,void 0,void 0,s,void 0)}void 0!==this._eachValues&&(i=i._then(this._eachComplete,void 0,void 0,this,void 0)),i._then(d,d,void 0,i,this)},e.prototype.reduce=function(e,t){return l(this,e,t,null)},e.reduce=function(e,t,i,n){return l(e,t,i,n)}}},function(e,t,i){(function(t,n){"use strict";var r,s=i(3),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},a=s.getNativePromise();if(s.isNode&&"undefined"==typeof MutationObserver){var d=t.setImmediate,l=n.nextTick;r=s.isRecentNode?function(e){d.call(t,e)}:function(e){l.call(n,e)}}else if("function"==typeof a&&"function"==typeof a.resolve){var u=a.resolve();r=function(e){u.then(e)}}else r="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var e=document.createElement("div"),t={attributes:!0},i=!1,n=document.createElement("div"),r=new MutationObserver(function(){e.classList.toggle("foo"),i=!1});r.observe(n,t);var s=function(){i||(i=!0,n.classList.toggle("foo"))};return function(i){var n=new MutationObserver(function(){n.disconnect(),i()});n.observe(e,t),s()}}():"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:o;e.exports=r}).call(t,function(){return this}(),i(16))},function(e,t,i){"use strict";e.exports=function(e,t,n){function r(e){this.constructor$(e)}var s=e.PromiseInspection,o=i(3);o.inherits(r,t),r.prototype._promiseResolved=function(e,t){this._values[e]=t;var i=++this._totalResolved;return i>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(e,t){var i=new s;return i._bitField=33554432,i._settledValueField=e,this._promiseResolved(t,i)},r.prototype._promiseRejected=function(e,t){var i=new s;return i._bitField=16777216,i._settledValueField=e,this._promiseResolved(t,i)},e.settle=function(e){return n.deprecated(".settle()",".reflect()"),new r(e).promise()},e.prototype.settle=function(){return e.settle(this)}}},function(e,t,i){"use strict";e.exports=function(e,t,n){function r(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function s(e,t){if((0|t)!==t||t<0)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var i=new r(e),s=i.promise();return i.setHowMany(t),i.init(),s}var o=i(3),a=i(7).RangeError,d=i(7).AggregateError,l=o.isArray,u={};o.inherits(r,t),r.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=l(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},r.prototype.init=function(){this._initialized=!0,this._init()},r.prototype.setUnwrap=function(){this._unwrap=!0},r.prototype.howMany=function(){return this._howMany},r.prototype.setHowMany=function(e){this._howMany=e},r.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},r.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},r.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},r.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new d,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},r.prototype._fulfilled=function(){return this._totalResolved},r.prototype._rejected=function(){return this._values.length-this.length()},r.prototype._addRejected=function(e){this._values.push(e)},r.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},r.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},r.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new a(t)},r.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return s(e,t)},e.prototype.some=function(e){return s(this,e)},e._SomePromiseArray=r}},function(e,t){"use strict";e.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var i=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},s=t.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},o=t.prototype.isPending=function(){return 0===(50397184&this._bitField)},a=t.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},e.prototype.isPending=function(){return o.call(this._target())},e.prototype.isRejected=function(){return s.call(this._target())},e.prototype.isFulfilled=function(){return r.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return i.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},function(e,t,i){"use strict";e.exports=function(e,t){function n(i,n){if(u(i)){if(i instanceof e)return i;var r=s(i);if(r===l){n&&n._pushContext();var d=e.reject(r.e);return n&&n._popContext(),d}if("function"==typeof r){if(o(i)){var d=new e(t);return i._then(d._fulfill,d._reject,void 0,d,null),d}return a(i,r,n)}}return i}function r(e){return e.then}function s(e){try{return r(e)}catch(e){return l.e=e,
l}}function o(e){try{return c.call(e,"_promise0")}catch(e){return!1}}function a(i,n,r){function s(e){a&&(a._resolveCallback(e),a=null)}function o(e){a&&(a._rejectCallback(e,c,!0),a=null)}var a=new e(t),u=a;r&&r._pushContext(),a._captureStackTrace(),r&&r._popContext();var c=!0,h=d.tryCatch(n).call(i,s,o);return c=!1,a&&h===l&&(a._rejectCallback(h.e,!0,!0),a=null),u}var d=i(3),l=d.errorObj,u=d.isObject,c={}.hasOwnProperty;return n}},function(e,t,i){"use strict";e.exports=function(e,t,n){function r(e){this.handle=e}function s(e){return clearTimeout(this.handle),e}function o(e){throw clearTimeout(this.handle),e}var a=i(3),d=e.TimeoutError;r.prototype._resultCancelled=function(){clearTimeout(this.handle)};var l=function(e){return u(+this).thenReturn(e)},u=e.delay=function(i,s){var o,a;return void 0!==s?(o=e.resolve(s)._then(l,null,null,i,void 0),n.cancellation()&&s instanceof e&&o._setOnCancel(s)):(o=new e(t),a=setTimeout(function(){o._fulfill()},+i),n.cancellation()&&o._setOnCancel(new r(a)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};e.prototype.delay=function(e){return u(e,this)};var c=function(e,t,i){var n;n="string"!=typeof t?t instanceof Error?t:new d("operation timed out"):new d(t),a.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._reject(n),null!=i&&i.cancel()};e.prototype.timeout=function(e,t){e=+e;var i,a,d=new r(setTimeout(function(){i.isPending()&&c(i,t,a)},e));return n.cancellation()?(a=this.then(),i=a._then(s,o,void 0,d,void 0),i._setOnCancel(d)):i=this._then(s,o,void 0,d,void 0),i}}},function(e,t,i){"use strict";e.exports=function(e,t,n,r,s,o){function a(e){setTimeout(function(){throw e},0)}function d(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function l(t,i){function r(){if(o>=l)return u._fulfill();var s=d(t[o++]);if(s instanceof e&&s._isDisposable()){try{s=n(s._getDisposer().tryDispose(i),t.promise)}catch(e){return a(e)}if(s instanceof e)return s._then(r,a,null,null,null)}r()}var o=0,l=t.length,u=new e(s);return r(),u}function u(e,t,i){this._data=e,this._promise=t,this._context=i}function c(e,t,i){this.constructor$(e,t,i)}function h(e){return u.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function p(e){this.length=e,this.promise=null,this[e-1]=null}var f=i(3),v=i(7).TypeError,m=i(3).inherits,g=f.errorObj,y=f.tryCatch,_={};u.prototype.data=function(){return this._data},u.prototype.promise=function(){return this._promise},u.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():_},u.prototype.tryDispose=function(e){var t=this.resource(),i=this._context;void 0!==i&&i._pushContext();var n=t!==_?this.doDispose(t,e):null;return void 0!==i&&i._popContext(),this._promise._unsetDisposable(),this._data=null,n},u.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},m(c,u),c.prototype.doDispose=function(e,t){var i=this.data();return i.call(e,e,t)},p.prototype._resultCancelled=function(){for(var t=this.length,i=0;i<t;++i){var n=this[i];n instanceof e&&n.cancel()}},e.using=function(){var i=arguments.length;if(i<2)return t("you must pass at least 2 arguments to Promise.using");var r=arguments[i-1];if("function"!=typeof r)return t("expecting a function but got "+f.classString(r));var s,a=!0;2===i&&Array.isArray(arguments[0])?(s=arguments[0],i=s.length,a=!1):(s=arguments,i--);for(var d=new p(i),c=0;c<i;++c){var v=s[c];if(u.isDisposer(v)){var m=v;v=v.promise(),v._setDisposable(m)}else{var _=n(v);_ instanceof e&&(v=_._then(h,null,null,{resources:d,index:c},void 0))}d[c]=v}for(var b=new Array(d.length),c=0;c<b.length;++c)b[c]=e.resolve(d[c]).reflect();var w=e.all(b).then(function(e){for(var t=0;t<e.length;++t){var i=e[t];if(i.isRejected())return g.e=i.error(),g;if(!i.isFulfilled())return void w.cancel();e[t]=i.value()}k._pushContext(),r=y(r);var n=a?r.apply(void 0,e):r(e),s=k._popContext();return o.checkForgottenReturns(n,s,"Promise.using",k),n}),k=w.lastly(function(){var t=new e.PromiseInspection(w);return l(d,t)});return d.promise=k,k._setOnCancel(d),k},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},e.prototype.disposer=function(e){if("function"==typeof e)return new c(e,this,r());throw new v}}},function(e,t,i){!function(t,i){e.exports=i()}(window,function(){return function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var r in e)t.d(n,r,function(t){return e[t]}.bind(null,r));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var s=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.found=!1,this.attributes=t,this.pixelsToTrack=i,this.rstField=n,this.pixels=[],this.actions=[],this.queryString={},this.stopped=!1}var t,i,r;return t=e,(i=[{key:"find",value:function(){return this.found||0<document.querySelectorAll(this.attributes).length&&(this.found=!0),this.found}},{key:"trackPixel",value:function(e){if(this._shouldTrackUrl(e)){var t=this._extractQueryString(e);if(t.hasOwnProperty(this.rstField)){var i=t[this.rstField];this.pixels.push(e),this.queryString[i]=t,this.actions.push(i)}}}},{key:"_shouldTrackUrl",value:function(e){return e&&-1<e.indexOf(this.pixelsToTrack)}},{key:"_extractQueryString",value:function(e){for(var t=e.substring(e.indexOf("?")+1).split("&"),i={},n=0;n<t.length;n++){var r=t[n].split("=");i[r[0].toLowerCase()]=r[1]}return i}},{key:"get",value:function(){return{found:this.found,pixels:this.pixels,actions:this.actions,qs:this.queryString}}},{key:"destroy",value:function(){this.pixels=this.actions=this.queryString=void 0,this.stopped=!0}}])&&n(t.prototype,i),r&&n(t,r),e}(),o=function(){function e(t){for(var i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.competitors={},t){var n=t[i];this.competitors[i]=new s(n.attr,n.pxltrck,n.rstfld)}this.maxRetries=5,this.stopped=!1}var t,i,n;return t=e,(i=[{key:"startDetection",value:function(){this._hasCompetitorsToDetect()&&(this.detectCompetitors=this._detectCompetitors.bind(this),this.detectCompetitors(),this._hookToPixels())}},{key:"_hasCompetitorsToDetect",value:function(){return 0<Object.keys(this.competitors).length}},{key:"_detectCompetitors",value:function(){if(!this.stopped){var e=!0;for(var t in this.competitors)this.competitors[t].find()||(e=!1);e||(0<--this.maxRetries?setTimeout(this.detectCompetitors,5e3):this.destroy())}}},{key:"_hookToPixels",value:function(){var e=this;Object.defineProperty(HTMLImageElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLImageElement.prototype,"src")),Object.defineProperty(HTMLImageElement.prototype,"src",{get:function(){return this._src},set:function(t){if(!e.stopped)for(var i in e.competitors)e.competitors[i].trackPixel(t);this._src=t}})}},{key:"destroy",value:function(){if(!this.stopped){this._hasCompetitorsToDetect()&&Object.defineProperty(HTMLImageElement.prototype,"src",Object.getOwnPropertyDescriptor(HTMLImageElement.prototype,"_src")),this.get();for(var e in this.competitors)this.competitors[e].destroy();this.competitors=this.detectCompetitors=void 0,this.stopped=!0}}},{key:"get",value:function(){var e={};for(var t in this.competitors)e[t]=this.competitors[t].get();return e}}])&&r(t.prototype,i),n&&r(t,n),e}();try{if(window.cmTag){var a=window.cmTag.config.ms||{};a["competitors-detection"]=a["competitors-detection"]||{},a["competitors-detection"]["1.0.1"]=o,window.cmTag.set("ms",a)}window.TRC&&(window.TRC["competitors-detection"]=window.TRC["competitors-detection"]||{},window.TRC["competitors-detection"]["1.0.1"]=o)}catch(e){}}])})},function(e,t,i){"use strict";function n(e){var t=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}function r(e,t){var i,r,a,d,l,u,c=!1;t||(t={}),i=t.debug||!1;try{a=s(),d=document.createRange(),l=document.getSelection(),u=document.createElement("span"),u.textContent=e,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",function(i){i.stopPropagation(),t.format&&(i.preventDefault(),i.clipboardData.clearData(),i.clipboardData.setData(t.format,e))}),document.body.appendChild(u),d.selectNodeContents(u),l.addRange(d);var h=document.execCommand("copy");if(!h)throw new Error("copy command was unsuccessful");c=!0}catch(s){i&&console.error("unable to copy using execCommand: ",s),i&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),c=!0}catch(s){i&&console.error("unable to copy using clipboardData: ",s),i&&console.error("falling back to prompt"),r=n("message"in t?t.message:o),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(d):l.removeAllRanges()),u&&document.body.removeChild(u),a()}return c}var s=i(154),o="Copy to clipboard: #{key}, Enter";e.exports=r},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(13),i(14),i(9),i(4))}(this,function(e){return function(){var t=e,i=t.lib,n=i.BlockCipher,r=t.algo,s=[],o=[],a=[],d=[],l=[],u=[],c=[],h=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)t<128?e[t]=t<<1:e[t]=t<<1^283;for(var i=0,n=0,t=0;t<256;t++){var r=n^n<<1^n<<2^n<<3^n<<4;r=r>>>8^255&r^99,s[i]=r,o[r]=i;var v=e[i],m=e[v],g=e[m],y=257*e[r]^16843008*r;a[i]=y<<24|y>>>8,d[i]=y<<16|y>>>16,l[i]=y<<8|y>>>24,u[i]=y;var y=16843009*g^65537*m^257*v^16843008*i;c[r]=y<<24|y>>>8,h[r]=y<<16|y>>>16,p[r]=y<<8|y>>>24,f[r]=y,i?(i=v^e[e[e[g^v]]],n^=e[e[n]]):i=n=1}}();var v=[0,1,2,4,8,16,32,64,128,27,54],m=r.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,i=e.sigBytes/4,n=this._nRounds=i+6,r=4*(n+1),o=this._keySchedule=[],a=0;a<r;a++)if(a<i)o[a]=t[a];else{var d=o[a-1];a%i?i>6&&a%i==4&&(d=s[d>>>24]<<24|s[d>>>16&255]<<16|s[d>>>8&255]<<8|s[255&d]):(d=d<<8|d>>>24,d=s[d>>>24]<<24|s[d>>>16&255]<<16|s[d>>>8&255]<<8|s[255&d],d^=v[a/i|0]<<24),o[a]=o[a-i]^d}for(var l=this._invKeySchedule=[],u=0;u<r;u++){var a=r-u;if(u%4)var d=o[a];else var d=o[a-4];u<4||a<=4?l[u]=d:l[u]=c[s[d>>>24]]^h[s[d>>>16&255]]^p[s[d>>>8&255]]^f[s[255&d]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,d,l,u,s)},decryptBlock:function(e,t){var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,c,h,p,f,o);var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,n,r,s,o,a){for(var d=this._nRounds,l=e[t]^i[0],u=e[t+1]^i[1],c=e[t+2]^i[2],h=e[t+3]^i[3],p=4,f=1;f<d;f++){var v=n[l>>>24]^r[u>>>16&255]^s[c>>>8&255]^o[255&h]^i[p++],m=n[u>>>24]^r[c>>>16&255]^s[h>>>8&255]^o[255&l]^i[p++],g=n[c>>>24]^r[h>>>16&255]^s[l>>>8&255]^o[255&u]^i[p++],y=n[h>>>24]^r[l>>>16&255]^s[u>>>8&255]^o[255&c]^i[p++];l=v,u=m,c=g,h=y}var v=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[c>>>8&255]<<8|a[255&h])^i[p++],m=(a[u>>>24]<<24|a[c>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^i[p++],g=(a[c>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^i[p++],y=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&c])^i[p++];e[t]=v,e[t+1]=m,e[t+2]=g,e[t+3]=y},keySize:8});t.AES=n._createHelper(m)}(),e.AES})},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(){function t(e){return e<<8&4278255360|e>>>8&16711935}var i=e,n=i.lib,r=n.WordArray,s=i.enc;s.Utf16=s.Utf16BE={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],r=0;r<i;r+=2){var s=t[r>>>2]>>>16-r%4*8&65535;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>1]|=e.charCodeAt(n)<<16-n%2*16;return r.create(i,2*t)}},s.Utf16LE={stringify:function(e){for(var i=e.words,n=e.sigBytes,r=[],s=0;s<n;s+=2){var o=t(i[s>>>2]>>>16-s%4*8&65535);r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var i=e.length,n=[],s=0;s<i;s++)n[s>>>1]|=t(e.charCodeAt(s)<<16-s%2*16);return r.create(n,2*i)}}}(),e.enc.Utf16})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return function(t){var i=e,n=i.lib,r=n.CipherParams,s=i.enc,o=s.Hex,a=i.format;a.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return r.create({ciphertext:t})}}}(),e.format.Hex})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(19),i(132),i(129),i(13),i(14),i(22),i(39),i(148),i(40),i(150),i(149),i(147),i(21),i(143),i(9),i(4),i(133),i(135),i(134),i(137),i(136),i(138),i(139),i(140),i(142),i(141),i(130),i(128),i(151),i(146),i(145),i(144))}(this,function(e){return e})},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){return function(){if("function"==typeof ArrayBuffer){var t=e,i=t.lib,n=i.WordArray,r=n.init,s=n.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,i=[],n=0;n<t;n++)i[n>>>2]|=e[n]<<24-n%4*8;r.call(this,i,t)}else r.apply(this,arguments)};s.prototype=n}}(),e.lib.WordArray})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.mode.CFB=function(){function t(e,t,i,n){var r=this._iv;if(r){var s=r.slice(0);this._iv=void 0}else var s=this._prevBlock;n.encryptBlock(s,0);for(var o=0;o<i;o++)e[t+o]^=s[o]}var i=e.lib.BlockCipherMode.extend();return i.Encryptor=i.extend({processBlock:function(e,i){var n=this._cipher,r=n.blockSize;t.call(this,e,i,r,n),this._prevBlock=e.slice(i,i+r)}}),i.Decryptor=i.extend({processBlock:function(e,i){var n=this._cipher,r=n.blockSize,s=e.slice(i,i+r);t.call(this,e,i,r,n),this._prevBlock=s}}),i}(),e.mode.CFB})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){/** @preserve
		 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
		 * derived from CryptoJS.mode.CTR
		 * Jan Hruby jhruby.web@gmail.com
		 */
return e.mode.CTRGladman=function(){function t(e){if(255===(e>>24&255)){var t=e>>16&255,i=e>>8&255,n=255&e;255===t?(t=0,255===i?(i=0,255===n?n=0:++n):++i):++t,e=0,e+=t<<16,e+=i<<8,e+=n}else e+=1<<24;return e}function i(e){return 0===(e[0]=t(e[0]))&&(e[1]=t(e[1])),e}var n=e.lib.BlockCipherMode.extend(),r=n.Encryptor=n.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,s=this._iv,o=this._counter;s&&(o=this._counter=s.slice(0),this._iv=void 0),i(o);var a=o.slice(0);n.encryptBlock(a,0);for(var d=0;d<r;d++)e[t+d]^=a[d]}});return n.Decryptor=r,n}(),e.mode.CTRGladman})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),i=t.Encryptor=t.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize,r=this._iv,s=this._counter;r&&(s=this._counter=r.slice(0),this._iv=void 0);var o=s.slice(0);i.encryptBlock(o,0),s[n-1]=s[n-1]+1|0;for(var a=0;a<n;a++)e[t+a]^=o[a]}});return t.Decryptor=i,t}(),e.mode.CTR})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t}(),e.mode.ECB})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),i=t.Encryptor=t.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize,r=this._iv,s=this._keystream;r&&(s=this._keystream=r.slice(0),this._iv=void 0),i.encryptBlock(s,0);for(var o=0;o<n;o++)e[t+o]^=s[o]}});return t.Decryptor=i,t}(),e.mode.OFB})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.pad.AnsiX923={pad:function(e,t){var i=e.sigBytes,n=4*t,r=n-i%n,s=i+r-1;e.clamp(),e.words[s>>>2]|=r<<24-s%4*8,e.sigBytes+=r},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.pad.Iso10126={pad:function(t,i){var n=4*i,r=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(r-1)).concat(e.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.pad.Iso97971={pad:function(t,i){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,i)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(4))}(this,function(e){return e.pad.ZeroPadding={pad:function(e,t){var i=4*t;e.clamp(),e.sigBytes+=i-(e.sigBytes%i||i)},unpad:function(e){for(var t=e.words,i=e.sigBytes-1;!(t[i>>>2]>>>24-i%4*8&255);)i--;e.sigBytes=i+1}},e.pad.ZeroPadding})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(22),i(21))}(this,function(e){return function(){var t=e,i=t.lib,n=i.Base,r=i.WordArray,s=t.algo,o=s.SHA1,a=s.HMAC,d=s.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=this.cfg,n=a.create(i.hasher,e),s=r.create(),o=r.create([1]),d=s.words,l=o.words,u=i.keySize,c=i.iterations;d.length<u;){var h=n.update(t).finalize(o);n.reset();for(var p=h.words,f=p.length,v=h,m=1;m<c;m++){v=n.finalize(v),n.reset();for(var g=v.words,y=0;y<f;y++)p[y]^=g[y]}s.concat(h),l[0]++}return s.sigBytes=4*u,s}});t.PBKDF2=function(e,t,i){return d.create(i).compute(e,t)}}(),e.PBKDF2})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(13),i(14),i(9),i(4))}(this,function(e){return function(){function t(){for(var e=this._X,t=this._C,i=0;i<8;i++)a[i]=t[i];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0;for(var i=0;i<8;i++){var n=e[i]+t[i],r=65535&n,s=n>>>16,o=((r*r>>>17)+r*s>>>15)+s*s,l=((4294901760&n)*n|0)+((65535&n)*n|0);d[i]=o^l}e[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,e[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,e[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,e[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,e[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,e[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,e[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,e[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}var i=e,n=i.lib,r=n.StreamCipher,s=i.algo,o=[],a=[],d=[],l=s.RabbitLegacy=r.extend({_doReset:function(){var e=this._key.words,i=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var s=0;s<4;s++)t.call(this);for(var s=0;s<8;s++)r[s]^=n[s+4&7];if(i){var o=i.words,a=o[0],d=o[1],l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),c=l>>>16|4294901760&u,h=u<<16|65535&l;r[0]^=l,r[1]^=c,r[2]^=u,r[3]^=h,r[4]^=l,r[5]^=c,r[6]^=u,r[7]^=h;for(var s=0;s<4;s++)t.call(this)}},_doProcessBlock:function(e,i){var n=this._X;t.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[i+r]^=o[r]},blockSize:4,ivSize:2});i.RabbitLegacy=r._createHelper(l)}(),e.RabbitLegacy})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(13),i(14),i(9),i(4))}(this,function(e){return function(){function t(){for(var e=this._X,t=this._C,i=0;i<8;i++)a[i]=t[i];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0;for(var i=0;i<8;i++){var n=e[i]+t[i],r=65535&n,s=n>>>16,o=((r*r>>>17)+r*s>>>15)+s*s,l=((4294901760&n)*n|0)+((65535&n)*n|0);d[i]=o^l}e[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,e[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,e[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,e[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,e[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,e[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,e[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,e[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}var i=e,n=i.lib,r=n.StreamCipher,s=i.algo,o=[],a=[],d=[],l=s.Rabbit=r.extend({_doReset:function(){for(var e=this._key.words,i=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],s=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var n=0;n<4;n++)t.call(this);for(var n=0;n<8;n++)s[n]^=r[n+4&7];if(i){var o=i.words,a=o[0],d=o[1],l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),c=l>>>16|4294901760&u,h=u<<16|65535&l;s[0]^=l,s[1]^=c,s[2]^=u,s[3]^=h,s[4]^=l,s[5]^=c,s[6]^=u,s[7]^=h;for(var n=0;n<4;n++)t.call(this)}},_doProcessBlock:function(e,i){var n=this._X;t.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[i+r]^=o[r]},blockSize:4,ivSize:2});i.Rabbit=r._createHelper(l)}(),e.Rabbit})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(13),i(14),i(9),i(4))}(this,function(e){return function(){function t(){for(var e=this._S,t=this._i,i=this._j,n=0,r=0;r<4;r++){t=(t+1)%256,i=(i+e[t])%256;var s=e[t];e[t]=e[i],e[i]=s,n|=e[(e[t]+e[i])%256]<<24-8*r}return this._i=t,this._j=i,n}var i=e,n=i.lib,r=n.StreamCipher,s=i.algo,o=s.RC4=r.extend({_doReset:function(){for(var e=this._key,t=e.words,i=e.sigBytes,n=this._S=[],r=0;r<256;r++)n[r]=r;for(var r=0,s=0;r<256;r++){var o=r%i,a=t[o>>>2]>>>24-o%4*8&255;s=(s+n[r]+a)%256;var d=n[r];n[r]=n[s],n[s]=d}this._i=this._j=0},_doProcessBlock:function(e,i){e[i]^=t.call(this)},keySize:8,ivSize:0});i.RC4=r._createHelper(o);var a=s.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)t.call(this)}});i.RC4Drop=r._createHelper(a)}(),e.RC4})},function(e,t,i){!function(n,r){e.exports=t=r(i(2))}(this,function(e){/** @preserve
		(c) 2012 by Cdric Mesnil. All rights reserved.
	
		Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
	
		    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
		    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
	
		THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
		*/
return function(t){function i(e,t,i){return e^t^i}function n(e,t,i){return e&t|~e&i}function r(e,t,i){return(e|~t)^i}function s(e,t,i){return e&i|t&~i}function o(e,t,i){return e^(t|~i)}function a(e,t){return e<<t|e>>>32-t}var d=e,l=d.lib,u=l.WordArray,c=l.Hasher,h=d.algo,p=u.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),f=u.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),v=u.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),m=u.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),g=u.create([0,1518500249,1859775393,2400959708,2840853838]),y=u.create([1352829926,1548603684,1836072691,2053994217,0]),_=h.RIPEMD160=c.extend({_doReset:function(){this._hash=u.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var d=0;d<16;d++){var l=t+d,u=e[l];e[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var c,h,_,b,w,k,A,T,C,E,P=this._hash.words,S=g.words,V=y.words,x=p.words,I=f.words,O=v.words,D=m.words;k=c=P[0],A=h=P[1],T=_=P[2],C=b=P[3],E=w=P[4];for(var M,d=0;d<80;d+=1)M=c+e[t+x[d]]|0,M+=d<16?i(h,_,b)+S[0]:d<32?n(h,_,b)+S[1]:d<48?r(h,_,b)+S[2]:d<64?s(h,_,b)+S[3]:o(h,_,b)+S[4],M|=0,M=a(M,O[d]),M=M+w|0,c=w,w=b,b=a(_,10),_=h,h=M,M=k+e[t+I[d]]|0,M+=d<16?o(A,T,C)+V[0]:d<32?s(A,T,C)+V[1]:d<48?r(A,T,C)+V[2]:d<64?n(A,T,C)+V[3]:i(A,T,C)+V[4],M|=0,M=a(M,D[d]),M=M+E|0,k=E,E=C,C=a(T,10),T=A,A=M;M=P[1]+_+C|0,P[1]=P[2]+b+E|0,P[2]=P[3]+w+k|0,P[3]=P[4]+c+A|0,P[4]=P[0]+h+T|0,P[0]=M},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[(n+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process();for(var r=this._hash,s=r.words,o=0;o<5;o++){var a=s[o];s[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return r},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}});d.RIPEMD160=c._createHelper(_),d.HmacRIPEMD160=c._createHmacHelper(_)}(Math),e.RIPEMD160})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(39))}(this,function(e){return function(){var t=e,i=t.lib,n=i.WordArray,r=t.algo,s=r.SHA256,o=r.SHA224=s.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=4,e}});t.SHA224=s._createHelper(o),t.HmacSHA224=s._createHmacHelper(o)}(),e.SHA224})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(19))}(this,function(e){return function(t){var i=e,n=i.lib,r=n.WordArray,s=n.Hasher,o=i.x64,a=o.Word,d=i.algo,l=[],u=[],c=[];!function(){for(var e=1,t=0,i=0;i<24;i++){l[e+5*t]=(i+1)*(i+2)/2%64;var n=t%5,r=(2*e+3*t)%5;e=n,t=r}for(var e=0;e<5;e++)for(var t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var s=1,o=0;o<24;o++){for(var d=0,h=0,p=0;p<7;p++){if(1&s){var f=(1<<p)-1;f<32?h^=1<<f:d^=1<<f-32}128&s?s=s<<1^113:s<<=1}c[o]=a.create(d,h)}}();var h=[];!function(){for(var e=0;e<25;e++)h[e]=a.create()}();var p=d.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var i=this._state,n=this.blockSize/2,r=0;r<n;r++){var s=e[t+2*r],o=e[t+2*r+1];s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);var a=i[r];a.high^=o,a.low^=s}for(var d=0;d<24;d++){for(var p=0;p<5;p++){for(var f=0,v=0,m=0;m<5;m++){var a=i[p+5*m];f^=a.high,v^=a.low}var g=h[p];g.high=f,g.low=v}for(var p=0;p<5;p++)for(var y=h[(p+4)%5],_=h[(p+1)%5],b=_.high,w=_.low,f=y.high^(b<<1|w>>>31),v=y.low^(w<<1|b>>>31),m=0;m<5;m++){var a=i[p+5*m];a.high^=f,a.low^=v}for(var k=1;k<25;k++){var a=i[k],A=a.high,T=a.low,C=l[k];if(C<32)var f=A<<C|T>>>32-C,v=T<<C|A>>>32-C;else var f=T<<C-32|A>>>64-C,v=A<<C-32|T>>>64-C;var E=h[u[k]];E.high=f,E.low=v}var P=h[0],S=i[0];P.high=S.high,P.low=S.low;for(var p=0;p<5;p++)for(var m=0;m<5;m++){var k=p+5*m,a=i[k],V=h[k],x=h[(p+1)%5+5*m],I=h[(p+2)%5+5*m];a.high=V.high^~x.high&I.high,a.low=V.low^~x.low&I.low}var a=i[0],O=c[d];a.high^=O.high,a.low^=O.low}},_doFinalize:function(){var e=this._data,i=e.words,n=(8*this._nDataBytes,8*e.sigBytes),s=32*this.blockSize;i[n>>>5]|=1<<24-n%32,i[(t.ceil((n+1)/s)*s>>>5)-1]|=128,e.sigBytes=4*i.length,this._process();for(var o=this._state,a=this.cfg.outputLength/8,d=a/8,l=[],u=0;u<d;u++){var c=o[u],h=c.high,p=c.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),l.push(p),l.push(h)}return new r.init(l,a)},clone:function(){for(var e=s.clone.call(this),t=e._state=this._state.slice(0),i=0;i<25;i++)t[i]=t[i].clone();return e}});i.SHA3=s._createHelper(p),i.HmacSHA3=s._createHmacHelper(p)}(Math),e.SHA3})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(19),i(40))}(this,function(e){return function(){var t=e,i=t.x64,n=i.Word,r=i.WordArray,s=t.algo,o=s.SHA512,a=s.SHA384=o.extend({_doReset:function(){this._hash=new r.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=16,e}});t.SHA384=o._createHelper(a),t.HmacSHA384=o._createHmacHelper(a)}(),e.SHA384})},function(e,t,i){!function(n,r,s){e.exports=t=r(i(2),i(13),i(14),i(9),i(4))}(this,function(e){return function(){function t(e,t){var i=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=i,this._lBlock^=i<<e}function i(e,t){var i=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=i,this._rBlock^=i<<e}var n=e,r=n.lib,s=r.WordArray,o=r.BlockCipher,a=n.algo,d=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=a.DES=o.extend({_doReset:function(){for(var e=this._key,t=e.words,i=[],n=0;n<56;n++){var r=d[n]-1;i[n]=t[r>>>5]>>>31-r%32&1}for(var s=this._subKeys=[],o=0;o<16;o++){for(var a=s[o]=[],c=u[o],n=0;n<24;n++)a[n/6|0]|=i[(l[n]-1+c)%28]<<31-n%6,a[4+(n/6|0)]|=i[28+(l[n+24]-1+c)%28]<<31-n%6;a[0]=a[0]<<1|a[0]>>>31;for(var n=1;n<7;n++)a[n]=a[n]>>>4*(n-1)+3;a[7]=a[7]<<5|a[7]>>>27}for(var h=this._invSubKeys=[],n=0;n<16;n++)h[n]=s[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,n,r){this._lBlock=e[n],this._rBlock=e[n+1],t.call(this,4,252645135),t.call(this,16,65535),i.call(this,2,858993459),i.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;s<16;s++){for(var o=r[s],a=this._lBlock,d=this._rBlock,l=0,u=0;u<8;u++)l|=c[u][((d^o[u])&h[u])>>>0];this._lBlock=d,this._rBlock=a^l}var p=this._lBlock;this._lBlock=this._rBlock,this._rBlock=p,t.call(this,1,1431655765),i.call(this,8,16711935),i.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),e[n]=this._lBlock,e[n+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=o._createHelper(p);var f=a.TripleDES=o.extend({_doReset:function(){var e=this._key,t=e.words;this._des1=p.createEncryptor(s.create(t.slice(0,2))),this._des2=p.createEncryptor(s.create(t.slice(2,4))),this._des3=p.createEncryptor(s.create(t.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});n.TripleDES=o._createHelper(f)}(),e.TripleDES})},function(e,t){(function(t){function i(e,t,i){function r(t){var i=v,n=m;return v=m=void 0,T=t,y=e.apply(n,i)}function s(e){return T=e,_=setTimeout(u,t),C?r(e):y}function d(e){var i=e-A,n=e-T,r=t-i;return E?w(r,g-n):r}function l(e){var i=e-A,n=e-T;return void 0===A||i>=t||i<0||E&&n>=g}function u(){var e=k();return l(e)?c(e):void(_=setTimeout(u,d(e)))}function c(e){return _=void 0,P&&v?r(e):(v=m=void 0,y)}function h(){void 0!==_&&clearTimeout(_),T=0,v=A=m=_=void 0}function p(){return void 0===_?y:c(k())}function f(){var e=k(),i=l(e);if(v=arguments,m=this,A=e,i){if(void 0===_)return s(A);if(E)return _=setTimeout(u,t),r(A)}return void 0===_&&(_=setTimeout(u,t)),y}var v,m,g,y,_,A,T=0,C=!1,E=!1,P=!0;if("function"!=typeof e)throw new TypeError(a);return t=o(t)||0,n(i)&&(C=!!i.leading,E="maxWait"in i,g=E?b(o(i.maxWait)||0,t):g,P="trailing"in i?!!i.trailing:P),f.cancel=h,f.flush=p,f}function n(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function r(e){return!!e&&"object"==typeof e}function s(e){return"symbol"==typeof e||r(e)&&_.call(e)==l}function o(e){if("number"==typeof e)return e;if(s(e))return d;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var i=h.test(e);return i||p.test(e)?f(e.slice(2),i?2:8):c.test(e)?d:+e}var a="Expected a function",d=NaN,l="[object Symbol]",u=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,p=/^0o[0-7]+$/i,f=parseInt,v="object"==typeof t&&t&&t.Object===Object&&t,m="object"==typeof self&&self&&self.Object===Object&&self,g=v||m||Function("return this")(),y=Object.prototype,_=y.toString,b=Math.max,w=Math.min,k=function(){return g.Date.now()};e.exports=i}).call(t,function(){return this}())},function(e,t,i){!function(t,i){e.exports=i()}(this,function(){return function(e){function t(e){delete installedChunks[e]}function i(e){var t=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.src=p.p+"hot_updater/hot-update.js",t.appendChild(i)}function n(){return new Promise(function(e,t){if("undefined"==typeof XMLHttpRequest)return t(new Error("No browser support"));try{var i=new XMLHttpRequest,n=p.p+"hot_updater/hot-update.json";i.open("GET",n,!0),i.timeout=1e4,i.send(null)}catch(e){return t(e)}i.onreadystatechange=function(){if(4===i.readyState)if(0===i.status)t(new Error("Manifest request to "+n+" timed out."));else if(404===i.status)e();else if(200!==i.status&&304!==i.status)t(new Error("Manifest request to "+n+" failed."));else{try{var r=JSON.parse(i.responseText)}catch(e){return void t(e)}e(r)}}})}function r(e){var t=I[e];if(!t)return p;var i=function(i){return t.hot.active?(I[i]?I[i].parents.indexOf(e)<0&&I[i].parents.push(e):(k=[e],v=i),t.children.indexOf(i)<0&&t.children.push(i)):(console.warn("[HMR] unexpected require("+i+") from disposed module "+e),k=[]),p(i)};for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&"e"!==n&&Object.defineProperty(i,n,function(e){return{configurable:!0,enumerable:!0,get:function(){return p[e]},set:function(t){p[e]=t}}}(n));return i.e=function(e){function t(){P--,"prepare"===C&&(S[e]||u(e),0===P&&0===E&&c())}return"ready"===C&&o("prepare"),P++,p.e(e).then(t,function(e){throw t(),e})},i}function s(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:v!==e,active:!0,accept:function(e,i){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._acceptedDependencies[e[n]]=i||function(){};else t._acceptedDependencies[e]=i||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._declinedDependencies[e[i]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var i=t._disposeHandlers.indexOf(e);i>=0&&t._disposeHandlers.splice(i,1)},check:d,apply:h,status:function(e){return e?void T.push(e):C},addStatusHandler:function(e){T.push(e)},removeStatusHandler:function(e){var t=T.indexOf(e);t>=0&&T.splice(t,1)},data:w[e]};return v=void 0,t}function o(e){C=e;for(var t=0;t<T.length;t++)T[t].call(null,e)}function a(e){return+e+""===e?+e:e}function d(e){if("idle"!==C)throw new Error("check() is only allowed in idle status");return _=e,o("check"),n().then(function(e){if(!e)return o("idle"),null;V={},S={},x=e.c,y=e.h,o("prepare");var t=new Promise(function(e,t){m={resolve:e,reject:t}});return g={},u(0),"prepare"===C&&0===P&&0===E&&c(),t})}function l(e,t){if(x[e]&&V[e]){V[e]=!1;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(g[i]=t[i]);0==--E&&0===P&&c()}}function u(e){x[e]?(V[e]=!0,E++,i(e)):S[e]=!0}function c(){o("ready");var e=m;if(m=null,e)if(_)h(_).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var i in g)Object.prototype.hasOwnProperty.call(g,i)&&t.push(a(i));e.resolve(t)}}function h(i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.indexOf(n)<0&&e.push(n)}}if("ready"!==C)throw new Error("apply() is only allowed in ready status");i=i||{};var r,s,d,l,u,c={},h=[],f={},v=function(){console.warn("[HMR] unexpected require("+_.moduleId+") to disposed module")};for(var m in g)if(Object.prototype.hasOwnProperty.call(g,m)){u=a(m);var _;_=g[m]?function(e){for(var t=[e],i={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var s=r.pop(),o=s.id,a=s.chain;if((l=I[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:a,moduleId:o};for(var d=0;d<l.parents.length;d++){var u=l.parents[d],c=I[u];if(c){if(c.hot._declinedDependencies[o])return{type:"declined",chain:a.concat([u]),moduleId:o,parentId:u};t.indexOf(u)>=0||(c.hot._acceptedDependencies[o]?(i[u]||(i[u]=[]),n(i[u],[o])):(delete i[u],t.push(u),r.push({chain:a.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}(u):{type:"disposed",moduleId:m};var A=!1,T=!1,E=!1,P="";switch(_.chain&&(P="\nUpdate propagation: "+_.chain.join(" -> ")),_.type){case"self-declined":i.onDeclined&&i.onDeclined(_),i.ignoreDeclined||(A=new Error("Aborted because of self decline: "+_.moduleId+P));break;case"declined":i.onDeclined&&i.onDeclined(_),i.ignoreDeclined||(A=new Error("Aborted because of declined dependency: "+_.moduleId+" in "+_.parentId+P));break;case"unaccepted":i.onUnaccepted&&i.onUnaccepted(_),i.ignoreUnaccepted||(A=new Error("Aborted because "+u+" is not accepted"+P));break;case"accepted":i.onAccepted&&i.onAccepted(_),T=!0;break;case"disposed":i.onDisposed&&i.onDisposed(_),E=!0;break;default:throw new Error("Unexception type "+_.type)}if(A)return o("abort"),Promise.reject(A);if(T){f[u]=g[u],n(h,_.outdatedModules);for(u in _.outdatedDependencies)Object.prototype.hasOwnProperty.call(_.outdatedDependencies,u)&&(c[u]||(c[u]=[]),n(c[u],_.outdatedDependencies[u]))}E&&(n(h,[_.moduleId]),f[u]=v)}var S=[];for(s=0;s<h.length;s++)u=h[s],I[u]&&I[u].hot._selfAccepted&&S.push({module:u,errorHandler:I[u].hot._selfAccepted});o("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&t(e)});for(var V,O=h.slice();O.length>0;)if(u=O.pop(),l=I[u]){var D={},M=l.hot._disposeHandlers;for(d=0;d<M.length;d++)(r=M[d])(D);for(w[u]=D,l.hot.active=!1,delete I[u],d=0;d<l.children.length;d++){var R=I[l.children[d]];R&&(V=R.parents.indexOf(u))>=0&&R.parents.splice(V,1)}}var F,L;for(u in c)if(Object.prototype.hasOwnProperty.call(c,u)&&(l=I[u]))for(L=c[u],d=0;d<L.length;d++)F=L[d],(V=l.children.indexOf(F))>=0&&l.children.splice(V,1);o("apply"),b=y;for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&(e[u]=f[u]);var B=null;for(u in c)if(Object.prototype.hasOwnProperty.call(c,u)){l=I[u],L=c[u];var j=[];for(s=0;s<L.length;s++)F=L[s],r=l.hot._acceptedDependencies[F],j.indexOf(r)>=0||j.push(r);for(s=0;s<j.length;s++){r=j[s];try{r(L)}catch(e){i.onErrored&&i.onErrored({type:"accept-errored",moduleId:u,dependencyId:L[s],error:e}),i.ignoreErrored||B||(B=e)}}}for(s=0;s<S.length;s++){var H=S[s];u=H.module,k=[u];try{p(u)}catch(e){if("function"==typeof H.errorHandler)try{H.errorHandler(e)}catch(t){i.onErrored&&i.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:t,orginalError:e}),i.ignoreErrored||B||(B=t),B||(B=e)}else i.onErrored&&i.onErrored({type:"self-accept-errored",moduleId:u,error:e}),i.ignoreErrored||B||(B=e)}}return B?(o("fail"),Promise.reject(B)):(o("idle"),new Promise(function(e){e(h)}))}function p(t){if(I[t])return I[t].exports;var i=I[t]={i:t,l:!1,exports:{},hot:s(t),parents:(A=k,k=[],A),children:[]};return e[t].call(i.exports,i,i.exports,r(t)),i.l=!0,i.exports}var f=this.webpackHotUpdate;this.webpackHotUpdate=function(e,t){l(e,t),f&&f(e,t)};var v,m,g,y,_=!0,b="0a7235b7d67844709e13",w={},k=[],A=[],T=[],C="idle",E=0,P=0,S={},V={},x={},I={};return p.m=e,p.c=I,p.i=function(e){return e},p.d=function(e,t,i){p.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="",p.h=function(){return b},r(0)(p.s=0)}({"./src/index.js":function(e,t,i){"use strict";var n=i("./src/oppsula.js");try{if(window.cmTag){var r=window.cmTag.config.ms||{};r.oppsula=r.oppsula||{},r.oppsula["1.3.6"]=n,window.cmTag.set("ms",r)}window.TRC&&(window.TRC.oppsula=window.TRC.oppsula||{},window.TRC.oppsula["1.3.6"]=n)}catch(e){}e.exports={}},"./src/opportunityType.js":function(e,t,i){"use strict";e.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,firstImpression:99,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,adLoaded:41,startAd:42,videoThrottle:43}},"./src/oppsula.js":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i("./src/xhr.js"),o=i("./src/store.js"),a=i("./src/utils.js"),d=i("./src/opportunityType.js"),l={},u=function(){function e(t,i){n(this,e);var r=this._getRedId(t)||this._getRedId(i)||"red_id";return l.hasOwnProperty(r)||(this.redId=r,this.store=new o(t,i),this.baseUrl=a.getOppsServletBaseUrl(this.store),this.xhr=new s(this.baseUrl,this.store.get("psthdrs")),this.opps=[],this.fireOppsInterval=null,this.stopped=!1,this.billableEvents=(this.store.get("bllblevt")||"").split(","),this.unloadCallbacks=[],this.fireOppsCallbacks=[],this._setFireOppsInterval(),this.unloadEventName=a.isOnIOS()?"pagehide":"beforeunload",this._setFireOppsBeforeUnload(),l[r]=this),l[r]}return r(e,[{key:"registerCallback",value:function(e,t){this[e].push(t)}},{key:"unRegisterCallback",value:function(e,t){this[e].splice(this[e].indexOf(t),1)}},{key:"_activateCallbacks",value:function(e){for(var t=0;t<this[e].length;t++){var i=this[e][t];this[e].splice(this[e].indexOf(i),1),i()}}},{key:"_getRedId",value:function(e){if(e)return e.get("redId")||e.get("red_id")}},{key:"send",value:function(e){e.tms=Math.floor((new Date).getTime()/1e3),this.stopped||(this._isBillableEvent(e.rst)||!this.store.get("cmbopps")?this.xhr.send(a.stringify([e]),e.rst):this.opps.push(e))}},{key:"_setFireOppsInterval",value:function(){this.stopped||this.fireOppsInterval||(this.fireOpps=this._fireOpps.bind(this),this.fireOppsInterval=setInterval(this.fireOpps,this.store.get("timbtopps")))}},{key:"destroy",value:function(){this.stopped||(this._activateCallbacks("unloadCallbacks"),window.removeEventListener(this.unloadEventName,this._destroy),this.fireOppsInterval=clearInterval(this.fireOppsInterval),this._fireOpps(),this.stopped=!0,this.store&&this.store.destroy(),this.opps=this.store=this.fireOpps=this.xhr=this._destroy=void 0,l[this.redId]=void 0)}},{key:"_fireOpps",value:function(){this.stopped||(this._activateCallbacks("fireOppsCallbacks"),this.opps.length>0&&this.xhr.send(a.stringify(this.opps)),this.opps=[])}},{key:"_setFireOppsBeforeUnload",value:function(){this._destroy=this.destroy.bind(this),window.addEventListener(this.unloadEventName,this._destroy)}},{key:"_isBillableEvent",value:function(e){return this.billableEvents.indexOf(""+e)>-1}},{key:"OppsID",get:function(){return d}}]),e}();e.exports=u},"./src/store.js":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=(i("./src/utils.js"),function(){function e(t,i){n(this,e),this.unitModel=t,this.playerModel=i,this.data={psthdrs:"application/json",timbtopps:2e3}}return r(e,[{key:"get",value:function(e){return this._getFromPlayerModel(e)}},{key:"_getFromPlayerModel",value:function(e){var t=this.playerModel?this.playerModel.get(e):void 0;return void 0!==t?t:this._getFromUnitModel(e)}},{key:"_getFromUnitModel",value:function(e){var t=this.unitModel?this.unitModel.get(e):void 0;return void 0!==t?t:this._getFromData(e)}},{key:"_getFromData",value:function(e){return e=e.toString(),-1===e.indexOf(".")?this.data[e]:o.get(e,!1,this.data)}},{key:"set",value:function(e,t){e=e.toString(),o.set(e,t,this.data)}},{key:"destroy",value:function(){this.unitModel=this.playerModel=this.data=void 0}}]),e}()),o=function(){var e=function(e,t,i){for(var n,r=i||data,s=0;r&&(n=e[s]);s++)r=n in r?r[n]:t?r[n]={}:void 0;return r};return{set:function(t,i,n){var r=t.split("."),s=r.pop(),o=e(r,!0,n);return o&&s?o[s]=i:void 0},get:function(t,i,n){return e(t.split("."),i,n)},exists:function(e,t){return void 0!==this.get(e,!1,t)}}}();e.exports=s},"./src/utils.js":function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={getOppsServletBaseUrl:function(e){var t=e.get("ms_data.opps_base_path");return this.setUrlPrefix(t)+(/.*\/$/g.test(t)?"":"/")+"OpportunityServlet"},setUrlPrefix:function(e){return"string"!=typeof e?e:(e=e.replace(/^(http[s]?:|ftp:)/g,""),0!==e.indexOf("//")&&(e="//"+e),e)},stringify:function(e,t){try{var i=[];return JSON.stringify(e,function(e,t){if(null!=t&&"object"==(void 0===t?"undefined":n(t))){if(i.indexOf(t)>-1)return;i.push(t)}return t},t)}catch(e){return""}},fireOpp:function(e){try{(new Image).src=e}catch(e){}},flattenParams:function(e){var t=[];for(var i in e)t.push(i+"="+e[i]);return t.join("&")},isOnIOS:function(){return navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)}}},"./src/xhr.js":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=(i("./src/utils.js"),function(){function e(t,i){
var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;arguments.length>5&&void 0!==arguments[5]&&arguments[5],n(this,e),this.baseUrl=t,this.async=void 0==r||r,this.withCredentials=void 0==s||s,this.timeout=o||5e3,this.contentType=i||"application/x-www-form-urlencoded"}return r(e,[{key:"_onFail",value:function(){this.gotResponse||(this.gotResponse=!0)}},{key:"send",value:function(e,t){if(this.baseUrl){var i=this.baseUrl+(void 0!==t?"?rst="+t:""),n=new XMLHttpRequest;return e=e||"",n.open(e?"POST":"GET",i,!0),n.withCredentials=this.withCredentials,n.setRequestHeader("Content-type",this.contentType),n.async=this.async,n.timeout=this.timeout,n.gotResponse=!1,n.addEventListener("error",this._onFail),n.addEventListener("abort",this._onFail),n.addEventListener("timeout",this._onFail),n.addEventListener("readystatechange",function(e){if(4==this.readyState){if(this.gotResponse)return;this.gotResponse=!0}}),n.send(e),!0}}}]),e}());e.exports=s},0:function(e,t,i){e.exports=i("./src/index.js")}})})},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,i=[],n=0;n<e.rangeCount;n++)i.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||i.forEach(function(t){e.addRange(t)}),t&&t.focus()}}},function(e,t,i){var n;!function(r,s){"use strict";var o="0.7.12",a="",d="?",l="function",u="undefined",c="object",h="string",p="major",f="model",v="name",m="type",g="vendor",y="version",_="architecture",b="console",w="mobile",k="tablet",A="smarttv",T="wearable",C="embedded",E={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2===0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===h?e.replace(/[^\d\.]/g,"").split(".")[0]:s},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},P={rgx:function(){for(var e,t,i,n,r,o,a,d=0,h=arguments;d<h.length&&!o;){var p=h[d],f=h[d+1];if(typeof e===u){e={};for(n in f)f.hasOwnProperty(n)&&(r=f[n],typeof r===c?e[r[0]]=s:e[r]=s)}for(t=i=0;t<p.length&&!o;)if(o=p[t++].exec(this.getUA()))for(n=0;n<f.length;n++)a=o[++i],r=f[n],typeof r===c&&r.length>0?2==r.length?typeof r[1]==l?e[r[0]]=r[1].call(this,a):e[r[0]]=r[1]:3==r.length?typeof r[1]!==l||r[1].exec&&r[1].test?e[r[0]]=a?a.replace(r[1],r[2]):s:e[r[0]]=a?r[1].call(this,a,r[2]):s:4==r.length&&(e[r[0]]=a?r[3].call(this,a.replace(r[1],r[2])):s):e[r]=a?a:s;d+=2}return e},str:function(e,t){for(var i in t)if(typeof t[i]===c&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(E.has(t[i][n],e))return i===d?s:i}else if(E.has(t[i],e))return i===d?s:i;return e}},S={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},V={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[v,y],[/(opios)[\/\s]+([\w\.]+)/i],[[v,"Opera Mini"],y],[/\s(opr)\/([\w\.]+)/i],[[v,"Opera"],y],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[v,y],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[v,"IE"],y],[/(edge)\/((\d+)?[\w\.]+)/i],[v,y],[/(yabrowser)\/([\w\.]+)/i],[[v,"Yandex"],y],[/(comodo_dragon)\/([\w\.]+)/i],[[v,/_/g," "],y],[/(micromessenger)\/([\w\.]+)/i],[[v,"WeChat"],y],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[y,[v,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[v,/(.+)/,"$1 WebView"],y],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[y,[v,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[v,y],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[v,"UCBrowser"],y],[/(dolfin)\/([\w\.]+)/i],[[v,"Dolphin"],y],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[v,"Chrome"],y],[/;fbav\/([\w\.]+);/i],[y,[v,"Facebook"]],[/fxios\/([\w\.-]+)/i],[y,[v,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[y,[v,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[y,v],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[v,[y,P.str,S.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[v,y],[/(navigator|netscape)\/([\w\.-]+)/i],[[v,"Netscape"],y],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[v,y]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[_,"amd64"]],[/(ia32(?=;))/i],[[_,E.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[_,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[_,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[_,/ower/,"",E.lowerize]],[/(sun4\w)[;\)]/i],[[_,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[_,E.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[f,g,[m,k]],[/applecoremedia\/[\w\.]+ \((ipad)/],[f,[g,"Apple"],[m,k]],[/(apple\s{0,1}tv)/i],[[f,"Apple TV"],[g,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[g,f,[m,k]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[f,[g,"Amazon"],[m,k]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[f,P.str,S.device.amazon.model],[g,"Amazon"],[m,w]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[f,g,[m,w]],[/\((ip[honed|\s\w*]+);/i],[f,[g,"Apple"],[m,w]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[g,f,[m,w]],[/\(bb10;\s(\w+)/i],[f,[g,"BlackBerry"],[m,w]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[f,[g,"Asus"],[m,k]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[g,"Sony"],[f,"Xperia Tablet"],[m,k]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[g,"Sony"],[f,"Xperia Phone"],[m,w]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[g,f,[m,b]],[/android.+;\s(shield)\sbuild/i],[f,[g,"Nvidia"],[m,b]],[/(playstation\s[34portablevi]+)/i],[f,[g,"Sony"],[m,b]],[/(sprint\s(\w+))/i],[[g,P.str,S.device.sprint.vendor],[f,P.str,S.device.sprint.model],[m,w]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[g,f,[m,k]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[g,[f,/_/g," "],[m,w]],[/(nexus\s9)/i],[f,[g,"HTC"],[m,k]],[/(nexus\s6p)/i],[f,[g,"Huawei"],[m,w]],[/(microsoft);\s(lumia[\s\w]+)/i],[g,f,[m,w]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[f,[g,"Microsoft"],[m,b]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[g,"Microsoft"],[m,w]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[f,[g,"Motorola"],[m,w]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[f,[g,"Motorola"],[m,k]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[g,E.trim],[f,E.trim],[m,A]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[g,"Samsung"],[m,A]],[/\(dtv[\);].+(aquos)/i],[f,[g,"Sharp"],[m,A]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[g,"Samsung"],f,[m,k]],[/smart-tv.+(samsung)/i],[g,[m,A],f],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[g,"Samsung"],f,[m,w]],[/sie-(\w+)*/i],[f,[g,"Siemens"],[m,w]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[g,"Nokia"],f,[m,w]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[f,[g,"Acer"],[m,k]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[g,"LG"],f,[m,k]],[/(lg) netcast\.tv/i],[g,f,[m,A]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[f,[g,"LG"],[m,w]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[f,[g,"Lenovo"],[m,k]],[/linux;.+((jolla));/i],[g,f,[m,w]],[/((pebble))app\/[\d\.]+\s/i],[g,f,[m,T]],[/android.+;\s(glass)\s\d/i],[f,[g,"Google"],[m,T]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[f,/_/g," "],[g,"Xiaomi"],[m,w]],[/android.+a000(1)\s+build/i],[f,[g,"OnePlus"],[m,w]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[m,E.lowerize],g,f]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[y,[v,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[v,y],[/rv\:([\w\.]+).*(gecko)/i],[y,v]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[v,y],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[v,[y,P.str,S.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[v,"Windows"],[y,P.str,S.os.windows.version]],[/\((bb)(10);/i],[[v,"BlackBerry"],y],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[v,y],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[v,"Symbian"],y],[/\((series40);/i],[v],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[v,"Firefox OS"],y],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[v,y],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[v,"Chromium OS"],y],[/(sunos)\s?([\w\.]+\d)*/i],[[v,"Solaris"],y],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[v,y],[/(haiku)\s(\w+)/i],[v,y],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[v,"iOS"],[y,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[v,"Mac OS"],[y,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[v,y]]},x=function(e,t){if(!(this instanceof x))return new x(e,t).getResult();var i=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:a),n=t?E.extend(V,t):V;return this.getBrowser=function(){var e=P.rgx.apply(this,n.browser);return e.major=E.major(e.version),e},this.getCPU=function(){return P.rgx.apply(this,n.cpu)},this.getDevice=function(){return P.rgx.apply(this,n.device)},this.getEngine=function(){return P.rgx.apply(this,n.engine)},this.getOS=function(){return P.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};x.VERSION=o,x.BROWSER={NAME:v,MAJOR:p,VERSION:y},x.CPU={ARCHITECTURE:_},x.DEVICE={MODEL:f,VENDOR:g,TYPE:m,CONSOLE:b,MOBILE:w,SMARTTV:A,TABLET:k,WEARABLE:T,EMBEDDED:C},x.ENGINE={NAME:v,VERSION:y},x.OS={NAME:v,VERSION:y},typeof t!==u?(typeof e!==u&&e.exports&&(t=e.exports=x),t.UAParser=x):"function"===l&&i(158)?(n=function(){return x}.call(t,i,t,e),!(n!==s&&(e.exports=n))):r.UAParser=x;var I=r.jQuery||r.Zepto;if(typeof I!==u){var O=new x;I.ua=O.getResult(),I.ua.get=function(){return O.getUA()},I.ua.set=function(e){O.setUA(e);var t=O.getResult();for(var i in t)I.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t){!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var r in e)t.d(n,r,function(t){return e[t]}.bind(null,r));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var r=function(){function e(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.cmTag||(window.cmTag={}),window.cmTag.testVideo=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"}),window.cmTag.autoPlayDetectorInstance?(window.cmTag.autoPlayDetectorInstance.callbacks.push(t),window.cmTag.autoPlayDetectorInstance.safelyRunCallbacks()):(this.isMobile=i.isMobile||/iPhone|iPad|Android/i.test(navigator.userAgent),this.timeout=i.timeout||250,this.autoPlaySupport={muted:!1,unmuted:!1},this.unmutedVideo=this.creatVideo(!1),this.mutedVideo=this.creatVideo(!0),this.callbacks=[t],this.testSupport(),window.cmTag.autoPlayDetectorInstance=this),window.cmTag.autoPlayDetectorInstance}return function(e,t,i){t&&n(e.prototype,t),i&&n(e,i)}(e,[{key:"creatVideo",value:function(e){var t=document.createElement("video");return t.tbData={isMuted:e},this.setVideoAttributes(t),this.setVideoStyle(t),e&&this.muteVideo(t),this.isMobile&&document.body.appendChild(t),t}},{key:"setVideoAttributes",value:function(e){e.src=URL.createObjectURL(window.cmTag.testVideo),e.type="video/mp4",e.setAttribute("playsinline",!0)}},{key:"setVideoStyle",value:function(e){e.style.left="0",e.style.top="0",e.style.height="0px",e.style.width="0px",e.style.position="absolute",e.style.display="none"}},{key:"muteVideo",value:function(e){e.muted=!0,e.setAttribute("muted",!0)}},{key:"testSupport",value:function(){this.testVideo(this.mutedVideo),this.isMobile?this.handleNotSupported(this.unmutedVideo,"Mobile"):this.testVideo(this.unmutedVideo)}},{key:"testVideo",value:function(e){var t=this;e.tbData.timeupdateHandler=this.handleSupported.bind(this,e),e.addEventListener("timeupdate",e.tbData.timeupdateHandler),e.tbData.timeout=setTimeout(this.handleNotSupported.bind(this,e,"no promise - timeout"),this.timeout);var i=e.tbData.promise=e.play();void 0===i||e.tbData.isResolved||i.then(function(){t.handleSupported(e)}).catch(function(i){t.handleNotSupported(e,i.message)})}},{key:"handleSupported",value:function(e){if(!e.tbData.isResolved)if(e.tbData.isMuted===e.muted){this.handleResolved(e);var t=e.tbData.isMuted?"muted":"unmuted";this.autoPlaySupport[t]={supported:!0},this.safelyRunCallbacks()}else this.handleNotSupported(e,"Muted by browser")}},{key:"handleNotSupported",value:function(e,t){if(!e.tbData.isResolved){this.handleResolved(e);var i=e.tbData.isMuted?"muted":"unmuted";this.autoPlaySupport[i]={supported:!1,error:t},this.safelyRunCallbacks()}}},{key:"handleResolved",value:function(e){e.tbData.isResolved=!0,this.removeTimeupdateEventListener(e),clearTimeout(e.tbData.timeout)}},{key:"removeTimeupdateEventListener",value:function(e){e.removeEventListener("timeupdate",e.tbData.timeupdateHandler),e.tbData.timeupdateHandler=void 0,delete e.tbData.timeupdateHandler}},{key:"safelyRunCallbacks",value:function(){var e=this;this.supportIsKnown()&&(this.callbacks.map(function(t){t(e.autoPlaySupport)}),this.callbacks=[])}},{key:"supportIsKnown",value:function(){return this.autoPlaySupport.muted&&this.autoPlaySupport.unmuted}}]),e}();try{if(window.cmTag){var s=window.cmTag.config.ms||{};s["video-autoplay-detector"]=s["video-autoplay-detector"]||{},s["video-autoplay-detector"]["1.0.0"]=r,window.cmTag.set("ms",s)}window.TRC&&(window.TRC["video-autoplay-detector"]=window.TRC["video-autoplay-detector"]||{},window.TRC["video-autoplay-detector"]["1.0.0"]=r)}catch(e){}}])},function(e,t){!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var r in e)t.d(n,r,function(t){return e[t]}.bind(null,r));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=2)}([function(e,t,i){"use strict";function n(){n.init.call(this)}function r(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function s(e,t,i,n){var s,o,a;if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),a=o[t]),void 0===a)a=o[t]=i,++e._eventsCount;else if("function"==typeof a?a=o[t]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),0<(s=r(e))&&a.length>s&&!a.warned){a.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=a.length,function(e){console&&console.warn&&console.warn(e)}(d)}return e}function o(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,h(this.listener,this.target,e))}.bind(n);return r.listener=i,n.wrapFn=r}function a(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):l(r,r.length)}function d(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function l(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}var u,c="object"==typeof Reflect?Reflect:null,h=c&&"function"==typeof c.apply?c.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};u=c&&"function"==typeof c.ownKeys?c.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var p=Number.isNaN||function(e){return e!=e};((e.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var f=10;Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e||e<0||p(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");f=e}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||p(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return r(this)},n.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var s;if(0<t.length&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=r[e];if(void 0===a)return!1;if("function"==typeof a)h(a,this,t);else{var d=a.length,u=l(a,d);for(i=0;i<d;++i)h(u[i],this,t)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return s(this,e,t,!1)},n.prototype.prependListener=function(e,t){return s(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,o(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,o(this,e,t)),this},n.prototype.off=n.prototype.removeListener=function(e,t){var i,n,r,s,o;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,s=i.length-1;0<=s;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},n.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},n.prototype.listeners=function(e){return a(this,e,!0)},n.prototype.rawListeners=function(e){return a(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},n.prototype.listenerCount=d,n.prototype.eventNames=function(){return 0<this._eventsCount?u(this._events):[]}},function(e,t,i){var n;!function(r,s){"use strict";var o="function",a="undefined",d="object",l="model",u="name",c="type",h="vendor",p="version",f="architecture",v="console",m="mobile",g="tablet",y="smarttv",_="wearable",b={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:s},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},w={rgx:function(){for(var e,t,i,n,r,l,u,c=0,h=arguments;c<h.length&&!l;){var p=h[c],f=h[c+1];if(typeof e==a)for(n in e={},f)f.hasOwnProperty(n)&&(typeof(r=f[n])==d?e[r[0]]=s:e[r]=s);for(t=i=0;t<p.length&&!l;)if(l=p[t++].exec(this.getUA()))for(n=0;n<f.length;n++)u=l[++i],typeof(r=f[n])==d&&0<r.length?2==r.length?typeof r[1]==o?e[r[0]]=r[1].call(this,u):e[r[0]]=r[1]:3==r.length?typeof r[1]!=o||r[1].exec&&r[1].test?e[r[0]]=u?u.replace(r[1],r[2]):s:e[r[0]]=u?r[1].call(this,u,r[2]):s:4==r.length&&(e[r[0]]=u?r[3].call(this,u.replace(r[1],r[2])):s):e[r]=u||s;c+=2}return e},str:function(e,t){for(var i in t)if(typeof t[i]==d&&0<t[i].length){for(var n=0;n<t[i].length;n++)if(b.has(t[i][n],e))return"?"===i?s:i}else if(b.has(t[i],e))return"?"===i?s:i;return e}},k={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},A={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[u,p],[/(opios)[\/\s]+([\w\.]+)/i],[[u,"Opera Mini"],p],[/\s(opr)\/([\w\.]+)/i],[[u,"Opera"],p],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[u,p],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[u,"IE"],p],[/(edge)\/((\d+)?[\w\.]+)/i],[u,p],[/(yabrowser)\/([\w\.]+)/i],[[u,"Yandex"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],p],[/(micromessenger)\/([\w\.]+)/i],[[u,"WeChat"],p],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[p,[u,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[u,/(.+)/,"$1 WebView"],p],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[p,[u,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[u,p],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[u,"UCBrowser"],p],[/(dolfin)\/([\w\.]+)/i],[[u,"Dolphin"],p],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[u,"Chrome"],p],[/;fbav\/([\w\.]+);/i],[p,[u,"Facebook"]],[/fxios\/([\w\.-]+)/i],[p,[u,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[p,[u,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[p,u],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[u,[p,w.str,k.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[u,p],[/(navigator|netscape)\/([\w\.-]+)/i],[[u,"Netscape"],p],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[u,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,b.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[f,/ower/,"",b.lowerize]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[f,b.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[l,h,[c,g]],[/applecoremedia\/[\w\.]+ \((ipad)/],[l,[h,"Apple"],[c,g]],[/(apple\s{0,1}tv)/i],[[l,"Apple TV"],[h,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[h,l,[c,g]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[l,[h,"Amazon"],[c,g]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[l,w.str,k.device.amazon.model],[h,"Amazon"],[c,m]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[l,h,[c,m]],[/\((ip[honed|\s\w*]+);/i],[l,[h,"Apple"],[c,m]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[h,l,[c,m]],[/\(bb10;\s(\w+)/i],[l,[h,"BlackBerry"],[c,m]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[l,[h,"Asus"],[c,g]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[h,"Sony"],[l,"Xperia Tablet"],[c,g]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[h,"Sony"],[l,"Xperia Phone"],[c,m]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[h,l,[c,v]],[/android.+;\s(shield)\sbuild/i],[l,[h,"Nvidia"],[c,v]],[/(playstation\s[34portablevi]+)/i],[l,[h,"Sony"],[c,v]],[/(sprint\s(\w+))/i],[[h,w.str,k.device.sprint.vendor],[l,w.str,k.device.sprint.model],[c,m]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[h,l,[c,g]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[h,[l,/_/g," "],[c,m]],[/(nexus\s9)/i],[l,[h,"HTC"],[c,g]],[/(nexus\s6p)/i],[l,[h,"Huawei"],[c,m]],[/(microsoft);\s(lumia[\s\w]+)/i],[h,l,[c,m]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[l,[h,"Microsoft"],[c,v]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[h,"Microsoft"],[c,m]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[l,[h,"Motorola"],[c,m]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[l,[h,"Motorola"],[c,g]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[h,b.trim],[l,b.trim],[c,y]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[h,"Samsung"],[c,y]],[/\(dtv[\);].+(aquos)/i],[l,[h,"Sharp"],[c,y]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[h,"Samsung"],l,[c,g]],[/smart-tv.+(samsung)/i],[h,[c,y],l],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[h,"Samsung"],l,[c,m]],[/sie-(\w+)*/i],[l,[h,"Siemens"],[c,m]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[h,"Nokia"],l,[c,m]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[l,[h,"Acer"],[c,g]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[h,"LG"],l,[c,g]],[/(lg) netcast\.tv/i],[h,l,[c,y]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[l,[h,"LG"],[c,m]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[l,[h,"Lenovo"],[c,g]],[/linux;.+((jolla));/i],[h,l,[c,m]],[/((pebble))app\/[\d\.]+\s/i],[h,l,[c,_]],[/android.+;\s(glass)\s\d/i],[l,[h,"Google"],[c,_]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[l,/_/g," "],[h,"Xiaomi"],[c,m]],[/android.+a000(1)\s+build/i],[l,[h,"OnePlus"],[c,m]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,b.lowerize],h,l]],
engine:[[/windows.+\sedge\/([\w\.]+)/i],[p,[u,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[u,p],[/rv\:([\w\.]+).*(gecko)/i],[p,u]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[u,p],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[u,[p,w.str,k.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[u,"Windows"],[p,w.str,k.os.windows.version]],[/\((bb)(10);/i],[[u,"BlackBerry"],p],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[u,p],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[u,"Symbian"],p],[/\((series40);/i],[u],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[u,"Firefox OS"],p],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[u,p],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[u,"Chromium OS"],p],[/(sunos)\s?([\w\.]+\d)*/i],[[u,"Solaris"],p],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[u,p],[/(haiku)\s(\w+)/i],[u,p],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[u,"iOS"],[p,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[u,"Mac OS"],[p,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[u,p]]},T=function(e,t){if(!(this instanceof T))return new T(e,t).getResult();var i=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),n=t?b.extend(A,t):A;return this.getBrowser=function(){var e=w.rgx.apply(this,n.browser);return e.major=b.major(e.version),e},this.getCPU=function(){return w.rgx.apply(this,n.cpu)},this.getDevice=function(){return w.rgx.apply(this,n.device)},this.getEngine=function(){return w.rgx.apply(this,n.engine)},this.getOS=function(){return w.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};T.VERSION="0.7.12",T.BROWSER={NAME:u,MAJOR:"major",VERSION:p},T.CPU={ARCHITECTURE:f},T.DEVICE={MODEL:l,VENDOR:h,TYPE:c,CONSOLE:v,MOBILE:m,SMARTTV:y,TABLET:g,WEARABLE:_,EMBEDDED:"embedded"},T.ENGINE={NAME:u,VERSION:p},T.OS={NAME:u,VERSION:p},typeof t!=a?(typeof e!=a&&e.exports&&(t=e.exports=T),t.UAParser=T):i(3)?(n=function(){return T}.call(t,i,t,e))===s||(e.exports=n):r.UAParser=T;var C=r.jQuery||r.Zepto;if(typeof C!=a){var E=new T;C.ua=E.getResult(),C.ua.get=function(){return E.getUA()},C.ua.set=function(e){E.setUA(e);var t=E.getResult();for(var i in t)C.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){e.exports=i(4)},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){function t(e,t){for(var i in t)e.style[i]=t[i]}var i=e.dataset.url;if(!i)throw"VideoElement has no `data-url` attribute";this.container=e,t(this.container,{display:"inline-block",position:"relative",minWidth:"80px",minHeight:"80px"}),this.canvas=document.createElement("canvas"),this.canvas.width=960,this.canvas.height=540,t(this.canvas,{display:"block",width:"100%"}),this.container.appendChild(this.canvas),this.playButton=document.createElement("div"),this.playButton.innerHTML=l.PLAY_BUTTON,t(this.playButton,{zIndex:2,position:"absolute",top:"0",bottom:"0",left:"0",right:"0",maxWidth:"75px",maxHeight:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.playButton);var n={canvas:this.canvas};for(var r in e.dataset)try{n[r]=JSON.parse(e.dataset[r])}catch(t){n[r]=e.dataset[r]}if(this.player=new M.Player(i,n),!n.poster||n.autoplay||this.player.options.streaming||(n.decodeFirstFrame=!1,this.poster=new Image,this.poster.src=n.poster,this.poster.addEventListener("load",this.posterLoaded),t(this.poster,{display:"block",zIndex:1,position:"absolute",top:0,left:0,bottom:0,right:0}),this.container.appendChild(this.poster)),this.player.options.streaming||this.container.addEventListener("click",this.onClick.bind(this)),(n.autoplay||this.player.options.streaming)&&(this.playButton.style.display="none"),this.player.audioOut&&!this.player.audioOut.unlocked){var s=this.container;(n.autoplay||this.player.options.streaming)&&(this.unmuteButton=document.createElement("div"),this.unmuteButton.innerHTML=l.UNMUTE_BUTTON,t(this.unmuteButton,{zIndex:2,position:"absolute",bottom:"10px",right:"20px",width:"75px",height:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.unmuteButton),s=this.unmuteButton),this.unlockAudioBound=this.onUnlockAudio.bind(this,s),s.addEventListener("touchstart",this.unlockAudioBound,!1),s.addEventListener("click",this.unlockAudioBound,!0)}}function u(e,t){this.options=t||{},e.match(/^wss?:\/\//)?(this.source=new M.Source.WebSocket(e,t),t.streaming=!0):(!1!==t.progressive?this.source=new M.Source.AjaxProgressive(e,t):this.source=new M.Source.Ajax(e,t),t.streaming=!1),this.maxAudioLag=t.maxAudioLag||.25,this.loop=!1!==t.loop,this.autoplay=!!t.autoplay||t.streaming,this.onFinished=t.onfinished,this.demuxer=new M.Demuxer.TS(t),this.source.connect(this.demuxer),!1!==t.video&&(this.video=new M.Decoder.MPEG1Video(t),this.renderer=!t.disableGl&&M.Renderer.WebGL.IsSupported()?new M.Renderer.WebGL(t):new M.Renderer.Canvas2D(t),this.demuxer.connect(M.Demuxer.TS.STREAM.VIDEO_1,this.video),this.video.connect(this.renderer)),!1!==t.audio&&M.AudioOutput.WebAudio.IsSupported()&&(this.audio=new M.Decoder.MP2Audio(t),this.audioOut=new M.AudioOutput.WebAudio(t),this.demuxer.connect(M.Demuxer.TS.STREAM.AUDIO_1,this.audio),this.audio.connect(this.audioOut)),Object.defineProperty(this,"currentTime",{get:this.getCurrentTime,set:this.setCurrentTime}),Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),(this.unpauseOnShow=!1)!==t.pauseWhenHidden&&document.addEventListener("visibilitychange",this.showHide.bind(this)),this.source.start(),this.autoplay&&this.play()}function c(e,t){"object"===d(e)?(this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.byteLength=this.bytes.length):(this.bytes=new Uint8Array(e||1048576),this.byteLength=0),this.mode=t||c.MODE.EXPAND,this.index=0}function h(e,t){this.url=e,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.onReadyCblk=t.onload,this.errHandler=t.errHndlr}function p(e,t){this.url=e,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.fileSize=0,this.loadedSize=0,this.chunkSize=t.chunkSize||1048576,this.isLoading=!1,this.loadStartTime=0,this.throttled=!1!==t.throttled}function f(e,t){this.url=e,this.socket=null,this.callbacks={connect:[],data:[]},this.destination=null,this.reconnectInterval=t.reconnectInterval||5,this.shouldAttemptReconnect=!!this.reconnectInterval,this.completed=!1,this.established=!1,this.progress=0}function v(e){this.bits=null,this.leftoverBytes=null,this.guessVideoFrameEnd=!0,this.pidsToStreamIds={},this.pesPacketInfo={},this.startTime=0,this.currentTime=0}function m(e){this.destination=null,this.canPlay=!1,this.collectTimestamps=!e.streaming,this.timestamps=[],this.timestampIndex=0,this.startTime=0,this.decodedTime=0,Object.defineProperty(this,"currentTime",{get:this.getCurrentTime})}function g(e){M.Decoder.Base.call(this,e);var t=e.videoBufferSize||524288,i=e.streaming?M.BitBuffer.MODE.EVICT:M.BitBuffer.MODE.EXPAND;this.bits=new M.BitBuffer(t,i),this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.currentFrame=0,this.decodeFirstFrame=!1!==e.decodeFirstFrame}function y(e){M.Decoder.Base.call(this,e);var t=e.audioBufferSize||131072,i=e.streaming?M.BitBuffer.MODE.EVICT:M.BitBuffer.MODE.EXPAND;this.bits=new M.BitBuffer(t,i),this.left=new Float32Array(1152),this.right=new Float32Array(1152),this.sampleRate=44100,this.D=new Float32Array(1024),this.D.set(y.SYNTHESIS_WINDOW,0),this.D.set(y.SYNTHESIS_WINDOW,512),this.V=new Float32Array(1024),this.U=new Int32Array(32),this.VPos=0,this.allocation=[new Array(32),new Array(32)],this.scaleFactorInfo=[new Uint8Array(32),new Uint8Array(32)],this.scaleFactor=[new Array(32),new Array(32)],this.sample=[new Array(32),new Array(32)];for(var n=0;n<2;n++)for(var r=0;r<32;r++)this.scaleFactor[n][r]=[0,0,0],this.sample[n][r]=[0,0,0]}function _(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0;var t={preserveDrawingBuffer:!!e.preserveDrawingBuffer,alpha:!1,depth:!1,stencil:!1,antialias:!1};if(this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),!this.gl)throw new Error("Failed to get WebGL Context");var i=this.gl,n=null,r=i.createBuffer(),s=new Float32Array([0,0,0,1,1,0,1,1]);i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,s,i.STATIC_DRAW),this.program=this.createProgram(_.SHADER.VERTEX_IDENTITY,_.SHADER.FRAGMENT_YCRCB_TO_RGBA),n=i.getAttribLocation(this.program,"vertex"),i.enableVertexAttribArray(n),i.vertexAttribPointer(n,2,i.FLOAT,!1,0,0),this.textureY=this.createTexture(0,"textureY"),this.textureCb=this.createTexture(1,"textureCb"),this.textureCr=this.createTexture(2,"textureCr"),this.loadingProgram=this.createProgram(_.SHADER.VERTEX_IDENTITY,_.SHADER.FRAGMENT_LOADING),n=i.getAttribLocation(this.loadingProgram,"vertex"),i.enableVertexAttribArray(n),i.vertexAttribPointer(n,2,i.FLOAT,!1,0,0),this.shouldCreateUnclampedViews=!this.allowsClampedTextureData()}function b(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0,this.context=this.canvas.getContext("2d")}function w(e){this.context=w.CachedContext=w.CachedContext||new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.destination=this.gain,this.startTime=0,this.buffer=null,this.wallclockStartTime=0,this.volume=1,this.enabled=!0,this.unlocked=!w.NeedsUnlocking(),Object.defineProperty(this,"enqueuedTime",{get:this.getEnqueuedTime})}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function T(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function S(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var V=i(1),x=i(0),I=function(){function e(t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i=s(this,o(e).call(this))).params=t,i.os=i.params.userAgent.os.name,i.osVersion=parseInt(i.params.userAgent.os.version),i.browserName=i.params.userAgent.browser.name,i.browserMajorVersion=parseInt(i.params.userAgent.browser.major),i.params.userAgent.ua&&-1<i.params.userAgent.ua.indexOf("UCBrowser")&&(i.browserName="UCBrowser"),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(e,x.EventEmitter),function(e,t,i){t&&r(e.prototype,t),i&&r(e,i)}(e,[{key:"isAutoplaySupported",value:function(){var e=this._isAutoplaySupportedByOS();e&&"Android"===this.os&&(e=!this._isDataSaverOn()),this._emitDetectionResult(e)}},{key:"_isAutoplaySupportedByOS",value:function(){switch(this.os){case"Android":return this.isAutoplaySupportedAndroid();case"iOS":return this.isAutoplaySupportedIOS();default:return!1}}},{key:"isAutoplaySupportedIOS",value:function(){if(this.osVersion<10)return!1;switch(this.browserName){case"Firefox":return 7<=this.browserMajorVersion;default:return!0}}},{key:"isAutoplaySupportedAndroid",value:function(){switch(this.browserName){case"Chrome":case"Chrome WebView":return 53<=parseInt(this.browserMajorVersion);case"Firefox":return 49<=parseInt(this.browserMajorVersion);case"Android Browser":return 7<=parseInt(this.browserMajorVersion);case"Silk":return 71<=parseInt(this.browserMajorVersion);case"Opera":case"MIUI Browser":case"Yandex":case"UCBrowser":return!0;default:return!1}}},{key:"_isDataSaverOn",value:function(){return this.params.canvas.dataSaverServerSide}},{key:"_emitDetectionResult",value:function(e){this.emit("detectIsAutoplaySupported",e)}}]),e}(),O="content",D={decodeUrl:!1,secureMediaFiles:!1,isMobile:!1,autoplay:!0,userAgent:{},isMultiVpaidUnit:!1,logToBI:function(){},videoState:O,canvas:{onAutoplayDetected:function(){},dataSaverServerSide:!1,dataSaverUrl:"//vidutils.taboola.com",disableWebGl:!1,parent:document.body,defaultVolume:.4,aspectRatio:"16:9",canvasLoadRate:5,mpegServerBaseUrl:"//mpg.taboola.com/getts?url",ignoreAutoplayDetection:!1,additionalCss:{},repeat:!1}},M={Player:null,VideoElement:null,BitBuffer:null,Source:{},Demuxer:{},Decoder:{},Renderer:{},AudioOutput:{},Now:function(){return window.performance?window.performance.now()/1e3:Date.now()/1e3},CreateVideoElements:function(){for(var e=document.querySelectorAll(".jsmpeg"),t=0;t<e.length;t++)new M.VideoElement(e[t])},Fill:function(e,t){if(e.fill)e.fill(t);else for(var i=0;i<e.length;i++)e[i]=t}};"complete"===document.readyState?M.CreateVideoElements():document.addEventListener("DOMContentLoaded",M.CreateVideoElements),M.VideoElement=(l.prototype.onUnlockAudio=function(e,t){this.unmuteButton&&(t.preventDefault(),t.stopPropagation()),this.player.audioOut.unlock(function(){this.unmuteButton&&(this.unmuteButton.style.display="none"),e.removeEventListener("touchstart",this.unlockAudioBound),e.removeEventListener("click",this.unlockAudioBound)}.bind(this))},l.prototype.onClick=function(e){this.player.isPlaying?(this.player.pause(),this.playButton.style.display="block"):(this.player.play(),this.playButton.style.display="none",this.poster&&(this.poster.style.display="none"))},l.PLAY_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 200 200" alt="Play video"><circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"/><polygon points="70, 55 70, 145 145, 100" fill="#fff"/></svg>',l.UNMUTE_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 75 75"><polygon class="audio-speaker" stroke="none" fill="#fff" points="39,13 22,28 6,28 6,47 21,47 39,62 39,13"/><g stroke="#fff" stroke-width="5"><path d="M 49,50 69,26"/><path d="M 69,50 49,26"/></g></svg>',l),M.Player=(u.prototype.showHide=function(e){"hidden"===document.visibilityState?(this.unpauseOnShow=this.wantsToPlay,this.pause()):this.unpauseOnShow&&this.play()},u.prototype.play=function(e){this.animationId=requestAnimationFrame(this.update.bind(this)),this.wantsToPlay=!0},u.prototype.pause=function(e){cancelAnimationFrame(this.animationId),this.wantsToPlay=!1,this.isPlaying=!1,this.audio&&this.audio.canPlay&&(this.audioOut.stop(),this.seek(this.currentTime))},u.prototype.getVolume=function(){return this.audioOut?this.audioOut.volume:0},u.prototype.setVolume=function(e){this.audioOut&&(this.audioOut.volume=e)},u.prototype.stop=function(e){this.pause(),this.seek(0),this.video&&!1!==this.options.decodeFirstFrame&&this.video.decode()},u.prototype.seek=function(e){var t=this.audio&&this.audio.canPlay?this.audio.startTime:this.video.startTime;this.video&&this.video.seek(e+t),this.audio&&this.audio.seek(e+t),this.startTime=M.Now()-e},u.prototype.getCurrentTime=function(){return this.audio&&this.audio.canPlay?this.audio.currentTime-this.audio.startTime:this.video.currentTime-this.video.startTime},u.prototype.setCurrentTime=function(e){this.seek(e)},u.prototype.update=function(){this.animationId=requestAnimationFrame(this.update.bind(this)),this.source.established?(this.isPlaying||(this.isPlaying=!0,this.startTime=M.Now()-this.currentTime),this.options.streaming?this.updateForStreaming():this.updateForStaticFile()):this.renderer&&this.renderer.renderProgress(this.source.progress)},u.prototype.updateForStreaming=function(){if(this.video&&this.video.decode(),this.audio){for(;this.audioOut.enqueuedTime>this.maxAudioLag&&(this.audioOut.resetEnqueuedTime(),this.audioOut.enabled=!1),this.audio.decode(););this.audioOut.enabled=!0}},u.prototype.updateForStaticFile=function(){var e=this,t=!1,i=0;if(this.audio&&this.audio.canPlay){for(;!t&&this.audio.decodedTime-this.audio.currentTime<.25;)t=!this.audio.decode();this.video&&this.video.currentTime<this.audio.currentTime&&(t=!this.video.decode()),i=this.demuxer.currentTime-this.audio.currentTime}else if(this.video){var n=M.Now()-this.startTime+this.video.startTime,r=n-this.video.currentTime,s=1/this.video.frameRate;this.video&&0<r&&(2*s<r&&(this.startTime+=r),t=!this.video.decode()),i=this.demuxer.currentTime-n}this.source.resume(i),t&&this.source.completed&&(this.loop?this.seek(0):(this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){e.onFinished()},500),this.pause()))},u),M.BitBuffer=(c.prototype.resize=function(e){var t=new Uint8Array(e);0!==this.byteLength&&(this.byteLength=Math.min(this.byteLength,e),t.set(this.bytes,0,this.byteLength)),this.bytes=t,this.index=Math.min(this.index,this.byteLength<<3)},c.prototype.evict=function(e){var t=this.index>>3,i=this.bytes.length-this.byteLength;return this.index===this.byteLength<<3||i+t<e?(this.byteLength=0,void(this.index=0)):void(0!=t&&(this.bytes.copyWithin?this.bytes.copyWithin(0,t,this.byteLength):this.bytes.set(this.bytes.subarray(t,this.byteLength)),this.byteLength=this.byteLength-t,this.index-=t<<3))},c.prototype.write=function(e){var t="object"===d(e[0]),i=0,n=this.bytes.length-this.byteLength;if(t)for(var r=i=0;r<e.length;r++)i+=e[r].byteLength;else i=e.byteLength;if(n<i)if(this.mode===c.MODE.EXPAND){var s=Math.max(2*this.bytes.length,i-n);this.resize(s)}else this.evict(i);if(t)for(r=0;r<e.length;r++)this.appendSingleBuffer(e[r]);else this.appendSingleBuffer(e)},c.prototype.appendSingleBuffer=function(e){e=e instanceof Uint8Array?e:new Uint8Array(e),this.bytes.set(e,this.byteLength),this.byteLength+=e.length},c.prototype.findNextStartCode=function(){for(var e=this.index+7>>3;e<this.byteLength;e++)if(0==this.bytes[e]&&0==this.bytes[e+1]&&1==this.bytes[e+2])return this.index=e+4<<3,this.bytes[e+3];return this.index=this.byteLength<<3,-1},c.prototype.findStartCode=function(e){for(var t=0;;)if((t=this.findNextStartCode())===e||-1===t)return t;return-1},c.prototype.nextBytesAreStartCode=function(){var e=this.index+7>>3;return e>=this.byteLength||0==this.bytes[e]&&0==this.bytes[1+e]&&1==this.bytes[2+e]},c.prototype.peek=function(e){for(var t=this.index,i=0;e;){var n=8-(7&t),r=n<e?n:e,s=n-r;i=i<<r|(this.bytes[t>>3]&255>>8-r<<s)>>s,t+=r,e-=r}return i},c.prototype.read=function(e){var t=this.peek(e);return this.index+=e,t},c.prototype.skip=function(e){return this.index+=e},c.prototype.rewind=function(e){this.index=Math.max(this.index-e,0)},c.prototype.has=function(e){return(this.byteLength<<3)-this.index>=e},c.MODE={EVICT:1,EXPAND:2},c),M.Source.Ajax=(h.prototype.connect=function(e){this.destination=e},h.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200===this.request.status&&(this.onLoad(this.request.response),this.onReadyCblk()),500!==this.request.status&&502!==this.request.status||this.errHandler({err:"error status ".concat(this.request.status," received for url:").concat(this.url)})}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("GET",this.url),this.request.responseType="arraybuffer",this.request.send()},h.prototype.resume=function(e){},h.prototype.abort=function(){this.request.abort()},h.prototype.onProgress=function(e){this.progress=e.loaded/e.total},h.prototype.onLoad=function(e){this.established=!0,this.completed=!0,this.progress=1,this.destination&&this.destination.write(e)},h),M.Source.AjaxProgressive=(p.prototype.connect=function(e){this.destination=e},p.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&(this.fileSize=parseInt(this.request.getResponseHeader("Content-Length")),this.loadNextChunk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("HEAD",this.url),this.request.send()},p.prototype.resume=function(e){!this.isLoading&&this.throttled&&e<8*this.loadTime+2&&this.loadNextChunk()},p.prototype.abort=function(){this.request.abort()},p.prototype.loadNextChunk=function(){var e=this.loadedSize,t=Math.min(this.loadedSize+this.chunkSize-1,this.fileSize-1);e>=this.fileSize?this.completed=!0:(this.isLoading=!0,this.loadStartTime=M.Now(),this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200<=this.request.status&&this.request.status<300?this.onChunkLoad(this.request.response):this.request.readyState===this.request.DONE&&this.loadFails++<3&&this.loadNextChunk()}.bind(this),0===e&&(this.request.onprogress=this.onProgress.bind(this)),this.request.open("GET",this.url+"?"+e+"-"+t),this.request.setRequestHeader("Range","bytes="+e+"-"+t),this.request.responseType="arraybuffer",this.request.send())},p.prototype.onProgress=function(e){this.progress=e.loaded/e.total},p.prototype.onChunkLoad=function(e){this.established=!0,this.progress=1,this.loadedSize+=e.byteLength,this.loadFails=0,this.isLoading=!1,this.destination&&this.destination.write(e),this.loadTime=M.Now()-this.loadStartTime,this.throttled||this.loadNextChunk()},p),M.Source.WebSocket=(f.prototype.connect=function(e){this.destination=e},f.prototype.abort=function(){this.shouldAttemptReconnect=!1,this.socket.close()},f.prototype.start=function(){this.shouldAttemptReconnect=!!this.reconnectInterval,this.progress=0,this.established=!1,this.socket=new WebSocket(this.url),this.socket.binaryType="arraybuffer",this.socket.onmessage=this.onMessage.bind(this),this.socket.onopen=this.onOpen.bind(this),this.socket.onerror=this.onClose.bind(this),this.socket.onclose=this.onClose.bind(this)},f.prototype.resume=function(e){},f.prototype.onOpen=function(){this.progress=1,this.established=!0},f.prototype.onClose=function(){this.shouldAttemptReconnect&&setTimeout(function(){this.start()}.bind(this),1e3*this.reconnectInterval)},f.prototype.onMessage=function(e){this.destination&&this.destination.write(e.data)},f),M.Demuxer.TS=(v.prototype.connect=function(e,t){this.pesPacketInfo[e]={destination:t,currentLength:0,totalLength:0,pts:0,buffers:[]}},v.prototype.write=function(e){if(this.leftoverBytes){var t=e.byteLength+this.leftoverBytes.byteLength;this.bits=new M.BitBuffer(t),this.bits.write([this.leftoverBytes,e])}else this.bits=new M.BitBuffer(e);for(;this.bits.has(1504);)this.parsePacket();var i=this.bits.byteLength-(this.bits.index>>3);this.leftoverBytes=0<i?this.bits.bytes.subarray(this.bits.index>>3):null},v.prototype.parsePacket=function(){var e=188+(this.bits.index>>3);if(71!==this.bits.read(8))throw"Sync Token not found";this.bits.read(1);var t=this.bits.read(1),i=(this.bits.read(1),this.bits.read(13)),n=(this.bits.read(2),this.bits.read(2)),r=(this.bits.read(4),this.pidsToStreamIds[i]);if(t&&r&&(v=this.pesPacketInfo[r])&&v.currentLength&&this.packetComplete(v),1&n){if(2&n){var s=this.bits.read(8);this.bits.skip(s<<3)}if(t&&this.bits.nextBytesAreStartCode()){this.bits.skip(24),r=this.bits.read(8),this.pidsToStreamIds[i]=r;var o=this.bits.read(16);this.bits.skip(8);var a=this.bits.read(2);this.bits.skip(6);var d=this.bits.read(8),l=this.bits.index+(d<<3);if(v=this.pesPacketInfo[r]){var u=0;if(2&a){this.bits.skip(4);var c=this.bits.read(3);this.bits.skip(1);var h=this.bits.read(15);this.bits.skip(1);var p=this.bits.read(15);this.bits.skip(1),u=(1073741824*c+32768*h+p)/9e4,this.currentTime=u,-1===this.startTime&&(this.startTime=u)}var f=o?o-d-3:0;this.packetStart(v,u,f)}this.bits.index=l}var v;if(r&&(v=this.pesPacketInfo[r])){var m=this.bits.index>>3,g=!t&&2&n;(this.packetAddData(v,m,e)||this.guessVideoFrameEnd&&g)&&this.packetComplete(v)}}this.bits.index=e<<3},v.prototype.packetStart=function(e,t,i){e.totalLength=i,e.currentLength=0,e.pts=t},v.prototype.packetAddData=function(e,t,i){return e.buffers.push(this.bits.bytes.subarray(t,i)),e.currentLength+=i-t,0!==e.totalLength&&e.currentLength>=e.totalLength},v.prototype.packetComplete=function(e){e.destination.write(e.pts,e.buffers),e.totalLength=0,e.currentLength=0,e.buffers=[]},v.STREAM={PACK_HEADER:186,SYSTEM_HEADER:187,PROGRAM_MAP:188,PRIVATE_1:189,PADDING:190,PRIVATE_2:191,AUDIO_1:192,VIDEO_1:224,DIRECTORY:255},v),M.Decoder.Base=(m.prototype.connect=function(e){this.destination=e},m.prototype.write=function(e,t){this.collectTimestamps&&(0===this.timestamps.length&&(this.startTime=e,this.decodedTime=e),this.timestamps.push({index:this.bits.byteLength<<3,time:e})),this.bits.write(t),this.canPlay=!0},m.prototype.seek=function(e){if(this.collectTimestamps){for(var t=this.timestampIndex=0;t<this.timestamps.length&&!(this.timestamps[t].time>e);t++)this.timestampIndex=t;var i=this.timestamps[this.timestampIndex];i?(this.bits.index=i.index,this.decodedTime=i.time):(this.bits.index=0,this.decodedTime=this.startTime)}},m.prototype.decode=function(){this.advanceDecodedTime(0)},m.prototype.advanceDecodedTime=function(e){if(this.collectTimestamps){for(var t=-1,i=this.timestampIndex;i<this.timestamps.length&&!(this.timestamps[i].index>this.bits.index);i++)t=i;if(-1!==t&&t!==this.timestampIndex)return this.timestampIndex=t,void(this.decodedTime=this.timestamps[this.timestampIndex].time)}this.decodedTime+=e},m.prototype.getCurrentTime=function(){return this.decodedTime},m),M.Decoder.MPEG1Video=(((g.prototype=Object.create(M.Decoder.Base.prototype)).constructor=g).prototype.write=function(e,t){if(M.Decoder.Base.prototype.write.call(this,e,t),!this.hasSequenceHeader){if(-1===this.bits.findStartCode(g.START.SEQUENCE))return!1;this.decodeSequenceHeader(),this.decodeFirstFrame&&this.decode()}},g.prototype.decode=function(){return!!this.hasSequenceHeader&&(-1!==this.bits.findStartCode(g.START.PICTURE)?(this.decodePicture(),this.advanceDecodedTime(1/this.frameRate),!0):(this.bits.byteLength,this.bits.index,!1))},g.prototype.readHuffman=function(e){for(var t=0;0<=(t=e[t+this.bits.read(1)])&&0!==e[t];);return e[t+2]},g.prototype.frameRate=30,g.prototype.decodeSequenceHeader=function(){var e=this.bits.read(12),t=this.bits.read(12);if(this.bits.skip(4),this.frameRate=g.PICTURE_RATE[this.bits.read(4)],this.bits.skip(30),e===this.width&&t===this.height||(this.width=e,this.height=t,this.initBuffers(),this.destination&&this.destination.resize(e,t)),this.bits.read(1)){for(var i=0;i<64;i++)this.customIntraQuantMatrix[g.ZIG_ZAG[i]]=this.bits.read(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.bits.read(1)){for(i=0;i<64;i++){var n=g.ZIG_ZAG[i];this.customNonIntraQuantMatrix[n]=this.bits.read(8)}this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}this.hasSequenceHeader=!0},g.prototype.initBuffers=function(){this.intraQuantMatrix=g.DEFAULT_INTRA_QUANT_MATRIX,this.nonIntraQuantMatrix=g.DEFAULT_NON_INTRA_QUANT_MATRIX,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.currentY=new Uint8ClampedArray(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new Uint8ClampedArray(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new Uint8ClampedArray(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new Uint8ClampedArray(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new Uint8ClampedArray(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new Uint8ClampedArray(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer)},g.prototype.currentY=null,g.prototype.currentCr=null,g.prototype.currentCb=null,g.prototype.pictureType=0,g.prototype.forwardY=null,g.prototype.forwardCr=null,g.prototype.forwardCb=null,g.prototype.fullPelForward=!1,g.prototype.forwardFCode=0,g.prototype.forwardRSize=0,g.prototype.forwardF=0,g.prototype.decodePicture=function(e){if(this.currentFrame++,this.bits.skip(10),this.pictureType=this.bits.read(3),this.bits.skip(16),!(this.pictureType<=0||this.pictureType>=g.PICTURE_TYPE.B)){if(this.pictureType===g.PICTURE_TYPE.PREDICTIVE){if(this.fullPelForward=this.bits.read(1),this.forwardFCode=this.bits.read(3),0===this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}for(var t=0;(t=this.bits.findNextStartCode())===g.START.EXTENSION||t===g.START.USER_DATA;);for(;t>=g.START.SLICE_FIRST&&t<=g.START.SLICE_LAST;)this.decodeSlice(255&t),t=this.bits.findNextStartCode();if(-1!==t&&this.bits.rewind(32),this.destination&&this.destination.render(this.currentY,this.currentCr,this.currentCb),this.pictureType===g.PICTURE_TYPE.INTRA||this.pictureType===g.PICTURE_TYPE.PREDICTIVE){var i=this.forwardY,n=this.forwardY32,r=this.forwardCr,s=this.forwardCr32,o=this.forwardCb,a=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=i,this.currentY32=n,this.currentCr=r,this.currentCr32=s,this.currentCb=o,this.currentCb32=a}}},g.prototype.quantizerScale=0,g.prototype.sliceBegin=!1,
g.prototype.decodeSlice=function(e){for(this.sliceBegin=!0,this.macroblockAddress=(e-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.bits.read(5);this.bits.read(1);)this.bits.skip(8);for(;this.decodeMacroblock(),!this.bits.nextBytesAreStartCode(););},g.prototype.macroblockAddress=0,g.prototype.mbRow=0,g.prototype.mbCol=0,g.prototype.macroblockType=0,g.prototype.macroblockIntra=!1,g.prototype.macroblockMotFw=!1,g.prototype.motionFwH=0,g.prototype.motionFwV=0,g.prototype.motionFwHPrev=0,g.prototype.motionFwVPrev=0,g.prototype.decodeMacroblock=function(){for(var e=0,t=this.readHuffman(g.MACROBLOCK_ADDRESS_INCREMENT);34===t;)t=this.readHuffman(g.MACROBLOCK_ADDRESS_INCREMENT);for(;35===t;)e+=33,t=this.readHuffman(g.MACROBLOCK_ADDRESS_INCREMENT);if(e+=t,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=e;else{if(this.macroblockAddress+e>=this.mbSize)return;for(1<e&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureType===g.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));1<e;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),e--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth;var i=g.MACROBLOCK_TYPE[this.pictureType];this.macroblockType=this.readHuffman(i),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.bits.read(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var n=0!=(2&this.macroblockType)?this.readHuffman(g.CODE_BLOCK_PATTERN):this.macroblockIntra?63:0,r=0,s=32;r<6;r++)0!=(n&s)&&this.decodeBlock(r),s>>=1},g.prototype.decodeMotionVectors=function(){var e,t,i=0;this.macroblockMotFw?(0!==(e=this.readHuffman(g.MOTION))&&1!==this.forwardF?(i=this.bits.read(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwHPrev+=t,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),0!==(e=this.readHuffman(g.MOTION))&&1!==this.forwardF?(i=this.bits.read(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwVPrev+=t,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureType===g.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},g.prototype.copyMacroblock=function(e,t,i,n,r){var s,o,a,d,l,u,c,h,p,f,v,m,g,y,_,b,w,k,A,T=this.currentY32,C=this.currentCb32,E=this.currentCr32;if(o=(s=this.codedWidth)-16,a=e>>1,d=t>>1,l=1==(1&e),u=1==(1&t),c=((this.mbRow<<4)+d)*s+(this.mbCol<<4)+a,p=(h=this.mbRow*s+this.mbCol<<2)+(s<<2),l)if(u)for(;h<p;){for(v=i[c]+i[c+s],c++,f=0;f<4;f++)g=v+(m=i[c]+i[c+s])+2>>2&255,g|=(v=i[++c]+i[c+s])+m+2<<6&65280,g|=v+(m=i[++c]+i[c+s])+2<<14&16711680,v=i[++c]+i[c+s],c++,g|=v+m+2<<22&4278190080,T[h++]=g;h+=o>>2,c+=o-1}else for(;h<p;){for(v=i[c++],f=0;f<4;f++)g=v+(m=i[c++])+1>>1&255,g|=(v=i[c++])+m+1<<7&65280,g|=v+(m=i[c++])+1<<15&16711680,g|=(v=i[c++])+m+1<<23&4278190080,T[h++]=g;h+=o>>2,c+=o-1}else if(u)for(;h<p;){for(f=0;f<4;f++)g=i[c]+i[c+s]+1>>1&255,g|=i[++c]+i[c+s]+1<<7&65280,g|=i[++c]+i[c+s]+1<<15&16711680,g|=i[++c]+i[c+s]+1<<23&4278190080,c++,T[h++]=g;h+=o>>2,c+=o}else for(;h<p;){for(f=0;f<4;f++)g=i[c],g|=i[++c]<<8,g|=i[++c]<<16,g|=i[++c]<<24,c++,T[h++]=g;h+=o>>2,c+=o}if(o=(s=this.halfWidth)-8,a=e/2>>1,d=t/2>>1,l=1==(e/2&1),u=1==(t/2&1),c=((this.mbRow<<3)+d)*s+(this.mbCol<<3)+a,p=(h=this.mbRow*s+this.mbCol<<1)+(s<<1),l)if(u)for(;h<p;){for(y=n[c]+n[c+s],w=r[c]+r[c+s],c++,f=0;f<2;f++)b=y+(_=n[c]+n[c+s])+2>>2&255,A=w+(k=r[c]+r[c+s])+2>>2&255,b|=(y=n[++c]+n[c+s])+_+2<<6&65280,A|=(w=r[c]+r[c+s])+k+2<<6&65280,b|=y+(_=n[++c]+n[c+s])+2<<14&16711680,A|=w+(k=r[c]+r[c+s])+2<<14&16711680,y=n[++c]+n[c+s],w=r[c]+r[c+s],c++,b|=y+_+2<<22&4278190080,A|=w+k+2<<22&4278190080,E[h]=b,C[h]=A,h++;h+=o>>2,c+=o-1}else for(;h<p;){for(y=n[c],w=r[c],c++,f=0;f<2;f++)b=y+(_=n[c])+1>>1&255,A=w+(k=r[c++])+1>>1&255,b|=(y=n[c])+_+1<<7&65280,A|=(w=r[c++])+k+1<<7&65280,b|=y+(_=n[c])+1<<15&16711680,A|=w+(k=r[c++])+1<<15&16711680,b|=(y=n[c])+_+1<<23&4278190080,A|=(w=r[c++])+k+1<<23&4278190080,E[h]=b,C[h]=A,h++;h+=o>>2,c+=o-1}else if(u)for(;h<p;){for(f=0;f<2;f++)b=n[c]+n[c+s]+1>>1&255,A=r[c]+r[c+s]+1>>1&255,b|=n[++c]+n[c+s]+1<<7&65280,A|=r[c]+r[c+s]+1<<7&65280,b|=n[++c]+n[c+s]+1<<15&16711680,A|=r[c]+r[c+s]+1<<15&16711680,b|=n[++c]+n[c+s]+1<<23&4278190080,A|=r[c]+r[c+s]+1<<23&4278190080,c++,E[h]=b,C[h]=A,h++;h+=o>>2,c+=o}else for(;h<p;){for(f=0;f<2;f++)b=n[c],A=r[c],b|=n[++c]<<8,A|=r[c]<<8,b|=n[++c]<<16,A|=r[c]<<16,b|=n[++c]<<24,A|=r[c]<<24,c++,E[h]=b,C[h]=A,h++;h+=o>>2,c+=o}},g.prototype.dcPredictorY=0,g.prototype.dcPredictorCr=0,g.prototype.dcPredictorCb=0,g.prototype.blockData=null,g.prototype.decodeBlock=function(e){var t,i=0;if(this.macroblockIntra){var n,r;if(0<(r=e<4?(n=this.dcPredictorY,this.readHuffman(g.DCT_DC_SIZE_LUMINANCE)):(n=4===e?this.dcPredictorCr:this.dcPredictorCb,this.readHuffman(g.DCT_DC_SIZE_CHROMINANCE)))){var s=this.bits.read(r);this.blockData[0]=0!=(s&1<<r-1)?n+s:n+(-1<<r|s+1)}else this.blockData[0]=n;e<4?this.dcPredictorY=this.blockData[0]:4===e?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,t=this.intraQuantMatrix,i=1}else t=this.nonIntraQuantMatrix;for(var o,a,d,l=0;;){var u=0,c=this.readHuffman(g.DCT_COEFF);if(1===c&&0<i&&0===this.bits.read(1))break;65535===c?(u=this.bits.read(6),0===(l=this.bits.read(8))?l=this.bits.read(8):128===l?l=this.bits.read(8)-256:128<l&&(l-=256)):(u=c>>8,l=255&c,this.bits.read(1)&&(l=-l));var h=g.ZIG_ZAG[i+=u];i++,l<<=1,this.macroblockIntra||(l+=l<0?-1:1),0==(1&(l=l*this.quantizerScale*t[h]>>4))&&(l-=0<l?1:-1),2047<l?l=2047:l<-2048&&(l=-2048),this.blockData[h]=l*g.PREMULTIPLIER_MATRIX[h]}e<4?(o=this.currentY,d=this.codedWidth-8,a=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&e)&&(a+=8),0!=(2&e)&&(a+=this.codedWidth<<3)):(o=4===e?this.currentCb:this.currentCr,d=(this.codedWidth>>1)-8,a=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1===i?(g.CopyValueToDestination(this.blockData[0]+128>>8,o,a,d),this.blockData[0]=0):(g.IDCT(this.blockData),g.CopyBlockToDestination(this.blockData,o,a,d),M.Fill(this.blockData,0)):1===i?(g.AddValueToDestination(this.blockData[0]+128>>8,o,a,d),this.blockData[0]=0):(g.IDCT(this.blockData),g.AddBlockToDestination(this.blockData,o,a,d),M.Fill(this.blockData,0)),i=0},g.CopyBlockToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]=e[r+0],t[i+1]=e[r+1],t[i+2]=e[r+2],t[i+3]=e[r+3],t[i+4]=e[r+4],t[i+5]=e[r+5],t[i+6]=e[r+6],t[i+7]=e[r+7]},g.AddBlockToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]+=e[r+0],t[i+1]+=e[r+1],t[i+2]+=e[r+2],t[i+3]+=e[r+3],t[i+4]+=e[r+4],t[i+5]+=e[r+5],t[i+6]+=e[r+6],t[i+7]+=e[r+7]},g.CopyValueToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]=e,t[i+1]=e,t[i+2]=e,t[i+3]=e,t[i+4]=e,t[i+5]=e,t[i+6]=e,t[i+7]=e},g.AddValueToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]+=e,t[i+1]+=e,t[i+2]+=e,t[i+3]+=e,t[i+4]+=e,t[i+5]+=e,t[i+6]+=e,t[i+7]+=e},g.IDCT=function(e){for(var t,i,n,r,s,o,a,d,l,u,c,h,p,f,v,m,g,y,_=0;_<8;++_)t=e[32+_],i=e[16+_]+e[48+_],n=e[40+_]-e[24+_],o=e[8+_]+e[56+_],a=e[24+_]+e[40+_],l=(p=(473*(r=e[8+_]-e[56+_])-196*n+128>>8)-(s=o+a))-(362*(o-a)+128>>8),f=(u=(d=e[0+_])-t)+(c=(362*(e[16+_]-e[48+_])+128>>8)-i),v=(h=d+t)+i,m=u-c,g=h-i,y=-l-(473*n+196*r+128>>8),e[0+_]=s+v,e[8+_]=p+f,e[16+_]=m-l,e[24+_]=g-y,e[32+_]=g+y,e[40+_]=l+m,e[48+_]=f-p,e[56+_]=v-s;for(_=0;_<64;_+=8)t=e[4+_],i=e[2+_]+e[6+_],n=e[5+_]-e[3+_],o=e[1+_]+e[7+_],a=e[3+_]+e[5+_],l=(p=(473*(r=e[1+_]-e[7+_])-196*n+128>>8)-(s=o+a))-(362*(o-a)+128>>8),f=(u=(d=e[0+_])-t)+(c=(362*(e[2+_]-e[6+_])+128>>8)-i),v=(h=d+t)+i,m=u-c,g=h-i,y=-l-(473*n+196*r+128>>8),e[0+_]=s+v+128>>8,e[1+_]=p+f+128>>8,e[2+_]=m-l+128>>8,e[3+_]=g-y+128>>8,e[4+_]=g+y+128>>8,e[5+_]=l+m+128>>8,e[6+_]=f-p+128>>8,e[7+_]=v-s+128>>8},g.PICTURE_RATE=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],g.ZIG_ZAG=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),g.DEFAULT_INTRA_QUANT_MATRIX=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),g.DEFAULT_NON_INTRA_QUANT_MATRIX=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),g.PREMULTIPLIER_MATRIX=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),g.MACROBLOCK_ADDRESS_INCREMENT=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),g.MACROBLOCK_TYPE_INTRA=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),g.MACROBLOCK_TYPE_PREDICTIVE=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),g.MACROBLOCK_TYPE_B=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),g.MACROBLOCK_TYPE=[null,g.MACROBLOCK_TYPE_INTRA,g.MACROBLOCK_TYPE_PREDICTIVE,g.MACROBLOCK_TYPE_B],g.CODE_BLOCK_PATTERN=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),g.MOTION=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),g.DCT_DC_SIZE_LUMINANCE=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),g.DCT_DC_SIZE_CHROMINANCE=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),g.DCT_COEFF=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),g.PICTURE_TYPE={INTRA:1,PREDICTIVE:2,B:3},g.START={SEQUENCE:179,SLICE_FIRST:1,SLICE_LAST:175,PICTURE:0,EXTENSION:181,USER_DATA:178},g),M.Decoder.MP2Audio=(((y.prototype=Object.create(M.Decoder.Base.prototype)).constructor=y).prototype.decode=function(){var e=this.bits.index>>3;if(e>=this.bits.byteLength)return!1;var t=this.decodeFrame(this.left,this.right);return this.bits.index=e+t<<3,!!t&&(this.destination&&this.destination.play(this.sampleRate,this.left,this.right),this.advanceDecodedTime(this.left.length/this.sampleRate),!0)},y.prototype.getCurrentTime=function(){var e=this.destination?this.destination.enqueuedTime:0;return this.decodedTime-e},y.prototype.decodeFrame=function(e,t){var i=this.bits.read(11),n=this.bits.read(2),r=this.bits.read(2),s=!this.bits.read(1);if(i!==y.FRAME_SYNC||n!==y.VERSION.MPEG_1||r!==y.LAYER.II)return 0;var o=this.bits.read(4)-1;if(13<o)return 0;var a=this.bits.read(2),d=y.SAMPLE_RATE[a];if(3===a)return 0;n===y.VERSION.MPEG_2&&(a+=4,o+=14);var l=this.bits.read(1),u=(this.bits.read(1),this.bits.read(2)),c=0;c=u===y.MODE.JOINT_STEREO?this.bits.read(2)+1<<2:(this.bits.skip(2),u===y.MODE.MONO?0:32),this.bits.skip(4),s&&this.bits.skip(16);var h=144e3*y.BIT_RATE[o]/(d=y.SAMPLE_RATE[a])+l|0,p=0,f=0;if(n===y.VERSION.MPEG_2)p=2,f=30;else{var v=u===y.MODE.MONO?0:1,m=y.QUANT_LUT_STEP_1[v][o];f=63&(p=y.QUANT_LUT_STEP_2[m][a]),p>>=6}f<c&&(c=f);for(var g=0;g<c;g++)this.allocation[0][g]=this.readAllocation(g,p),this.allocation[1][g]=this.readAllocation(g,p);for(g=c;g<f;g++)this.allocation[0][g]=this.allocation[1][g]=this.readAllocation(g,p);var _=u===y.MODE.MONO?1:2;for(g=0;g<f;g++){for(b=0;b<_;b++)this.allocation[b][g]&&(this.scaleFactorInfo[b][g]=this.bits.read(2));u===y.MODE.MONO&&(this.scaleFactorInfo[1][g]=this.scaleFactorInfo[0][g])}for(g=0;g<f;g++){for(var b=0;b<_;b++)if(this.allocation[b][g]){var w=this.scaleFactor[b][g];switch(this.scaleFactorInfo[b][g]){case 0:w[0]=this.bits.read(6),w[1]=this.bits.read(6),w[2]=this.bits.read(6);break;case 1:w[0]=w[1]=this.bits.read(6),w[2]=this.bits.read(6);break;case 2:w[0]=w[1]=w[2]=this.bits.read(6);break;case 3:w[0]=this.bits.read(6),w[1]=w[2]=this.bits.read(6)}}u===y.MODE.MONO&&(this.scaleFactor[1][g][0]=this.scaleFactor[0][g][0],this.scaleFactor[1][g][1]=this.scaleFactor[0][g][1],this.scaleFactor[1][g][2]=this.scaleFactor[0][g][2])}for(var k=0,A=0;A<3;A++)for(var T=0;T<4;T++){for(g=0;g<c;g++)this.readSamples(0,g,A),this.readSamples(1,g,A);for(g=c;g<f;g++)this.readSamples(0,g,A),this.sample[1][g][0]=this.sample[0][g][0],this.sample[1][g][1]=this.sample[0][g][1],this.sample[1][g][2]=this.sample[0][g][2];for(g=f;g<32;g++)this.sample[0][g][0]=0,this.sample[0][g][1]=0,this.sample[0][g][2]=0,this.sample[1][g][0]=0,this.sample[1][g][1]=0,this.sample[1][g][2]=0;for(var C=0;C<3;C++){for(this.VPos=this.VPos-64&1023,b=0;b<2;b++){y.MatrixTransform(this.sample[b],C,this.V,this.VPos),M.Fill(this.U,0);for(var E=512-(this.VPos>>1),P=this.VPos%128>>1;P<1024;){for(var S=0;S<32;++S)this.U[S]+=this.D[E++]*this.V[P++];P+=96,E+=32}for(P=1120-P,E-=480;P<1024;){for(S=0;S<32;++S)this.U[S]+=this.D[E++]*this.V[P++];P+=96,E+=32}for(var V=0===b?e:t,x=0;x<32;x++)V[k+x]=this.U[x]/2147418112}k+=32}}return this.sampleRate=d,h},y.prototype.readAllocation=function(e,t){var i=y.QUANT_LUT_STEP_3[t][e],n=y.QUANT_LUT_STEP4[15&i][this.bits.read(i>>4)];return n?y.QUANT_TAB[n-1]:0},y.prototype.readSamples=function(e,t,i){var n=this.allocation[e][t],r=this.scaleFactor[e][t][i],s=this.sample[e][t],o=0;if(n){if(63===r)r=0;else{var a=r/3|0;r=y.SCALEFACTOR_BASE[r%3]+(1<<a>>1)>>a}var d=n.levels;n.group?(o=this.bits.read(n.bits),s[0]=o%d,o=o/d|0,s[1]=o%d,s[2]=o/d|0):(s[0]=this.bits.read(n.bits),s[1]=this.bits.read(n.bits),s[2]=this.bits.read(n.bits));var l=65536/(d+1)|0;o=((d=(d+1>>1)-1)-s[0])*l,s[0]=o*(r>>12)+(o*(4095&r)+2048>>12)>>12,o=(d-s[1])*l,s[1]=o*(r>>12)+(o*(4095&r)+2048>>12)>>12,o=(d-s[2])*l,s[2]=o*(r>>12)+(o*(4095&r)+2048>>12)>>12}else s[0]=s[1]=s[2]=0},y.MatrixTransform=function(e,t,i,n){var r,s,o,a,d,l,u,c,h,p,f,v,m,g,y,_,b,w,k,A,T,C,E,P,S,V,x,I,O,D,M,R,F;r=e[0][t]+e[31][t],s=.500602998235*(e[0][t]-e[31][t]),o=e[1][t]+e[30][t],a=.505470959898*(e[1][t]-e[30][t]),d=e[2][t]+e[29][t],l=.515447309923*(e[2][t]-e[29][t]),u=e[3][t]+e[28][t],c=.53104259109*(e[3][t]-e[28][t]),h=e[4][t]+e[27][t],p=.553103896034*(e[4][t]-e[27][t]),f=e[5][t]+e[26][t],v=.582934968206*(e[5][t]-e[26][t]),m=e[6][t]+e[25][t],g=.622504123036*(e[6][t]-e[25][t]),y=e[7][t]+e[24][t],_=.674808341455*(e[7][t]-e[24][t]),b=e[8][t]+e[23][t],w=.744536271002*(e[8][t]-e[23][t]),k=e[9][t]+e[22][t],A=.839349645416*(e[9][t]-e[22][t]),T=e[10][t]+e[21][t],C=.972568237862*(e[10][t]-e[21][t]),E=e[11][t]+e[20][t],P=1.16943993343*(e[11][t]-e[20][t]),S=e[12][t]+e[19][t],V=1.48416461631*(e[12][t]-e[19][t]),x=e[13][t]+e[18][t],I=2.05778100995*(e[13][t]-e[18][t]),O=e[14][t]+e[17][t],D=3.40760841847*(e[14][t]-e[17][t]),F=r+(M=e[15][t]+e[16][t]),M=.502419286188*(r-M),r=o+O,O=.52249861494*(o-O),o=d+x,x=.566944034816*(d-x),d=u+S,S=.64682178336*(u-S),u=h+E,E=.788154623451*(h-E),h=f+T,T=1.06067768599*(f-T),f=m+k,k=1.72244709824*(m-k),m=y+b,b=5.10114861869*(y-b),y=F+m,m=.509795579104*(F-m),F=r+f,r=.601344886935*(r-f),f=o+h,h=.899976223136*(o-h),o=d+u,u=2.56291544774*(d-u),d=y+o,y=.541196100146*(y-o),o=F+f,f=1.30656296488*(F-f),F=d+o,d=.707106781187*(d-o),o=y+f,o+=y=.707106781187*(y-f),f=m+u,m=.541196100146*(m-u),u=r+h,h=1.30656296488*(r-h),r=f+u,u=.707106781187*(f-u),f=m+h,r+=f+=m=.707106781187*(m-h),f+=u,u+=m,h=M+b,M=.509795579104*(M-b),b=O+k,O=.601344886935*(O-k),k=x+T,T=.899976223136*(x-T),x=S+E,E=2.56291544774*(S-E),S=h+x,h=.541196100146*(h-x),x=b+k,k=1.30656296488*(b-k),b=S+x,x=.707106781187*(S-x),S=h+k,k=.707106781187*(h-k),h=M+E,M=.541196100146*(M-E),E=O+T,T=1.30656296488*(O-T),O=h+E,E=.707106781187*(h-E),h=M+T,b+=O+=h+=M=.707106781187*(M-T),O+=S+=k,S+=h+=E,h+=x,x+=E+=M,E+=k,k+=M,T=s+(R=10.1900081235*(e[15][t]-e[16][t])),s=.502419286188*(s-R),R=a+D,a=.52249861494*(a-D),D=l+I,I=.566944034816*(l-I),l=c+V,c=.64682178336*(c-V),V=p+P,p=.788154623451*(p-P),P=v+C,C=1.06067768599*(v-C),v=g+A,A=1.72244709824*(g-A),g=_+w,_=5.10114861869*(_-w),w=T+g,g=.509795579104*(T-g),T=R+v,R=.601344886935*(R-v),v=D+P,P=.899976223136*(D-P),D=l+V,V=2.56291544774*(l-V),l=w+D,w=.541196100146*(w-D),D=T+v,v=1.30656296488*(T-v),T=l+D,D=.707106781187*(l-D),l=w+v,v=.707106781187*(w-v),w=g+V,V=.541196100146*(g-V),g=R+P,P=1.30656296488*(R-P),R=w+g,g=.707106781187*(w-g),w=V+P,R+=w+=P=.707106781187*(V-P),w+=g,V=g+P,g=s+_,s=.509795579104*(s-_),_=a+A,a=.601344886935*(a-A),A=I+C,C=.899976223136*(I-C),I=c+p,p=2.56291544774*(c-p),c=g+I,g=.541196100146*(g-I),I=_+A,A=1.30656296488*(_-A),_=c+I,I=.707106781187*(c-I),c=g+A,A=.707106781187*(g-A),g=s+p,s=.541196100146*(s-p),p=a+C,C=1.30656296488*(a-C),a=g+p,p=.707106781187*(g-p),g=s+C,T+=_+=a+=g+=s=.707106781187*(s-C),_+=R,R+=a+=c+=A,a+=l+=v,l+=c+=g+=p,c+=w,w+=g+=I,g+=D,D+=I+=p+=s,I+=V,V+=p+=A,p+=v,v+=A+=s,A+=P,P+=s,i[n+48]=-F,i[n+49]=i[n+47]=-T,i[n+50]=i[n+46]=-b,i[n+51]=i[n+45]=-_,i[n+52]=i[n+44]=-r,i[n+53]=i[n+43]=-R,i[n+54]=i[n+42]=-O,i[n+55]=i[n+41]=-a,i[n+56]=i[n+40]=-o,i[n+57]=i[n+39]=-l,i[n+58]=i[n+38]=-S,i[n+59]=i[n+37]=-c,i[n+60]=i[n+36]=-f,i[n+61]=i[n+35]=-w,i[n+62]=i[n+34]=-h,i[n+63]=i[n+33]=-g,i[n+32]=-d,i[n+0]=d,i[n+31]=-D,i[n+1]=D,i[n+30]=-x,i[n+2]=x,i[n+29]=-I,i[n+3]=I,i[n+28]=-u,i[n+4]=u,i[n+27]=-V,i[n+5]=V,i[n+26]=-E,i[n+6]=E,i[n+25]=-p,i[n+7]=p,i[n+24]=-y,i[n+8]=y,i[n+23]=-v,i[n+9]=v,i[n+22]=-k,i[n+10]=k,i[n+21]=-A,i[n+11]=A,i[n+20]=-m,i[n+12]=m,i[n+19]=-P,i[n+13]=P,i[n+18]=-M,i[n+14]=M,i[n+17]=-s,i[n+15]=s,i[n+16]=0},y.FRAME_SYNC=2047,y.VERSION={MPEG_2_5:0,MPEG_2:2,MPEG_1:3},y.LAYER={III:1,II:2,I:3},y.MODE={STEREO:0,JOINT_STEREO:1,DUAL_CHANNEL:2,MONO:3},y.SAMPLE_RATE=new Uint16Array([44100,48e3,32e3,0,22050,24e3,16e3,0]),y.BIT_RATE=new Uint16Array([32,48,56,64,80,96,112,128,160,192,224,256,320,384,8,16,24,32,40,48,56,64,80,96,112,128,144,160]),y.SCALEFACTOR_BASE=new Uint32Array([33554432,26632170,21137968]),y.SYNTHESIS_WINDOW=new Float32Array([0,-.5,-.5,-.5,-.5,-.5,-.5,-1,-1,-1,-1,-1.5,-1.5,-2,-2,-2.5,-2.5,-3,-3.5,-3.5,-4,-4.5,-5,-5.5,-6.5,-7,-8,-8.5,-9.5,-10.5,-12,-13,-14.5,-15.5,-17.5,-19,-20.5,-22.5,-24.5,-26.5,-29,-31.5,-34,-36.5,-39.5,-42.5,-45.5,-48.5,-52,-55.5,-58.5,-62.5,-66,-69.5,-73.5,-77,-80.5,-84.5,-88,-91.5,-95,-98,-101,-104,106.5,109,111,112.5,113.5,114,114,113.5,112,110.5,107.5,104,100,94.5,88.5,81.5,73,63.5,53,41.5,28.5,14.5,-1,-18,-36,-55.5,-76.5,-98.5,-122,-147,-173.5,-200.5,-229.5,-259.5,-290.5,-322.5,-355.5,-389.5,-424,-459.5,-495.5,-532,-568.5,-605,-641.5,-678,-714,-749,-783.5,-817,-849,-879.5,-908.5,-935,-959.5,-981,-1000.5,-1016,-1028.5,-1037.5,-1042.5,-1043.5,-1040,-1031.5,1018.5,1e3,976,946.5,911,869.5,822,767.5,707,640,565.5,485,397,302.5,201,92.5,-22.5,-144,-272.5,-407,-547.5,-694,-846,-1003,-1165,-1331.5,-1502,-1675.5,-1852.5,-2031.5,-2212.5,-2394,-2576.5,-2758.5,-2939.5,-3118.5,-3294.5,-3467.5,-3635.5,-3798.5,-3955,-4104.5,-4245.5,-4377.5,-4499,-4609.5,-4708,-4792.5,-4863.5,-4919,-4958,-4979.5,-4983,-4967.5,-4931.5,-4875,-4796,-4694.5,-4569.5,-4420,-4246,-4046,-3820,-3567,3287,2979.5,2644,2280.5,1888,1467.5,1018.5,541,35,-499,-1061,-1650,-2266.5,-2909,-3577,-4270,-4987.5,-5727.5,-6490,-7274,-8077.5,-8899.5,-9739,-10594.5,-11464.5,-12347,-13241,-14144.5,-15056,-15973.5,-16895.5,-17820,-18744.5,-19668,-20588,-21503,-22410.5,-23308.5,-24195,-25068.5,-25926.5,-26767,-27589,-28389,-29166.5,-29919,-30644.5,-31342,-32009.5,-32645,-33247,-33814.5,-34346,-34839.5,-35295,-35710,-36084.5,-36417.5,-36707.5,-36954,-37156.5,-37315,-37428,-37496,37519,37496,37428,37315,37156.5,36954,36707.5,36417.5,36084.5,35710,35295,34839.5,34346,33814.5,33247,32645,32009.5,31342,30644.5,29919,29166.5,28389,27589,26767,25926.5,25068.5,24195,23308.5,22410.5,21503,20588,19668,18744.5,17820,16895.5,15973.5,15056,14144.5,13241,12347,11464.5,10594.5,9739,8899.5,8077.5,7274,6490,5727.5,4987.5,4270,3577,2909,2266.5,1650,1061,499,-35,-541,-1018.5,-1467.5,-1888,-2280.5,-2644,-2979.5,3287,3567,3820,4046,4246,4420,4569.5,4694.5,4796,4875,4931.5,4967.5,4983,4979.5,4958,4919,4863.5,4792.5,4708,4609.5,4499,4377.5,4245.5,4104.5,3955,3798.5,3635.5,3467.5,3294.5,3118.5,2939.5,2758.5,2576.5,2394,2212.5,2031.5,1852.5,1675.5,1502,1331.5,1165,1003,846,694,547.5,407,272.5,144,22.5,-92.5,-201,-302.5,-397,-485,-565.5,-640,-707,-767.5,-822,-869.5,-911,-946.5,-976,-1e3,1018.5,1031.5,1040,1043.5,1042.5,1037.5,1028.5,1016,1000.5,981,959.5,935,908.5,879.5,849,817,783.5,749,714,678,641.5,605,568.5,532,495.5,459.5,424,389.5,355.5,322.5,290.5,259.5,229.5,200.5,173.5,147,122,98.5,76.5,55.5,36,18,1,-14.5,-28.5,-41.5,-53,-63.5,-73,-81.5,-88.5,-94.5,-100,-104,-107.5,-110.5,-112,-113.5,-114,-114,-113.5,-112.5,-111,-109,106.5,104,101,98,95,91.5,88,84.5,80.5,77,73.5,69.5,66,62.5,58.5,55.5,52,48.5,45.5,42.5,39.5,36.5,34,31.5,29,26.5,24.5,22.5,20.5,19,17.5,15.5,14.5,13,12,10.5,9.5,8.5,8,7,6.5,5.5,5,4.5,4,3.5,3.5,3,2.5,2.5,2,2,1.5,1.5,1,1,1,1,.5,.5,.5,.5,.5,.5]),y.QUANT_LUT_STEP_1=[[0,0,1,1,1,2,2,2,2,2,2,2,2,2],[0,0,0,0,0,0,1,1,1,2,2,2,2,2]],y.QUANT_LUT_STEP_2=[[(y.QUANT_TAB={A:91,B:94,C:8,D:12}).C,y.QUANT_TAB.C,y.QUANT_TAB.D],[y.QUANT_TAB.A,y.QUANT_TAB.A,y.QUANT_TAB.A],[y.QUANT_TAB.B,y.QUANT_TAB.A,y.QUANT_TAB.B]],y.QUANT_LUT_STEP_3=[[68,68,52,52,52,52,52,52,52,52,52,52],[67,67,67,66,66,66,66,66,66,66,66,49,49,49,49,49,49,49,49,49,49,49,49,32,32,32,32,32,32,32],[69,69,69,69,52,52,52,52,52,52,52,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36]],y.QUANT_LUT_STEP4=[[0,1,2,17],[0,1,2,3,4,5,6,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17],[0,1,3,5,6,7,8,9,10,11,12,13,14,15,16,17],[0,1,2,4,5,6,7,8,9,10,11,12,13,14,15,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],y.QUANT_TAB=[{levels:3,group:1,bits:5},{levels:5,group:1,bits:7},{levels:7,group:0,bits:3},{levels:9,group:1,bits:10},{levels:15,group:0,bits:4},{levels:31,group:0,bits:5},{levels:63,group:0,bits:6},{levels:127,group:0,bits:7},{levels:255,group:0,bits:8},{levels:511,group:0,bits:9},{levels:1023,group:0,bits:10},{levels:2047,group:0,bits:11},{levels:4095,group:0,bits:12},{levels:8191,group:0,bits:13},{levels:16383,group:0,bits:14},{levels:32767,group:0,bits:15},{levels:65535,group:0,bits:16}],y),M.Renderer.WebGL=(_.prototype.resize=function(e,t){this.width=0|e,this.height=0|t,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)},_.prototype.createTexture=function(e,t){var i=this.gl,n=i.createTexture();return i.bindTexture(i.TEXTURE_2D,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.uniform1i(i.getUniformLocation(this.program,t),e),n},_.prototype.createProgram=function(e,t){var i=this.gl,n=i.createProgram();return i.attachShader(n,this.compileShader(i.VERTEX_SHADER,e)),i.attachShader(n,this.compileShader(i.FRAGMENT_SHADER,t)),i.linkProgram(n),i.useProgram(n),n},_.prototype.compileShader=function(e,t){var i=this.gl,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(n));return n},_.prototype.allowsClampedTextureData=function(){var e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,1,1,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8ClampedArray([0])),0===e.getError()},_.prototype.renderProgress=function(e){var t=this.gl,i=t.getUniformLocation(this.loadingProgram,"progress");t.uniform1f(i,e),t.drawArrays(t.TRIANGLE_STRIP,0,4)},_.prototype.render=function(e,t,i){if(this.enabled){var n=this.gl,r=this.width+15>>4<<4,s=this.height,o=r>>1,a=s>>1;this.shouldCreateUnclampedViews&&(e=new Uint8Array(e.buffer),t=new Uint8Array(t.buffer),i=new Uint8Array(i.buffer)),this.updateTexture(n.TEXTURE0,this.textureY,r,s,e),this.updateTexture(n.TEXTURE1,this.textureCb,o,a,t),this.updateTexture(n.TEXTURE2,this.textureCr,o,a,i),n.drawArrays(n.TRIANGLE_STRIP,0,4)}},_.prototype.updateTexture=function(e,t,i,n,r){var s=this.gl;s.activeTexture(e),s.bindTexture(s.TEXTURE_2D,t),s.texImage2D(s.TEXTURE_2D,0,s.LUMINANCE,i,n,0,s.LUMINANCE,s.UNSIGNED_BYTE,r)},_.IsSupported=function(){try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas");return!(!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},_.SHADER={FRAGMENT_YCRCB_TO_RGBA:["precision mediump float;","uniform sampler2D textureY;","uniform sampler2D textureCb;","uniform sampler2D textureCr;","varying vec2 texCoord;","mat4 rec601 = mat4(","1.16438,  0.00000,  1.59603, -0.87079,","1.16438, -0.39176, -0.81297,  0.52959,","1.16438,  2.01723,  0.00000, -1.08139,","0, 0, 0, 1",");","void main() {","float y = texture2D(textureY, texCoord).r;","float cb = texture2D(textureCb, texCoord).r;","float cr = texture2D(textureCr, texCoord).r;","gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;","}"].join("\n"),FRAGMENT_LOADING:["precision mediump float;","uniform float progress;","varying vec2 texCoord;","void main() {","float c = ceil(progress-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),VERTEX_IDENTITY:["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},_),M.Renderer.Canvas2D=(b.prototype.resize=function(e,t){this.width=0|e,this.height=0|t,this.canvas.width=this.width,this.canvas.height=this.height,this.imageData=this.context.getImageData(0,0,this.width,this.height),M.Fill(this.imageData.data,255)},b.prototype.renderProgress=function(e){var t=this.canvas.width,i=this.canvas.height,n=this.context;n.fillStyle="#222",n.fillRect(0,0,t,i),n.fillStyle="#fff",n.fillRect(0,i-i*e,t,i*e)},b.prototype.render=function(e,t,i){this.YCbCrToRGBA(e,t,i,this.imageData.data),this.context.putImageData(this.imageData,0,0)},b.prototype.YCbCrToRGBA=function(e,t,i,n){if(this.enabled)for(var r,s,o,a,d,l=this.width+15>>4<<4,u=l>>1,c=0,h=l,p=l+(l-this.width),f=0,v=u-(this.width>>1),m=0,g=4*this.width,y=4*this.width,_=this.width>>1,b=this.height>>1,w=0;w<b;w++){for(var k=0;k<_;k++){r=t[f],s=i[f],f++,o=r+(103*r>>8)-179,a=(88*s>>8)-44+(183*r>>8)-91,d=s+(198*s>>8)-227;var A=e[c++],T=e[c++];n[m]=A+o,n[m+1]=A-a,n[m+2]=A+d,n[m+4]=T+o,n[m+5]=T-a,n[m+6]=T+d,m+=8;var C=e[h++],E=e[h++];n[g]=C+o,n[g+1]=C-a,n[g+2]=C+d,n[g+4]=E+o,n[g+5]=E-a,n[g+6]=E+d,g+=8}c+=p,h+=p,m+=y,g+=y,f+=v}},b),M.AudioOutput.WebAudio=(w.prototype.play=function(e,t,i){if(this.enabled){if(!this.unlocked){var n=M.Now();return this.wallclockStartTime<n&&(this.wallclockStartTime=n),void(this.wallclockStartTime+=t.length/e)}this.gain.gain.value=this.volume;var r=this.context.createBuffer(2,t.length,e);r.getChannelData(0).set(t),r.getChannelData(1).set(i);var s=this.context.createBufferSource();s.buffer=r,s.connect(this.destination);var o=this.context.currentTime,a=r.duration;this.startTime<o&&(this.startTime=o,this.wallclockStartTime=M.Now()),s.start(this.startTime),this.startTime+=a,this.wallclockStartTime+=a}},w.prototype.stop=function(){this.gain.gain.value=0;
},w.prototype.getEnqueuedTime=function(){return Math.max(this.wallclockStartTime-M.Now(),0)},w.prototype.resetEnqueuedTime=function(){this.startTime=this.context.currentTime,this.wallclockStartTime=M.Now()},w.prototype.unlock=function(e){if(this.unlocked)e&&e();else{this.unlockCallback=e;var t=this.context.createBuffer(1,1,22050),i=this.context.createBufferSource();i.buffer=t,i.connect(this.destination),i.start(0),setTimeout(this.checkIfUnlocked.bind(this,i,0),0)}},w.prototype.checkIfUnlocked=function(e,t){e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE?(this.unlocked=!0,this.unlockCallback&&(this.unlockCallback(),this.unlockCallback=null)):t<10&&setTimeout(this.checkIfUnlocked.bind(this,e,t+1),100)},w.NeedsUnlocking=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},w.IsSupported=function(){return window.AudioContext||window.webkitAudioContext},w.CachedContext=null,w);var R=function(e,t){return new M.Player(e,t)},F=function(){function e(t,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(n=T(this,C(e).call(this))).video=t,n.params=i,n.target=n.params.canvas.parent,n.logToBI=n.params.logToBI,n.createCanvas(),n.modifyVideo(t),n.shouldAutoPlay=!1,n.canvasCss=i.canvas.additionalCss||{},n.bypass=!1,n.clntRedirRslvWhiteList=n.params.clientRedirRslvWhiteList||[],n.ready=!1,n.loop=!1,n.vidAttr={},t.muted=!0,n.status="LOADING",n.quartiles=[{event:"AdVideoFirstQuartile",percentage:.25},{event:"AdVideoMidpoint",percentage:.5},{event:"AdVideoThirdQuartile",percentage:.75}],n.logToBI("canvas",{ctor:!0}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(e,x.EventEmitter),function(e,t,i){t&&A(e.prototype,t),i&&A(e,i)}(e,[{key:"emitStartAd",value:function(){var e=this;this.stratAdCalled=!0,this._playTimeout=setTimeout(function(){e._play()},2e3)}},{key:"backToVideoTag",value:function(e){var t=this;if(!this.bypass&&this.src){this.bypass=!0;var i=this.jsmpeg.currentTime,n=this.video.style,r=this.video.parentElement||this.target,s=parseInt(this.canvas.style.zIndex),o=this.jsmpeg.loop;this.newVid=r.insertBefore(document.createElement("video"),this.canvas),this.newVid.className="mc-loud-video",this.newVid.setAttribute("playsinline",""),this.newVid.setAttribute("autoplay",""),o&&this.newVid.setAttribute("loop",""),this.newVid.style.height=n.height,this.newVid.style.width=n.width,this.newVid.style.top=n.top?n.top:"0",this.newVid.style.left=n.left?n.left:"0",this.newVid.style.background="#000000",this.newVid.style.zIndex=s,this.newVid.style.display="none",this.newVid.src=this.src,this.newVid.volume="muteChanged"===e.type?this.params.canvas.defaultVolume:0,this.newVid.muted=0===this.newVid.volume,this.newVid.addEventListener("ended",function(e){t.dispatchDOM("ended")},!1),this.newVid.addEventListener("click",function(e){t.dispatchDOM("click",e)}),this.newVid.addEventListener("durationchange",function n(){if(0!==t.newVid.duration){t.newVid.removeEventListener("durationchange",n);var r=t.jsmpeg&&0<t.jsmpeg.currentTime?t.jsmpeg.currentTime:i;(0===t.newVid.currentTime||t.newVid.currentTime<r)&&(t.newVid.currentTime=r,t.newVid.addEventListener("timeupdate",function i(){t.newVid.currentTime>r&&(t.newVid.removeEventListener("timeupdate",i),t.tuTicker=clearInterval(t.tuTicker),t.jsmpeg.stop(),t.jsmpeg=void 0,t.newVid.style.display="block",t.canvas.style.display="none",t.video.style.display="none","playChanged"!==e.type&&!t.video.paused||t._pause(),t.emit("newVidCreated",t.newVid))}))}}),this.newVid.addEventListener("timeupdate",function(){t.dispatchDOM("canvas-timeupdate")}),this.newVid.currentTime=i,this.newVid.play().then(function(){t.newVid.currentTime=i}),this.isCanvasFinished=!1}}},{key:"mpegFinish",value:function(){this.isCanvasFinished||(this.emit("canvasEnded"),this.dispatchDOM("ended"),this.isCanvasFinished=!0)}},{key:"onLoad",value:function(){var e=this;if(!this.loaded){this.loaded=!0;var t=parseInt(this.video.clientWidth),i=parseInt(this.video.clientHeight);this.onResize(t,i),setTimeout(function(){e.ready=!0,e.emit("ready"),e.dispatchDOM("loadedmetadata")},0)}}},{key:"createCanvas",value:function(){var e=this,t=document.createElement("canvas");t.className="mc-canvas",this.params.isMultiVpaidUnit&&function(e,t){e.className.indexOf(t)<0&&(e.className+=" ".concat(t)),e.className=e.className.split(" ").join(" ")}(t,"multi-vpaids");var i=this.video.parentElement||this.target;this.canvas=i.appendChild(t),i.className+=" mpegcnv";var n=this;i._appendChild=i.appendChild,i.appendChild=function(e){i.insertBefore(e,n.canvas)},this.video&&this.video.addEventListener("resize",function(e){n.onResize(e.target.clientWidth,e.target.clientHeight)}),this.canvas.addEventListener("click",function(t){e.dispatchDOM("click",t)})}},{key:"_getAspectRatio",value:function(){var e=this.params.canvas.aspectRatio;if(e&&e.indexOf(":")){var t=e.split(":");if(2===t.length&&t[0]&&t[1])return t}return!1}},{key:"onResize",value:function(e,t){var i,n;if(e||t){var r=this._getAspectRatio();r?e?(t=t||this.video.clientHeight,n=e,i=Math.floor(parseFloat(e)*parseInt(r[1])/parseInt(r[0]))):(e=this.video.clientWidth,i=t,n=Math.floor(parseFloat(t)*parseInt(r[0])/parseInt(r[1]))):(n=e,i=t),this.newVid?(this.newVid.style.width="".concat(e,"px"),this.newVid.style.height="".concat(t,"px")):this.jsmpeg&&this.canvas&&(this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.width=n+"px",this.canvas.style.height=i+"px",this.canvas.style.marginTop=(t-i)/2+"px",this.canvas.style.marginLeft=(e-n)/2+"px"),this.height=t,this.width=e}}},{key:"hookProp",value:function(e,t,i,n){var r="alt_"+t;e.hasOwnProperty(r)||(e[r]="",Object.defineProperty(e,t,{get:function(){return i?i():this[r]},set:function(i){this[r]=i,n&&n(i)&&e.setAttribute(t,i)}}))}},{key:"hookMethod",value:function(e,t,i){this.hooks||(this.hooks=[]),this.hooks[t]=e[t];var n=this;e[t]=function(){var e={};if(i(arguments,e)){if(!n.hooks.hasOwnProperty(t)||"function"!=typeof n.hooks[t])return!1;var r=n.hooks[t].apply(this,arguments);return e.res?e.res:r}}}},{key:"dispatchDOM",value:function(e,t){if(this.video){var i=new Event(e);this.video.dispatchEvent(i)}}},{key:"errHndlr",value:function(e){this.logToBI("jsmpegError",e),this.emit("canvasError")}},{key:"isUrlInRslvWhiteList",value:function(e){if(!this.clntRedirRslvWhiteList.length)return!0;for(var t=0;t<this.clntRedirRslvWhiteList.length;++t)if(-1<e.indexOf(this.clntRedirRslvWhiteList[t]))return!0;return!1}},{key:"setSrc",value:function(e){if((e=e.trim())&&!this.hasVidUrl){this.logToBI("canvasUrl",{url:e},!1,!1),this.hasVidUrl=!0,this.video&&this.video._vidSetAttr("src",e),this.src=e;var t=this.params.canvas.canvasLoadRate,i=parseInt(this.video.clientWidth),n=parseInt(this.video.clientHeight),r={loadeReadyRate:t,canvas:this.canvas,audio:!1,centerVertically:!0,autoplay:this.shouldAutoPlay,loop:this.loop||!1,pcy:n,pcx:i,onload:this.onLoad.bind(this),errHndlr:this.errHndlr.bind(this),onfinished:this.mpegFinish.bind(this),progressive:!1,canvasCss:this.canvasCss,disableGl:this.params.canvas.disableWebGl},s=this.params.canvas.mpegServerBaseUrl+"="+encodeURIComponent(e);return(/\.mpg$/.test(e)||/\.mpeg$/.test(e))&&(s=e),this.jsmpeg=new R(s,r,this),this._setVideoDuration(this.src),!1}}},{key:"_play",value:function(){var e=this;this.blockActions||(clearTimeout(this._playTimeout),this._timeUpdateTicker(),this.ready?(this.newVid?this.newVid.play():this.jsmpeg.play(),this.dispatchDOM("playing"),this.status="PLAYING",this._render()):this.on("ready",function(){e.emit("play"),e._play()}))}},{key:"_timeUpdateTicker",value:function(){var e=this;clearInterval(this.tuTicker),this.tuTicker=setInterval(function(){e.dispatchDOM("timeupdate"),e.dispatchDOM("canvas-timeupdate"),0<e.quartiles.length&&e.video.currentTime/e.video.duration>=e.quartiles[0].percentage&&e.logToBI("canvas_quartiles",{event:e.quartiles.shift().event})},250)}},{key:"_pause",value:function(){this.stopped||(this.status="PAUSED",this._render(),this.newVid?this.newVid.pause():this.jsmpeg&&this.jsmpeg.pause())}},{key:"muteButtonClick",value:function(e){if(!this.stopped){var t=!!this.newVid&&!this.newVid.muted;this.logToBI("canvasMuteToggle",{muted:t}),this.newVid?(this.newVid.volume=t?0:this.params.canvas.defaultVolume,this.newVid.muted=0===this.newVid.volume):this.backToVideoTag({type:"muteChanged"})}}},{key:"playButtonClick",value:function(e){if(!this.stopped){var t="PLAYING"===this.status?"PAUSED":"PLAYING";if(this.logToBI("canvasPlayToggle",{status:t,view:this.newVid?"newVid":"canvas"}),this.status=t,this.newVid){var i=this.newVid||this.jsmpeg;"PLAYING"===this.status?i.play():i.pause(),this._render()}else this.backToVideoTag({type:"playChanged"})}}},{key:"modifyVideo",value:function(e){var t=this;if(!this.stopped){var i=this;e._vidSetAttr=e.setAttribute,e.getAttribute=function(e,i){return t.vidAttr[e]},e.setAttribute=function(n,r){if(!i.stopped)return t.vidAttr[n]=r,"volume"===n&&(t._volume=r),t.logToBI("hookSetAttribute",{key:n,val:r}),"src"===n?void t.setSrc(r):e._vidSetAttr(n,r)},this.hookMethod(e,"play",function(){if(!i.stopped)return i._play(),i.dispatchDOM("playing"),!1}),this.hookMethod(e,"pause",function(){if(!i.stopped)return i._pause(),!0}),this.hookMethod(e,"stop",function(){if(!i.stopped)return i.jsmpeg.stop(),!0}),this.hookProp(e,"paused",function(){return"PAUSED"===this.status}.bind(this),null),this.hookProp(e,"src",null,this.setSrc.bind(this)),this.hookProp(this.video,"volume",function(){return t.newVid?t.newVid.volume:t._volume},function(e){return t._volume=e,!0}),this.hookProp(e,"currentTime",function(){var e=i.newVid||i.jsmpeg;return e?e.currentTime:0},null),this.hookProp(e,"duration",function(){if(i.duration)return i.duration},function(e){i.duration=e})}}},{key:"_setVideoDuration",value:function(e){var t=this,i=document.createElement("video");i.src=e,i.addEventListener("loadedmetadata",function(){t.video&&(t.video.duration=i.duration),i.src="",i=void 0}),i.load()}},{key:"_render",value:function(){this.newVid||this.canvas}},{key:"hide",value:function(){this.stopped||(this.canvas.style.display="none",this._render())}},{key:"show",value:function(){this.stopped||(this.canvas.style.display="block",this._render())}},{key:"removeDomMember",value:function(e){e.parentNode.removeChild(e)}},{key:"restartAd",value:function(){var e=this;this.stopped||(this.newVid?(this.newVid.currentTime=0,this.newVid.play()):this.jsmpeg&&(this.blockActions=!0,this.jsmpeg.stop(),setTimeout(function(){e.jsmpeg.play()},20),setTimeout(function(){e.blockActions=!1},2e3)))}},{key:"destroy",value:function(){clearTimeout(this._playTimeout),clearInterval(this.tuTicker),this.jsmpeg=void 0;var e=this._events;for(var t in e)this.removeAllListeners(t);this.removeDomMember(this.canvas),this.canvas=void 0}}]),e}(),L=D,B=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=document.createElement("video"),this._initVideoElementParams(t),this._addVideoElementMethods(),this._addVideoElementProperties(),this._addVideoEvents(),this._loopThroughMediaSources(),this.video.videoState=t.videoState||O,this.video}return function(e,t,i){t&&S(e.prototype,t),i&&S(e,i)}(e,[{key:"_shouldDetectAutoplay",value:function(){return this.params.isMobile&&!this.params.canvas.ignoreAutoplayDetection}},{key:"_initVideoElementParams",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(this.params=P({},L,t),this.params.canvas=P({},L.canvas,t.canvas),this.params.secureMediaFiles=this.params.secureMediaFiles&&"https:"===window.location.protocol,this.params.userAgent=V.UAParser(window.navigator.userAgent),this.params.isMobile)if(this.params.logToBI("videoElement",{forceCanvas:this.params.canvas.force},!1,!1),this.params.canvas.force){if(this.params.videoState===O&&this.params.canvas.useAutoplayForContent)return;this._initCanvas()}else this._shouldDetectAutoplay()&&this._detectAutoplay()}},{key:"_detectAutoplay",value:function(){var e=new I(this.params);e.on("detectIsAutoplaySupported",this._onIsAutoplaySupportedDetected.bind(this)),e.isAutoplaySupported()}},{key:"_onIsAutoplaySupportedDetected",value:function(e){this.params.autoplay=e,this.video.forceCanvas=!this.params.autoplay,this.params.canvas.onAutoplayDetected(this.params.autoplay),this.params.logToBI("videoElement",{isAutoplaySupported:e},!1,!1),"iOS"===this.params.userAgent.os.name?this._initVideoOnIOS():"Android"!==this.params.userAgent.os.name||this.params.autoplay||this._initCanvas()}},{key:"_initVideoOnIOS",value:function(){this.video.removeAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0}},{key:"_initCanvas",value:function(){this.canvasInited||(this.canvasInited=!0,this.video.forceCanvas=!0,this.canvas=new F(this.video,this.params),this._addCanvasMethods(),this._registerToCanvasEvents())}},{key:"_addCanvasMethods",value:function(){this._addMuteButtonClickedMethod(),this._addPlayButtonClickedMethod(),this._addResizeMethod(),this._addIsCanvasLoadedMethod(),this._addUseResumeCallbackMethod(),this._addEmitStartAdMethod(),this._addShowCanvasMetnod(),this._addHideCanvasMetnod()}},{key:"_registerToCanvasEvents",value:function(){this._registerToCanvasReadyEvent(),this._registerToCanvasNewVidCreatedEvent(),this._registerToCanvasPlayEvent(),this._registerToCanvasEndedEvent(),this._registerToCanvasErrorEvent()}},{key:"_registerToCanvasReadyEvent",value:function(){var e=this;this._onCanvasReady=function(){e.video.canvasReady=!0,e._dispatchEvent("canvasReady")},this.canvas.on("ready",this._onCanvasReady)}},{key:"_registerToCanvasNewVidCreatedEvent",value:function(){var e=this;this._onNewVidCreated=function(t){t.style.pointerEvents="all",t.style.zIndex=t.style.zIndex||e.zIndex,e.newVidCreated=!0,e._dispatchEvent("canvasRemoved",{videoElement:t}),e._removeCanvasMethods(),e._unregisterFromCanvasEvents()},this.canvas.on("newVidCreated",this._onNewVidCreated)}},{key:"_registerToCanvasPlayEvent",value:function(){var e=this;this._onCanvasPlay=function(){e.newVidCreated||e._dispatchEvent("canvasPlay")},this.canvas.on("play",this._onCanvasPlay)}},{key:"_registerToCanvasEndedEvent",value:function(){var e=this;this._onCanvasEnded=function(){e.newVidCreated||e._dispatchEvent("canvasEnded")},this.canvas.on("canvasEnded",this._onCanvasEnded)}},{key:"_registerToCanvasErrorEvent",value:function(){var e=this;this._onCanvasError=function(){e.newVidCreated||e._dispatchEvent("canvasError")},this.canvas.on("canvasError",this._onCanvasError)}},{key:"_addVideoElementMethods",value:function(){this._addClearVideoSourcesMethod(),this._addDestroyMethod(),this._addRestartMethod(),this._addAppendSourceMethod(),this._addAppendVideoSourcesMethod(),this._addRegisterProgressEventsMethod(),this._addRegisterTickingEventsMethod(),this._addProtectVideoPauseMethod(),this._addGetSrcMethod(),this._addHookMutedPropertyMethod(),this._addSupressErrorEventsMethod()}},{key:"_addClearVideoSourcesMethod",value:function(){this.video.clearVideoSources=function(){for(;this.childNodes.length;)this.removeChild(this.childNodes[0])}}},{key:"_addDestroyMethod",value:function(){var e=this;this.video.destroy=function(){this.pause(),this.clearVideoSources(),this.src="",e.canvas&&e.canvas.destroy()}}},{key:"_addRestartMethod",value:function(){this.video.restart=function(){this.currentTime=0,this.play()}}},{key:"_addAppendSourceMethod",value:function(){this.video.appendSource=function(e,t){if(this.forceCanvas)this.setAttribute("src",e),this.setAttribute("type",t);else{var i=document.createElement("source");i.src=e,i.setAttribute("type",t),this.appendChild(i)}this.relevantSources++}}},{key:"_addAppendVideoSourcesMethod",value:function(){var e=this;this.video.appendVideoSources=function(t){var i=null;this.clearVideoSources();for(var n=0;n<t.length;n++){var r=t[n],s=r.url;this.canPlayType(r.originalType)&&(e.params.decodeUrl&&(s=decodeURI(s)),e.params.secureMediaFiles&&(s=s.replace("http:","https:")),i||((i=r).mediaUrl=s),this.appendSource(s,r.originalType))}return i}}},{key:"_addRegisterProgressEventsMethod",value:function(){this.video.registerProgressEvents=function(e){this._progressEvents={};for(var t=0;t<e.length;t++){var i="precentage"===e[t].offsetType?e[t].offset:e[t].offset/this.duration;this._progressEvents[i]={offset:i,fired:!1}}}}},{key:"_addRegisterTickingEventsMethod",value:function(){this.video.registerTickingEvents=function(e){this._ticker=e}}},{key:"_addProtectVideoPauseMethod",value:function(){this.video.protectPause=function(){this._play=this.play,this.play=function(){this.resumeInvoked&&this._play()}}}},{key:"_addGetSrcMethod",value:function(){this.video.getSrc=function(){if(this.src)return this.src;for(var e=0;e<this.childNodes.length;e++){var t=this.childNodes[e];if("source"===t.nodeName.toLowerCase()&&t.src)return t.src}return""}}},{key:"_addHookMutedPropertyMethod",value:function(){this.params.isMobile&&(this.video.hookMutedProperty=function(){this.__defineSetter__("_muted",this.__lookupSetter__("muted")),this.__defineSetter__("muted",function(e){return this.mutedChangeByUserGesture?(this._muted=e,void this.__defineSetter__("muted",this.__lookupSetter__("_muted"))):void(this._muted=!0)})})}},{key:"_addSupressErrorEventsMethod",value:function(){this.video.supressErrorEvents=function(){this._addEventListener=this.addEventListener,this.addEventListener=function(e,t){"error"!==e&&this._addEventListener(e,t)}}}},{key:"_addMuteButtonClickedMethod",value:function(){var e=this;this.video.muteButtonClicked=function(){e.canvas&&e.canvas.muteButtonClick()}}},{key:"_addPlayButtonClickedMethod",value:function(){var e=this;this.video.playButtonClicked=function(){e.canvas&&e.canvas.playButtonClick()}}},{key:"_addResizeMethod",value:function(){var e=this;this.video.resize=function(){if(e.canvas){var t=1<arguments.length?arguments:arguments[0],i=t[0],n=t[1],r=t[2];r&&(e.params.canvas.aspectRatio=r),e.canvas.onResize(i,n)}}}},{key:"_addIsCanvasLoadedMethod",value:function(){var e=this;this.video.isCanvasLoaded=function(){return e.canvas&&e.canvas.loaded}}},{key:"_addUseResumeCallbackMethod",value:function(){var e=this;this.video.useResumeCallback=function(){return e.canvas}}},{key:"_addEmitStartAdMethod",value:function(){var e=this;this.video.emitStartAd=function(){return e.canvas.emitStartAd()}}},{key:"_addShowCanvasMetnod",value:function(){var e=this;this.video.showCanvas=function(){return e.canvas.show()}}},{key:"_addHideCanvasMetnod",value:function(){var e=this;this.video.hideCanvas=function(){return e.canvas.hide()}}},{key:"_addVideoElementProperties",value:function(){this._addTbVersionProperty(),this._addProgressPrecentageProperty(),this._addRemainingTimeProperty(),this._addRelevantSourcesProperty(),this._addBufferSizeProperty(),this._addResumeInvokedProperty(),this._addMutedChangeByUserGestureProperty(),this._addVideoStateProperty(),this._addForceCanvasProperty()}},{key:"_addTbVersionProperty",value:function(){Object.defineProperty(this.video,"TB__VERSION",{get:function(){return"2.0.1"}})}},{key:"_addProgressPrecentageProperty",value:function(){Object.defineProperty(this.video,"progressPrecentage",{get:function(){return this.currentTime/this.duration}})}},{key:"_addRemainingTimeProperty",value:function(){Object.defineProperty(this.video,"remainingTime",{get:function(){return this.duration-this.currentTime}})}},{key:"_addRelevantSourcesProperty",value:function(){Object.defineProperty(this.video,"relevantSources",{get:function(){return this._relevantSources||0},set:function(e){this._relevantSources=e}})}},{key:"_addBufferSizeProperty",value:function(){Object.defineProperty(this.video,"bufferSize",{get:function(){if(this.buffered)return 0===this.buffered.length||0!==this.buffered.start(0)?0:this.buffered.end(0)-this.buffered.start(0)}})}},{key:"_addResumeInvokedProperty",value:function(){Object.defineProperty(this.video,"resumeInvoked",{get:function(){return this._resumeInvoked||!1},set:function(e){this._resumeInvoked=e}})}},{key:"_addMutedChangeByUserGestureProperty",value:function(){this.params.isMobile&&Object.defineProperty(this.video,"mutedChangeByUserGesture",{get:function(){return this._mutedChangeByUserGesture||!1},set:function(e){this._mutedChangeByUserGesture=e}})}},{key:"_addVideoStateProperty",value:function(){Object.defineProperty(this.video,"videoState",{get:function(){return this._videoState||O},set:function(e){this._videoState=e}})}},{key:"_addForceCanvasProperty",value:function(){var e=this;if(this.params.isMobile){var t=this.video.forceCanvas||!1;Object.defineProperty(this.video,"forceCanvas",{get:function(){return this._forceCanvas||t},set:function(t){this._forceCanvas=t,this._forceCanvas&&e._initCanvas()}})}}},{key:"_removeCanvasMethods",value:function(){this.video.isCanvasLoaded=this.video.emitStartAd=this.video.showCanvas=this.video.hideCanvas=void 0}},{key:"_unregisterFromCanvasEvents",value:function(){this.canvas.removeListener("ready",this._onCanvasReady),this.canvas.removeListener("newVidCreated",this._onNewVidCreated),this.canvas.removeListener("play",this._onCanvasPlay),this.canvas.removeListener("canvasEnded",this._onCanvasEnded),this.canvas.removeListener("canvasError",this._onCanvasError),this._onCanvasReady=this._onNewVidCreated=this._onCanvasPlay=this._onCanvasEnded=this._onCanvasError=void 0}},{key:"_addVideoEvents",value:function(){this._addTimeupdateEvents()}},{key:"_addTimeupdateEvents",value:function(){this.quartiles={q1:!1,q2:!1,q3:!1};var e=this;this.video.addEventListener(this.video.forceCanvas?"canvas-timeupdate":"timeupdate",function t(){!e.quartiles.q1&&.25<=this.progressPrecentage?(e.quartiles.q1=!0,e._dispatchEvent("firstQuartile")):!e.quartiles.q2&&.5<=this.progressPrecentage?(e.quartiles.q2=!0,e._dispatchEvent("midpoint")):!e.quartiles.q3&&.75<=this.progressPrecentage&&(e.quartiles.q3=!0,e._dispatchEvent("thirdQuartile"));var i=!0;for(var n in this._progressEvents)this._progressEvents[n].fired||(this._progressEvents[n].offset<=this.progressPrecentage?(this._progressEvents[n].fired=!0,e._dispatchEvent("timeProgress",{pre:this.progressPrecentage,time:this.currentTime})):i=!1);if(this._ticker){var r=Math.floor(this.currentTime);this._currentTimeFloored!==r&&r%this._ticker==0&&(this._currentTimeFloored=r,e._dispatchEvent("ticking",{time:r}))}i&&e.quartiles.q3&&!this._ticker&&this.removeEventListener("timeupdate",t,!0)})}},{key:"_loopThroughMediaSources",value:function(){var e=this;this.video.addEventListener("ended",function(){if(e._isPlayingContent()&&1<this.childNodes.length){var t=this.removeChild(this.childNodes[0]);this.appendChild(t),this.load(),this.play()}})}},{key:"_dispatchEvent",value:function(e,t){var i=document.createEvent("Event");i.initEvent(e,!0,!0),i.data=t||{},this.video.dispatchEvent(i)}},{key:"_isPlayingContent",value:function(){return this.video.videoState===O}}]),e}();try{if(window.cmTag){var j=window.cmTag.config.ms||{};j["video-element"]=j["video-element"]||{},j["video-element"]["2.0.1"]=B,window.cmTag.set("ms",j)}}catch(e){}try{window.TRC=window.TRC||{},window.TRC["video-element"]=window.TRC["video-element"]||{},window.TRC["video-element"]["2.0.1"]=B}catch(e){}}])},function(e,t){(function(t){e.exports=t}).call(t,{})}]);
!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(5),s=n(o),r=i(6),a=i(91),l=n(a),d=i(104),c=(n(d),i(17)),u=n(c),h=i(105),p=(n(h),i(111)),f=(n(p),i(26)),m=n(f);i(126);var g=window.define;window.define=null;var v=i(8),y=(i(128),i(129),i(11)),b=(i(130),i(10));window.define=g;var _=(i(25),i(131)),w=i(132),T=i(133),A=i(134),S=i(22),P=i(135),C=i(139),E=i(142);window.startCMTagMain=function(e,t){function n(){if(e.unitName=e.unitType,e.urlPrefix){var t=e.urlPrefix.split("/");e.unitVersion=t[t.length-2],e.unitVersion=e.unitVersion.replace(/_/g,"")}else e.unitVersion=e.version.replace(/_/g,"");Q[e.unitType](),Y.get("multiUnitManager.isActive")&&w.addUnit(Y.get("redId"),Y);var i=Y.get("cookieMatchActive"),n=Y.get("sync");i&&n&&new A(Y)}function o(){}function a(){}function d(){}function c(){}function h(){}function p(){}function f(){}function g(){var t=i(143),n=i(148);Y=x(t,n,e);var o=i(149);O(o,Y,void 0,!1)}function k(){}function I(){}function O(t,i,n,o){v.parseBool(e.isWaitForStartEvent)?(X.unit=t,X.model=i,X.placement=n,X.isUnitPlay=o,i.fireUnitDelayedPixel(),window.TRC=window.TRC||{},window.TRC.videoFunctions={},window.TRC.videoFunctions.startEvent=function(){K||(X.model.fireUnitLoadAfterDelayPixel(),V(X.unit,X.model,X.placement,X.isUnitPlay),K=!0)}):V(t,i,n,o)}function V(e,i,n,o){var s=new e({model:i,placementElement:n});o&&(t.play=s.play.bind(s))}function x(i,n,o){var s=new y.DeepModel;s.set(o),t&&t._settings&&(cmTag&&cmTag.logger&&cmTag.logger.info("settings by FPP",t._settings),s.set(t._settings)),$(s.attributes);var a=(new T(s.attributes),o.isMobile?n:i),l=new a(s.attributes);if(v.parseBool(e.isUseCMP)){new r.GDPRManager(l)}else l.set("canStartPlayer",!0);return D(l),M(l),l}function D(e){if(e.get("isOppsulaEnabled")===!0){var t={version:e.get("microServices.oppsula.version"),model:e},i=new r.OppsulaManager(t);S.oppsula=i}}function M(e){S.serviceLoader.get("video-autoplay-detector",e.get("microServices.autoplayDetector.version"),function(t){S.autoPlayDetector=new t(e.handleAutoPlayData.bind(e),{isMobile:e.get("isMobile"),timeout:1e3*e.get("autoplayDetectorTimeoutSec")})})}function R(){return"FEED_MANAGER"===e.unitType&&(!!window.isCmTagFMOnPage||(window.isCmTagFMOnPage=!0,!1))}function N(){cmTag.units=cmTag.units||{},cmTag.units[v.now()]=e}function L(e){"open"===e?(Y.set("supportTool",{isOpen:!0}),F()):(Y.set("supportTool",{isOpen:!1}),B())}function F(){if(!G&&"OMNI_TAG"!==e.unitType){var t=S.player&&S.player.getVpaidLogs?S.player.getVpaidLogs():void 0;Y.set("supportTool",{isOpen:!0});var i=void 0;S&&S.supportTool&&S.supportTool.dp&&(i=S.supportTool.dp);var n={creativeData:e,vpaidLogs:v.stripObject(v.arrayToObj(t),[],!0,!0,!0)};n.unitModel=v.stripObject(Y.attributes,[],!0,!0,!0),i&&(n.dp=i),q=new E(n),G=new C({model:q})}}function B(){G.remove(),G=null,q=null}function j(){t&&(t._events&&(t._events.forEach(function(e){y.on(e.name,e.cb)}),t.on=function(e,t){y.on(e,t)}),t.trigger=function(e,t){y.trigger(e,t)})}function U(){if(window.TRC=window.TRC||{},y.$=b,v.templateSettings={interpolate:/\{\{(.+?)\}\}/g},cmTag.logger||(cmTag.logger=new u.default(e)),e.documentReadyState=document.readyState,cmTag.logger.info("init",e),!R()){cmTag.utils=v,cmTag.$=b,j();var t=window;v.isInFriendlyIframe(cmTag.config.iframeData)&&(t=v.getTopWindow()),e.isHideIframe&&v.hideDFPIframe(e.iframeData),e.hasSupportTool!==!0&&"true"!==e.hasSupportTool||y.on("supportTool:event",L),cmTag.config.scrollSelector?(new _(t,cmTag.config.scrollSelector),new m.default(e,t,cmTag.config.scrollSelector)):(new _(t),new m.default(e,t)),H()}}function H(){var e=new y.DeepModel;e.set({microServices:S.microServices}),e.set(cmTag.config);var t=e.get("microServices");s.default.init(t),S.serviceLoader=s.default,W(t)}function W(e){S.serviceLoader.get("PMS",e.PMS.version,z.bind(this),z.bind(this,l.default))}function z(e){cmTag.logger.info("PMS Loaded");var t=new e;S.pms=t,n(),N()}function $(e){if(e.onPassback)return void(e.isApiPassbackExist=!0);if(TRC&&TRC._taboolaClone)for(var t=0;t<TRC._taboolaClone.length;t++)if("video.passback"==TRC._taboolaClone[t].listenTo)return void(e.isApiPassbackExist=!0);e.isApiPassbackExist=!1}var G,q,Y,K=!1;P.beforeCMTag(e);var Q={INLINE:o,INLINE_INSTREAM:a,SLIDER_OUTSTREAM:d,SLIDER_INSTREAM:c,"300X600":h,EXPANDABLE:p,WIDGET_ITEM:f,FEED_MANAGER:g,MSN_WIDGET:k,CUSTOM:I},X={unit:void 0,model:void 0,placement:void 0,isUnitPlay:!1};v.parseBool(e.isStartUnitOnWindowLoaded)?("complete"===document.readyState&&U(),document.onreadystatechange=function(){"complete"===document.readyState&&setTimeout(U,0)}):b("document").ready(U)},e.exports=window.cmTag},,,,,function(e,t,i){!function(t,i){e.exports=i()}(window,function(){return function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}({"./index.js":function(e,t,i){"use strict";var n=i("./options.js"),o=i("./utils.js"),s=function(e,t){if("trc"===n.mcrsrvcsnmspc)try{return window.TRC[e][t]}catch(e){}if("cmTag"===n.mcrsrvcsnmspc)try{return window.cmTag.config.ms[e][t]}catch(e){}return null};e.exports={get:function(e,t,i,r){e=o.cleanServiceName(e),t=t||function(e){return n.serviceDefaultVersion[e]}(e);var a=s(e,t);if(a)i&&i(a);else{var l=document.createElement("script"),d=o.setUrlPrefix(n.base_url);l.async=n.async,l.type="text/javascript",l.src=d+(/.*\/$/g.test(d)?"":"/")+e+"/"+t+"/"+e+".js",l.onload=function(){document.head.removeChild(l);try{i&&i(s(e,t))}catch(e){r&&r()}},l.onerror=function(){document.head.removeChild(l),r&&r()},document.head.appendChild(l)}},init:function(e){for(var t in n)e.hasOwnProperty(t)&&(n[t]=e[t])}}},"./options.js":function(e,t,i){"use strict";e.exports={base_url:"//vidstat.taboola.com/",async:!0,mcrsrvcsnmspc:"trc",serviceDefaultVersion:{oppsula:"1.0.1"}}},"./utils.js":function(e,t,i){"use strict";e.exports={setUrlPrefix:function(e){return"string"!=typeof e?e:(0!==(e=e.replace(/^(http[s]?:|ftp:)/g,"")).indexOf("//")&&(e="//"+e),e)},cleanServiceName:function(e){return e.replace(/.js$/,"")}}},0:function(e,t,i){e.exports=i("./index.js")}})})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.viewability=t.DebugData=t.OrganicCardInjector=t.PlayPriorityHandler=t.CompetitionDetector=t.RvHandler=t.PreEligibility=t.PublisherVideoDetector=t.GDPRManager=t.ObserverService=t.OppsulaManager=t.TabStatus=t.PlayerSubUnitMSN=t.PlayerSubUnit=t.CardLocator=t.AdsManager=t.PlayerLoader=t.FeedEligibility=t.SubFeedEligibility=t.Eligibility=t.Player=t.Pixels=t.Kibana=t.Timer=t.Seer=t.Ad=void 0;var o=i(7),s=n(o),r=i(39),a=n(r),l=i(63),d=n(l),c=i(64),u=n(c),h=i(66),p=n(h),f=i(67),m=n(f),g=i(70),v=n(g),y=i(72),b=n(y),_=i(73),w=n(_),T=i(75),A=n(T),S=i(76),P=n(S),C=i(77),E=n(C),k=i(78),I=n(k),O=i(79),V=n(O),x=i(81),D=n(x),M=i(83),R=n(M),N=i(82),L=n(N),F=i(84),B=n(F),j=i(85),U=n(j),H=i(86),W=n(H),z=i(87),$=n(z),G=i(88),q=n(G),Y=i(80),K=n(Y),Q=i(89),X=n(Q),J=i(27),Z=n(J),ee=i(90),te=n(ee);t.Ad=s.default,t.Seer=a.default,t.Timer=d.default,t.Kibana=u.default,t.Pixels=p.default,t.Player=m.default,t.Eligibility=w.default,t.SubFeedEligibility=A.default,t.FeedEligibility=E.default,t.PlayerLoader=I.default,t.AdsManager=V.default,t.CardLocator=D.default,t.PlayerSubUnit=v.default,t.PlayerSubUnitMSN=b.default,t.TabStatus=R.default,t.OppsulaManager=W.default,t.ObserverService=L.default,t.GDPRManager=B.default,t.PublisherVideoDetector=$.default,t.PreEligibility=P.default,t.RvHandler=U.default,t.CompetitionDetector=q.default,t.PlayPriorityHandler=K.default,t.OrganicCardInjector=X.default,t.DebugData=Z.default,t.viewability=te.default},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(10),h=o(u),p=i(11),f=o(p),m=i(12),g=i(16),v=o(g),y=i(21),b=n(y),_=i(22),w=o(_),T=i(23),A=o(T),S=i(25),P=n(S),C=i(26),E=o(C),k=i(28),I=o(k),O=function(e){function t(e){var i=e.model,n=e.ppKey,o=e.adId,a=e.impressionCb,l=e.completeCb,d=e.kibana,c=e.predictName,u=e.getAdProperties;s(this,t);var h=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i));return h.model=i,h._handleKibana(d),h.getAdKey=isNaN(parseInt(n))?n:parseInt(n),h.adId=o,h.impressionCb=a,h.completeCb=l,h.predictName=c,h.scrollManager=new E.default,h.getAdProperties=u||{},h.log=new v.default({unitType:h.model.get("unitType"),className:"adService",version:h.model.get("version"),isDebug:h.model.get("isDebug")}),h.adState=b.readyState,h.getAdState=b.getAdState.notCalled,h.adQState=b.adQState.readyState,h.hadPlay=!1,h.isActive=!1,h.hadImpression=!1,h.sizeObj={},h.adClickCounter=1,h._bindEvents(),h._onPlayerStateReady(),h._getAd(),h}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adManagerState:paused",funcName:"_pauseGetAd",isListenOnce:!0},{event:"adManagerState:stopped",funcName:"_stopGetAd",isListenOnce:!0},{event:"playerState:ready",funcName:"_onPlayerStateReady",isListenOnce:!0},{event:"adViewabilityFired:true",funcName:"adViewabilityFired",isListenOnce:!0},{event:"adConversionFired:true",funcName:"adConversionFired",isListenOnce:!0}])}},{key:"_onPlayerStateReady",value:function(){!this.player&&w.default.player&&(this.player=w.default.player)}},{key:"_pauseGetAd",value:function(){this.cancelGetAd(),this.getAdState=b.getAdState.stopped,this.setToModel("getAdState",b.getAdState.stopped),this.model.get("isReplayAd")||(this.player=void 0)}},{key:"_stopGetAd",value:function(){this.cancelGetAd(),this.getAdState=b.getAdState.finished,this.player=void 0}},{key:"adViewabilityFired",value:function(){if(this._hasVpaidWrapper()&&this.vpaidWrapper.emit){this.vpaidWrapper.emit("unit::viewability");var e=this.vpaidWrapper.getVpaidData(),t=e&&e.eventTrackers&&e.eventTrackers.viewability;c.default.each(t,this._sendPixel,this)}this.isViewabilityFired=!0}},{key:"adConversionFired",value:function(){this._hasVpaidWrapper()&&this.vpaidWrapper.emit&&this.vpaidWrapper.emit("unit::conversion")}},{key:"_getAd",value:function(){return this._hasPlayer()&&this.player.getAd?this.getAdState===b.getAdState.gettingAd?void this.log.info("[adID=${trimmedBranch}]getAd was called while trying to get an ad from player",this.adId):(this.log.info("GetAd was called, requiredViewability: "+this.getAdKey),this.getAdPPS=this.scrollManager.pps,this.getAdPPSChange=this.scrollManager.ppsChange,this.setToModel("lastGetAdKey",this.getAdKey),this.model.get("getAdState")===b.getAdState.gettingAd?this.model.trigger("change:getAdState",this.model,this.model.get("getAdState")):this.setToModel("getAdState",b.getAdState.gettingAd),this.getAdState=b.getAdState.gettingAd,"any"===this.getAdKey?this.getAdResult=this.player.getAd({getAdTimeout:this._getTimeOut(),adProperties:this.getAdProperties.adProperties,excAdProperties:this.getAdProperties.excAdProperties}):this.getAdResult=this.player.getAd({requiredViewability:this.getAdKey,getAdTimeout:this._getTimeOut(),adProperties:this.getAdProperties.adProperties,excAdProperties:this.getAdProperties.excAdProperties}),this._sendEventToKibana(this.kibanaEvents.getAd,{getAdKey:this.getAdKey,predictName:this.predictName}),void(this.getAdResult?this.getAdResult.then(this._getAdResult.bind(this)).catch(this._getAdCatch.bind(this)):this.log.error("getAd Failed in auction  manager"))):(this.setToModel("getAdCurrId",this.adId),void setTimeout(this.setToModel.bind(this,"getAdState",b.getAdState.failed),0))}},{key:"_getAdResult",value:function(e){try{this.vpaidWrapper=e,this._setAdTypeConfig(),this.rpox=e.tag.rpox,this.adData=c.default.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon","requiredViewability","rpox"]),this.adData.cpm=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.vastPrice?this.vpaidWrapper.tag.vpaidWrapperData.vastPrice:this.vpaidWrapper.tag.price,this.adData.requiredViewability=c.default.parseBool(this.adData.requiredViewability),this.adData.getAdPPS=this.getAdPPS,this.adData.getAdPPSChange=this.getAdPPSChange,this.vpaidWrapper.playerDAST&&this.vpaidWrapper.playerDAST.get&&(this.adData.pdast=this.vpaidWrapper.playerDAST.get()),this._setDebugReportDataOnGotAd(),this.vpaidWrapper.vpaidLog.data.unit_history=[],this.reportToVpaid("gotAd",{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime"),predictName:this.predictName,getAdKey:"any"===this.getAdKey?10:this.getAdKey},!1),this.adData&&(w.default.supportTool.dp[this.adId]=this.adData.dp),this.setToModel("lastGotAdData",this.adData),this.model.get("lastImpressionData.sequenceId")?this.sequenceId=this.model.get("lastImpressionData.sequenceId")+1:this.sequenceId=1;var t=void 0;return this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(t=this.vpaidWrapper.vpaidLog.data._id),this.lastImpressionData={predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag.requiredViewability,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag.dp,tagData:c.default.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:t,lineItemId:this.vpaidWrapper.tag.lineItemId,predictName:this.predictName},this.setToModel("lastImpressionData",this.lastImpressionData),this._sendEventToKibana(this.kibanaEvents.gotAd,this.lastImpressionData),this.setToModel("impressionCount",this.model.get("impressionCount")+1),this.oppsService=new A.default({model:this.model,adData:this.adData,reportFunc:this.reportToVpaid.bind(this),getAdDataFunc:this.getAdData.bind(this),setDebugData:this.vpaidWrapper.setDebugData.bind(this.vpaidWrapper)}),this.log.info("GotAd requiredViewability: "+(e.tag.requiredViewability?1:0)),this.getAdState=b.getAdState.gotAd,this.setToModel("getAdState",b.getAdState.gotAd),this.getAdResult=void 0,this._registerListeners(),this._onAdImpression(e),this._setAdRV(),null}catch(e){this.log.error(e)}}},{key:"_getAdCatch",value:function(e){this.hadImpression||(this.getAdResult=void 0,this.log.info("GetAd failed requiredViewability: "+this.getAdKey,this.adId),this.getAdState=b.getAdState.failed,this.setToModel("getAdCurrId",this.adId),this.setToModel("getAdState",b.getAdState.failed))}},{key:"_registerListeners",value:function(){this.vpaidWrapper.on&&(this.vpaidWrapper.on("AdError",this._onAdError.bind(this)),this.vpaidWrapper.on("AdVideoFirstQuartile",this._onAdVideoFirstQuartile.bind(this)),this.vpaidWrapper.on("AdVideoMidpoint",this._onAdVideoMidpoint.bind(this)),this.vpaidWrapper.on("AdVideoThirdQuartile",this._onAdVideoThirdQuartile.bind(this)),this.vpaidWrapper.on("end",this._adVideoEnd.bind(this)),this.vpaidWrapper.on("AdClickThru",this._onAdClickThru.bind(this)),this.vpaidWrapper.on("activeAdCurrentTime",this._onActiveAdCurrentTime.bind(this)))}},{key:"_onActiveAdCurrentTime",value:function(e){this.isCompleted||(this.setToModel("activeAdCurrentTime",e.currentTime),this.setToModel("activeAdMaxTime",e.duration))}},{key:"_onAdImpression",value:function(e){this.vpaidWrapper.pauseAd(),this._sendEventToKibana(this.kibanaEvents.adPaused,{pauseReason:"pauseOnAdImpression"}),this.reportToVpaid("pauseAdCalled",{reason:"pauseOnAdImpression",tab:this.model.get("isInTab")},!1),this._bringToBack(),this.log.info("onAdImpression (got ad - pausing ad)",this.adId),this.hadImpression=!0,this.rpox=e.tag.rpox,this.adQState=b.adQState.impression;var t={lineItemId:this.model.get("lineItemId"),placement:this.model.get("placement"),redId:this.model.get("redId")};this.model.get("isSendCPM")&&(t.cpm=this.adData.cpm),f.default.trigger("onImpression",t),this.model.get("adQState")===b.adQState.impression?setTimeout(this.model.trigger.bind(this.model,"change:adQState",this.adQState),0):setTimeout(this.setToModel.bind(this,"adQState",this.adQState),0),this.impressionCb(this)}},{key:"_onAdError",value:function(e){this.log.error("Vpaid Wrapper Error, key: "+this.getAdKey,this.adId)}},{key:"_onAdVideoFirstQuartile",value:function(){this.hadPlay&&(this.adQState=b.adQState.q1,this.setToModel("adQState",b.adQState.q1,this.adId),this.log.info("AdVideoFirstQuartile"))}},{key:"_onAdVideoMidpoint",value:function(){this.hadPlay&&(this.adQState=b.adQState.q2,this.setToModel("adQState",b.adQState.q2,this.adId),this.log.info("AdVideoMidpoint"))}},{key:"_onAdVideoThirdQuartile",value:function(){this.hadPlay&&(this.adQState=b.adQState.q3,this.setToModel("adQState",b.adQState.q3,this.adId),this.log.info("AdVideoThirdQuartile"))}},{key:"_adVideoEnd",value:function(){if(this.player){var e=this.subModel||this.model;if(e.stopListening(e,"change:nativeAdClick"),this._setAdPlayingWithAdChoice(!1),this.log.info("on ad video end",this.adId),this.reportToVpaid("vpaidDone",{tab:this.model.get("isInTab")},!0),this.isCompleted=!0,!this.hadPlay)return this.adState=b.adState.autoKill,void this.completeCb(this,!0);this._sendEventToKibana(this.kibanaEvents.adComplete),this.setToModel("activeTag",void 0),this.adQState=b.adQState.completed,this.adState=b.adState.completed,this.completeCb(this,!1),this.setToModel("adQState",this.adQState),this.setToModel("adState",this.adState),this.model.get("isReplayAd")||(this.vpaidWrapper=void 0),this.getAdState=b.getAdState.stopped,w.default.supportTool.dp[this.adId]=void 0,delete w.default.supportTool.dp[this.adId]}}},{key:"_onAdClickThru",value:function(){1===this.adClickCounter?(this.setToModel("clickThruState",b.clickThruState.clicked),this.oppsService.onAdClicked(),this.reportToVpaid("firstAdClick",{number:this.adClickCounter},!1)):this.reportToVpaid("falseAdClick",{number:this.adClickCounter},!1),this.adClickCounter++}},{key:"_onTitleContainerClick",value:function(){if(this._hasVpaidWrapper()){var e=this.vpaidWrapper.getVpaidData(),t=this.subModel.get("adNativeSettings"),i=t.link||e.vastClickThruLink;i&&this._clickThru(i);var n=this.subModel.get("nativeAdClick");this.oppsService.fireTitleContaineClick(n),this._onAdClickThru()}}},{key:"_clickThru",value:function(e){if(this.model.get("isInApp")&&window.taboolaMobile&&window.tbNativeBridge){var t=window.tbNativeBridge;if(t.invoke)return void t.invoke("onClick",["",e,e,!1,"0","video"])}window.open(e)}},{key:"_bringToFront",value:function(){if(this.vpaidWrapper.localTarget){var e=this.model.get("style.videoBackgroundColor");(0,h.default)(this.vpaidWrapper.localTarget).css({zIndex:1e3,display:"block",height:this.model.get("height")+"px",backgroundColor:e})}}},{key:"_bringToBack",value:function(){this.vpaidWrapper.localTarget&&(0,h.default)(this.vpaidWrapper.localTarget).css({zIndex:0})}},{key:"_hasVpaidWrapper",value:function(){return this._hasPlayer()&&this.vpaidWrapper}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"setActiveTag",value:function(){this.log.info("setActiveTag",this.adId);var e=c.default.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]);this.model.get("activeTag")!==e&&this.setToModel("activeTag",e)}},{key:"getAdData",value:function(){if(this.vpaidWrapper){var e=void 0;this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(e=this.vpaidWrapper.vpaidLog.data._id);var t={adId:this.adId,predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag?c.default.parseBool(this.vpaidWrapper.tag.requiredViewability):void 0,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag?this.vpaidWrapper.tag.dp:void 0,rpox:this.rpox,isCompleted:this.isCompleted,tagData:c.default.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:e};return this._setSubUnitData(t),t}}},{key:"isPWOV",value:function(){return!(!this.vpaidWrapper||!this.vpaidWrapper.pwov)&&(this.model.get("isPWOV")&&c.default.isFactor(100/this.vpaidWrapper.pwov))}},{key:"pause",value:function(){return(this.model.get("isInTab")&&"continueAd"===this.model.get("onOutOfView")||this.isPWOV())&&this.isViewabilityFired?(this.log.info("onOutOfView continueAd",this.adId),this.setToModel("adState",b.adState.continueAd),this.oppsService.fireContinueAd(),void this._sendEventToKibana(this.kibanaEvents.continueAd)):(this._hasVpaidWrapper()&&(this.log.info("Pause ad",this.adId),this.vpaidWrapper.pauseAd(),this.oppsService.onFirstPauseAfterPlay(),this._sendEventToKibana(this.kibanaEvents.adPaused,{pauseReason:"outOfView"}),this.reportToVpaid("pauseAdCalled",{reason:"outOfView",tab:this.model.get("isInTab")},!1)),void this.setToModel("adState",b.adState.paused))}},{key:"play",value:function(){this.model.set("lastActiveAd",this.adId),this.log.info("playing ad",this.adId);var e=this.getAdData();this.setToModel("activeAdData",e),this._updateAdChoiceVisibility(),this._keepReplayableAdAlive(),this.hadPlay||(this.hadPlay=!0,this.log.info("Winning ad: "+this.getAdKey,this.adId),this.model.get("isMultiActiveAds")||(this._bringToFront(this.vpaidWrapper),(0,h.default)(this.vpaidWrapper.adTarget).removeClass("_cm-ad")),this.setActiveTag(),this.adQState=b.adQState.q0,this.setToModel("adQState",b.adQState.q0),this._setDebugReportDataOnConversion(e),this.oppsService.onConversion(),this.adConversionFired(),this.setAdParametersToModel(),setTimeout(this._fireTwoSecAfterPlay.bind(this),2e3)),this._hasVpaidWrapper()?(this.log.info("resumeAd VpaidWrapper is alive ",this.adId),this.vpaidWrapper.resumeAd(),this.model.set("hadPlayedAd",!0),this.reportToVpaid("resumeAdCalled",{tab:this.model.get("isInTab")},!1),this._sendEventToKibana(this.kibanaEvents.adPlay)):this.log.warning("resumeAd failed VpaidWrapper is NOT alive ",this.adId),setTimeout(this._firePlayEvents.bind(this),0)}},{key:"_firePlayEvents",value:function(){this.setToModel("adState",b.adState.playing),f.default.trigger("global:adState:playing")}},{key:"_fireTwoSecAfterPlay",value:function(){this.oppsService.onTwoSecAfterPlay()}},{key:"cancelGetAd",value:function(){this.getAdResult&&(this.log.info("GetAd was cancelled",this.adId),this.getAdResult.cancel(),this.getAdResult=void 0)}},{key:"setToModel",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model.set(e,t,i),this.subModel&&this.subModel.set(e,t,i)}},{key:"setSubModel",value:function(e){this.subModel=e,this.oppsService&&this.oppsService.setSubModel(this.subModel)}},{key:"resize",value:function(e){return e&&e.width&&e.height?void(this.sizeObj.width===e.width&&this.sizeObj.height===e.height||(this.sizeObj.width=e.width,this.sizeObj.height=e.height,this.log.info("resizing ad",h.default.extend({},e,{adId:this.adId,aspectRatio:this.aspectRatioString})),this.vpaidWrapper.resizeAd(e.width,e.height,this.aspectRatioString))):void this.log.warning("resize was called with empty sizeObj!",e)}},{key:"recheckSize",value:function(){var e=this.sizeObj;this.sizeObj={},this.resize(e)}},{key:"mute",value:function(){this.vpaidWrapper&&(this.log.info("Mute Player"),this.vpaidWrapper.mute())}},{key:"unmute",value:function(){this.vpaidWrapper&&(this.log.info("UnMute Player"),this.vpaidWrapper.unmute(),this.oppsService.fireAdUnmuted())}},{key:"fireSkipVimp1EligibilityLost",value:function(){this.oppsService.fireSkipVimp1EligibilityLost()}},{key:"fireSkipVimp1Vimp0Playing",value:function(){this.oppsService.fireSkipVimp1Vimp0Playing()}},{key:"onViewability",value:function(){this.isViewed||(this.isViewed=!0,this.adViewabilityFired(),this.oppsService.onViewability(),this._sendEventToKibana(this.kibanaEvents.viewability))}},{key:"onViewabilityOneS",value:function(){this.isViewedOneS||(this.isViewedOneS=!0,this.oppsService.onViewabilityOneS())}},{key:"onViewability100",value:function(){this.isViewed100||(this.isViewed100=!0,this.oppsService.onViewability100())}},{key:"onDetached",value:function(){this.isDetached||(this.isDetached=!0,this.oppsService.onAdDetached())}},{key:"onAttached",value:function(){this.isDetached&&(this.isDetached=!1,this.oppsService.onAdAttached())}},{key:"onSliderClose",value:function(){this.isSliderClosed||(this.isSliderClosed=!0,this.oppsService.onAdSliderClosed())}},{key:"reportToVpaid",value:function(e,t,i){this._setSubUnitData(t),this._hasVpaidWrapper()&&this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.push&&(this.vpaidWrapper.vpaidLog.push("unit_"+e,t,!1),this.vpaidWrapper.vpaidLog.data.unit_history.push(e),this.vpaidWrapper.vpaidLog.data.statuses.push(e),i&&this.vpaidWrapper.vpaidLog.push("unit_state",{status:e},i))}},{key:"fireSkipVimp1EligibilityLost",value:function(e){this.oppsService.fireSkipVimp1EligibilityLost(e)}},{key:"fireSkipVimp1Vimp0Playing",value:function(e){this.oppsService.fireSkipVimp1Vimp0Playing(e)}},{key:"reportRpoxSkip",value:function(e){this.reportToVpaid("skipRpox",{otherRpox:e.rpox,otherRequiredViewability:e.requiredViewability,otherAdDp:e.dp,otherSequenceId:e.sequenceId},!1)}},{key:"reportPpKeySkip",value:function(e){this.reportToVpaid("skipPpKey",{otherRpox:e.rpox,otherRequiredViewability:e.requiredViewability,otherAdDp:e.dp,otherSequenceId:e.sequenceId},!1)}},{key:"_setAdPlayingWithAdChoice",value:function(e){this.setToModel("adPlayingWithAdChoice",e)}},{key:"_updateAdChoiceVisibility",value:function(){this.vpaidWrapper.hasAdChoices?this._setAdPlayingWithAdChoice(!0):this._setAdPlayingWithAdChoice(!1)}},{key:"_setSubUnitData",value:function(e){var t=this.model.get("subUnitType");if(this.model&&(t||0===t)&&(e.su=t),!this.subModel)return void(this.model.get("MSNCard.row")&&(e.sp=this.model.get("MSNCard.row")));var i=this.model.get("detachToSlider"),n=this.subModel.get("gotFirstEligibility");i&&i.isStartFromSlider&&i.isDetachToSlider?n?e.sp=this.subModel.get("cardNumber"):e.sp=0:i&&i.isStartFromSlider&&!this.subModel.get("isEligibleToPlay")?e.sp=0:this.subModel.get("cardNumber")&&(e.sp=this.subModel.get("cardNumber"))}},{key:"_handleKibana",value:function(e){this.kibanaEvents=P.KIBANA_EVENTS,e&&(this.kibana=e)}},{key:"_sendEventToKibana",value:function(e,t){this.kibana&&(t=t||{},t.adId=this.adId,this.subModel&&this.subModel.get("cardNumber")&&(t.cardNumber=this.subModel.get("cardNumber")),this.kibana.adEvent(e,t))}},{key:"onCardSwap",value:function(){this.oppsService.fireContinueAdInAnotherCard()}},{key:"onShouldCardSwap",value:function(){this.oppsService.fireShouldContinueAdInAnotherCard()}},{key:"onLearnMoreClick",value:function(){this.oppsService.fireLearnMoreClick()}},{key:"_setDebugReportDataOnGotAd",value:function(){this.model.increaseCounter("sqv"),this.adData.requiredViewability?this.model.increaseCounter("rvvs1"):this.model.increaseCounter("rvvs0"),this.adData.pn=this.predictName,this.adData.adId=this.adId}},{key:"_setDebugReportDataOnConversion",value:function(){this.model.increaseCounter("conversionCount"),this.adData.requiredViewability?this.model.increaseCounter("rvps1"):this.model.increaseCounter("rvps0")}},{key:"_setAdRV",value:function(){this.adData.requiredViewability?this.setToModel("gotRvAd",!0):this.setToModel("gotNonRvAd",!0)}},{key:"_getTimeOut",value:function(){var e=this.model.get("vForce.secondsToGetAdFail."+this.getAdKey);return e}},{key:"_setAdTypeConfig",value:function(){if(this.vpaidWrapper&&this.vpaidWrapper.getVpaidData){var e=this.vpaidWrapper.getVpaidData();this.adTypeTranslator=new I.default({model:this.subModel||this.model}),this.adTypeConfig={};for(var t in e)if(e[t]){var i=this.adTypeTranslator.getConfigForKey(t);if(c.default.isEmpty(i))continue;if(this.log.info("got adTypeConfig for key "+t,i),i.revertAfter){var n=this._createRevertAdType(i,t);this._setAdTypeConfigAfter(i.revertAfter,n)}i.setAdConfigAfter?this._setAdTypeConfigAfter(i.setAdConfigAfter,i):this.setToModel(i),this.adTypeConfig[t]=i}this.aspectRatioNum=this.getAspectRatioNum(e),this.log.info("Ad size received is - width: "+e.adWidth+"; height: "+e.adHeight),this._setAdTypeConfigAfter("setSubModel",{aspectRatioNum:this.aspectRatioNum}),this.supportVideoCurrentTimeEvents=e.supportVideoCurrentTimeEvents}}},{key:"_setAdTypeConfigAfter",value:function(e,t){var i=this[e];c.default.isFunction(i)&&(this[e]=function(){i.apply(this,arguments),this.setToModel(t),this.log.info("setting ad type config after "+i.name+" function",t)})}},{key:"_createRevertAdType",value:function(e,t){var i={};for(var n in e)"setAdConfigAfter"!==n&&"revertAfter"!==n&&(i[n]=this.model.get(n));return i}},{key:"onAdSetToUnits",value:function(){}},{key:"_keepReplayableAdAlive",value:function(){var e=this.vpaidWrapper;e.dontDie&&this.model.get("isReplayAd")&&(e.isReplayable||this.model.get("isForceDontDie"))&&(e.dontDie(),this.model.set("dontRenderRepeatButton",!e.isReplayable))}},{key:"setAdParametersToModel",value:function(){if(this.model.get("components.nativeAd.isActive")){var e=this.vpaidWrapper.getVpaidData(),t=e.adNativeSettings||{},i=this.subModel||this.model;e.adNativeSettings&&this.model.set("continueToPlayInNexCard.isActive",!1),this.setNativeAdClickListener(),this.setToModel("adNativeSettings",void 0,{silent:!0}),this.setToModel("adNativeSettings",t,{silent:!0}),i.trigger("change:adNativeSettings",i,i.get("adNativeSettings"))}this.vpaidWrapper.clickThruUrl?(this.log.info("updated click through URL",this.vpaidWrapper.clickThruUrl),this.setToModel("adClickThroughUrl",this.vpaidWrapper.clickThruUrl)):this.setToModel("adClickThroughUrl",""),this.setToModel("activeAdRV",this.adData.requiredViewability)}},{key:"setNativeAdClickListener",value:function(){var e=this.subModel||this.model;e.listenTo(e,"change:nativeAdClick",this._onTitleContainerClick.bind(this))}},{key:"_sendPixel",value:function(e){"img"===e.method?(new Image).src=e.pixel:"js"===e.method&&this._sendJSPixel(e.pixel)}},{key:"_sendJSPixel",value:function(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.async=!0,document.body.appendChild(t)}},{key:"getAspectRatioNum",value:function(e){return e&&e.supportVerticalVideo?(this.aspectRatioString=e.adWidth.toString()+":"+e.adHeight.toString(),e.adWidth/e.adHeight):this.aspectRatioNum?this.aspectRatioNum:(this.aspectRatioString="16:9",this.model.get("defaultAspectRatioNum"))}},{key:"onadProgressionAfterBeginPredict",value:function(){this.oppsService.adProgressionAfterBeginPredict()}},{key:"onadProgressionBeforeEndPredictPredict",value:function(){this.oppsService.adProgressionBeforeEndPredict();
}}]),t}(m.StateManager);e.exports=O},function(e,t,i){var n,o;(function(e,i){!function(){var s="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||this||{},r=s._,a=Array.prototype,l=Object.prototype,d="undefined"!=typeof Symbol?Symbol.prototype:null,c=a.push,u=a.slice,h=l.toString,p=l.hasOwnProperty,f=Array.isArray,m=Object.keys,g=Object.create,v=function(){},y=function(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)};"undefined"==typeof t||t.nodeType?s._=y:("undefined"!=typeof i&&!i.nodeType&&i.exports&&(t=i.exports=y),t._=y),y.VERSION="1.9.1";var b,_=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 3:return function(i,n,o){return e.call(t,i,n,o)};case 4:return function(i,n,o,s){return e.call(t,i,n,o,s)}}return function(){return e.apply(t,arguments)}},w=function(e,t,i){return y.iteratee!==b?y.iteratee(e,t):null==e?y.identity:y.isFunction(e)?_(e,t,i):y.isObject(e)&&!y.isArray(e)?y.matcher(e):y.property(e)};y.iteratee=b=function(e,t){return w(e,t,1/0)};var T=function(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var s=Array(t+1);for(o=0;o<t;o++)s[o]=arguments[o];return s[t]=n,e.apply(this,s)}},A=function(e){if(!y.isObject(e))return{};if(g)return g(e);v.prototype=e;var t=new v;return v.prototype=null,t},S=function(e){return function(t){return null==t?void 0:t[e]}},P=function(e,t){return null!=e&&p.call(e,t)},C=function(e,t){for(var i=t.length,n=0;n<i;n++){if(null==e)return;e=e[t[n]]}return i?e:void 0},E=Math.pow(2,53)-1,k=S("length"),I=function(e){var t=k(e);return"number"==typeof t&&t>=0&&t<=E};y.each=y.forEach=function(e,t,i){t=_(t,i);var n,o;if(I(e))for(n=0,o=e.length;n<o;n++)t(e[n],n,e);else{var s=y.keys(e);for(n=0,o=s.length;n<o;n++)t(e[s[n]],s[n],e)}return e},y.map=y.collect=function(e,t,i){t=w(t,i);for(var n=!I(e)&&y.keys(e),o=(n||e).length,s=Array(o),r=0;r<o;r++){var a=n?n[r]:r;s[r]=t(e[a],a,e)}return s};var O=function(e){var t=function(t,i,n,o){var s=!I(t)&&y.keys(t),r=(s||t).length,a=e>0?0:r-1;for(o||(n=t[s?s[a]:a],a+=e);a>=0&&a<r;a+=e){var l=s?s[a]:a;n=i(n,t[l],l,t)}return n};return function(e,i,n,o){var s=arguments.length>=3;return t(e,_(i,o,4),n,s)}};y.reduce=y.foldl=y.inject=O(1),y.reduceRight=y.foldr=O(-1),y.find=y.detect=function(e,t,i){var n=I(e)?y.findIndex:y.findKey,o=n(e,t,i);if(void 0!==o&&o!==-1)return e[o]},y.filter=y.select=function(e,t,i){var n=[];return t=w(t,i),y.each(e,function(e,i,o){t(e,i,o)&&n.push(e)}),n},y.reject=function(e,t,i){return y.filter(e,y.negate(w(t)),i)},y.every=y.all=function(e,t,i){t=w(t,i);for(var n=!I(e)&&y.keys(e),o=(n||e).length,s=0;s<o;s++){var r=n?n[s]:s;if(!t(e[r],r,e))return!1}return!0},y.some=y.any=function(e,t,i){t=w(t,i);for(var n=!I(e)&&y.keys(e),o=(n||e).length,s=0;s<o;s++){var r=n?n[s]:s;if(t(e[r],r,e))return!0}return!1},y.contains=y.includes=y.include=function(e,t,i,n){return I(e)||(e=y.values(e)),("number"!=typeof i||n)&&(i=0),y.indexOf(e,t,i)>=0},y.invoke=T(function(e,t,i){var n,o;return y.isFunction(t)?o=t:y.isArray(t)&&(n=t.slice(0,-1),t=t[t.length-1]),y.map(e,function(e){var s=o;if(!s){if(n&&n.length&&(e=C(e,n)),null==e)return;s=e[t]}return null==s?s:s.apply(e,i)})}),y.pluck=function(e,t){return y.map(e,y.property(t))},y.where=function(e,t){return y.filter(e,y.matcher(t))},y.findWhere=function(e,t){return y.find(e,y.matcher(t))},y.max=function(e,t,i){var n,o,s=-(1/0),r=-(1/0);if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e){e=I(e)?e:y.values(e);for(var a=0,l=e.length;a<l;a++)n=e[a],null!=n&&n>s&&(s=n)}else t=w(t,i),y.each(e,function(e,i,n){o=t(e,i,n),(o>r||o===-(1/0)&&s===-(1/0))&&(s=e,r=o)});return s},y.min=function(e,t,i){var n,o,s=1/0,r=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e){e=I(e)?e:y.values(e);for(var a=0,l=e.length;a<l;a++)n=e[a],null!=n&&n<s&&(s=n)}else t=w(t,i),y.each(e,function(e,i,n){o=t(e,i,n),(o<r||o===1/0&&s===1/0)&&(s=e,r=o)});return s},y.shuffle=function(e){return y.sample(e,1/0)},y.sample=function(e,t,i){if(null==t||i)return I(e)||(e=y.values(e)),e[y.random(e.length-1)];var n=I(e)?y.clone(e):y.values(e),o=k(n);t=Math.max(Math.min(t,o),0);for(var s=o-1,r=0;r<t;r++){var a=y.random(r,s),l=n[r];n[r]=n[a],n[a]=l}return n.slice(0,t)},y.sortBy=function(e,t,i){var n=0;return t=w(t,i),y.pluck(y.map(e,function(e,i,o){return{value:e,index:n++,criteria:t(e,i,o)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index}),"value")};var V=function(e,t){return function(i,n,o){var s=t?[[],[]]:{};return n=w(n,o),y.each(i,function(t,o){var r=n(t,o,i);e(s,t,r)}),s}};y.groupBy=V(function(e,t,i){P(e,i)?e[i].push(t):e[i]=[t]}),y.indexBy=V(function(e,t,i){e[i]=t}),y.countBy=V(function(e,t,i){P(e,i)?e[i]++:e[i]=1});var x=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(e){return e?y.isArray(e)?u.call(e):y.isString(e)?e.match(x):I(e)?y.map(e,y.identity):y.values(e):[]},y.size=function(e){return null==e?0:I(e)?e.length:y.keys(e).length},y.partition=V(function(e,t,i){e[i?0:1].push(t)},!0),y.first=y.head=y.take=function(e,t,i){return null==e||e.length<1?null==t?void 0:[]:null==t||i?e[0]:y.initial(e,e.length-t)},y.initial=function(e,t,i){return u.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},y.last=function(e,t,i){return null==e||e.length<1?null==t?void 0:[]:null==t||i?e[e.length-1]:y.rest(e,Math.max(0,e.length-t))},y.rest=y.tail=y.drop=function(e,t,i){return u.call(e,null==t||i?1:t)},y.compact=function(e){return y.filter(e,Boolean)};var D=function(e,t,i,n){n=n||[];for(var o=n.length,s=0,r=k(e);s<r;s++){var a=e[s];if(I(a)&&(y.isArray(a)||y.isArguments(a)))if(t)for(var l=0,d=a.length;l<d;)n[o++]=a[l++];else D(a,t,i,n),o=n.length;else i||(n[o++]=a)}return n};y.flatten=function(e,t){return D(e,t,!1)},y.without=T(function(e,t){return y.difference(e,t)}),y.uniq=y.unique=function(e,t,i,n){y.isBoolean(t)||(n=i,i=t,t=!1),null!=i&&(i=w(i,n));for(var o=[],s=[],r=0,a=k(e);r<a;r++){var l=e[r],d=i?i(l,r,e):l;t&&!i?(r&&s===d||o.push(l),s=d):i?y.contains(s,d)||(s.push(d),o.push(l)):y.contains(o,l)||o.push(l)}return o},y.union=T(function(e){return y.uniq(D(e,!0,!0))}),y.intersection=function(e){for(var t=[],i=arguments.length,n=0,o=k(e);n<o;n++){var s=e[n];if(!y.contains(t,s)){var r;for(r=1;r<i&&y.contains(arguments[r],s);r++);r===i&&t.push(s)}}return t},y.difference=T(function(e,t){return t=D(t,!0,!0),y.filter(e,function(e){return!y.contains(t,e)})}),y.unzip=function(e){for(var t=e&&y.max(e,k).length||0,i=Array(t),n=0;n<t;n++)i[n]=y.pluck(e,n);return i},y.zip=T(y.unzip),y.object=function(e,t){for(var i={},n=0,o=k(e);n<o;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i};var M=function(e){return function(t,i,n){i=w(i,n);for(var o=k(t),s=e>0?0:o-1;s>=0&&s<o;s+=e)if(i(t[s],s,t))return s;return-1}};y.findIndex=M(1),y.findLastIndex=M(-1),y.sortedIndex=function(e,t,i,n){i=w(i,n,1);for(var o=i(t),s=0,r=k(e);s<r;){var a=Math.floor((s+r)/2);i(e[a])<o?s=a+1:r=a}return s};var R=function(e,t,i){return function(n,o,s){var r=0,a=k(n);if("number"==typeof s)e>0?r=s>=0?s:Math.max(s+a,r):a=s>=0?Math.min(s+1,a):s+a+1;else if(i&&s&&a)return s=i(n,o),n[s]===o?s:-1;if(o!==o)return s=t(u.call(n,r,a),y.isNaN),s>=0?s+r:-1;for(s=e>0?r:a-1;s>=0&&s<a;s+=e)if(n[s]===o)return s;return-1}};y.indexOf=R(1,y.findIndex,y.sortedIndex),y.lastIndexOf=R(-1,y.findLastIndex),y.range=function(e,t,i){null==t&&(t=e||0,e=0),i||(i=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/i),0),o=Array(n),s=0;s<n;s++,e+=i)o[s]=e;return o},y.chunk=function(e,t){if(null==t||t<1)return[];for(var i=[],n=0,o=e.length;n<o;)i.push(u.call(e,n,n+=t));return i};var N=function(e,t,i,n,o){if(!(n instanceof t))return e.apply(i,o);var s=A(e.prototype),r=e.apply(s,o);return y.isObject(r)?r:s};y.bind=T(function(e,t,i){if(!y.isFunction(e))throw new TypeError("Bind must be called on a function");var n=T(function(o){return N(e,n,t,this,i.concat(o))});return n}),y.partial=T(function(e,t){var i=y.partial.placeholder,n=function(){for(var o=0,s=t.length,r=Array(s),a=0;a<s;a++)r[a]=t[a]===i?arguments[o++]:t[a];for(;o<arguments.length;)r.push(arguments[o++]);return N(e,n,this,this,r)};return n}),y.partial.placeholder=y,y.bindAll=T(function(e,t){t=D(t,!1,!1);var i=t.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=t[i];e[n]=y.bind(e[n],e)}}),y.memoize=function(e,t){var i=function(n){var o=i.cache,s=""+(t?t.apply(this,arguments):n);return P(o,s)||(o[s]=e.apply(this,arguments)),o[s]};return i.cache={},i},y.delay=T(function(e,t,i){return setTimeout(function(){return e.apply(null,i)},t)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(e,t,i){var n,o,s,r,a=0;i||(i={});var l=function(){a=i.leading===!1?0:y.now(),n=null,r=e.apply(o,s),n||(o=s=null)},d=function(){var d=y.now();a||i.leading!==!1||(a=d);var c=t-(d-a);return o=this,s=arguments,c<=0||c>t?(n&&(clearTimeout(n),n=null),a=d,r=e.apply(o,s),n||(o=s=null)):n||i.trailing===!1||(n=setTimeout(l,c)),r};return d.cancel=function(){clearTimeout(n),a=0,n=o=s=null},d},y.debounce=function(e,t,i){var n,o,s=function(t,i){n=null,i&&(o=e.apply(t,i))},r=T(function(r){if(n&&clearTimeout(n),i){var a=!n;n=setTimeout(s,t),a&&(o=e.apply(this,r))}else n=y.delay(s,t,this,r);return o});return r.cancel=function(){clearTimeout(n),n=null},r},y.wrap=function(e,t){return y.partial(t,e)},y.negate=function(e){return function(){return!e.apply(this,arguments)}},y.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},y.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},y.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}},y.once=y.partial(y.before,2),y.restArguments=T;var L=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],B=function(e,t){var i=F.length,n=e.constructor,o=y.isFunction(n)&&n.prototype||l,s="constructor";for(P(e,s)&&!y.contains(t,s)&&t.push(s);i--;)s=F[i],s in e&&e[s]!==o[s]&&!y.contains(t,s)&&t.push(s)};y.keys=function(e){if(!y.isObject(e))return[];if(m)return m(e);var t=[];for(var i in e)P(e,i)&&t.push(i);return L&&B(e,t),t},y.allKeys=function(e){if(!y.isObject(e))return[];var t=[];for(var i in e)t.push(i);return L&&B(e,t),t},y.values=function(e){for(var t=y.keys(e),i=t.length,n=Array(i),o=0;o<i;o++)n[o]=e[t[o]];return n},y.mapObject=function(e,t,i){t=w(t,i);for(var n=y.keys(e),o=n.length,s={},r=0;r<o;r++){var a=n[r];s[a]=t(e[a],a,e)}return s},y.pairs=function(e){for(var t=y.keys(e),i=t.length,n=Array(i),o=0;o<i;o++)n[o]=[t[o],e[t[o]]];return n},y.invert=function(e){for(var t={},i=y.keys(e),n=0,o=i.length;n<o;n++)t[e[i[n]]]=i[n];return t},y.functions=y.methods=function(e){var t=[];for(var i in e)y.isFunction(e[i])&&t.push(i);return t.sort()};var j=function(e,t){return function(i){var n=arguments.length;if(t&&(i=Object(i)),n<2||null==i)return i;for(var o=1;o<n;o++)for(var s=arguments[o],r=e(s),a=r.length,l=0;l<a;l++){var d=r[l];t&&void 0!==i[d]||(i[d]=s[d])}return i}};y.extend=j(y.allKeys),y.extendOwn=y.assign=j(y.keys),y.findKey=function(e,t,i){t=w(t,i);for(var n,o=y.keys(e),s=0,r=o.length;s<r;s++)if(n=o[s],t(e[n],n,e))return n};var U=function(e,t,i){return t in i};y.pick=T(function(e,t){var i={},n=t[0];if(null==e)return i;y.isFunction(n)?(t.length>1&&(n=_(n,t[1])),t=y.allKeys(e)):(n=U,t=D(t,!1,!1),e=Object(e));for(var o=0,s=t.length;o<s;o++){var r=t[o],a=e[r];n(a,r,e)&&(i[r]=a)}return i}),y.omit=T(function(e,t){var i,n=t[0];return y.isFunction(n)?(n=y.negate(n),t.length>1&&(i=t[1])):(t=y.map(D(t,!1,!1),String),n=function(e,i){return!y.contains(t,i)}),y.pick(e,n,i)}),y.defaults=j(y.allKeys,!0),y.create=function(e,t){var i=A(e);return t&&y.extendOwn(i,t),i},y.clone=function(e){return y.isObject(e)?y.isArray(e)?e.slice():y.extend({},e):e},y.tap=function(e,t){return t(e),e},y.isMatch=function(e,t){var i=y.keys(t),n=i.length;if(null==e)return!n;for(var o=Object(e),s=0;s<n;s++){var r=i[s];if(t[r]!==o[r]||!(r in o))return!1}return!0};var H,W;H=function(e,t,i,n){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return!1;if(e!==e)return t!==t;var o=typeof e;return("function"===o||"object"===o||"object"==typeof t)&&W(e,t,i,n)},W=function(e,t,i,n){e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var o=h.call(e);if(o!==h.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return d.valueOf.call(e)===d.valueOf.call(t)}var s="[object Array]"===o;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var r=e.constructor,a=t.constructor;if(r!==a&&!(y.isFunction(r)&&r instanceof r&&y.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===e)return n[l]===t;if(i.push(e),n.push(t),s){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!H(e[l],t[l],i,n))return!1}else{var c,u=y.keys(e);if(l=u.length,y.keys(t).length!==l)return!1;for(;l--;)if(c=u[l],!P(t,c)||!H(e[c],t[c],i,n))return!1}return i.pop(),n.pop(),!0},y.isEqual=function(e,t){return H(e,t)},y.isEmpty=function(e){return null==e||(I(e)&&(y.isArray(e)||y.isString(e)||y.isArguments(e))?0===e.length:0===y.keys(e).length)},y.isElement=function(e){return!(!e||1!==e.nodeType)},y.isArray=f||function(e){return"[object Array]"===h.call(e)},y.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){y["is"+e]=function(t){return h.call(t)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(e){return P(e,"callee")});var z=s.document&&s.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof z&&(y.isFunction=function(e){return"function"==typeof e||!1}),y.isFinite=function(e){return!y.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},y.isNaN=function(e){return y.isNumber(e)&&isNaN(e)},y.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===h.call(e)},y.isNull=function(e){return null===e},y.isUndefined=function(e){return void 0===e},y.has=function(e,t){if(!y.isArray(t))return P(e,t);for(var i=t.length,n=0;n<i;n++){var o=t[n];if(null==e||!p.call(e,o))return!1;e=e[o]}return!!i},y.noConflict=function(){return s._=r,this},y.identity=function(e){return e},y.constant=function(e){return function(){return e}},y.noop=function(){},y.property=function(e){return y.isArray(e)?function(t){return C(t,e)}:S(e)},y.propertyOf=function(e){return null==e?function(){}:function(t){return y.isArray(t)?C(e,t):e[t]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(t){return y.isMatch(t,e)}},y.times=function(e,t,i){var n=Array(Math.max(0,e));t=_(t,i,1);for(var o=0;o<e;o++)n[o]=t(o);return n},y.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},y.now=Date.now||function(){return(new Date).getTime()};var $={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},G=y.invert($),q=function(e){var t=function(t){return e[t]},i="(?:"+y.keys(e).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(o,t):e}};y.escape=q($),y.unescape=q(G),y.result=function(e,t,i){y.isArray(t)||(t=[t]);var n=t.length;if(!n)return y.isFunction(i)?i.call(e):i;for(var o=0;o<n;o++){var s=null==e?void 0:e[t[o]];void 0===s&&(s=i,o=n),e=y.isFunction(s)?s.call(e):s}return e};var Y=0;y.uniqueId=function(e){var t=++Y+"";return e?e+t:t},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},X=/\\|'|\r|\n|\u2028|\u2029/g,J=function(e){return"\\"+Q[e]};y.template=function(e,t,i){!t&&i&&(t=i),t=y.defaults({},t,y.templateSettings);var n=RegExp([(t.escape||K).source,(t.interpolate||K).source,(t.evaluate||K).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(n,function(t,i,n,r,a){return s+=e.slice(o,a).replace(X,J),o=a+t.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(s+="';\n"+r+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";var r;try{r=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var a=function(e){return r.call(this,e,y)},l=t.variable||"obj";return a.source="function("+l+"){\n"+s+"}",a},y.chain=function(e){var t=y(e);return t._chain=!0,t};var Z=function(e,t){return e._chain?y(t).chain():t};y.mixin=function(e){return y.each(y.functions(e),function(t){var i=y[t]=e[t];y.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),Z(this,i.apply(y,e))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];y.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],Z(this,i)}}),y.each(["concat","join","slice"],function(e){var t=a[e];y.prototype[e]=function(){return Z(this,t.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)},n=[],o=function(){return y}.apply(t,n),!(void 0!==o&&(i.exports=o))}()}).call(t,function(){return this}(),i(9)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(){Array.prototype.forEach=function(e){for(var t=0;t<this.length;t++)e(this[t],t,this)};var e=function(){function e(e){return null==e?String(e):q[Y.call(e)]||"object"}function t(t){return"function"==e(t)}function n(e){return null!=e&&e==e.window}function o(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function s(t){return"object"==e(t)}function r(e){return s(e)&&!n(e)&&Object.getPrototypeOf(e)==Object.prototype}function a(e){return"number"==typeof e.length}function l(e){return O.call(e,function(e){return null!=e})}function d(e){return e.length>0?S.fn.concat.apply([],e):e}function c(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function u(e){return e in D?D[e]:D[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function h(e,t){return"number"!=typeof t||M[c(e)]?t:t+"px"}function p(e){var t,i;return x[e]||(t=V.createElement(e),V.body.appendChild(t),i=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),x[e]=i),x[e]}function f(e){return"children"in e?I.call(e.children):S.map(e.childNodes,function(e){if(1==e.nodeType)return e})}function m(e,t,i){for(A in t)i&&(r(t[A])||J(t[A]))?(r(t[A])&&!r(e[A])&&(e[A]={}),J(t[A])&&!J(e[A])&&(e[A]=[]),m(e[A],t[A],i)):t[A]!==T&&(e[A]=t[A])}function g(e,t){return null==t?S(e):S(e).filter(t)}function v(e,i,n,o){return t(i)?i.call(e,n,o):i}function y(e,t,i){try{null==i?e.removeAttribute(t):e.setAttribute(t,i)}catch(e){}}function b(e,t){var i=e.className||"",n=i&&i.baseVal!==T;return t===T?n?i.baseVal:i:void(n?i.baseVal=t:e.className=t)}function _(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?S.parseJSON(e):e):e}catch(t){return e}}function w(e,t){t(e);for(var i=0,n=e.childNodes.length;i<n;i++)w(e.childNodes[i],t)}var T,A,S,P,C,E,k=[],I=k.slice,O=k.filter,V=window.document,x={},D={},M={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},R=/^\s*<(\w+|!)[^>]*>/,N=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,L=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,F=/^(?:body|html)$/i,B=/([A-Z])/g,j=["val","css","html","text","data","width","height","offset"],U=["after","prepend","before","append"],H=V.createElement("table"),W=V.createElement("tr"),z={tr:V.createElement("tbody"),tbody:H,thead:H,tfoot:H,td:W,th:W,"*":V.createElement("div")},$=/complete|loaded|interactive/,G=/^[\w-]*$/,q={},Y=q.toString,K={},Q=V.createElement("div"),X={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},J=Array.isArray||function(e){return e instanceof Array};return K.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var i=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var n,o=e.parentNode,s=!o;return s&&(o=Q).appendChild(e),n=~K.qsa(o,t).indexOf(e),s&&Q.removeChild(e),n},C=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},E=function(e){return O.call(e,function(t,i){return e.indexOf(t)==i})},K.fragment=function(e,t,i){var n,o,s;return N.test(e)&&(n=S(V.createElement(RegExp.$1))),n||(e.replace&&(e=e.replace(L,"<$1></$2>")),t===T&&(t=R.test(e)&&RegExp.$1),t in z||(t="*"),s=z[t],s.innerHTML=""+e,n=S.each(I.call(s.childNodes),function(){s.removeChild(this)})),r(i)&&(o=S(n),S.each(i,function(e,t){j.indexOf(e)>-1?o[e](t):o.attr(e,t)})),n},K.Z=function(e,t){return e=e||[],e.__proto__=S.fn,e.selector=t||"",e},K.isZ=function(e){return e instanceof K.Z},K.init=function(e,i){var n;if(!e)return K.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&R.test(e))n=K.fragment(e,RegExp.$1,i),e=null;else{if(i!==T)return S(i).find(e);n=K.qsa(V,e)}else{if(t(e))return S(V).ready(e);if(K.isZ(e))return e;if(J(e))n=l(e);else if(s(e))n=[e],e=null;else if(R.test(e))n=K.fragment(e.trim(),RegExp.$1,i),e=null;else{if(i!==T)return S(i).find(e);n=K.qsa(V,e)}}return K.Z(n,e)},S=function(e,t){return K.init(e,t)},S.extend=function(e){var t,i=I.call(arguments,1);return"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach(function(i){m(e,i,t)}),e},K.qsa=function(e,t){var i,n="#"==t[0],s=!n&&"."==t[0],r=n||s?t.slice(1):t,a=G.test(r);return o(e)&&a&&n?(i=e.getElementById(r))?[i]:[]:1!==e.nodeType&&9!==e.nodeType?[]:I.call(a&&!n?s?e.getElementsByClassName(r):e.getElementsByTagName(t):e.querySelectorAll(t))},S.contains=V.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},S.type=e,S.isFunction=t,S.isWindow=n,S.isArray=J,S.isPlainObject=r,S.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},S.inArray=function(e,t,i){return k.indexOf.call(t,e,i)},S.camelCase=C,S.trim=function(e){return null==e?"":String.prototype.trim.call(e)},S.uuid=0,S.support={},S.expr={},S.map=function(e,t){var i,n,o,s=[];if(a(e))for(n=0;n<e.length;n++)i=t(e[n],n),null!=i&&s.push(i);else for(o in e)i=t(e[o],o),null!=i&&s.push(i);return d(s)},S.each=function(e,t){var i,n;if(a(e)){for(i=0;i<e.length;i++)if(t.call(e[i],i,e[i])===!1)return e}else for(n in e)if(t.call(e[n],n,e[n])===!1)return e;return e},S.grep=function(e,t){return O.call(e,t)},window.JSON&&(S.parseJSON=JSON.parse),S.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){q["[object "+t+"]"]=t.toLowerCase()}),S.fn={forEach:k.forEach,reduce:k.reduce,push:k.push,sort:k.sort,indexOf:k.indexOf,concat:k.concat,map:function(e){return S(S.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return S(I.apply(this,arguments))},ready:function(e){return $.test(V.readyState)&&V.body?e(S):V.addEventListener("DOMContentLoaded",function(){e(S)},!1),this},get:function(e){return e===T?I.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return k.every.call(this,function(t,i){return e.call(t,i,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):S(O.call(this,function(t){return K.matches(t,e)}))},add:function(e,t){return S(E(this.concat(S(e,t))))},is:function(e){return this.length>0&&K.matches(this[0],e)},not:function(e){var i=[];if(t(e)&&e.call!==T)this.each(function(t){e.call(this,t)||i.push(this)});else{var n="string"==typeof e?this.filter(e):a(e)&&t(e.item)?I.call(e):S(e);this.forEach(function(e){n.indexOf(e)<0&&i.push(e)})}return S(i)},has:function(e){return this.filter(function(){return s(e)?S.contains(this,e):S(this).find(e).size()})},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!s(e)?e:S(e)},last:function(){var e=this[this.length-1];return e&&!s(e)?e:S(e)},find:function(e){var t,n=this;return t=e?"object"==("undefined"==typeof e?"undefined":i(e))?S(e).filter(function(){var e=this;return k.some.call(n,function(t){return S.contains(t,e)})}):1==this.length?S(K.qsa(this[0],e)):this.map(function(){return K.qsa(this,e)}):S()},closest:function(e,t){var n=this[0],s=!1;for("object"==("undefined"==typeof e?"undefined":i(e))&&(s=S(e));n&&!(s?s.indexOf(n)>=0:K.matches(n,e));)n=n!==t&&!o(n)&&n.parentNode;return S(n)},parents:function(e){for(var t=[],i=this;i.length>0;)i=S.map(i,function(e){if((e=e.parentNode)&&!o(e)&&t.indexOf(e)<0)return t.push(e),e});return g(t,e)},parent:function(e){return g(E(this.pluck("parentNode")),e)},children:function(e){return g(this.map(function(){return f(this)}),e)},contents:function(){return this.map(function(){return I.call(this.childNodes)})},siblings:function(e){return g(this.map(function(e,t){return O.call(f(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return S.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var i=t(e);if(this[0]&&!i)var n=S(e).get(0),o=n.parentNode||this.length>1;return this.each(function(t){S(this).wrapAll(i?e.call(this,t):o?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){S(this[0]).before(e=S(e));for(var t;(t=e.children()).length;)e=t.first();S(e).append(this)}return this},wrapInner:function(e){var i=t(e);return this.each(function(t){var n=S(this),o=n.contents(),s=i?e.call(this,t):e;o.length?o.wrapAll(s):n.append(s)})},unwrap:function(){return this.parent().each(function(){S(this).replaceWith(S(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=S(this);(e===T?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return S(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return S(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var i=this.innerHTML;S(this).empty().append(v(this,e,t,i))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var i=v(this,e,t,this.textContent);this.textContent=null==i?"":""+i}):0 in this?this[0].textContent:null},attr:function(e,t){var i;return"string"!=typeof e||1 in arguments?this.each(function(i){if(1===this.nodeType)if(s(e))for(A in e)y(this,A,e[A]);else y(this,e,v(this,t,i,this.getAttribute(e)))}):this.length&&1===this[0].nodeType?!(i=this[0].getAttribute(e))&&e in this[0]?this[0][e]:i:T},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){y(this,e)},this)})},prop:function(e,t){return e=X[e]||e,1 in arguments?this.each(function(i){this[e]=v(this,t,i,this[e])}):this[0]&&this[0][e]},data:function e(t,i){var n="data-"+t.replace(B,"-$1").toLowerCase(),e=1 in arguments?this.attr(n,i):this.attr(n);return null!==e?_(e):T},val:function(e){return 0 in arguments?this.each(function(t){this.value=v(this,e,t,this.value)}):this[0]&&(this[0].multiple?S(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each(function(t){var i=S(this),n=v(this,e,t,i.offset()),o=i.offsetParent().offset(),s={top:n.top-o.top,left:n.left-o.left};"static"==i.css("position")&&(s.position="relative"),i.css(s)});if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function t(i,n){if(arguments.length<2){var o,s=this[0];if(!s)return;if(o=getComputedStyle(s,""),"string"==typeof i)return s.style[C(i)]||o.getPropertyValue(i);if(J(i)){var r={};return S.each(i,function(e,t){r[t]=s.style[C(t)]||o.getPropertyValue(t)}),r}}var t="";if("string"==e(i))n||0===n?t=c(i)+":"+h(i,n):this.each(function(){this.style.removeProperty(c(i))});else for(A in i)i[A]||0===i[A]?t+=c(A)+":"+h(A,i[A])+";":this.each(function(){this.style.removeProperty(c(A))});return this.each(function(){this.style.cssText+=";"+t})},index:function(e){return e?this.indexOf(S(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&k.some.call(this,function(e){return this.test(b(e))},u(e))},addClass:function(e){return e?this.each(function(t){if("className"in this){P=[];var i=b(this),n=v(this,e,t,i);n.split(/\s+/g).forEach(function(e){S(this).hasClass(e)||P.push(e)},this),P.length&&b(this,i+(i?" ":"")+P.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===T)return b(this,"");P=b(this),v(this,e,t,P).split(/\s+/g).forEach(function(e){P=P.replace(u(e)," ")}),b(this,P.trim())}})},toggleClass:function(e,t){return e?this.each(function(i){var n=S(this),o=v(this,e,i,b(this));o.split(/\s+/g).forEach(function(e){(t===T?!n.hasClass(e):t)?n.addClass(e):n.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===T?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===T?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),i=this.offset(),n=F.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(S(e).css("margin-top"))||0,i.left-=parseFloat(S(e).css("margin-left"))||0,n.top+=parseFloat(S(t[0]).css("border-top-width"))||0,n.left+=parseFloat(S(t[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||V.body;e&&!F.test(e.nodeName)&&"static"==S(e).css("position");)e=e.offsetParent;return e})}},S.fn.detach=S.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});S.fn[e]=function(i){var s,r=this[0];return i===T?n(r)?r["inner"+t]:o(r)?r.documentElement["scroll"+t]:(s=this.offset())&&s[e]:this.each(function(t){r=S(this),r.css(e,v(this,i,t,r[e]()))})}}),U.forEach(function(t,i){var n=i%2;S.fn[t]=function(){var t,o,s=S.map(arguments,function(i){return t=e(i),"object"==t||"array"==t||null==i?i:K.fragment(i);
}),r=this.length>1;return s.length<1?this:this.each(function(e,t){o=n?t:t.parentNode,t=0==i?t.nextSibling:1==i?t.firstChild:2==i?t:null;var a=S.contains(V.documentElement,o);s.forEach(function(e){if(r)e=e.cloneNode(!0);else if(!o)return S(e).remove();o.insertBefore(e,t),a&&w(e,function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},S.fn[n?t+"To":"insert"+(i?"Before":"After")]=function(e){return S(e)[t](this),this}}),K.Z.prototype=S.fn,K.uniq=E,K.deserializeValue=_,S.zepto=K,S}(),t=e;return function(e){function t(e){return e._zid||(e._zid=h++)}function i(e,i,s,r){if(i=n(i),i.ns)var a=o(i.ns);return(g[t(e)]||[]).filter(function(e){return e&&(!i.e||e.e==i.e)&&(!i.ns||a.test(e.ns))&&(!s||t(e.fn)===t(s))&&(!r||e.sel==r)})}function n(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function o(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function s(e,t){return e.del&&!y&&e.e in b||!!t}function r(e){return _[e]||y&&b[e]||e}function a(i,o,a,l,c,h,p){var f=t(i),m=g[f]||(g[f]=[]);o.split(/\s/).forEach(function(t){if("ready"==t)return e(document).ready(a);var o=n(t);o.fn=a,o.sel=c,o.e in _&&(a=function(t){var i=t.relatedTarget;if(!i||i!==this&&!e.contains(this,i))return o.fn.apply(this,arguments)}),o.del=h;var f=h||a;o.proxy=function(e){if(e=d(e),!e.isImmediatePropagationStopped()){e.data=l;var t=f.apply(i,e._args==u?[e]:[e].concat(e._args));return t===!1&&(e.preventDefault(),e.stopPropagation()),t}},o.i=m.length,m.push(o),"addEventListener"in i&&i.addEventListener(r(o.e),o.proxy,s(o,p))})}function l(e,n,o,a,l){var d=t(e);(n||"").split(/\s/).forEach(function(t){i(e,t,o,a).forEach(function(t){delete g[d][t.i],"removeEventListener"in e&&e.removeEventListener(r(t.e),t.proxy,s(t,l))})})}function d(t,i){return!i&&t.isDefaultPrevented||(i||(i=t),e.each(S,function(e,n){var o=i[e];t[e]=function(){return this[n]=w,o&&o.apply(i,arguments)},t[n]=T}),(i.defaultPrevented!==u?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(t.isDefaultPrevented=w)),t}function c(e){var t,i={originalEvent:e};for(t in e)A.test(t)||e[t]===u||(i[t]=e[t]);return d(i,e)}var u,h=1,p=Array.prototype.slice,f=e.isFunction,m=function(e){return"string"==typeof e},g={},v={},y="onfocusin"in window,b={focus:"focusin",blur:"focusout"},_={mouseenter:"mouseover",mouseleave:"mouseout"};v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",e.event={add:a,remove:l},e.proxy=function(i,n){var o=2 in arguments&&p.call(arguments,2);if(f(i)){var s=function(){return i.apply(n,o?o.concat(p.call(arguments)):arguments)};return s._zid=t(i),s}if(m(n))return o?(o.unshift(i[n],i),e.proxy.apply(null,o)):e.proxy(i[n],i);throw new TypeError("expected function")},e.fn.bind=function(e,t,i){return this.on(e,t,i)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,i,n){return this.on(e,t,i,n,1)};var w=function(){return!0},T=function(){return!1},A=/^([A-Z]|returnValue$|layer[XY]$)/,S={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,i){return this.on(t,e,i)},e.fn.undelegate=function(e,t,i){return this.off(t,e,i)},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.on=function(t,i,n,o,s){var r,d,h=this;return t&&!m(t)?(e.each(t,function(e,t){h.on(e,i,n,t,s)}),h):(m(i)||f(o)||o===!1||(o=n,n=i,i=u),(f(n)||n===!1)&&(o=n,n=u),o===!1&&(o=T),h.each(function(u,h){s&&(r=function(e){return l(h,e.type,o),o.apply(this,arguments)}),i&&(d=function(t){var n,s=e(t.target).closest(i,h).get(0);if(s&&s!==h)return n=e.extend(c(t),{currentTarget:s,liveFired:h}),(r||o).apply(s,[n].concat(p.call(arguments,1)))}),a(h,t,o,n,i,d||r)}))},e.fn.off=function(t,i,n){var o=this;return t&&!m(t)?(e.each(t,function(e,t){o.off(e,i,t)}),o):(m(i)||f(n)||n===!1||(n=i,i=u),n===!1&&(n=T),o.each(function(){l(this,t,n,i)}))},e.fn.trigger=function(t,i){return t=m(t)||e.isPlainObject(t)?e.Event(t):d(t),t._args=i,this.each(function(){t.type in b&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,i)})},e.fn.triggerHandler=function(t,n){var o,s;return this.each(function(r,a){o=c(m(t)?e.Event(t):t),o._args=n,o.target=a,e.each(i(a,t.type||t),function(e,t){if(s=t.proxy(o),o.isImmediatePropagationStopped())return!1})}),s},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),e.Event=function(e,t){m(e)||(t=e,e=t.type);var i=document.createEvent(v[e]||"Events"),n=!0;if(t)for(var o in t)"bubbles"==o?n=!!t[o]:i[o]=t[o];return i.initEvent(e,n,!0),d(i)}}(e),function(e){function t(t,i,n){var o=e.Event(i);return e(t).trigger(o,n),!o.isDefaultPrevented()}function i(e,i,n,o){if(e.global)return t(i||y,n,o)}function n(t){t.global&&0===e.active++&&i(t,null,"ajaxStart")}function o(t){t.global&&!--e.active&&i(t,null,"ajaxStop")}function s(e,t){var n=t.context;return t.beforeSend.call(n,e,t)!==!1&&i(t,n,"ajaxBeforeSend",[e,t])!==!1&&void i(t,n,"ajaxSend",[e,t])}function r(e,t,n,o){var s=n.context,r="success";n.success.call(s,e,r,t),o&&o.resolveWith(s,[e,r,t]),i(n,s,"ajaxSuccess",[t,n,e]),l(r,t,n)}function a(e,t,n,o,s){var r=o.context;o.error.call(r,n,t,e),s&&s.rejectWith(r,[n,t,e]),i(o,r,"ajaxError",[n,o,e||t]),l(t,n,o)}function l(e,t,n){var s=n.context;n.complete.call(s,t,e),i(n,s,"ajaxComplete",[t,n]),o(n)}function d(){}function c(e){return e&&(e=e.split(";",2)[0]),e&&(e==A?"html":e==T?"json":_.test(e)?"script":w.test(e)&&"xml")||"text"}function u(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function h(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=u(t.url,t.data),t.data=void 0)}function p(t,i,n,o){return e.isFunction(i)&&(o=n,n=i,i=void 0),e.isFunction(n)||(o=n,n=void 0),{url:t,data:i,success:n,dataType:o}}function f(t,i,n,o){var s,r=e.isArray(i),a=e.isPlainObject(i);e.each(i,function(i,l){s=e.type(l),o&&(i=n?o:o+"["+(a||"object"==s||"array"==s?i:"")+"]"),!o&&r?t.add(l.name,l.value):"array"==s||!n&&"object"==s?f(t,l,n,i):t.add(i,l)})}var m,g,v=0,y=window.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,_=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,T="application/json",A="text/html",S=/^\s*$/,P=y.createElement("a");P.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,i){if(!("type"in t))return e.ajax(t);var n,o,l=t.jsonpCallback,d=(e.isFunction(l)?l():l)||"jsonp"+ ++v,c=y.createElement("script"),u=window[d],h=function(t){e(c).triggerHandler("error",t||"abort")},p={abort:h};return i&&i.promise(p),e(c).on("load error",function(s,l){clearTimeout(o),e(c).off().remove(),"error"!=s.type&&n?r(n[0],p,t,i):a(null,l||"error",p,t,i),window[d]=u,n&&e.isFunction(u)&&u(n[0]),u=n=void 0}),s(p,t)===!1?(h("abort"),p):(window[d]=function(){n=arguments},c.src=t.url.replace(/\?(.+)=\?/,"?$1="+d),y.head.appendChild(c),t.timeout>0&&(o=setTimeout(function(){h("timeout")},t.timeout)),p)},e.ajaxSettings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:T,xml:"application/xml, text/xml",html:A,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var i,o=e.extend({},t||{}),l=e.Deferred&&e.Deferred();for(m in e.ajaxSettings)void 0===o[m]&&(o[m]=e.ajaxSettings[m]);n(o),o.crossDomain||(i=y.createElement("a"),i.href=o.url,i.href=i.href,o.crossDomain=P.protocol+"//"+P.host!=i.protocol+"//"+i.host),o.url||(o.url=window.location.toString()),h(o);var p=o.dataType,f=/\?.+=\?/.test(o.url);if(f&&(p="jsonp"),o.cache!==!1&&(t&&t.cache===!0||"script"!=p&&"jsonp"!=p)||(o.url=u(o.url,"_="+Date.now())),"jsonp"==p)return f||(o.url=u(o.url,o.jsonp?o.jsonp+"=?":o.jsonp===!1?"":"callback=?")),e.ajaxJSONP(o,l);var v,b=o.accepts[p],_={},w=function(e,t){_[e.toLowerCase()]=[e,t]},T=/^([\w-]+:)\/\//.test(o.url)?RegExp.$1:window.location.protocol,A=o.xhr(),C=A.setRequestHeader;if(l&&l.promise(A),o.crossDomain||w("X-Requested-With","XMLHttpRequest"),w("Accept",b||"*/*"),(b=o.mimeType||b)&&(b.indexOf(",")>-1&&(b=b.split(",",2)[0]),A.overrideMimeType&&A.overrideMimeType(b)),(o.contentType||o.contentType!==!1&&o.data&&"GET"!=o.type.toUpperCase())&&w("Content-Type",o.contentType||"application/x-www-form-urlencoded"),o.headers)for(g in o.headers)w(g,o.headers[g]);if(A.setRequestHeader=w,A.onreadystatechange=function(){if(4==A.readyState){A.onreadystatechange=d,clearTimeout(v);var t,i=!1;if(A.status>=200&&A.status<300||304==A.status||0==A.status&&"file:"==T){p=p||c(o.mimeType||A.getResponseHeader("content-type")),t=A.responseText;try{"script"==p?(0,eval)(t):"xml"==p?t=A.responseXML:"json"==p&&(t=S.test(t)?null:e.parseJSON(t))}catch(e){i=e}i?a(i,"parsererror",A,o,l):r(t,A,o,l)}else a(A.statusText||null,A.status?"error":"abort",A,o,l)}},s(A,o)===!1)return A.abort(),a(null,"abort",A,o,l),A;if(o.xhrFields)for(g in o.xhrFields)A[g]=o.xhrFields[g];var E=!("async"in o)||o.async;A.open(o.type,o.url,E,o.username,o.password);for(g in _)C.apply(A,_[g]);return o.timeout>0&&(v=setTimeout(function(){A.onreadystatechange=d,A.abort(),a(null,"timeout",A,o,l)},o.timeout)),A.send(o.data?o.data:null),A},e.get=function(){return e.ajax(p.apply(null,arguments))},e.post=function(){var t=p.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=p.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,i,n){if(!this.length)return this;var o,s=this,r=t.split(/\s/),a=p(t,i,n),l=a.success;return r.length>1&&(a.url=r[0],o=r[1]),a.success=function(t){s.html(o?e("<div>").html(t.replace(b,"")).find(o):t),l&&l.apply(s,arguments)},e.ajax(a),this};var C=encodeURIComponent;e.param=function(t,i){var n=[];return n.add=function(t,i){e.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(C(t)+"="+C(i))},f(n,t,i),n.join("&").replace(/%20/g,"+")}}(e),function(e){e.fn.serializeArray=function(){var t,i,n=[],o=function e(i){return i.forEach?i.forEach(e):void n.push({name:t,value:i})};return this[0]&&e.each(this[0].elements,function(n,s){i=s.type,t=s.name,t&&"fieldset"!=s.nodeName.toLowerCase()&&!s.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||s.checked)&&o(e(s).val())}),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(e){"__proto__"in{}||e.extend(e.zepto,{Z:function(t,i){return t=t||[],e.extend(t,e.fn),t.selector=i||"",t.__Z=!0,t},isZ:function(t){return"array"===e.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e,i){try{return t(e,i)}catch(e){return null}}}}(e),t}()},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=!1;!function(e,n){if(e||(e={}),e.Backbone||(e.Backbone={}),"function"==typeof o&&o.amd)o(["underscore","jquery","exports"],function(t,i,o){e.Backbone=n(e,o,t,i)});else{var s=i(8);n(e,t,s)}}(void 0,function(e,t,i,o){var s=e.Backbone,r=[],a=(r.push,r.slice);r.splice;t.VERSION="1.1.2",t.$=o,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function e(t,n,o){if(!c(this,"once",t,[n,o])||!n)return this;var s=this,e=i.once(function(){s.off(t,e),n.apply(this,arguments)});return e._callback=n,this.on(t,e,o)},off:function(e,t,n){var o,s,r,a,l,d,u,h;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(a=e?[e]:i.keys(this._events),l=0,d=a.length;l<d;l++)if(e=a[l],r=this._events[e]){if(this._events[e]=o=[],t||n)for(u=0,h=r.length;u<h;u++)s=r[u],(t&&t!==s.callback&&t!==s.callback._callback||n&&n!==s.context)&&o.push(s);o.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&u(i,t),n&&u(n,arguments),this},stopListening:function(e,t,o){var s=this._listeningTo;if(!s)return this;var r=!t&&!o;o||"object"!==("undefined"==typeof t?"undefined":n(t))||(o=this),e&&((s={})[e._listenId]=e);for(var a in s)e=s[a],e.off(t,o,this),(r||i.isEmpty(e._events))&&delete this._listeningTo[a];return this}},d=/\s+/,c=function(e,t,i,o){if(!i)return!0;if("object"===("undefined"==typeof i?"undefined":n(i))){for(var s in i)e[t].apply(e,[s,i[s]].concat(o));return!1}if(d.test(i)){for(var r=i.split(d),a=0,l=r.length;a<l;a++)e[t].apply(e,[r[a]].concat(o));return!1}return!0},u=function(e,t){var i,n=-1,o=e.length,s=t[0],r=t[1],a=t[2];switch(t.length){case 0:for(;++n<o;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=e[n]).callback.call(i.ctx,s,r);return;case 3:for(;++n<o;)(i=e[n]).callback.call(i.ctx,s,r,a);return;default:for(;++n<o;)(i=e[n]).callback.apply(i.ctx,t);return}},h={listenTo:"on",listenToOnce:"once"};i.each(h,function(e,t){l[t]=function(t,o,s){var r=this._listeningTo||(this._listeningTo={}),a=t._listenId||(t._listenId=i.uniqueId("l"));return r[a]=t,s||"object"!==("undefined"==typeof o?"undefined":n(o))||(s=this),t[e](o,s,this),this}}),l.bind=l.on,l.unbind=l.off,i.extend(t,l);var p=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,o){var s,r,a,l,d,c,u,h;if(null==e)return this;if("object"===("undefined"==typeof e?"undefined":n(e))?(r=e,o=t):(r={})[e]=t,o||(o={}),!this._validate(r,o))return!1;a=o.unset,d=o.silent,l=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)t=r[s],i.isEqual(h[s],t)||l.push(s),i.isEqual(u[s],t)?delete this.changed[s]:this.changed[s]=t,a?delete h[s]:h[s]=t;if(!d){l.length&&(this._pending=o);for(var p=0,f=l.length;p<f;p++)this.trigger("change:"+l[p],this,h[l[p]],o)}if(c)return this;if(!d)for(;this._pending;)o=this._pending,this._pending=!1,this.trigger("change",this,o);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t,n=!1,o=this._changing?this._previousAttributes:this.attributes;for(var s in e)i.isEqual(o[s],t=e[s])||((n||(n={}))[s]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return!!t.set(t.parse(i,e),e)&&(n&&n(t,i,e),void t.trigger("sync",t,i,e))},F(this,e),this.sync("read",this,e)},save:function(e,t,o){var s,r,a,l=this.attributes;if(null==e||"object"===("undefined"==typeof e?"undefined":n(e))?(s=e,o=t):(s={})[e]=t,o=i.extend({validate:!0},o),s&&!o.wait){if(!this.set(s,o))return!1}else if(!this._validate(s,o))return!1;s&&o.wait&&(this.attributes=i.extend({},l,s)),void 0===o.parse&&(o.parse=!0);var d=this,c=o.success;return o.success=function(e){d.attributes=l;var t=d.parse(e,o);return o.wait&&(t=i.extend(s||{},t)),!(i.isObject(t)&&!d.set(t,o))&&(c&&c(d,e,o),void d.trigger("sync",d,e,o))},F(this,o),r=this.isNew()?"create":o.patch?"patch":"update","patch"===r&&(o.attrs=s),a=this.sync(r,this,o),s&&o.wait&&(this.attributes=l),a},destroy:function e(t){t=t?i.clone(t):{};var n=this,o=t.success,e=function(){n.trigger("destroy",n,n.collection,t)};if(t.success=function(i){(t.wait||n.isNew())&&e(),o&&o(n,i,t),n.isNew()||n.trigger("sync",n,i,t)},this.isNew())return t.success(),!1;F(this,t);var s=this.sync("delete",this,t);return t.wait||e(),s},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||L();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}});var f=["keys","values","pairs","invert","pick","omit"];i.each(f,function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},v={add:!0,remove:!1};i.extend(m.prototype,l,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,v))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var o,s,r,a;for(o=0,s=e.length;o<s;o++)a=e[o]=this.get(e[o]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,t.silent||(t.index=r,a.trigger("remove",a,this,t)),this._removeReference(a,t));return n?e[0]:e},set:function(e,t){t=i.defaults({},t,g),t.parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var o,s,r,a,l,d,c,u=t.at,h=this.model,f=this.comparator&&null==u&&t.sort!==!1,m=i.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},_=t.add,w=t.merge,T=t.remove,A=!(f||!_||!T)&&[];for(o=0,s=e.length;o<s;o++){if(l=e[o]||{},r=l instanceof p?a=l:l[h.prototype.idAttribute||"id"],d=this.get(r))T&&(b[d.cid]=!0),w&&(l=l===a?a.attributes:l,t.parse&&(l=d.parse(l,t)),d.set(l,t),f&&!c&&d.hasChanged(m)&&(c=!0)),e[o]=d;else if(_){if(a=e[o]=this._prepareModel(l,t),!a)continue;v.push(a),this._addReference(a,t)}a=d||a,!A||!a.isNew()&&b[a.id]||A.push(a),b[a.id]=!0}if(T){for(o=0,s=this.length;o<s;++o)b[(a=this.models[o]).cid]||y.push(a);y.length&&this.remove(y,t)}if(v.length||A&&A.length)if(f&&(c=!0),this.length+=v.length,null!=u)for(o=0,s=v.length;o<s;o++)this.models.splice(u+o,0,v[o]);else{A&&(this.models.length=0);var S=A||v;for(o=0,s=S.length;o<s;o++)this.models.push(S[o])}if(c&&this.sort({silent:!0}),!t.silent){for(o=0,s=v.length;o<s;o++)(a=v[o]).trigger("add",a,this,t);(c||A&&A.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,o=this.models.length;n<o;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return a.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var o=e.reset?"reset":"set";n[o](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},F(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,o=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),o&&o(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(y,function(e){m.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var b=["groupBy","countBy","sortBy","indexBy"];i.each(b,function(e){m.prototype[e]=function(t,n){var o=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,o,n)}});var _=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,T)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var o=t.match(w),s=o[1],r=o[2];n=i.bind(n,this),s+=".delegateEvents"+this.cid,""===r?this.$el.on(s,n):this.$el.on(s,r,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,o){var s=S[e];i.defaults(o||(o={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:s,dataType:"json"};if(o.url||(r.url=i.result(n,"url")||L()),null!=o.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),o.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){r.type="POST",o.emulateJSON&&(r.data._method=s);var a=o.beforeSend;o.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",s),a)return a.apply(this,arguments)}}"GET"===r.type||o.emulateJSON||(r.processData=!1),"PATCH"===r.type&&A&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=o.xhr=t.ajax(i.extend(r,o));return n.trigger("request",n,l,o),l};var A=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),S={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var P=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,k=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(P.prototype,l,{initialize:function(){},route:function(e,n,o){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var s=this;return t.history.route(e,function(i){var r=s._extractParameters(e,i);s.execute(o,r),s.trigger.apply(s,["route:"+n].concat(r)),s.trigger("route",n,r),t.history.trigger("route",s,n,r)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(I,"\\$&").replace(C,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var O=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},V=/^[#\/]|\s+$/g,x=/^\/+|\/+$/g,D=/msie [\w.]+/,M=/\/$/,R=/#.*$/;O.started=!1,i.extend(O.prototype,l,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(M,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(V,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),o=document.documentMode,s=D.exec(navigator.userAgent.toLowerCase())&&(!o||o<=7);if(this.root=("/"+this.root+"/").replace(x,"/"),s&&this._wantsHashChange){var r=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=r.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(V,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t!==this.fragment&&(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!O.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(R,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new O;var N=function(e,t){var n,o=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,t);var s=function(){this.constructor=n};return s.prototype=o.prototype,n.prototype=new s,e&&i.extend(n.prototype,e),n.__super__=o.prototype,n};p.extend=m.extend=P.extend=_.extend=O.extend=N;var L=function(){throw new Error('A "url" property or function must be specified')},F=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(13),s=n(o),r=i(15),a=n(r);e.exports={StateManager:s.default,StateManagerView:a.default}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8),a=(n(r),i(14)),l=function(){function e(){o(this,e)}return s(e,[{key:"createStateHandlers",value:function(e){(0,a.createStateHandlers)(this,e)}}]),e}();e.exports=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e);
}Object.defineProperty(t,"__esModule",{value:!0}),t.createStateHandlers=void 0;var s=i(8),r=n(s);t.createStateHandlers=function(e,t){if(e.model&&r.default.isArray(t)){var i=function(e){var t=e.self,i=e.funcName,n=e.withBind,s=e.args;if(r.default.isString(i)&&r.default.isFunction(t[i]))if(n){var a;(a=t[i]).bind.apply(a,[t].concat(o(s)))()}else t[i].apply(t,o(s))},n=function(e){var t=e.self,n=e.funcName,o=e.event,s=e.withBind,r=e.listen,a=e.isListenOnce,l=o.split(":")[0],d=o.split(":")[1],c=function(){var e=t.model.get(l).toString();e==d?i({self:t,funcName:n,withBind:s,args:arguments}):a&&t.model.listenToOnce(t.model,"change:"+l,c)}.bind(t);t.model[r](t.model,"change:"+l,c)},s=function(e){var t=e.self,i=e.event,n=e.func,o=e.listen,s=e.isListenOnce,r=e.onEventNotEqual,a=i.split(":")[0],l=i.split(":")[1],d=function(){var e=function(){};s&&(e=function(){t.model.listenToOnce(t.model,"change:"+a,d)});var i=t.model.get(a).toString();i===l?n.call(t,e):s?(r(),e()):r()}.bind(t);t.model[o](t.model,"change:"+a,d)},a=function(t){var n=t.event,o=t.funcName,a=t.isListenOnce,l=t.withBind,d=a?"listenToOnce":"listenTo",c=!0,u=!1,h=[];r.default.forEach(n,function(e){var t=e.split(":")[0],i=e.split(":")[1];h.push({eventName:t,stateName:i})}.bind(e));var p=function(t){if(!a||!u){var n=!0;r.default.forEach(h,function(t){var i=void 0!==e.model.get(t.eventName)?e.model.get(t.eventName).toString():void 0;i!==t.stateName&&(n=!1)}),n&&c?(c=!1,u=!0,i({self:e,funcName:o,withBind:l,args:arguments})):n||t()}};r.default.forEach(n,function(t){s({self:e,func:p,event:t,withBind:l,listen:d,isListenOnce:a,onEventNotEqual:function(){c=!0}.bind(e)})}.bind(e))};r.default.each(t,function(t){var o=t.event,s=t.funcName,l=t.isListenOnce,d=void 0!==l&&l,c=t.withBind,u=void 0===c||c;if(r.default.isArray(o)&&a({event:o,funcName:s,isListenOnce:d,withBind:u}),r.default.isString(o)&&r.default.isString(s)){var h=d?"listenToOnce":"listenTo";o.match(":")?n({self:e,funcName:s,event:o,withBind:u,listen:h,isListenOnce:d}):e.model[h](e.model,"change:"+o,function(){i({self:e,funcName:s,withBind:u,args:arguments})}.bind(e))}}.bind(e))}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(14),u=i(11),h=n(u),p=function(e){function t(e){return o(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return r(t,e),a(t,[{key:"renderTemplate",value:function(){if(this.template&&this.model&&(this.template=d.default.template(this.template),this.$el.append(this.template(this.model.attributes)),this.ui)){var e={};for(var t in this.ui)e[t]=this.$el.find(this.ui[t]);this.ui=e}}},{key:"createStateHandlers",value:function(e){(0,c.createStateHandlers)(this,e)}}]),t}(h.default.View);e.exports=p},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(17),a=n(r),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.unitType,n=t.className,s=t.logger,r=void 0===s?a.default.getInstance():s,l=t.version,d=t.isDebug,c=void 0===d||d;o(this,e),this._logger=r,this.unitType=i,this.className=n,this.version=l,this.isDebug=c}return s(e,[{key:"info",value:function(e,t){this._logger.info("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"success",value:function(e,t){this._logger.success("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"important",value:function(e,t){this._logger.important("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"warning",value:function(e,t){this._logger.warning("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"pixel",value:function(e,t){this._logger.pixel("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"debug",value:function(e,t){this.isDebug&&this._logger.debug("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"error",value:function(e,t){this.isDebug&&this._logger.error("unit type: "+this.unitType+", "+("class name: "+this.className+" - "+e),t)}},{key:"ga",value:function(e){this._logger.ga(this.unitType,e,this.version)}},{key:"ul",value:function(e,t,i){this._logger.ul(e,t,i)}}]),e}();t.default=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(18),u=n(c),h=i(19),p=n(h),f=i(20),m=n(f),g=i(10),v=n(g),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.addTrace,n=void 0!==i&&i,r=e.isDebug,a=void 0!==r&&r,l=e.isConsole,c=void 0===l?a:l,h=e.isSaveLog,p=void 0===h?a:h,f=e.extraLogGA,g=void 0!==f&&f,v=e.version,y=e.isGA;o(this,t);var b=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return b.addTrace=n,b.isDebug=d.default.parseBool(a),b.isConsole=d.default.parseBool(c),b.isSaveLog=d.default.parseBool(p),b.isGA=d.default.parseBool(y),b.extraLogGA=g,b._ga=u.default.getInstance(v,b.isGA),b._ul=m.default.getInstance(),b.dataIndexName="units_debug_logs",b.isDebug&&(window.cmLogs=window.cmLogs||[]),b.initModel={},b}return r(t,e),a(t,[{key:"pushLog",value:function(e,t){this.isDebug&&(window.cmLogs.push({ts:(new Date).getTime(),message:e,obj:t}),"cmTag: init"===e&&(this.initModel=t,this.initModel["debugDataStore.indexName"]&&(this.dataIndexName=this.initModel["debugDataStore.indexName"]),console.log("cmTag: init obj:",JSON.stringify(t)),this.sessionID=this.getUniqSessionId(),this.showSessionID()),this.initModel["debugDataStore.isActive"]&&this.sendToServer(e,t))}},{key:"info",value:function(e,t){this.isDebug&&(console.info("cmTag: "+e,t),this.pushLog("cmTag: "+e,t),this.addTrace&&console.trace())}},{key:"debug",value:function(e,t){this.isDebug&&(console.log("%ccmTag: "+e,"color: RoyalBlue",t),this.pushLog("cmTag: "+e,t))}},{key:"error",value:function(e,t){console.error("cmTag: "+e,t),this.pushLog("cmTag: "+e,t)}},{key:"ga",value:function(e,t,i){return this.extraLogGA&&this.info("GA extra log",{unitType:e,action:t,version:i}),this._ga.send(e,t,i)}},{key:"ul",value:function(e,t,i){return this._ul.send(e,t,i)}},{key:"success",value:function(e,t){this.isDebug&&(console.log("%ccmTag: "+e,"color: green",t),this.pushLog("cmTag: "+e,t))}},{key:"important",value:function(e,t){this.isDebug&&(console.log("%ccmTag: "+e,"color: purple",t),this.pushLog("cmTag: "+e,t))}},{key:"warning",value:function(e,t){this.isDebug&&(console.log("%ccmTag: "+e,"color: orange",t),this.pushLog("cmTag: "+e,t))}},{key:"pixel",value:function(e,t){this.isDebug&&(console.log("%ccmTag: "+e,"color: #00A0B2",t),this.pushLog("cmTag: "+e,t))}},{key:"sendToServer",value:function(e,t){var i="no data";try{var n=JSON.stringify(t);t&&(i=n)}catch(e){}var o=this.initModel["player.settings.kbnul"]+"/putes/"+this.dataIndexName;v.default.ajax({type:"POST",url:o,data:JSON.stringify({message:e,dataObject:i,timestamp:(new Date).toISOString(),sessionID:this.sessionID}),contentType:"text/plain"})}},{key:"getUniqSessionId",value:function(){return""+this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()}},{key:"showSessionID",value:function(){var e=document.createElement("div");e.setAttribute("id","_cm-session-id-div"),e.setAttribute("style","background: black; color: wheat; position: fixed; top: 0; left: 0;z-index:999999999");var t=document.createTextNode("SessionID: "+this.sessionID),i=document.createElement("button");i.innerHTML="X",i.addEventListener("click",function(){var e=document.querySelector("#_cm-session-id-div");e.remove()}),e.appendChild(t),e.appendChild(i),document.querySelector("body").appendChild(e)}},{key:"getRandomNumber",value:function(){return Math.floor(10*Math.random())}}],[{key:"create",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return new(Function.prototype.bind.apply(t,[null].concat(i)))}}]),t}(p.default);t.default=y},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){return window.ga&&"function"==typeof window.ga}function l(){!function(e,t,i,n,o,s,r){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,s=t.createElement(i),r=t.getElementsByTagName(i)[0],s.async=1,s.src=n,r.parentNode.insertBefore(s,r)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),window.ga("create","UA-66399520-1","auto"),window.ga("send","pageview")}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=i(19),u=n(c),h=function(e){function t(e,i){o(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.version=e,n.isGa=i,n.isGa&&(a()||l(),n._setup()),n}return r(t,e),d(t,[{key:"_setup",value:function(){window.ga("create","UA-66399520-1","auto",{name:"cmGa"}),window.ga("cmGa.send","pageview")}},{key:"send",value:function(e,t){this.isGa&&window.ga("cmGa.send","event",e+" "+this.version,t,location.host)}}],[{key:"create",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return new(Function.prototype.bind.apply(t,[null].concat(i)))}}]),t}(u.default);t.default=h},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){if(i(this,e),"instance"in this.constructor)throw new Error("Cannot instantiate more than one '"+this.constructor.name+"'");if("Singleton"==this.constructor.name)throw new Error("Cannot instantiate abstract class 'Singleton'");this.constructor.instance=this}return n(e,null,[{key:"getInstance",value:function(){return"instance"in this||this.create.apply(this,arguments),this.instance}},{key:"create",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return new(Function.prototype.bind.apply(e,[null].concat(i)))}}]),e}();t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(19),d=n(l),c=i(10),u=function(e){function t(){return o(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return r(t,e),a(t,[{key:"send",value:function(e,t,i){i||(i="ul");var n=JSON.stringify({timestamp:(new Date).toISOString(),type:e,data:t}),o="//vidanalytics.taboola.com";c.ajax({type:"POST",url:o+"/putes/"+i,data:n,contentType:"text/plain"})}}],[{key:"create",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return new(Function.prototype.bind.apply(t,[null].concat(i)))}}]),t}(d.default);t.default=u},function(e,t){"use strict";e.exports={readyState:"ready",adManagerState:{empty:"empty",hasAds:"hasAds",stopped:"stopped",paused:"paused"},adState:{failed:"failed",playing:"playing",paused:"paused",continueAd:"continueAd",completed:"completed",autoKill:"autoKill",repeating:"repeating"},adQState:{impression:"impression",q0:"q0",q1:"q1",q2:"q2",q3:"q3",completed:"completed",repeating:"repeating"},getAdState:{notCalled:"notCalled",gettingAd:"gettingAd",gotAd:"gotAd",waiting:"waiting",failed:"failed",stopped:"stopped",finished:"finished"},playerState:{error:"error",stopped:"stopped",closed:"closed",restarted:"restarted"},containerViewState:{rendered:"rendered",eligible:"eligible",playing:"playing",collapsed:"collapsed"},videoViewState:{rendered:"rendered",attached:"attached",detached:"detached"},repeatState:{hiding:"hiding",showing:"showing",spinning:"spinning",clicked:"clicked"},loadingViewState:{hiding:"hiding",showing:"showing",clicked:"clicked"},clickThruState:{clicked:"clicked",waiting:"waiting"},timerState:{working:"started",paused:"paused",stopped:"stopped",done:"done"},closeState:{terminate:"terminate",containerViewClosed:"containerViewClosed",videoViewClosed:"videoViewClosed",adManagerStop:"adManagerStop",playerClosed:"playerClosed"},tabState:{focus:"focus",blur:"blur",tabOut:"tabOut"},rvHandlerState:{working:"working",idle:"idle"}}},function(e,t){"use strict";e.exports={player:void 0,oppsula:void 0,pms:void 0,serviceLoader:void 0,microServices:{base_url:"//vidstat.taboola.com/",async:!0,PMS:{version:"2.2.1"}}}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=(o(d),i(8)),u=o(c),h=i(11),p=(o(h),i(12)),f=i(16),m=o(f),g=i(21),v=n(g),y=i(24),b=o(y),_=i(25),w=n(_),T=i(22),A=o(T),S=i(26),P=(o(S),i(27)),C=o(P),E={viewability:{id:30,name:"viewability"},viewabilityOneS:{id:54,name:"viewabilityOneS"},viewability100:{id:63,name:"viewability100"},pauseAfterPlay:{id:31,name:"pauseAfterPlay"},conversion:{id:32,name:"adPlay"},clickThru:{id:33,name:"clickThru"},fireSkipVimp1EligibilityLost:{id:43,name:"skipLostEligibility"},fireSkipVimp1Vimp0Playing:{id:44,name:"skipOtherPlaying"},unitImpression:{id:45,name:"unitImpression"},continueAd:{id:46,name:"continueAd"},continueAdInAnotherCard:{id:55,name:"continueAdInAnotherCard"},shouldContinueAdInAnotherCard:{id:56,name:"shouldContinueAdInAnotherCard"},lostCardEligibility:{id:57,name:"lostCardEligibility"},adUnmuted:{id:58,name:"adUnmuted"},userAdUnmuted:{id:64,name:"userAdUnmuted"},learnMoreClick:{id:71,name:"learnMoreClick"},adTitleClick:{id:74,name:"adTitleClick"},adCtaButtonClick:{id:75,name:"adCtaButtonClick"},adDescriptionClick:{id:76,name:"adDescriptionClick"},adBrandingClick:{id:77,name:"adBrandingClick"},adIconClick:{id:78,name:"adIconClick"},detach:{id:79,name:"detach"},attach:{id:80,name:"attach"},sliderClosed:{id:81,name:"sliderClosed"},twoSecAfterPlay:{id:82,name:"twoSecAfterPlay"},adProgressionAfterBeginPredict:{id:84,name:"adProgressionAfterBeginPredict"},adProgressionBeforeEndPredict:{id:85,name:"adProgressionBeforeEndPredict"}},k=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.model));return i.model=e.model,i.adData=e.adData,i.reportFunc=e.reportFunc,i.getAdData=e.getAdDataFunc,i.setDebugData=e.setDebugData,i.log=new m.default({unitType:i.model.get("unitType"),className:"oppsService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.oppManager=new b.default(i.model.get("player.urls.oppsRequest"),{"auc-dast":i.model.get("cmDast"),pt:u.default.crc32(i.model.get("abTest")||999)}),i.isViewed=!1,i.hadConversion=!1,i.hadImpression=!1,i.isFirstPlayForAd=!0,i.pageEventHistory=window.cmTag.PEH,i.unifiedPlacementEH=window.cmTag.UPEH,i._bindEvents(),i._fireUnitImpression(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){}},{key:"_fireUnitImpression",value:function(){this._fireOpp(E.unitImpression.id,E.unitImpression.name),this.reportFunc(E.unitImpression.name,{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime")},!0),this.model.get("hadEligibility")||this.reportFunc("waitingForEligibilty",{tab:this.model.get("isInTab")},!1)}},{key:"fireSkipVimp1EligibilityLost",value:function(e){e&&this._fireOpp(E.fireSkipVimp1EligibilityLost.id,E.fireSkipVimp1EligibilityLost.name),this.reportFunc(E.fireSkipVimp1EligibilityLost.name,{},!1)}},{key:"fireSkipVimp1Vimp0Playing",value:function(e){e&&this._fireOpp(E.fireSkipVimp1Vimp0Playing.id,E.fireSkipVimp1Vimp0Playing.name),this.reportFunc(E.fireSkipVimp1Vimp0Playing.name,{otherAdRequiredViewbility:this.model.get("activeAdData.requiredViewability"),otherAdPlayerSequenceId:this.model.get("activeAdData.tagData.sequenceId"),otherAdDp:this.model.get("activeAdData.dp")},!1)}},{key:"fireLostCardEligibility",value:function(){this._fireOpp(E.lostCardEligibility.id,E.lostCardEligibility.name)}},{key:"onConversion",value:function(){this.hadConversion||(this.shouldFirePauseAfterPlay=!0,this.hadConversion=!0,this._fireOpp(E.conversion.id,E.conversion.name),this.reportFunc(E.conversion.name,{},!0))}},{key:"fireAdUnmuted",value:function(){this.adUnmutedOppFired||(this._fireOpp(E.adUnmuted.id,E.adUnmuted.name),this.adUnmutedOppFired=!0)}},{key:"fireUserAdUnmuted",value:function(){this.userAdUnmutedOppFired||(this._fireOpp(E.userAdUnmuted.id,E.userAdUnmuted.name),this.userAdUnmutedOppFired=!0)}},{key:"onFirstPauseAfterPlay",value:function(){this.shouldFirePauseAfterPlay&&!this.isViewed&&(this.shouldFirePauseAfterPlay=!1,this._fireOpp(E.pauseAfterPlay.id,E.pauseAfterPlay.name),this.reportFunc(E.pauseAfterPlay.name,{tab:this.model.get("isInTab")},!0))}},{key:"onViewabilityOneS",value:function(){this._fireOpp(E.viewabilityOneS.id,E.viewabilityOneS.name)}},{key:"onViewability",value:function(){this.isViewed=!0,this._fireOpp(E.viewability.id,E.viewability.name),this.reportFunc(E.viewability.name,{},!0)}},{key:"onTwoSecAfterPlay",value:function(){this.model.get("opps.twoSecAfterPlay.isFire")&&this._fireOpp(E.twoSecAfterPlay.id,E.twoSecAfterPlay.name)}},{key:"onViewability100",value:function(){this._fireOpp(E.viewability100.id,E.viewability100.name)}},{key:"fireContinueAd",value:function(){this.isContinueAdFired||(this.isContinueAdFired=!0,this._fireOpp(E.continueAd.id,E.continueAd.name),this.reportFunc(E.continueAd.name,{tab:this.model.get("isInTab")},!0))}},{key:"onAdClicked",value:function(){this._fireOpp(E.clickThru.id),this.reportFunc(E.clickThru.name,{},!0),this.model.set("clickThruState",v.clickThruState.waiting)}},{key:"onAdDetached",value:function(){this.model.get("opps.detach.isFire")&&(this._fireOpp(E.detach.id),this.reportFunc(E.detach.name,{},!0))}},{key:"onAdAttached",value:function(){this.model.get("opps.attach.isFire")&&(this._fireOpp(E.attach.id),this.reportFunc(E.attach.name,{},!0))}},{key:"onAdSliderClosed",value:function(){this.model.get("opps.sliderClosed.isFire")&&(this._fireOpp(E.sliderClosed.id),this.reportFunc(E.sliderClosed.name,{},!0))}},{key:"fireLearnMoreClick",value:function(){this._fireOpp(E.learnMoreClick.id)}},{key:"fireTitleContaineClick",value:function(e){var t=E[e];t&&this._fireOpp(t.id,t.name)}},{key:"_fireOpp",value:function(e,t){if(this.adData&&e){t&&this.log.info("Fire "+t+" opps");var i={rs:this.adData.sequenceId,st:w.ROLL_TYPE[this.adData.rollType],sts:this.model.get("playerRepeatCount"),os:Number(this.adData.waterfallTagId)+1,rst:e,d:(new Date).getTime()-this.adData.created,dast:this.adData.dast,vpd:this.adData.pubId,vptd:this.adData.tagId,pv:this.model.get("playerVersion"),dp:u.default.crc32(this.adData.dp),vmt:Number(this.adData.isRon)||0,abt:this.model.get("abTest"),vstt:this.model.get("isInTab")?1:0,agl:this.model.get("preset.level")?this.model.get("preset.level"):1,pdast:this.adData.pdast,ft:this.model.get("frameType")};this._setSubUnitData(e,i),this._sendDebugDataReporting(i,e),this.model.get("isOppsulaEnabled")===!0&&A.default.oppsula?(i["auc-dast"]=this.model.get("cmDast")||void 0,A.default.oppsula.send(i)):this.oppManager.send(i)}}},{key:"setSubModel",value:function(e){this.subModel=e}},{key:"_onSecondsToCloseGlobal",value:function(){this.reportFunc("secondsToCloseGlobal",{},!0)}},{key:"_onCloseButtonClick",value:function(){this.reportFunc("closeButtonClick",{},!0)}},{key:"_setSubUnitData",value:function(e,t){var i=this.model.get("isFireSP");for(var n in i){if(e!==parseInt(n)||!i[n])break;var o=this.getAdData();void 0!==o.sp&&(t.sp=o.sp)}var s=this.model.get("subUnitType");this.model&&(s||0===s)&&(t.su=s)}},{key:"fireContinueAdInAnotherCard",value:function(){this._fireOpp(E.continueAdInAnotherCard.id,E.continueAdInAnotherCard.name),this.reportFunc(E.continueAdInAnotherCard.name,{},!0)}},{key:"fireShouldContinueAdInAnotherCard",value:function(){this._fireOpp(E.shouldContinueAdInAnotherCard.id,E.shouldContinueAdInAnotherCard.name),this.reportFunc(E.shouldContinueAdInAnotherCard.name,{},!0)}},{key:"adProgressionBeforeEndPredict",value:function(){this.model.get("opps.adProgressionBeforeEndPredict.isFire")&&this._fireOpp(E.adProgressionBeforeEndPredict.id,E.adProgressionBeforeEndPredict.name)}},{key:"adProgressionAfterBeginPredict",value:function(){this.model.get("opps.adProgressionAfterBeginPredict.isFire")&&this._fireOpp(E.adProgressionAfterBeginPredict.id,E.adProgressionAfterBeginPredict.name)}},{key:"_sendDebugDataReporting",value:function(e,t){if(this.model.get("isSendDebugDataReporting")){var i=new C.default({model:this.model,subModel:this.subModel,adData:this.adData,onDebugDataChange:this.setDebugData,isViewed:this.isViewed});e.dbg=i.getDebugData(),this.model.get("isSendDebugDataReportingLog")&&this.log.info("DBG-Opp "+t+" - "+e.dbg)}}}]),t}(p.StateManager);e.exports=k},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8),a=n(r),l=i(16),d=n(l),c=function(){function e(t,i){o(this,e),this.oppUrl=t,0!==t.indexOf("//")&&(this.oppUrl="//"+this.oppUrl),this.options={"auc-dast":void 0,dast:void 0,d:void 0,dp:void 0,os:void 0,pv:void 0,pt:void 0,rs:void 0,rst:void 0,st:void 0,sts:void 0,tms:void 0,vmt:void 0,vpd:void 0,vptd:void 0},this.options=a.default.extend(this.options,i),this.log=new d.default({className:"Opportunity Manager"}),this.pixelType={tagStarted:0,tagImpression:1,tagTimeout:2,tagError:4,playerClosed:7,AdVideoFirstQuartile:21,AdVideoMidpoint:22,AdVideoThirdQuartile:23,AdVideoComplete:24,viewability:30,firstImpression:99}}return s(e,[{key:"send",value:function(e){var t=this.oppUrl;e=a.default.extend({},this.options,{tms:Math.floor((new Date).getTime()/1e3)},e),t=a.default.addParametersToUrl(t,e,!0),a.default.firePixel(t,"Opportunity Pixel")}}]),e}();e.exports=c},function(e,t){"use strict";e.exports={UNIT_TYPES:{INLINE:0,INTERSTITIAL:1,SLIDER_OUTSTREAM:2,SLIDER_INSTREAM:3,EXPANDABLE:4,"300X600":5,INLINE_FEED:6,COFFEEBREAK:7,SLIDESHOW:8,INLINE_INSTREAM:9,COFFEEBREAK_MOBILE:10,"300X600_MOBILE":11,INLINE_MOBILE:12,INTERSTITIAL_MOBILE:14,SLIDER_OUTSTREAM_MOBILE:15,SLIDER_INSTREAM_MOBILE:16,EXPANDABLE_MOBILE:17,INLINE_INSTREAM_MOBILE:18,INLINE_OUT_OF_VIEW:19,INLINE_OUT_OF_VIEW_MOBILE:20,INLINE_VIEWABILITY_EXPAND:21,INLINE_VIEWABILITY_EXPAND_MOBILE:22,INLINE_INSTREAM_VIEWABILITY_EXPAND:23,INLINE_INSTREAM_VIEWABILITY_EXPAND_MOBILE:24,INLINE_FEED_MOBILE:25,WIDGET_ITEM:26,WIDGET_ITEM_MOBILE:27,NEW_INLINE:28,NEW_INLINE_MOBILE:29,NEW_INLINE_ADJACENT:30,NEW_INLINE_ADJACENT_MOBILE:31,FEED_MANAGER:32,FEED_MANAGER_MOBILE:33,MSN_WIDGET:34,SLIDER_INSTREAM_VFORCE:36,SLIDER_INSTREAM_MOBILE_VFORCE:37},STREAM_TYPES:{IN_STREAM:1,OUT_STREAM:0},UNITS_STREAM_TYPE:{INLINE:0,INTERSTITIAL:0,SLIDER_OUTSTREAM:0,SLIDER_INSTREAM:1,EXPANDABLE:1,"300X600":1,OMNI_TAG:0},APPEND_TYPE:{BEFORE_BEGIN:0,AFTER_BEGIN:1,BEFORE_END:2,AFTER_END:3,beforebegin:0,afterbegin:1,beforeend:2,afterend:3},INVALID_SELECTOR_TAG_NAMES:{IMG:0,UL:1,BUTTON:3,INPUT:4,LABEL:5},OMNI_TAG_UNIT_NAMES:{rightrail1:1,rightrail2:2,rightrail3:3,inlineTop:4,inlineMiddle:5,inlineBottom:6,interstitial:7,sliderOutstream1:8,sliderOutstream2:9,sliderInstream1:10,sliderInstream2:11,coffeeBreak:12,expandable1:13,expandable2:14,expandable3:15,invalidUnitName:1e3},ROLL_TYPE:{preroll:0,"pre-roll":0,midroll:-1,"mid-roll":-1,postroll:-2,"post-roll":-2},TAB_STATE:{focus:0,blur:1,tabOut:2},DFP_KEYWORDS:["google","dfp","gpt"],MIME_TYPES:{1:"video/mp4",5:"video/webm",7:"video/ogg",10:"video/mp4",11:"video/ogg",12:"video/webm"},SUB_UNIT_TYPE:{FEED:0,SLIDER_TO_FEED:1,FEED_TO_SLIDER:2,SLIDER_TO_FEED_TO_SLIDER:3,INLINE_SINGLE_SELECTOR:4,INLINE_MULTI_SELECTOR:5,FEED_STICKY_BELOW:6,FEED_STICKY_ABOVE:7,FEED_STICKY_BELOW_ABOVE:8,WIDGET:9,WIDGET_TO_SLIDER:10},FEED_SELECTOR:"tbl-feed-container",AD_CHOICE_TYPE:{TITLE:"title",VIDEO_AD:"videoAd",SLIDER:"slider"},REPLAY_AD_CLICK:{ALL:"all",RESTART_PLAYER:"restartPlayer"},DISPLAY_FILLER:{BEFORE_AD:{NONE:"none",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},BETWEEN_ADS:{LOADING:"loading",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},ON_TIMEOUT:{CLOSE:"close",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"}},TITLE_POSITION:{ABOVE:"above",BELOW:"below"},KIBANA_EVENTS:{start:"start",renderWasCalled:"renderWasCalled",getAd:"getAd",getAdFailed:"getAdFailed",gotAd:"gotAd",adPlay:"adPlay",conversion:"conversion",adPaused:"adPaused",viewability:"viewability",continueAd:"continueAd",adComplete:"adComplete",firstEligibility:"firstEligibility",unitCloseByUser:"unitCloseByUser",unitClosedByMidRollTimeOut:"unitClosedByMidRollTimeOut",attach:"attach",detach:"detach",topParentSelectorLost:"topParentSelectorLost",playerWidthLost:"playerWidthLost",playerHeightLost:"playerHeightLost",invalidCDBobject:"invalidCDBobject",rvHandlerState:"rvHandlerState",playerHasRvInQ:"playerHasRvInQ",rvHandlerTimerExpired:"rvHandlerTimerExpired",D2DClick:"D2DClick"},DEBUG_DATA:{pn:"pn",sqg:"sqg",sqv:"sqv",rv:"rv",sqp:"sqp",rvps:"rvps",rvvs:"rvvs",pps:"pps",ppsc:"ppsc",vms:"vms",gpps:"gpps",gppsc:"gppsc",ft:"ft",fsc:"fsc",fpc:"fpc",sa:"sa",pi:"pi",dt:"dt",vb:"vb",dur:"dur"},DEBUG_DATA_PIXELS:{ft:"ft",fsc:"fsc",fpc:"fpc"},PREDICT_NAMES:{distancePercentPredict:0,distancePixelsPredict:1,getAdFailPredict:2,loadingPredict:3,multiAdPredict:4,playerReadyPredict:5,repeatPredict:6,autoKillPredict:7,firstScrollPredict:8,emptyQueuePredict:9,bForcePredict:10,intersectionPredict:11,fullEligibilityPredict:12,feedXPredict:13,adProgressionAfterBeginPredict:14,adProgressionBeforeEndPredict:15,feedContainerChangedPredict:16},ANIMATION_TYPE:{none:0,attaching:1,detaching:2,expanding:3,collapsing:4},FLOATING_VIEW_TOP_COMPONENT:{video:0,loading:1,repeat:2,d2d:3,content:4},FRAME_TYPE:{plainPage:0,friendlyIframe:1,nonFriendlyIframe:2,amp:3,inApp:4},CHECK_FOR_RV_PRIORITY:{onEligibility:"hasReachedEligibility",pixelsFromSelector:"hasReachedPixelsFromSelector",intersectionPercent:"intersectionPercent",beforeLoaderEnd:"beforeLoaderEnd"},TIMER_NAMES:{viewability:"viewability",viewabilityOneS:"viewabilityOneS",viewability100:"viewability100"},AD_STATUS:{new:0,adLoaded:1,startAd:2,adImpression:3,adPlay:4,adError:5,adComplete:6},GENERAL_ERROR:{1:"empty data from player"},CSS_PROPERTIES_FROM_RBOX:["font","@font-face","font-family","font-feature-settings","@font-feature-values","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","line-break","line-height","outline","outline-color","outline-offset","outline-style","outline-width","text-decoration-line","text-underline-position","padding","padding-bottom","padding-left","padding-right","padding-top","margin","margin-bottom","margin-left","margin-right","margin-top","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","text-transform","z-index","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-indent","text-justify","text-orientation","text-overflow","text-shadow","text-transform","text-underline-position","direction","color"]
}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(16),a=n(r),l=i(10),d=n(l),c=i(8),u=n(c),h=function(){function e(t,i,n){o(this,e),this.conf=t,this.log=new a.default({unitType:"Manager",className:"ScrollManager",version:this.conf.version,isDebug:this.conf.isDebug}),this.log.info("Created"),this.window=i||window,this.$window=(0,d.default)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.scrollElement=u.default.isEmpty(n)?this.window:(0,d.default)(n)[0],this.$scrollElement=(0,d.default)(this.scrollElement),this.timeBetweenEvents=100,this.lastTimeStamp=0,this.lastScrollTop=0,this.pps=0,this.ppsChange=0,this.vms=1/0,this.direction=1,this.maxMSBetweenEvents=2e3,this.scrollEndTimeout=500;var s=u.default.throttle(this.onScroll.bind(this),this.timeBetweenEvents);this.scrollElement.addEventListener("scroll",s)}return s(e,[{key:"onScroll",value:function(e){clearTimeout(this.scrollEnd);var t=e.timeStamp-this.lastTimeStamp;this.lastTimeStamp=e.timeStamp;var i=this.$scrollElement.scrollTop()-this.lastScrollTop;this.lastScrollTop=this.$scrollElement.scrollTop(),i<0?this.direction=-1:this.direction=1,t<this.maxMSBetweenEvents&&this.changePPS(i/t*1e3),u.default.parseBool(this.conf.isLogScroll)&&this.log.info("onScroll - pps: "+this.direction*this.pps),this.scrollEnd=setTimeout(this.onScrollEnd.bind(this),this.scrollEndTimeout)}},{key:"onScrollEnd",value:function(){u.default.parseBool(this.conf.isLogScroll)&&this.log.warning("onScrollEnd"),this.changePPS(0),u.default.forEach(this.onScrollEndCBList,function(e){e()}.bind(this))}},{key:"changePPS",value:function(e){this.ppsChange=e-this.pps,this.pps=e,0===this.pps&&(this.vms=1/0),this.vms=this.windowHeight/this.pps*1e3,u.default.forEach(this.onScrollPPSChange,function(e){setTimeout(e,0)})}},{key:"registerForPPSChange",value:function(e){this.onScrollPPSChange=this.onScrollPPSChange||[];var t=this.onScrollPPSChange.indexOf(e);return t!==-1?t:this.onScrollPPSChange.push(e)-1}},{key:"deRegisterForPPSChange",value:function(e){var t=this.onScrollPPSChange.indexOf(e);this.onScrollPPSChange.splice(t,1)}},{key:"registerForScrollEnd",value:function(e){this.onScrollEndCBList=this.onScrollEndCBList||[];var t=this.onScrollEndCBList.indexOf(e);return t!==-1?t:this.onScrollEndCBList.push(e)-1}},{key:"deRegisterForScrollEnd",value:function(e){var t=this.onScrollEndCBList.indexOf(e);this.onScrollEndCBList.splice(t,1)}}]),e}(),p=function(){var e=void 0;return function(t,i,n){return e||(e=new h(t,i,n)),e}}();e.exports=p},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(16),h=o(u),p=i(12),f=i(26),m=o(f),g=i(25),v=o(g),y=i(21),b=n(y),_=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.model));return i.model=e.model,i.subModel=e.subModel,i.adData=e.adData||{},i.scrollManager=new m.default,i.onDebugDataChange=e.onDebugDataChange,i.log=new h.default({unitType:i.model.get("unitType"),className:"DebugData",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.isViewed=e.isViewed,e.onDebugDataChange&&(i._onDebugChange(),i._bindEvents()),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"sqv",funcName:"_onDebugChange"},{event:"conversionCount",funcName:"_onDebugChange"},{event:"rvvs1",funcName:"_onDebugChange"},{event:"rvvs0",funcName:"_onDebugChange"},{event:"rvps1",funcName:"_onDebugChange"},{event:"rvps0",funcName:"_onDebugChange"}])}},{key:"_onDebugChange",value:function(){this.onDebugDataChange(this.getDebugData())}},{key:"getDebugData",value:function(){if(this.model.get("isSendDebugDataReporting")){var e="";for(var t in v.default.DEBUG_DATA){var i=this[t]();e+="undefined"!=typeof i?v.default.DEBUG_DATA[t]+":"+i+"!":v.default.DEBUG_DATA[t]+":!"}return e}}},{key:"pn",value:function(){return v.default.PREDICT_NAMES[this.adData.pn]}},{key:"sqg",value:function(){return this.adData.adId}},{key:"sqv",value:function(){return this.model.get("sqv")}},{key:"sqp",value:function(){if(this.model.get("conversionCount"))return parseInt(this.model.get("conversionCount"))}},{key:"rv",value:function(){return this.isRv()?1:0}},{key:"rvvs",value:function(){return this.isRv()?this.model.get("rvvs1"):this.model.get("rvvs0")}},{key:"rvps",value:function(){return this.isRv()?this.model.get("rvps1"):this.model.get("rvps0")}},{key:"ppsc",value:function(){return parseInt(this.scrollManager.ppsChange)}},{key:"vms",value:function(){var e=this.scrollManager.vms;return e=e!==1/0?parseInt(e):"inf"}},{key:"pps",value:function(){return parseInt(this.scrollManager.pps)}},{key:"gpps",value:function(){return parseInt(this.adData.getAdPPS)}},{key:"gppsc",value:function(){return parseInt(this.adData.getAdPPSChange)}},{key:"isRv",value:function(){return c.default.parseBool(this.adData.requiredViewability)}},{key:"ft",value:function(){return this.model.get("frameType")}},{key:"fsc",value:function(){var e=this.model.get("startCard");if("undefined"!=typeof e&&""!==e)return parseInt(e)}},{key:"fpc",value:function(){var e=this.model.get("permanentCard");if("undefined"!=typeof e&&""!==e)return parseInt(e)}},{key:"sa",value:function(){var e=this.subModel||this.model;return e&&e.get("isPlacementSingleAd")?1:0}},{key:"pi",value:function(){return this.model.get("MSNCard.placementIndex")}},{key:"dt",value:function(){var e=this.subModel||this.model;if(!e.get("videoViewState"))return 0;var t=e.get("videoViewState")===b.videoViewState.detached;return t?1:0}},{key:"vb",value:function(){return this.isViewed?1:0}},{key:"dur",value:function(){var e=this.subModel||this.model,t=parseInt(e.get("activeAdMaxTime"));return t||(t=void 0),t}}]),t}(p.StateManager);e.exports=_},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(12),u=i(29),h=n(u),p=i(8),f=n(p),m=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.model=e.model||{},i.log=new d.default({unitType:i.model.get("unitType"),className:constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.configHierarchy=i._getConfigHierarchy(),i}return r(t,e),a(t,[{key:"_getConfigHierarchy",value:function(){return f.default.sortBy(h.default,function(e){return e.priority}).reverse()}},{key:"getConfig",value:function(e){var t={};for(var i in this.configHierarchy){var n=this.configHierarchy[i].name,o=e[n],s=h.default[n];o&&s&&(this.log.info("creating config for",n),f.default.extend(t,this._getDefaultConfig(n)),f.default.extend(t,this._getUnitConfig(n)))}return t}},{key:"getConfigForKey",value:function(e){var t={},i=h.default[e]&&h.default[e].name;return i&&(this.log.info("creating config for",i),f.default.extend(t,this._getDefaultConfig(i)),f.default.extend(t,this._getUnitConfig(i))),t}},{key:"_getDefaultConfig",value:function(e){var t=h.default[e].defaultConfigFile;return this.loadFile(t)}},{key:"_getUnitConfig",value:function(e){var t=this.model.get("unitType"),i=h.default[e]&&h.default[e].unitsConfigFiles,n=i&&i[t];return this.loadFile(n)}},{key:"loadFile",value:function(e){if(e)return i(30)(e)}}]),t}(c.StateManager),g=function(){var e=void 0;return function(t){return e||(e=new m(t)),e}}();e.exports=g},function(e,t){"use strict";var i={singleAd:{name:"singleAd",priority:1,defaultConfigFile:"./SingleAd/DefaultSingleAdConfig",unitsConfigFiles:{FEED_MANAGER:"./SingleAd/units/SingleAdFeedManagerConfig",FEED_MANAGER_MOBILE:"./SingleAd/units/SingleAdFeedManagerConfig",WIDGET_ITEM:"./SingleAd/units/SingleAdWidgetItemConfig",WIDGET_ITEM_MOBILE:"./SingleAd/units/SingleAdWidgetItemConfig"}},rv:{name:"rv",priority:3},adjacency:{name:"adjacency",priority:2,defaultConfigFile:"./Adjacency/DefaultAdjacencyConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Adjacency/units/AdjacFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Adjacency/units/AdjacFeedManagerConfig.js",WIDGET_ITEM:"./Adjacency/units/AdjacencyWidgetItemConfig",WIDGET_ITEM_MOBILE:"./Adjacency/units/AdjacencyWidgetItemConfig"}},replayable:{name:"replayable",defaultConfigFile:"./Replayable/DefaultReplayableConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Replayable/units/ReplayableAdFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Replayable/units/ReplayableAdFeedManagerConfig.js"},priority:4}};e.exports=i},function(e,t,i){function n(e){return i(o(e))}function o(e){return s[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var s={"./AdTypeConfig":29,"./AdTypeConfig.js":29,"./AdTypeTranslator":28,"./AdTypeTranslator.js":28,"./Adjacency/DefaultAdjacencyConfig":31,"./Adjacency/DefaultAdjacencyConfig.js":31,"./Adjacency/units/AdjacFeedManagerConfig":32,"./Adjacency/units/AdjacFeedManagerConfig.js":32,"./Adjacency/units/AdjacencyWidgetItemConfig":33,"./Adjacency/units/AdjacencyWidgetItemConfig.js":33,"./Replayable/DefaultReplayableConfig":34,"./Replayable/DefaultReplayableConfig.js":34,"./Replayable/units/ReplayableAdFeedManagerConfig":35,"./Replayable/units/ReplayableAdFeedManagerConfig.js":35,"./SingleAd/DefaultSingleAdConfig":36,"./SingleAd/DefaultSingleAdConfig.js":36,"./SingleAd/units/SingleAdFeedManagerConfig":37,"./SingleAd/units/SingleAdFeedManagerConfig.js":37,"./SingleAd/units/SingleAdWidgetItemConfig":38,"./SingleAd/units/SingleAdWidgetItemConfig.js":38};n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id=30},function(e,t){"use strict";var i={};e.exports=i},function(e,t){"use strict";var i={setAdConfigAfter:"onAdSetToUnits",revertAfter:"setSubModel",isNeedAdjacCard:!0,adjacCardPlacement:1};e.exports=i},function(e,t){"use strict";var i={setAdConfigAfter:"onAdSetToUnits",isTakeoverWidget:!0,isForceDontDie:!0,"detachToSlider.isDetachToSlider":!1};e.exports=i},function(e,t){"use strict";var i={};e.exports=i},function(e,t){"use strict";var i={setAdConfigAfter:"setSubModel",isReplayable:!0};e.exports=i},function(e,t){"use strict";var i={};e.exports=i},function(e,t){"use strict";var i={setAdConfigAfter:"setSubModel",isPlacementSingleAd:!0,"detachToSlider.isDetachToSlider.singleAd":!1,"continueToPlayInNexCard.isActive":!1};e.exports=i},function(e,t){"use strict";var i={setAdConfigAfter:"onAdSetToUnits",stopPredicts:!0,isKeepViewOnMidroll:!0,isKeepUnitOnMidroll:!0,isPlacementSingleAd:!0,isMultiAd:!1,isReplayAd:!0,isPreventNextAd:!0};e.exports=i},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(21),h=n(u),p=i(8),f=o(p),m=i(40),g=i(12),v=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new c.default({unitType:i.model.get("unitType"),className:"seerService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.activePredict={},i._createPlayerReadyPredict(),i._createRequestedPredictors(),i}return a(t,e),l(t,[{key:"multiAd",value:function(){this.activePredict.multiAd||(this.activePredict.multiAd=[]);var e=this.model.get("predictors.multiAd.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"qState",predictArr:this.activePredict.multiAd,predict:m.multiAdPredict})}},{key:"emptyQueue",value:function(){this.activePredict.emptyQueue=this._createPredict(m.emptyQueuePredict,this.getAdProperties("emptyQueue"))}},{key:"getAdFail",value:function(){this.activePredict.getAdFailPredict=this._createPredict(m.getAdFailPredict,this.getAdProperties("getAdFail"))}},{key:"repeat",value:function(){this.activePredict.repeatPredict=this._createPredict(m.repeatPredict,this.getAdProperties("repeat"))}},{key:"loading",value:function(){this.activePredict.loadingPredict=this._createPredict(m.loadingPredict,this.getAdProperties("loading"))}},{key:"autoKill",value:function(){this.activePredict.autoKillPredict=this._createPredict(m.autoKillPredict,this.getAdProperties("autoKill"))}},{key:"fullEligibility",value:function(){this.activePredict.fullEligibilityPredict=this._createPredict(m.fullEligibilityPredict,this.getAdProperties("fullEligibility"))}},{key:"bForce",value:function(){this.activePredict.bForcePredict=this._createPredict(m.bForcePredict,this.getAdProperties("bForce"))}},{key:"distancePercent",value:function(){this.activePredict.distancePercent||(this.activePredict.distancePercent=[]);var e=this.model.get("predictors.distancePercent.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"requirePercentageToSelector",predictArr:this.activePredict.distancePercent,predict:m.distancePercentPredict})}},{key:"distancePixels",value:function(){this.activePredict.distancePixels||(this.activePredict.distancePixels=[]);var e=this.model.get("predictors.distancePixels.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"pixelsFromSelectors",predictArr:this.activePredict.distancePixels,predict:m.distancePixelsPredict})}},{key:"firstScroll",value:function(){this.activePredict.firstScrollPredict=this._createPredict(m.firstScrollPredict,this.getAdProperties("firstScroll"))}},{key:"feedX",value:function(){this.activePredict.feedXPredict=this._createPredict(m.feedXPredict,this.getAdProperties("feedX"))}},{key:"feedContainerChanged",value:function(){this.activePredict.feedContainerChanged=this._createPredict(m.feedContainerChangedPredict,this.getAdProperties("feedContainerChanged"))}},{key:"intersection",value:function(){this.activePredict.intersectionPredict||(this.activePredict.intersectionPredict=[]);var e=this.model.get("predictors.intersection.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"intersectionPercent",predictArr:this.activePredict.intersectionPredict,predict:m.intersectionPredict})}},{key:"adProgressionAfterBegin",value:function(){this.activePredict.adProgressionAfterBeginPredict||(this.activePredict.adProgressionAfterBeginPredict=[]);var e=this.model.get("predictors.adProgressionAfterBegin.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"secondsAfterBegin",predictArr:this.activePredict.adProgressionAfterBeginPredict,predict:m.adProgressionAfterBeginPredict})}},{key:"adProgressionBeforeEnd",value:function(){this.activePredict.adProgressionBeforeEndPredict||(this.activePredict.adProgressionBeforeEndPredict=[]);var e=this.model.get("predictors.adProgressionBeforeEnd.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"secondsBeforeEnd",predictArr:this.activePredict.adProgressionBeforeEndPredict,predict:m.adProgressionBeforeEndPredict})}},{key:"_createPlayerReadyPredict",value:function(){this.model.get("predictors.playerReady")&&this.model.get("predictors.playerReady.isActive")&&(this.activePredict.playerPredict=this._createPredict(m.playerReadyPredict,this.getAdProperties("playerReady")))}},{key:"onPredict",value:function(e,t,i){this.model.get("stopPredicts")||(this.model.set("nextPredictName",t),this.model.set("nextPredict",e),this.model.set("nextAdProperties",i),this.model.increaseCounter("predictCounter"))}},{key:"startWF",value:function(){this.model.set("startWF",!0)}},{key:"_createRequestedPredictors",value:function(){if(this.model.get("playerState")!==h.readyState)return void this.model.listenToOnce(this.model,"change:playerState",this._createRequestedPredictors.bind(this));var e=this,t=this.model.get("predictors"),i=Object.keys(t);i.forEach(function(i){var n=t[i];n&&e[i]&&(n.isActive||n.isStartWF)&&e[i].call(e)})}},{key:"_createMultiPointPredict",value:function(e){var t=this,i=e.predictPoints,n=e.pointKey,o=e.predictArr,s=e.predict;f.default.each(i,function(e,i){o.push(t._createPredict(s,{predictPoint:e[n],predictKey:void 0!==e.key?e.key:i,adProperties:{adProperties:e.adProperties,excAdProperties:e.excAdProperties}}))})}},{key:"_createPredict",value:function(e,t){return f.default.extend(t,{model:this.model,onPredict:this.onPredict,startWfFunc:this.startWF}),new e(t)}},{key:"getAdProperties",value:function(e){return{adProperties:{adProperties:this.model.get("predictors."+e+".adProperties"),excAdProperties:this.model.get("predictors."+e+".excAdProperties")}}}}]),t}(g.StateManager);e.exports=v},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.feedContainerChangedPredict=t.timePredict=t.adProgressionBeforeEndPredict=t.adProgressionAfterBeginPredict=t.baseDistancePredict=t.feedXPredict=t.bForcePredict=t.intersectionPredict=t.fullEligibilityPredict=t.emptyQueuePredict=t.firstScrollPredict=t.autoKillPredict=t.repeatPredict=t.playerReadyPredict=t.multiAdPredict=t.loadingPredict=t.getAdFailPredict=t.distancePixelsPredict=t.distancePercentPredict=t.basePredict=void 0;var o=i(41),s=n(o),r=i(42),a=n(r),l=i(43),d=n(l),c=i(46),u=n(c),h=i(47),p=n(h),f=i(48),m=n(f),g=i(49),v=n(g),y=i(50),b=n(y),_=i(51),w=n(_),T=i(52),A=n(T),S=i(53),P=n(S),C=i(54),E=n(C),k=i(55),I=n(k),O=i(56),V=n(O),x=i(45),D=n(x),M=i(57),R=n(M),N=i(58),L=n(N),F=i(59),B=n(F),j=i(61),U=n(j),H=i(62),W=n(H);t.basePredict=s.default,t.distancePercentPredict=d.default,t.distancePixelsPredict=u.default,t.getAdFailPredict=p.default,t.loadingPredict=m.default,t.multiAdPredict=v.default,t.playerReadyPredict=b.default,t.repeatPredict=w.default,t.autoKillPredict=a.default,t.firstScrollPredict=A.default,t.emptyQueuePredict=P.default,t.fullEligibilityPredict=E.default,t.intersectionPredict=V.default,t.bForcePredict=I.default,t.feedXPredict=R.default,t.baseDistancePredict=D.default,t.adProgressionAfterBeginPredict=U.default,t.adProgressionBeforeEndPredict=B.default,t.timePredict=W.default,t.feedContainerChangedPredict=L.default},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(12),h=i(16),p=o(h),f=i(21),m=(n(f),function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.model));return i.model=e.model,i.onPredict=e.onPredict,i.adProperties=e.adProperties,i.currentKey=0,i.log=new p.default({unitType:i.model.get("unitType"),className:"basePredictService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i._bindEvents(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){}},{key:"_setCuerrentKey",value:function(e){this.currentKey=c.default.last(e.split(".")),this.model.set("adsManagerLastPredictKey",this.currentKey)}},{key:"_predicted",value:function(e){return this.model.set("lastPredictPoint",e),this.model.set("lastPredictPath",this.predictPath),this.model.get(this.predictPath+".isStartWF")&&this.startWf&&(this.log.info("startWF predicted"),this.startWf()),this._checkIsGet1OnlyOnAdLoaded()&&1===parseInt(e)&&!this.model.get("playerHasRvInQ")?(this.log.warning("no rv=1 in adLoaded skipping predict"),void this.model.set("isSkippedDistancePredict",!0)):void(this.predictPath&&!this.model.get(this.predictPath+".isActive")||(this._logPredict(e),this.onPredict(e,this.log.className,this.adProperties)))}},{key:"_checkIsGet1OnlyOnAdLoaded",value:function(){var e=this.model.get("predictors.isGet1OnlyAfterAdLoaded");return this.predictPath&&void 0!==this.model.get(this.predictPath+".isGet1OnlyAfterAdLoaded")&&(e=this.model.get(this.predictPath+".isGet1OnlyAfterAdLoaded")),e}},{key:"_logPredict",value:function(e){var t="predicted with key: "+e;this.adProperties?this.log.info(t+" with properties: ",this.adProperties):this.log.info(t)}}]),t}(u.StateManager));e.exports=m},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(41),h=o(u),p=i(21),f=(n(p),function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new c.default({unitType:i.model.get("unitType"),className:"autoKillPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint="predictors.autoKill.predictPoint",i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adState:autoKill",funcName:"_onAutoKillPredict"}])}},{key:"_onAutoKillPredict",value:function(){setTimeout(this._predicted.bind(this,this.model.get("lastAutoKilledPredict")),0)}}]),t}(h.default));e.exports=f},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(10),d=n(l),c=i(8),u=n(c),h=i(11),p=(n(h),i(16)),f=n(p),m=i(41),g=(n(m),i(44)),v=i(45),y=n(v),b=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new f.default({unitType:i.model.get("unitType"),className:"distancePercentPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.distancePercent",i.maxPPS=i.model.get("predictors.distancePercent.maxPPS"),i.utils=(0,g.distancePredictorUtils)(i,i.model),i._initPredict(e),i}return r(t,e),a(t,[{key:"_calcPredict",value:function(){if(!this.isPredicted){var e=(0,d.default)(this.model.get("scrollSelector"))[0],t=void 0!==e,i=t?e.clientHeight:window.innerHeight,n=t?i+e.scrollTop:i+window.pageYOffset,o=this.predictPoint||1,s=100/o,r=u.default.getTopOfEl(this.parentSelector),a=r+this.model.get("height")/(100/this.model.get("viewPercent")||1),l=i+(a-i)/s;this.model.get("logViewabilityCalc")&&this.log.info("\ntopParentSelector: "+r+",\neligibilityPoint: "+a+",\nstartPoint: "+i+",\nbottomViewPort: "+n+",\npredictionPoint: "+l+",\ncalc: predictionPoint <= bottomViewPort: "+(l<=n)),l<=n?(this.model.set("distancePercentPredictData",{topParentSelector:r,bottomViewPort:n,eligibilityPoint:a,startPoint:i,predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this._onDistancePredicted(this.predictKey)):this._bindEvents()}}}]),t}(y.default);e.exports=b},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.distancePredictorUtils=void 0;var o=i(8),s=n(o),r=i(10),a=n(r);t.distancePredictorUtils=function(e,t){e.model=t,e.parentSelectorStr=void 0,e.model.get("permanentCard")?e.parentSelectorStr='[data-card-index="'+e.model.get("permanentCard")+'"]':e.model.get("startCard")>1?e.parentSelectorStr='[data-card-index="'+e.model.get("startCard")+'"]':e.model.get("predictors.isUseWidgetSelector")?e.parentSelectorStr=e.model.get("widgetSelector"):e.parentSelectorStr=e.model.get("parentSelector");var i=function(){if(e.parentSelectorStr){var t=e.parentSelectorStr.toString(),i=(0,a.default)(t);if(e.model.get("predictors.isNeedValidateParentSelector")){var n=s.default.getValidSelectorElements(i);return n[0]}return i[0]}},n=function(){var t=e.model.get(e.predictPoints);s.default.each(t,function(t,i){e._calcPredict(t,i)})};return{getParentSelector:i,calcPredicts:n}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(10),d=(n(l),i(8)),c=(n(d),i(11)),u=n(c),h=i(16),p=n(h),f=i(41),m=n(f),g=i(44),v=i(26),y=n(v),b=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new p.default({unitType:i.model.get("unitType"),className:"baseDistancePredicts",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i}return r(t,e),a(t,[{key:"_initPredict",value:function(e){this.predictPoint=e.predictPoint,this.predictKey=e.predictKey,this.startWf=e.startWfFunc,this.utils=(0,g.distancePredictorUtils)(this,this.model),this.scrollManager=new y.default,this._setParentSelector()}},{key:"_setParentSelector",value:function(){if(!this.isSelectorFound){var e=this.utils.getParentSelector();e?(this.isSelectorFound=!0,this.parentSelector=e,this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._calcPredict()):(this.log.info("no parentSelector can't predict distance waiting for parentSelector"),u.default.once("window:scroll:change",this._setParentSelector.bind(this)),this.model.listenToOnce(this.model,"change:parentSelector",this._setParentSelector.bind(this)))}}},{key:"_bindEvents",value:function(){this.parentSelector&&u.default.once("window:scroll:change",this._calcPredict.bind(this))}},{key:"_calcPredict",value:function(){}},{key:"_onDistancePredicted",value:function(e){return this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS?(this.log.warning("Distance Predicted, speed is too high",this.scrollManager.pps),void this.model.set("isSkippedDistancePredict",!0)):(this.log.warning("Distance Predicted, speed is OK",this.scrollManager.pps),void this._predicted(e))}}]),t}(m.default);e.exports=b},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(10),d=(n(l),i(8)),c=n(d),u=i(11),h=(n(u),i(16)),p=n(h),f=(i(44),i(45)),m=n(f),g=function(e){function t(e){
o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new p.default({unitType:i.model.get("unitType"),className:"distancePixelsPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.distancePixels",i.maxPPS=i.model.get("predictors.distancePixels.maxPPS"),i._initPredict(e),i}return r(t,e),a(t,[{key:"_calcPredict",value:function(){if(!this.isPredicted){var e=c.default.hasPassedPixelFromSelector(this.parentSelectorStr,this.model.get("scrollSelector"),this.predictPoint,this.model.get("predictors.isNeedValidateParentSelector"));e?(this.model.set("distancePixelPredictData",{predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this._onDistancePredicted(this.predictKey)):this._bindEvents()}}}]),t}(m.default);e.exports=g},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(41),h=o(u),p=i(21),f=(n(p),i(8)),m=o(f),g=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new c.default({unitType:i.model.get("unitType"),className:"getAdFailPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.allowedPredictPoints="predictors.getAdFail.allowedPredictPoints",i.keysToPredict=i.model.get(i.allowedPredictPoints),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"getAdState:failed",funcName:"_onFailedToGetAd"}])}},{key:"_onFailedToGetAd",value:function(){var e=this.model.get("lastFailedPredict");this._shouldPredict(e)&&(this.adProperties=this.model.get("lastFailedPredictProperties"),setTimeout(this._predicted.bind(this,this.model.get("lastFailedPredict")),200))}},{key:"_shouldPredict",value:function(e){var t=!1;return t=Array.isArray(this.keysToPredict)?m.default.contains(this.keysToPredict,e):"any"===this.keysToPredict.toString()||this.keysToPredict===e}}]),t}(h.default);e.exports=g},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(41),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new d.default({unitType:i.model.get("unitType"),className:"loadingPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint="predictors.loading.predictPoint",i.predictKey=i.model.get("predictors.loading.predictPoints"),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"playerState:restarted",funcName:"_onLoadingClick"}])}},{key:"_incrementAd",value:function(){var e=this.model.get("predictors.loading.counterAd");e=e?++e:1,this.model.set("predictors.loading.counterAd",e)}},{key:"_onLoadingClick",value:function(){this._predicted(this.predictKey)}}]),t}(u.default);e.exports=h},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(41),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new d.default({unitType:i.model.get("unitType"),className:"multiAdPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.adQState=e.predictPoint,i.predictKey=e.predictKey,i.predictPath="predictors.multiAd",i._bindPredictAdQState(),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){}},{key:"_bindPredictAdQState",value:function(){var e=this.adQState;this.createStateHandlers([{event:"adQState:"+e,funcName:"_onPredictPoint"}])}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.predictKey)}}]),t}(u.default);e.exports=h},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=(o(d),i(8)),u=(o(c),i(11)),h=(o(u),i(16)),p=o(h),f=i(21),m=(n(f),i(41)),g=o(m),v=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new p.default({unitType:i.model.get("unitType"),className:"playerReadyPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.playerReady",i.startWf=e.startWfFunc,i.predictKey=i.model.get(i.predictPath+".predictPoint"),i.predictPoint=i.predictPath+".predictPoint",i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){"ready"===this.model.get("playerState")?this._onPlayerReady():this.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerReady",isListenOnce:!0}])}},{key:"_onPlayerReady",value:function(){this._predicted(this.predictKey)}}]),t}(g.default);e.exports=v},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=(o(d),i(8)),u=(o(c),i(11)),h=(o(u),i(16)),p=o(h),f=i(21),m=(n(f),i(41)),g=o(m),v=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new p.default({unitType:i.model.get("unitType"),className:"repeatPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint="predictors.repeat.predictPoint",i.predictKey=i.model.get("predictors.repeat.predictPoints"),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"repeatState:spinning",funcName:"_onRepeatSpinning"}])}},{key:"_incrementAd",value:function(){var e=this.model.get("predictors.repeat.counterAd");e=e?++e:1,this.model.set("predictors.repeat.counterAd",e)}},{key:"_allowPredict",value:function(){return!this.model.get("isMultiAd")}},{key:"_onRepeatSpinning",value:function(){this._allowPredict&&this._predicted(this.predictKey)}}]),t}(g.default);e.exports=v},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(11),d=n(l),c=i(16),u=n(c),h=i(41),p=n(h),f=i(10),m=n(f),g=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new u.default({unitType:i.model.get("unitType"),className:"firstScrollPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.firstScroll",i.predictPoints=i.predictPath+".predictPoints",i.predictKey=i.model.get(i.predictPath+".predictPoints"),i.startWf=e.startWfFunc,i.isPredicted=!1,i.model.get("isEligibleToPlay")?i._callPredict():i._onFirstScroll(),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){d.default.once("window:scroll:change",this._onFirstScroll.bind(this)),this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_callPredict"}])}},{key:"_onFirstScroll",value:function(){if(!this.isPredicted){var e=window.pageYOffset,t=5,i=(0,m.default)(this.model.get("scrollSelector"))[0],n=void 0!==i;if(n){var o=i.clientHeight;e=o+i.scrollTop,t=o+5}t<=e?this._callPredict():this._bindEvents()}}},{key:"_callPredict",value:function(){this.isPredicted||(this.isPredicted=!0,this._predicted(this.predictKey))}}]),t}(p.default);e.exports=g},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(41),h=o(u),p=i(21),f=n(p),m=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new c.default({unitType:i.model.get("unitType"),className:"emptyQueuePredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i._bindEmptyQueuePredict(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){}},{key:"_bindEmptyQueuePredict",value:function(){this.createStateHandlers([{event:"adManagerState:"+f.adManagerState.empty,funcName:"_onQEmpty"}])}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onQEmpty",value:function(){this.model.get("getAdState")!==f.getAdState.gettingAd&&this._onPredictPoint()}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.model.get("predictors.emptyQueue.predictPoints"))}}]),t}(h.default);e.exports=m},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=(o(d),i(8)),u=(o(c),i(11)),h=o(u),p=i(16),f=o(p),m=i(41),g=o(m),v=i(26),y=o(v),b=i(21),_=n(b),w=i(25),T=o(w),A=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new f.default({unitType:i.model.get("unitType"),className:"fullEligibilityPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint=e.predictPoint,i.predictKey=i.model.get("predictors.fullEligibility.predictPoints"),i.predictPath="predictors.fullEligibility",i.startWf=e.startWfFunc,i.hadGetAdRv=!1,i.maxPPS=i.model.get("predictors.fullEligibility.maxPPS"),i.scrollManager=new y.default,i._bindEvents(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.scrollManager&&(this.createStateHandlers([{event:"getAdState:"+_.getAdState.gettingAd,funcName:"_onGettingAd",isListenOnce:!0}]),this.model.get("frameType")===T.default.FRAME_TYPE.plainPage?(h.default.once("window:scroll:change",this._calcPredict.bind(this)),this.scrollManager.registerForScrollEnd(this._calcPredict.bind(this))):this.calcPredictInterval=setInterval(this._calcPredict.bind(this),1e3*this.model.get("predictors.fullEligibility.checkPredictsSeconds")))}},{key:"_onGettingAd",value:function(){return 1===this.model.get("lastGetAdKey")?void(this.hadGetAdRv=!0):void this.createStateHandlers([{event:"getAdState:"+_.getAdState.gettingAd,funcName:"_onGettingAd",isListenOnce:!0}])}},{key:"_calcPredict",value:function(){this.hadGetAdRv||this.isPredicted||(this._canPredict()&&this.maxPPS&&Math.abs(this.scrollManager.pps)<this.maxPPS?(this.isPredicted=!0,this.calcPredictInterval&&(clearInterval(this.calcPredictInterval),this.calcPredictInterval=void 0),this.model.set("fullEligibilityPredicted",!0),this._predicted(this.predictKey)):h.default.once("window:scroll:change",this._calcPredict.bind(this)))}},{key:"_canPredict",value:function(){var e=this.model.get("adState")===_.adState.playing,t=this.model.get("isEligibleToPlay")&&this.model.get("isSkippedDistancePredict")&&!e;return t&&this._checkIsGet1OnlyOnAdLoaded()&&(t=t&&this.model.get("playerHasRvInQ")),t}}]),t}(g.default);e.exports=A},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(41),h=o(u),p=i(21),f=(n(p),function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new c.default({unitType:i.model.get("unitType"),className:"bForcePredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint="predictors.bForce.predictPoints",i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"canGetRv:true",funcName:"_onCanGetRv"}])}},{key:"_onCanGetRv",value:function(){this._predicted(this.model.get(this.predictPoint))}}]),t}(h.default));e.exports=f},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(10),d=(n(l),i(8)),c=(n(d),i(11)),u=(n(c),i(16)),h=n(u),p=i(41),f=n(p),m=i(44),g=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new h.default({unitType:i.model.get("unitType"),className:"intersectionPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPoint=e.predictPoint,i.predictKey=e.predictKey,i.predictPath="predictors.intersection",i.startWf=e.startWfFunc,i.utils=(0,m.distancePredictorUtils)(i,i.model),i._setSelector(),i}return r(t,e),a(t,[{key:"_initObserver",value:function(){var e={rootMargin:"0px",threshold:[0,this.predictPoint/100]};this.observer=new IntersectionObserver(this._observerCallback.bind(this),e),this.observer.observe(this.parentSelector)}},{key:"_setSelector",value:function(){if(!this.isSelectorFound){var e=this.utils.getParentSelector();e?(this.isSelectorFound=!0,this.selectorTimeOut&&(clearTimeout(this.selectorTimeOut),this.selectorTimeOut=void 0),this.parentSelector=e,this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._initObserver()):(this.log.info("no parentSelector can't predict distance waiting for parentSelector"),this.model.listenToOnce(this.model,"change:parentSelector",this._setSelector.bind(this)),this.selectorTimeOut=setTimeout(this._setSelector.bind(this),1e3))}}},{key:"_observerCallback",value:function(e,t){if(!this.isPredicted){var i=100*e[0].intersectionRatio;i>=this.predictPoint&&(this.isPredicted=!0,this._predicted(this.predictKey),this.observer.disconnect())}}}]),t}(f.default);e.exports=g},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(41),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new d.default({unitType:i.model.get("unitType"),className:"feedXPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.feedX",i.predictPoints=i.predictPath+".predictPoints",i.predictKey=i.model.get(i.predictPath+".predictPoints"),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"feedxToggle",funcName:"_onFeedxToggle"}])}},{key:"_onFeedxToggle",value:function(){this.model.get("feedxToggle")%2===1&&this._predicted(this.predictKey)}}]),t}(u.default);e.exports=h},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(41),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new d.default({unitType:i.model.get("unitType"),className:constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.feedContainerChanged",i.predictPoints=i.predictPath+".predictPoints",i.predictKey=i.model.get(i.predictPath+".predictPoints"),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"feedContainerChanged",funcName:"_onFeedContainerChanged"}])}},{key:"_onFeedContainerChanged",value:function(){this._predicted(this.predictKey)}}]),t}(u.default);e.exports=h},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(60),d=n(l),c=i(16),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new u.default({unitType:i.model.get("unitType"),className:"adProgressionBeforeEndPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.adProgressionBeforeEnd",i._initPredict(e),i}return r(t,e),a(t,[{key:"_allowPredict",value:function(){if(this.isPredicted)return!1;var e=this.model.get("activeAdMaxTime"),t=this.model.get("activeAdCurrentTime");return!!(e&&t&&e-this.requestedTime<=t)&&(this.isPredicted=!0,this.model.increaseCounter("onadProgressionBeforeEndPredictPredict"),!0)}}]),t}(d.default);e.exports=h},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(41),c=o(d),u=i(16),h=o(u),p=i(21),f=(n(p),function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new h.default({unitType:i.model.get("unitType"),className:"baseAdProgressionPredicts",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i}return a(t,e),l(t,[{key:"_initPredict",value:function(e){this.requestedTime=e.predictPoint,this.predictKey=e.predictKey,this._bindPredictAdDuration()}},{key:"_bindPredictAdDuration",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_onPredictPoint"},{event:"lastActiveAd",funcName:"_onAdCompleted"}])}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.predictKey)}},{key:"_allowPredict",value:function(){}},{key:"_onAdCompleted",value:function(){this.isPredicted=!1}}]),t}(c.default));e.exports=f},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(60),d=n(l),c=i(16),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new u.default({unitType:i.model.get("unitType"),className:"adProgressionAfterBeginPredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.adProgressionAfterBegin",i._initPredict(e),i}return r(t,e),a(t,[{key:"_allowPredict",value:function(){if(this.isPredicted)return!1;var e=this.model.get("activeAdCurrentTime");return!!(e&&this.requestedTime<=e)&&(this.isPredicted=!0,this.model.increaseCounter("onadProgressionAfterBeginPredict"),!0)}}]),t}(d.default);e.exports=h},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(41),u=n(c),h=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new d.default({unitType:i.model.get("unitType"),className:"timePredict",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.predictPath="predictors.time",i.predictKey=i.model.get(i.predictPath+".predictPoints"),i.repeat=i.model.get(i.predictPath+".repeat"),i._bindTimePredict(),i._startPredictTimer(),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){}},{key:"_bindTimePredict",value:function(){this.createStateHandlers([{event:"time:"+this.predictPath,funcName:"_startPredictTimer"}])}},{key:"_allowPredict",value:function(){return this.model.get(this.predictPath+".isActive")||this.model.get("sync")}},{key:"_canRepeatPredict",value:function(){return this.repeat>0}},{key:"_canStartTimer",value:function(){return!this.stopped&&this._allowPredict()&&this._canRepeatPredict()}},{key:"_startPredictTimer",value:function(){var e=this;this._canStartTimer()&&(this.timer&&(this.timer=clearTimeout(this.timer)),this.log.info("Starting timer",this.predictKey),this.timer=setTimeout(function(){--e.repeat,e._predicted(e.predictKey),
e._startPredictTimer()},this.predictKey))}},{key:"stop",value:function(){this.log.info("Timer predict stopped"),this.timer=clearTimeout(this.timer),this.stopped=!0}}]),t}(u.default);e.exports=h},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(16),l=o(a),d=i(21),c=n(d),u=function(){function e(t,i,n,o){s(this,e),this.model=t,this.log=new l.default({unitType:this.model.get("unitType"),className:"timerService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.doneFunction=n||function(){},this.time=o||0,this.conditions=i||{startCondition:{stateToListen:"",state:""},pauseCondition:{stateToListen:"",state:""},continueCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:"",state:""},isStartOnce:!1},this._startListeningToConditions(),this.timerState=c.readyState}return r(e,[{key:"_startListeningToConditions",value:function(){this.conditions.startCondition&&(this.conditions.isStartOnce?this.model.listenToOnce(this.model,"change:"+this.conditions.startCondition.state,this.start.bind(this)):this.model.listenTo(this.model,"change:"+this.conditions.startCondition.state,this.start.bind(this))),this.conditions.pauseCondition&&this.model.listenTo(this.model,"change:"+this.conditions.pauseCondition.state,this.pause.bind(this)),this.conditions.continueCondition&&this.model.listenTo(this.model,"change:"+this.conditions.continueCondition.state,this.continue.bind(this)),this.conditions.stopCondition&&this.model.listenTo(this.model,"change:"+this.conditions.stopCondition.state,this.stop.bind(this))}},{key:"start",value:function(e,t){this.conditions.startCondition.stateToListen!==t&&"any"!==this.conditions.startCondition.stateToListen||(this.timerState=c.timerState.working,this.stTime=(new Date).valueOf(),this.timeout=setTimeout(this.done.bind(this),this.time),this.timeLeft=this.time)}},{key:"pause",value:function(e,t){if(this.timerState===c.timerState.working&&(!t||this.conditions.pauseCondition.stateToListen===t)){this.timerState=c.timerState.paused,this._clearTimer();var i=(new Date).valueOf()-this.stTime;this.timeLeft-=i}}},{key:"continue",value:function(e,t){this.timerState===c.timerState.paused&&(!t||t&&this.conditions.continueCondition.stateToListen===t)&&(this.timerState=c.timerState.working,this.timeout=setTimeout(this.done.bind(this),this.timeLeft),this.stTime=(new Date).valueOf())}},{key:"stop",value:function(e,t,i,n){this.timeout&&(n||this.conditions.stopCondition.stateToListen===t)&&(this.timerState=c.timerState.stopped,this._clearTimer())}},{key:"done",value:function(){this.timerState=c.timerState.done,this.doneFunction(),this.timeout=void 0}},{key:"getTimerState",value:function(){return this.timerState}},{key:"_clearTimer",value:function(){clearTimeout(this.timeout),this.timeout=void 0}},{key:"isTimerActive",value:function(){return this.timerState===c.timerState.working||this.timerState===c.timerState.paused}}]),e}();e.exports=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(12),u=i(10),h=n(u),p=i(65),f=n(p),m=i(25),g=n(m),v=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e.model,i.getAdCount=0,i.impressionCount=0,i.isFirstImpression=!0,i.isFirstPlay=!0,i.isFirstPauseAfterPlay=!0,i.isFirstisEligiblilty=!0,i.hadLostEligibility=!1,i.eventsToSend=i.model.get("kibanaEventsToSend")||"all",i.isDirty=!1,i.changesCount=0,i.totalData={_id:d.default.generateGuid(10),redId:i.model.get("redId")},i.startTime=i._getCurrentTime(),i._createAdsEvents(),i.kibanaAdsService=new f.default({model:i.model,startTime:i.startTime,predictors:i._parsePredicts(i.model.get("predictors"))}),i._start(),i._bindEvents(),i}return r(t,e),a(t,[{key:"_start",value:function(){this._saveDataToStorage(g.default.KIBANA_EVENTS.start,{isEligible:this.model.get("isEligibleToPlay")||!1,startTime:this.startTime,pageUrl:window.location.href,selector:this.model.get("parentSelector")?this.model.get("parentSelector").toString():"",predictors:this._parsePredicts(this.model.get("predictors")),viewPercent:this.model.get("viewPercent"),viewabilityPercent:this.model.get("viewabilityPercent"),creativeId:this.model.get("creativeId"),unitType:this.model.get("unitType"),abTest:this.model.get("abTest"),playerType:this.model.get("mobilePlayer"),playerVersions:this.model.get("player.versions"),urlPrefix:this.model.get("urlPrefix"),version:this.model.get("version"),vForce:this.model.get("vForce"),isInTab:this.model.get("isInTab"),detachToSlider:this.model.get("detachToSlider"),scrollSelector:this.model.get("scrollSelector"),isUseObserver:this.model.get("isUseObserver"),isUseObserverChanged:this.model.get("isUseObserverChanged"),documentReadyState:this.model.get("documentReadyState"),lineItemId:this.model.get("lineItemId"),isAMP:window.TRC&&window.TRC.isAMP,isEligibilityNomination:this.model.get("isEligibilityNomination")||!1,secondsToWaitForRV:this.model.get("secondsToWaitForRV")},!0)}},{key:"_bindEvents",value:function(){var e=[{event:"renderWasCalled:true",funcName:"_onRenderCalled"},{event:"getAdState:failed",funcName:"_getAdFailed"},{event:"isEligibleToPlay:true",funcName:"_onFirstEligibility"},{event:"closeState:closeButtonClicked",funcName:"_closeButtonClicked"},{event:"getAdState:stopped",funcName:"_unitClosedByMidRollTimeOut"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"},{event:"playerWidthLost:true",funcName:"_onLostPlayerSize"},{event:"playerHeightLost:true",funcName:"_onLostPlayerSize"},{event:"invalidCDBobject",funcName:"_onInvalidCDBobject"},{event:"playerHasRvInQ",funcName:"_onPlayerHasRvInQ"},{event:"rvHandlerState",funcName:"_onRvHandlerStateChange"},{event:"rvHandlerTimerExpired",funcName:"_onRvHandlerTimerExpired"}];this.createStateHandlers(e)}},{key:"_getCurrentTime",value:function(){return(new Date).getTime()}},{key:"_onRenderCalled",value:function(){this.renderCallTime=this._getCurrentTime();var e={isEligible:this.model.get("isEligibleToPlay"),timeFromAdImpression:this.renderCallTime-this.adImpressionTime,isInTab:this.model.get("isInTab")};this._saveDataToStorage(g.default.KIBANA_EVENTS.renderWasCalled,e)}},{key:"_getAdFailed",value:function(){this.getAdFailTime=this._getCurrentTime();var e={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:this.getAdFailTime-this.getAdTime,isInTab:this.model.get("isInTab"),width:this.model.get("width"),height:this.model.get("height")};this._saveDataToStorage(g.default.KIBANA_EVENTS.getAdFailed,e)}},{key:"getAdCalled",value:function(e){this.getAdCount++,this.getAdTime=this._getCurrentTime();var t=this._getTopParentSelector();t=t?t:-999;var i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.getAdTime-this.startTime,getAdCount:this.getAdCount,predictPointKey:"any"===e.getAdKey?10:e.getAdKey,predictName:e.predictName,isInTab:this.model.get("isInTab"),topParentSelector:t,adId:e.adId};this.model.get("distancePercentPredictData")&&"distancePercentPredict"===e.predictName&&d.default.extend(i,this.model.get("distancePercentPredictData")),this.model.get("distancePixelPredictData")&&"distancePixelsPredict"===e.predictName&&d.default.extend(i,this.model.get("distancePixelPredictData")),this._saveDataToStorage(g.default.KIBANA_EVENTS.getAd,i)}},{key:"gotAd",value:function(e){this.isFirstImpression=!1,this.adImpressionTime=this._getCurrentTime();var t=this._calcScrollPercentage(),i={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:this.adImpressionTime-this.getAdTime,scrollPercentageFromSelector:t.scrollPercentageFromSelector,bottomViewPort:t.bottomViewPort,topParentSelector:t.topParentSelector,isInTab:this.model.get("isInTab")};i.hadLostEligibility=!!this.model.get("lostEligibilityTime"),this.model.get("lostEligibilityTime")&&(i.timeFromLostEligibility=this.adImpressionTime-this.model.get("lostEligibilityTime")),this.playerHadRvInQTime&&this.model.get("gotRvAd")&&(i.timeFromPlayerHasRV=this.adImpressionTime-this.playerHadRvInQTime),e&&d.default.extend(i,e),this._saveDataToStorage(g.default.KIBANA_EVENTS.gotAd,i,!1),this.impressionCount++}},{key:"adPlaying",value:function(e){this.hadPlay=!0,this.adPlayingTime=this._getCurrentTime();var t={timeFromAdImpression:this.adPlayingTime-this.adImpressionTime,isInTab:this.model.get("isInTab"),isFirstPlay:this.isFirstPlay};e&&d.default.extend(t,e),this.isFirstPlay=!1,this._saveDataToStorage(g.default.KIBANA_EVENTS.adPlay,t)}},{key:"adPaused",value:function(e){if(this.hadPlay){this.adPausedAfterPlayTime=this._getCurrentTime();var t={timeFromAdPlay:this.adPausedAfterPlayTime-this.adPlayingTime,isInTab:this.model.get("isInTab"),pauseReason:e.pauseReason};e&&d.default.extend(t,e),this._saveDataToStorage(g.default.KIBANA_EVENTS.adPaused,t)}}},{key:"_onFirstEligibility",value:function(){if(this.isFirstisEligiblilty){this.isFirstisEligiblilty=!1,this.firstEligibilityTime=this._getCurrentTime();var e={timeFromStart:this.firstEligibilityTime-this.startTime};this._saveDataToStorage(g.default.KIBANA_EVENTS.firstEligibility,e)}}},{key:"_closeButtonClicked",value:function(){this._unitClose(g.default.KIBANA_EVENTS.unitCloseByUser)}},{key:"_unitClosedByMidRollTimeOut",value:function(){this._unitClose(g.default.KIBANA_EVENTS.unitClosedByMidRollTimeOut)}},{key:"_unitClose",value:function(e){this.closeTime=this._getCurrentTime();var t={impressionCount:this.impressionCount,timeFromAdPlay:this.closeTime-this.adPlayingTime};this._saveDataToStorage(e,t,!0),clearInterval(this.updateTimer),this.updateTimer=void 0}},{key:"onViewability",value:function(e){this.viewabilityTime=this._getCurrentTime();var t={timeFromAdPlay:this.viewabilityTime-this.adPlayingTime};e&&d.default.extend(t,e),this._saveDataToStorage(g.default.KIBANA_EVENTS.viewability,t,!1)}},{key:"onD2DClick",value:function(e,t){var i={isTrusted:e,isNewTab:t};this._saveDataToStorage(EVENTS.D2DClick,i,!1)}},{key:"_onParentSelectorLost",value:function(){this.lostTime=this._getCurrentTime();var e=this._getTopParentSelector();e=e?e:-999;var t={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.lostTime-this.startTime,isInTab:this.model.get("isInTab"),topParentSelector:e,isTop0Left0:this.model.get("top0Left0")};this._saveDataToStorage(g.default.KIBANA_EVENTS.topParentSelectorLost,t,!0)}},{key:"_onLostPlayerSize",value:function(){var e=g.default.KIBANA_EVENTS.playerHeightLost;this.model.get("playerWidthLost")&&(e=g.default.KIBANA_EVENTS.playerWidthLost),this.lostTime=this._getCurrentTime();var t=this._calcScrollPercentage();t.topParentSelector=t.topParentSelector?t.topParentSelector:-999;var i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.lostTime-this.startTime,isInTab:this.model.get("isInTab"),scrollPercentageFromSelector:t.scrollPercentageFromSelector,bottomViewPort:t.bottomViewPort,topParentSelector:t.topParentSelector};this._saveDataToStorage(e,i)}},{key:"_getTopParentSelector",value:function(){var e=this.model.get("parentSelector");e=d.default.isArray(e)?e[0]:e,e=(0,h.default)(e)[0];var t=d.default.getTopOfEl(e);return t}},{key:"_calcScrollPercentage",value:function(){var e=this._getTopParentSelector();e=e?e:-999;var t=window.innerHeight+window.pageYOffset;return{scrollPercentageFromSelector:t/e*100,topParentSelector:e,bottomViewPort:t}}},{key:"_onInvalidCDBobject",value:function(){var e=g.default.KIBANA_EVENTS.invalidCDBobject,t=this._getCurrentTime(),i={cdbObject:this.model.get("invalidCDBobject"),timeFromStart:t-this.startTime};this._saveDataToStorage(e,i)}},{key:"_onRvHandlerStateChange",value:function(e,t){var i=g.default.KIBANA_EVENTS.rvHandlerState,n=this._getCurrentTime(),o={rvHandlerState:t,timeFromStart:n-this.startTime,gotRvAd:this.model.get("gotRvAd"),gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(i,o)}},{key:"_onPlayerHasRvInQ",value:function(e,t){var i=g.default.KIBANA_EVENTS.playerHasRvInQ,n=this._getCurrentTime();this.playerHadRvInQTime=n;var o={rvHandlerState:this.model.get("rvHandlerState"),timeFromStart:n-this.startTime,gotRvAd:this.model.get("gotRvAd"),gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(i,o)}},{key:"_onRvHandlerTimerExpired",value:function(){var e=g.default.KIBANA_EVENTS.rvHandlerTimerExpired,t=this._getCurrentTime(),i={timeFromStart:t-this.startTime,gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(e,i)}},{key:"_parsePredicts",value:function(e){var t=h.default.extend(!0,{},e);return"any"===t.playerReady.predictPoint&&(t.playerReady.predictPoint=10),t}},{key:"_createAdsEvents",value:function(){this.adEvents={},this.adEvents[g.default.KIBANA_EVENTS.getAd]=this.getAdCalled.bind(this),this.adEvents[g.default.KIBANA_EVENTS.gotAd]=this.gotAd.bind(this),this.adEvents[g.default.KIBANA_EVENTS.viewability]=this.onViewability.bind(this),this.adEvents[g.default.KIBANA_EVENTS.adPlay]=this.adPlaying.bind(this),this.adEvents[g.default.KIBANA_EVENTS.adPaused]=this.adPaused.bind(this)}},{key:"adEvent",value:function(e,t){var i={eventTime:this._getCurrentTime(),scrollData:this._calcScrollPercentage()};d.default.extend(t,i),this.kibanaAdsService.pushEvent(e,t),this.adEvents[e]&&this.adEvents[e](t)}},{key:"_saveDataToStorage",value:function(e,t,i){("all"===this.eventsToSend||d.default.contains(this.eventsToSend,e))&&(this.totalData[e]?d.default.isArray(this.totalData[e])?this.totalData[e].push(t):this.totalData[e]=[this.totalData[e],t]:this.totalData[e]=t,i?this._saveDataToLogServer(i):this.isDirty=!0)}},{key:"_saveDataToLogServer",value:function(e){if(e||this.isDirty){this.changesCount++,this.totalData.redId=this.model.get("redId"),this.totalData.countChanges=this.changesCount,this.totalData.abTest=this.model.get("abTest"),this.totalData.age=this._getCurrentTime()-this.startTime;var t=this.model.get("kbnul");this.kibanaAdsService.saveAdsData(t),h.default.ajax({type:"POST",url:t+"/putes/unitsanalytics",data:JSON.stringify(d.default.extend(this.totalData,{timestamp:(new Date).toISOString()})),contentType:"text/plain"}),this.isDirty=!1,this.updateTimer||(this.updateTimer=setInterval(this._saveDataToLogServer.bind(this),1e3*this.model.get("reportTimerSeconds")))}}}]),t}(c.StateManager);e.exports=v},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(12),u=i(10),h=n(u),p=i(25),f=n(p),m=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e.model,i.events=f.default.KIBANA_EVENTS,i.startTime=e.startTime,i.predictors=e.predictors,i.adsList=[],i.getAdCount=0,i.impressionCount=0,i.dirtyAds=[],i._createEventList(),i}return r(t,e),a(t,[{key:"_getAd",value:function(e){this.createAd(e.adId),this.getAdCount++;var t="any"===e.getAdKey?10:e.getAdKey,i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:e.eventTime-this.startTime,getAdTime:e.eventTime,getAdCount:this.getAdCount,predictPointKey:t,predictName:e.predictName,isInTab:this.model.get("isInTab"),topParentSelector:e.scrollData.topParentSelector};this.model.get("distancePercentPredictData")&&"distancePercentPredict"===e.predictName&&d.default.extend(i,this.model.get("distancePercentPredictData")),this.model.get("distancePixelPredictData")&&"distancePixelsPredict"===e.predictName&&d.default.extend(i,this.model.get("distancePixelPredictData")),d.default.extend(i,this._checkIsFirstGetAdType(e.getAdKey)),this._addDataToAd(this.events.getAd,e.adId,i,{hadImpression:!1,getAdKey:t}),this.isFirstGetAd&&(this.isFirstGetAd=!1)}},{key:"_checkIsFirstGetAdType",value:function(e){var t={};return t.isFirstGetAd=!1,t.isFirstNonRv=!1,t.isFirstRv=!1,void 0===this.isFirstGetAd&&(t.isFirstGetAd=!0,this.isFirstGetAd=!1),0===e&&void 0===this.isFirstNonRv?(t.isFirstNonRv=!0,this.isFirstNonRv=!1):1===e&&void 0===this.isFirstRv&&(t.isFirstRv=!0,this.isFirstRv=!1),t}},{key:"_gotAd",value:function(e){this.createAd(e.adId),this.impressionCount++;var t={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:e.eventTime-this.adsList[e.adId].getAd.getAdTime,adImpressionTime:e.eventTime,scrollPercentageFromSelector:e.scrollData.scrollPercentageFromSelector,bottomViewPort:e.scrollData.bottomViewPort,topParentSelector:e.scrollData.topParentSelector,isInTab:this.model.get("isInTab"),isFirstImpression:1===this.impressionCount,isFirstRv:this.adsList[e.adId].getAd.isFirstRv,isFirstNonRv:this.adsList[e.adId].getAd.isFirstNonRv};t.hadLostEligibility=!!this.model.get("lostEligibilityTime"),this.model.get("lostEligibilityTime")&&(t.timeFromLostEligibility=e.eventTime-this.model.get("lostEligibilityTime")),d.default.extend(t,e);var i={hadImpression:!0,lineItemId:e.lineItemId,requiredViewability:e.requiredViewability};t.isFirstRv?(i.hadRvVimp=!0,this.hadRvVimp=!0):t.isFirstNonRv&&(i.hadNonRvVimp=!0,this.hadNonRvVimp=!0),e.requiredViewability?i.hadNonRvVimpBefore=this.hadNonRvVimp||!1:i.hadRvVimpBefore=this.hadRvVimp||!1,this._addDataToAd(this.events.gotAd,e.adId,t,i)}},{key:"_adPlay",value:function(e){this.createAd(e.adId);var t=!this.adsList[e.adId].hadConversion,i={timeFromAdImpression:e.eventTime-this.adsList[e.adId].gotAd.adImpressionTime,adPlayTime:e.eventTime,isInTab:this.model.get("isInTab"),isFirstConversion:!this.hadConversion,playPauseReason:this.model.get("playPauseReason")};d.default.extend(i,e);var n={hadConversion:!0};t&&(n.conversionTime=e.eventTime,this._addDataToAd(this.events.conversion,e.adId,i,n)),i.isFirstPlayForAd=t,this._addDataToAd(this.events.adPlay,e.adId,i,n),this.hadConversion||(this.hadConversion=!0)}},{key:"_adPaused",value:function(e){this.createAd(e.adId);var t={isInTab:this.model.get("isInTab"),pauseReason:e.pauseReason,playPauseReason:"pauseOnAdImpression"!==e.pauseReason?this.model.get("playPauseReason"):e.pauseReason};this.adsList[e.adId].conversionTime?t.timeFromAdPlay=e.eventTime-this.adsList[e.adId].conversionTime:t.timeFromAdImpression=e.eventTime-this.adsList[e.adId].gotAd.adImpressionTime,d.default.extend(t,e),this._addDataToAd(this.events.adPaused,e.adId,t)}},{key:"_viewability",value:function(e){this.createAd(e.adId);var t={timeFromAdPlay:e.eventTime-this.adsList[e.adId].conversionTime};d.default.extend(t,e),this._addDataToAd(this.events.viewability,e.adId,t,{hadViewability:!0})}},{key:"_completed",value:function(e){this.createAd(e.adId);var t={timeFromAdPlay:e.eventTime-this.adsList[e.adId].conversionTime};d.default.extend(t,e),this._addDataToAd(this.events.adComplete,e.adId,t,{isCompleted:!0})}},{key:"_continueAd",value:function(e){}},{key:"createAd",value:function(e){var t=this.adsList[e];return t||(t={adId:e,_id:d.default.generateGuid(10),countChanges:0,hadImpression:!1,hadConversion:!1,abTest:this.model.get("abTest"),pageUrl:window.location.href},t.conf=this._createConf(),this.adsList[e]=t),t}},{key:"_createConf",value:function(){var e={predictors:this.predictors,detachToSlider:this.model.get("detachToSlider"),unitType:this.model.get("unitType"),version:this.model.get("version")};return e}},{key:"_createEventList",value:function(){this.adEvents={},this.adEvents[this.events.getAd]=this._getAd.bind(this),this.adEvents[this.events.gotAd]=this._gotAd.bind(this),this.adEvents[this.events.viewability]=this._viewability.bind(this),this.adEvents[this.events.adPlay]=this._adPlay.bind(this),this.adEvents[this.events.adPaused]=this._adPaused.bind(this),this.adEvents[this.events.adComplete]=this._completed.bind(this),this.adEvents[this.events.continueAd]=this._continueAd.bind(this)}},{key:"pushEvent",value:function(e,t){this.adEvents[e]&&this.adEvents[e](t)}},{key:"_addDataToAd",value:function(e,t,i,n){var o=this.adsList[t];o[e]?d.default.isArray(o[e])?o[e].push(i):o[e]=[o[e],i]:o[e]=i,o.redId=this.model.get("redId"),o.abTest=this.model.get("abTest"),this._addCardData(i,n),d.default.extend(o,n),o.countChanges++,this.adsList[t]=o,this.dirtyAds[t]=!0}},{key:"_addCardData",value:function(e,t){if(e.cardNumber){var i=this._getCardInfo(e.cardNumber);e.scrollData=e.scrollData||{},d.default.extend(e.scrollData,i),t&&(t.cardInfo=t.cardInfo||{},d.default.extend(t.cardInfo,i))}}},{key:"_getCardInfo",value:function(e){var t=("#cm_place_holder_"+e).replace(".",""),i=(0,h.default)(t)[0],n=d.default.getTopOfEl(i),o=window.innerHeight+window.pageYOffset,s=n-o;return{distanceToEligibility:s,eligibilityPercentage:o/n*100,cardTopPixels:n,cardNumber:e}}},{key:"getAdsData",value:function(){var e={adsList:this.adsList};return e}},{key:"saveAdsData",value:function(e){this.adsList.length&&d.default.forEach(this.adsList,function(t,i){t.hadImpression&&this.dirtyAds[i]&&(this.dirtyAds[i]=!1,h.default.ajax({type:"POST",url:e+"/putes/units-ads-analytics",data:JSON.stringify(d.default.extend(t,{timestamp:(new Date).toISOString()})),contentType:"text/plain"}))}.bind(this))}}]),t}(c.StateManager);e.exports=m},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=o(d),u=i(8),h=o(u),p=i(11),f=o(p),m=i(12),g=i(16),v=o(g),y=i(21),b=(n(y),i(24)),_=o(b),w=i(25),T=o(w),A=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new v.default({unitType:i.model.get("unitType"),className:"pixelsService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.oppManager=new _.default(i.model.get("player.urls.oppsRequest"),{"auc-dast":i.model.get("cmDast"),pt:h.default.crc32(i.model.get("abTest")||999)}),i.hadEligibility=!1,i.hadImpression=!1,i.playerHadRvInQ=!1,i.shouldFirePauseAfterPlay=!1,i.adsList={},i._bindEvents(),i.model.set("hadEligibility",!1),i.model.get("detachToSlider.isStartFromSlider")&&i._firePixel(i.model.getPixel("pixels.sliderFeedStartWithABT"),"slider to feed start with abTest"),i._fireCMPpixel(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adQState:impression",funcName:"_onAdImpression"},{event:"adState:playing",funcName:"_onAdPlaying"},{event:"adState:completed",funcName:"_onAdCompleted"},{event:"loadingViewState:clicked",funcName:"_onRepeatClicked"},{event:"isEligibleToPlay",funcName:"_onEligibilityChange"},{event:"videoViewState:attached",funcName:"_fireAttachPixel",isListenOnce:!0},{event:"videoViewState:detached",funcName:"_fireDetachPixel",isListenOnce:!0},{event:"closeTimer",funcName:"_fireTimerPixel"},{event:"getAdState:gettingAd",funcName:"_fireGetAdPixel"},{event:"TRCResetCloseUnit:true",funcName:"_onTRCResetCloseUnit"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"},{event:"isSkippedDistancePredict:true",funcName:"_onSkipDistancePredict"},{event:"publisherVideoDetected:true",funcName:"_onPublisherVideoDetected"},{event:"rvHandlerTimerExpired:true",funcName:"_onRvHandlerTimerExpired"},{event:"playerHasRvInQ:true",funcName:"_onPlayerHasRvInQ"},{event:"fullEligibilityPredicted:true",funcName:"_onFullEligibilityPredicted"},{event:"publisherIframeVideoDetected:true",funcName:"_onPublisherIframeVideoDetected",isListenOnce:!0},{event:"compDetected",funcName:"_onCompetitionDetected"},{event:"progressLoaderInit:true",funcName:"_onProgressLoaderInit"},{event:"progressLoaderTimerReached:true",funcName:"_onProgressLoaderMove"},{event:"progressLoaderViewClosed:true",funcName:"_onProgressLoaderClose"},{event:"feedxToggle",funcName:"_onFeedxToggle"},{event:"isOrganicCardInjected:true",funcName:"_onOrganicCardInjected"},{event:"organicInjectorFail:true",funcName:"_onOrganicCardInjectionFail"},{event:"isTerminateOnResize:true",funcName:"_onTerminateOnResize"},{event:"generalError",funcName:"_onGeneralError"},{event:"exploreMore",funcName:"_onExploreMore"},{event:"foundUnitDimensions:true",funcName:"_onUnitDimensionsFound"}]),f.default.once("global:passback",this._onPassbackFunctionCalled.bind(this)),this.model.get("autoplaySoundOn")?this._onAutoplayVolumeStatus():this.createStateHandlers([{event:"autoplaySoundOn:true",funcName:"_onAutoplayVolumeStatus",isListenOnce:!0}])}},{key:"_onAdImpression",value:function(){this._firePixel(this.model.getPixel("pixels.addImpresion"),"addImpresion (the player got an ad)")}},{key:"_onAdPlaying",value:function(){var e=this.model.get("activeAdData");this.adsList[e.adId]&&this.adsList[e.adId].hadPlay||(this.adsList[e.adId]=e,this.adsList[e.adId].hadPlay=!0,this._firePixel(this.model.getPixel("pixels.conversion"),"conversion (the ad is playing)"))}},{key:"_onAdCompleted",value:function(){this.isViewed=!1,this.activeTag=void 0}},{key:"_onEligibilityChange",value:function(e,t){this.stopSendingEligibility||(t&&!this.hadEligibility?(this.model.set("hadEligibility",!0),this.hadEligibility=!0,this._firePixel(this.model.getPixel("pixels.eligible"),"First eligible")):this.hadEligibility&&(this._firePixel(this.model.getPixel("pixels.lostEligibility"),"Lost first eligible"),this.model.set("lostEligibilityTime",(new Date).getTime()),this.stopSendingEligibility=!0))}},{key:"_onRepeatClicked",value:function(){this._firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel")}},{key:"_onRenderWasCalled",value:function(){this._firePixel(this.model.getPixel("pixels.renderOnDemand"),"Render Was Called")}},{key:"_onPublisherVideoDetected",value:function(){this._firePixel(this.model.getPixel("pixels.publisherVideoDetected"),"Publisher Video Tag was Detected")}},{key:"_onPublisherIframeVideoDetected",value:function(){this._firePixel(this.model.getPixel("pixels.publisherIframeVideoDetected"),"Publisher Video Tag was Detected in iframe")}},{key:"_fireCMPpixel",value:function(){this.model.get("hasCMPonPage")?this._firePixel(this.model.getPixel("pixels.hasCMPonPage"),"GDPR - Has CMP on page"):this._firePixel(this.model.getPixel("pixels.noCMPonPage"),"GDPR - No CMP on page")}},{key:"_firePixel",value:function(e,t,i){if(e){i&&(e=this._addParametersToUrl(e,i,e.indexOf("?")===-1)),this.log.pixel("firing pixel: "+t+" url: "+e);var n=document.createElement("IMG");n.src=e}}},{key:"_addParametersToUrl",value:function(e,t,i){var n=e;return n+=i?"?":"&",c.default.each(t,function(e,t){void 0!==t&&""!==t&&(n+=e+"="+t+"&")}),n}},{key:"_fireAttachPixel",value:function(){this._firePixel(this.model.getPixel("pixels.attach"),"first attach")}},{key:"_fireDetachPixel",value:function(){this._firePixel(this.model.getPixel("pixels.detach"),"first detach")}},{key:"_fireTimerPixel",value:function(e,t){this.model.get("pixels."+t+"Timer.isFire")&&this._firePixel(this.model.getPixel("pixels."+t+"Timer"),t+" timer")}},{key:"_fireGetAdPixel",value:function(){var e={};this._setDebugReportData(e),"any"===this.model.get("lastGetAdKey")&&this.model.get("pixels.getAdAny.isFire")?this._firePixel(this.model.getPixel("pixels.getAdAny"),"getAd",e):0===this.model.get("lastGetAdKey")&&this.model.get("pixels.getAdNoRV.isFire")?this._firePixel(this.model.getPixel("pixels.getAdNoRV"),"getAd",e):1===this.model.get("lastGetAdKey")&&this.model.get("pixels.getAd.isFire")&&this._firePixel(this.model.getPixel("pixels.getAd"),"getAd",e)}},{key:"_onTRCResetCloseUnit",value:function(){this._firePixel(this.model.getPixel("pixels.TRCResetCloseUnit"),"TRCResetCloseUnit")}},{key:"_onParentSelectorLost",value:function(){this._firePixel(this.model.getPixel("pixels.onParentSelectorLost"),"onParentSelectorLost")}},{key:"_onRvHandlerTimerExpired",value:function(){this._firePixel(this.model.getPixel("pixels.rvHandlerTimerExpired"),"rvHandlerTimerExpired")}},{key:"_onPlayerHasRvInQ",value:function(){this.playerHadRvInQ||(this._firePixel(this.model.getPixel("pixels.onPlayerHasRVinQ"),"onPlayerHasRVinQ"),this.playerHadRvInQ=!0)}},{key:"_setDebugReportData",value:function(e){if(this.model.get("isSendDebugDataReporting")){var t=T.default.PREDICT_NAMES[this.model.get("nextPredictName")],i="pn:"+t+"!sqg:"+this.model.get("adId")+"!";for(var n in T.default.DEBUG_DATA_PIXELS){var o=this[n]();i+="undefined"!=typeof o?T.default.DEBUG_DATA[n]+":"+o+"!":T.default.DEBUG_DATA[n]+":!"}e.debug=i,this.model.get("isSendDebugDataReportingLog")&&this.log.info("DBG-Pixel getAd-"+this.model.get("lastGetAdKey")+" - "+i)}}},{key:"_onSkipDistancePredict",value:function(){this._firePixel(this.model.getPixel("pixels.skippedDistancePredict"),"onSkipDistancePredict")}},{key:"_onFullEligibilityPredicted",value:function(){this.model.get("pixels.fullEligibilityPredict.isFire")&&this._firePixel(this.model.getPixel("pixels.fullEligibilityPredict"),"fullEligibilityPredict")}},{key:"_onCompetitionDetected",value:function(){this._firePixel(this.model.getPixel("pixels.compDetectedOnPage"),"compDetectedOnPage")}},{key:"ft",value:function(){return this.model.get("frameType")}},{key:"fsc",value:function(){var e=this.model.get("startCard");if("undefined"!=typeof e&&""!==e)return parseInt(e)}},{key:"fpc",value:function(){var e=this.model.get("permanentCard");if("undefined"!=typeof e&&""!==e)return parseInt(e)}},{key:"_onFeedxToggle",value:function(){this._firePixel(this.model.getPixel("pixels.feedxToggle"),"feedxToggled")}},{key:"_onExploreMore",value:function(){this._firePixel(this.model.getPixel("pixels.exploreMore"),"exploreMore");
}},{key:"_onProgressLoaderInit",value:function(){this._firePixel(this.model.getPixel("pixels.progressLoaderInit"),"progressLoaderInit")}},{key:"_onProgressLoaderClose",value:function(){this._firePixel(this.model.getPixel("pixels.progressLoaderClose"),"progressLoaderClose")}},{key:"_onProgressLoaderMove",value:function(){this._firePixel(this.model.getPixel("pixels.progressLoaderMove"),"progressLoaderMove")}},{key:"_onOrganicCardInjected",value:function(){this._firePixel(this.model.getPixel("pixels.organicCardInjected"),"organicCardInjected")}},{key:"_onOrganicCardInjectionFail",value:function(){this._firePixel(this.model.getPixel("pixels.organicCardInjectionFail"),"organicCardInjectionFail")}},{key:"_onTerminateOnResize",value:function(){this._firePixel(this.model.getPixel("pixels.terminateOnResize"),"closeDueResize")}},{key:"_onUnitDimensionsFound",value:function(){this._firePixel(this.model.getPixel("pixels.onUnitDimensionsFound"),"UnitDimensionsFound")}},{key:"_onAutoplayVolumeStatus",value:function(){this.isSentAutoplayVolume||(this._firePixel(this.model.getPixel("pixels.autoplaySoundOn"),"autoplaySoundOn"),this.isSentAutoplayVolume=!0)}},{key:"_onGeneralError",value:function(){var e=this.model.get("generalErrorData"),t={debug:"ge:"+e};this._firePixel(this.model.getPixel("pixels.generalError"),"generalErrorData",t)}},{key:"_onPassbackFunctionCalled",value:function(){(h.default.isFunction(this.model.get("onPassback"))||this.model.get("isApiPassbackExist"))&&this._firePixel(this.model.getPixel("pixels.passbackFunctionCalled"),"passback function called")}}]),t}(m.StateManager);e.exports=A},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function e(t,i,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},c=i(8),u=o(c),h=i(10),p=o(h),f=i(68),m=o(f),g=i(29),v=o(g),y=i(25),b=(o(y),i(21)),_=n(b),w=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.targetElem=(0,p.default)("#"+i.model.get("targetId").toString()),i._waterfallRetries=Number(i.model.get("waterfallRetries")),isNaN(i._waterfallRetries)&&(i._waterfallRetries=0),i._init(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_bindEvents",this).call(this),this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"resize"},{event:"videoViewSize",funcName:"resizeDetach"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"adState:playing",funcName:"_dropSingleAds",isListenOnce:!0},{event:["dropAds:adjacency","playerState:ready"],funcName:"_dropSingleAds",isListenOnce:!0}])}},{key:"resize",value:function(e,t,i){if(this.model.get("videoViewState")!==_.videoViewState.detached||i){var n=t||e;if(this.lastSize=this.lastSize||{},this.lastSize.width===n.width&&this.lastSize.height===n.height)return;this.player&&this.player.resize&&n&&n.width&&n.height&&(this.lastSize=u.default.extend({},n),this.player.resize(n.width,n.height),this.log.info("player was resize",n))}}},{key:"resizeDetach",value:function(e,t){this.resize(e,t,!0)}},{key:"_dropSingleAds",value:function(){this.dropAds(v.default.singleAd.name)}},{key:"dropAds",value:function(e){this.player&&this.player.dropAds&&(this.player.dropAds(v.default[e].name),this.log.info("dropping "+e+" ads from player Q"),this.model.appendArray("droppedAdTypes",e))}},{key:"_canGetAdjacCard",value:function(){return!this.model.get("isContainerRatioNotValidForTakeOver")}},{key:"_onAdError",value:function(){this.log.error("onAdError"),this._errorCount++,this._waterfallRetries&&!this._hasImpression&&this._errorCount>=this._waterfallRetries&&(this.log.info("number of errors reached the allowed waterfall retries - stopping the unit",this._waterfallRetries),this.model.set("closeState",_.closeState.terminate))}}]),t}(m.default);e.exports=w},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(16),h=o(u),p=i(21),f=n(p),m=i(22),g=o(m),v=i(12),y=i(10),b=o(y),_=i(6),w=i(29),T=o(w),A=i(69),S=o(A),P=i(11),C=o(P),E=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new h.default({unitType:i.model.get("unitType"),className:"playerService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.isRestarted=!1,i}return a(t,e),l(t,[{key:"_init",value:function(){this._bindEvents(),this.model.get("isPlayerLoaded")&&this._onPlayerLoaded()}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isPlayerLoaded",funcName:"_onPlayerLoaded"},{event:"getAdState:stopped",funcName:"_pausePlayer"},{event:"isInTab",funcName:"_onTabEvent"},{event:"startWF",funcName:"startWf"},{event:"canStartPlayer:true",funcName:"_onPlayerLoaded"}])}},{key:"_onPlayerLoaded",value:function(){if(this.model.get("isPlayerLoaded")&&this.model.get("canStartPlayer")&&!this.player&&this._validatePlayerSize()){if(this.isMuted="on"!==this.model.get("volume"),this.volume="off"!==this.model.get("volume")?40:0,this.contentIndex=0,this.playlist=this.model.get("player.playlist"),this.playlist&&c.default.isEmpty(this.playlist))return void this.model.listenToOnce(this.model,"change:player.playlist",this._onPlayerLoaded.bind(this));var e=this.playlist[this.contentIndex];this.model.set("isInIdleMode",!this.model.get("isInTab")&&this.model.get("isCallIDLE"));var t=this._getAdTypesToDrop();this.data={abTest:this.model.get("abTest"),ad_controls:this.model.get("player.hasAdControls"),aspect_ratio:this.model.get("aspectRatio"),auc_dast:this.model.get("cmDast"),autostart:this.model.get("autoPlay"),base_url:this.model.get("urls.base"),bf_factor:this.model.get("player.bfFactor"),bug_feature:this.model.get("player.hasBFeature"),cfr:this.model.get("cfr"),cipid:this.model.get("cipid"),cirf:decodeURIComponent(this.model.get("referrer")),creativeId:this.model.get("creativeId"),controls:this.model.get("player.hasControls"),country:this.model.get("country"),debug:this.model.get("isDebug")?["*"]:[],default_ad_parameters:this.model.get("defaultAdParameters"),default_ad_timeout:this.model.get("adMaxPlaySeconds"),default_b2b:this.model.get("player.b2b"),fire99:this.model.get("player.isFire99"),ga_factor:this.model.get("gaFactor"),ga_frame_src:this.model.get("gaFrameSrc"),image:this.model.get("loaderImage"),interrupt_loading:this.model.get("interruptLoading"),ip:this.model.get("ip"),isViewable:this.model.get("isPlayerViewable"),keywords:this.model.get("adTitle"),min_vpaid_run_time:this.model.get("player.minVpaidRunTime"),no_debug_report:this.model.get("noDebugReport"),oid:this.model.get("originId"),opps_base_path:this.model.get("player.urls.oppsBasePath"),page_url:decodeURIComponent(this.model.get("referrer")),referrer:decodeURIComponent(this.model.get("referrer")),repeat:this.model.get("repeat"),ron_percent:this.model.get("ronPercent"),schedule_auto:this.model.get("timeBetweenAds"),tags:this.model.get("tags"),time_between_waterfall:this.model.get("secondsBW"),use_flash_bypass:this.model.get("player.isBypassFlash"),use_flash_player:this.model.get("player.isFlashPlayer"),version:this.model.get("adTitle"),vertical:this.model.get("vertical"),wf_base_path:this.model.get("player.urls.wfBasePath"),wf_url:this.model.get("player.urls.wfRequest"),opps_url:this.model.get("player.urls.oppsRequest"),height:""+parseInt(this.model.get("height")),width:""+parseInt(this.model.get("width")),dplayerSettings:this.model.get("player.settings"),loadrsrc:!0,preset:this.model.get("preset"),isDFP:this.model.get("iframeData.inDFP"),can_opt_out:!1,description:e.title,domain:window.location.hostname,mute:this.isMuted,title:e.title,volume:this.volume,isIdleMode:this.model.get("isInIdleMode"),dlywf:this.model.get("dlywf"),target_id:this.getTarget(),schedule:this.model.getScheduleArr(),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),isMobile:this.model.get("isMobile"),queue_size:this.model.get("player.settings.queueSize"),max_ready_vpaid:this.model.get("player.settings.maxReadyVpaid"),adto:this.model.get("player.settings.adto"),vakll:this.model.get("player.settings.vakll"),mintimwf:this.model.get("player.settings.mintimwf"),agressiveLevel:this.model.get("preset.level"),suppressContentZindex:this._getSuppressContentZindex(),vimpFireEvent:this.model.get("vimpFireEvent"),subUnitType:this.model.get("subUnitType"),vForce:this.model.get("vForce.isActive"),get_ad_timeout_seconds:this.model.get("vForce.getAdTimeoutSeconds"),wf_manual:this.model.get("wfManual"),wf_dynmc_ps:this.model.get("wfDynamicPause"),run_wf_when_empty:this.model.get("runWfWhenEmpty"),rndmt:this.model.get("rndmt"),unit_name:this.model.get("unitName"),unit_loader_version:this.model.get("version"),unit_main_version:this.model.get("unitVersion"),mprdct:this.model.get("player.settings.mprdct"),gdprApplies:this.model.get("gdprApplies"),cdb:this.model.get("consentDaisyBit"),adTypesToDrop:t,red_id:this.model.get("redId"),files:[e],onPlayerClose:this._onPlayerClose.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerStop:this._onPlayerStop.bind(this)},c.default.extend(this.data,this.extraData||{}),this.player=new OvaMediaPlayer(this.data),g.default.player=this.player,this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("emptyFirstWaterfall",this._triggerPassback.bind(this)),this._alignPlayer()}}},{key:"_validatePlayerSize",value:function(){var e=this.model.get("width"),t=this.model.get("height"),i=!0;return c.default.isWidthValid(e)?c.default.isHeightValid(t)||(this.model.set("height",c.default.getVideoHeight(e)),this.model.set("playerHeightLost",!0)):(i=!1,this.model.set("playerWidthLost",!0)),i}},{key:"_getSuppressContentZindex",value:function(){return this.model.get("suppressContentZindex")&&this.model.get("vForce.isActiv")||!1}},{key:"_onAdClickThru",value:function(){this.model.set("clickThruState",f.clickThruState.clicked)}},{key:"_onPlayerReady",value:function(){this.playerQueueSeeker=new S.default(this.model),this.playerQueueSeeker.registerIsPlayerHasRvInQ(this.isPlayerHasRvInQ.bind(this)),this.playerQueueSeeker.registerToPlayerQueueStatusChange({instance:this,type:void 0,typeValue:void 0,status:"adLoaded",cb:this.isFirstAdLoaded.bind(this),isListenOnce:!0}),this._onTabEvent(this.model,this.model.get("isInTab")),this.model.set("playerVersion",this.player.get("player_version")),this.model.set("playerRepeatCount",this.player.repeatCount),this.model.set("playerState",f.readyState),this.player.on("AdVolumeChange",this._onVolumeChange.bind(this)),this.player.on("AdPaused",this._onAdPaused.bind(this)),this.player.on("AdPlaying",this._onAdPlaying.bind(this)),this.player.on("UserInteractionPauseState",this._onPausedChanged.bind(this)),this.player.on("queueStatus",this.playerQueueSeeker.updateAdsList.bind(this.playerQueueSeeker)),this.player.setDebugData&&(this.debugData=new _.DebugData({model:this.model,onDebugDataChange:this.player.setDebugData.bind(this.player)})),this.isRestarted?(this.model.set("playerState",f.playerState.restarted),this.model.get("player.settings.dlywf")&&this.startWf()):this.model.set("playerState",f.readyState),this.model.get("isContainerRatioNotValidForTakeOver")&&(this.dropAds(T.default.adjacency.name),this.dropAds(T.default.singleAd.name))}},{key:"_onPausedChanged",value:function(e){this.model.set("generalPlayingUnitState",!e)}},{key:"_onAdPaused",value:function(){this.model.set("generalPlayingUnitState",!1)}},{key:"_onAdPlaying",value:function(){this.model.set("generalPlayingUnitState",!0)}},{key:"_onPlayerClose",value:function(){this._setGeneralPlayingUnitState(!1),this.model.set("playerState",f.playerState.closed)}},{key:"_setGeneralPlayingUnitState",value:function(e){this.model.set("generalPlayingUnitState",null),this.model.set("generalPlayingUnitState",e)}},{key:"_onPlayerStop",value:function(){this.model.set("playerState",f.playerState.stopped)}},{key:"_onPlayerError",value:function(){this.model.set("playerState",f.playerState.error)}},{key:"isPlayerHasRvInQ",value:function(){this.model.set("playerHasRvInQ",!0)}},{key:"isFirstAdLoaded",value:function(){this.model.set("isFirstAdLoaded",!0)}},{key:"close",value:function(){setTimeout(function(){this.player&&(this.player.closeCleanPlayer(),this.player=null,this.model.set("closeState",f.closeState.playerClosed),this.model.set("playerState",f.playerState.closed),this.log.info("player was closed"))}.bind(this),0)}},{key:"_pausePlayer",value:function(){this.close()}},{key:"_onLoadingClick",value:function(){var e=this;this.isRestarted=!0,setTimeout(e._onPlayerLoaded.bind(e),0)}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"_onVolumeChange",value:function(e){this.isMuted=0===e.adVolume}},{key:"getTarget",value:function(){if(this.model.get("targetId"))return this.model.get("targetId").toString();var e=c.default.now().toString(),t=(0,b.default)("<div>");return t.attr("id",e),t.css({width:this.model.get("width")+"px",height:0,position:"absolute",top:0,left:0,display:"none"}),"FEED_MANAGER"!==this.model.get("unitType")&&t.css({}),t.appendTo("body"),this.playerDiv=t,e}},{key:"_onTabEvent",value:function(e,t){this.model.get("isCallIDLE")&&this.player&&this.player.startIdleMode&&this.player.stopIdleMode&&(t?(this.player.stopIdleMode(),this.model.set("isInIdleMode",!1),this.log.info("Stop idle mode")):(this.player.startIdleMode(),this.model.set("isInIdleMode",!0),this.log.info("Start idle mode")))}},{key:"startWf",value:function(){this._hasPlayer()&&this.player.startWf&&!this.model.get("isInIdleMode")?(this.log.info("Starting Waterfall"),this.player.startWf()):this.model.get("isInIdleMode")&&this.createStateHandlers([{event:"isInIdleMode:false",funcName:"startWf",isListenOnce:!0}])}},{key:"_alignPlayer",value:function(){if(this.playerDiv||this.targetElem){var e=this.playerDiv||this.targetElem.parent(),t=this.player.store.get("dataSaver"),i=this.player.store.get("forcecnvsmpg");if(t||i){var n=this.model.get("playerTextAlign");n&&e.css({"text-align":"left"})}}}},{key:"_getAdTypesToDrop",value:function(){var e=[];return this._canGetAdjacCard()||e.push(T.default.adjacency.name+"Ad"),e}},{key:"_triggerPassback",value:function(){var e=this.model.get("isApiPassbackExist");!this.model.get("isFirstAdLoaded")&&e&&(this.log.info("Waterfall returned Empty"),C.default.trigger("global:passback",{isApiPassbackExist:e}),this.model.set("closeState",f.closeState.terminate))}}]),t}(v.StateManager);e.exports=E},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(25),a=n(r),l=i(8),d=n(l),c=function(){function e(t){o(this,e),this.adsList=[],this.listeners=[],this.registerIndex=0,this.model=t}return s(e,[{key:"updateAdsList",value:function(e){e&&!d.default.isEmpty(e)?(this.adsList=e.items,this._notifyListeners(e)):(this.model.set("generalErrorData",1),this.model.increaseCounter("generalError"))}},{key:"_notifyListeners",value:function(e){var t=this;this.isPlayerHasRvInQ(e);var i=[];this.listeners.forEach(function(e){var n=t._findAdsByStatusAndType(e.type,e.typeValue,e.status,e.cb);e.isListenOnce&&n&&i.push(e.index)}),i.forEach(function(e){return t.unregisterToPlayerQueueStatusChange(e)})}},{key:"_findAdsByStatusAndType",value:function(e,t,i,n){var o=this,s=!1,r=[];return this.adsList.forEach(function(n){(!e||o[e]&&o[e](n,t))&&(!i||a.default.AD_STATUS[i]&&n.vw&&n.vw.st===a.default.AD_STATUS[i])&&(r.push(n),s=!0)}),s&&d.default.isFunction(n)&&n(r),s}},{key:"singleAd",value:function(e,t){return!!(t&&e.sa||!t&&!e.sa)}},{key:"adjacency",value:function(e,t){return this.singleAd(e,t)}},{key:"registerIsPlayerHasRvInQ",value:function(e){this.isPlayerHasRvInQCb=e}},{key:"isPlayerHasRvInQ",value:function(e){this.isPlayerHasRvInQCb&&e.requiredViewabilityCount&&this.isPlayerHasRvInQCb()}},{key:"registerToPlayerQueueStatusChange",value:function(e){var t=e.type,i=e.typeValue,n=e.status,o=void 0===n?a.default.AD_STATUS.new:n,s=e.cb,r=e.isListenOnce,l=void 0!==r&&r,d={type:t,typeValue:i,status:o,cb:s,isListenOnce:l,index:this.registerIndex};return this.registerIndex=this.registerIndex+1,this.listeners.push(d),d.index}},{key:"unregisterToPlayerQueueStatusChange",value:function(e){this.listeners=this.listeners.filter(function(t){return t.index!==e})}}]),e}(),u=function(){var e=void 0;return function(t){return e||(e=new c(t)),e}}();e.exports=u},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function e(t,i,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},c=i(8),u=o(c),h=i(21),p=n(h),f=i(10),m=o(f),g=i(25),v=o(g),y=i(29),b=o(y),_=i(68),w=o(_),T=i(71),A=n(T),S=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._init(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_bindEvents",this).call(this),this.createStateHandlers([{event:"getAdState:stopped",funcName:"_pausePlayer"},{event:"adState:playing",funcName:"_onFirstAdPlay",isListenOnce:!0}])}},{key:"_onPlayerLoaded",value:function(){this.extraData={vpdcntrcstmcss:this.model.get("vpaidDivCss"),target_id:this.getTarget()},d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onPlayerLoaded",this).call(this)}},{key:"_onPlayerReady",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onPlayerReady",this).call(this),this._canGetAdjacCard()||(this.log.info("drop adjacency ad from player"),this._dropAdFromPlayer(b.default.adjacency.name+"Ad")),(0,m.default)(".vpaid-player-container").css({height:0});var e=A.UAParser(window.navigator.userAgent);"IE"===e.browser.name&&e.browser.name&&(0,m.default)(".vpaid-player-container").addClass("vpaid-player-container-ie-fix")}},{key:"close",value:function(){setTimeout(function(){this.player&&(this.player.closeCleanPlayer(),this.player=null,this.model.set("closeState",p.closeState.playerClosed),this.model.set("playerState",p.playerState.closed),this.log.info("player was closed"),this.createStateHandlers([{event:"loadingViewState:clicked",funcName:"_onLoadingClick",isListenOnce:!0}]),"onHover"===this.model.get("volume")&&this.model.stopListening(this.model,"change:isMouseOn"))}.bind(this),0)}},{key:"_pausePlayer",value:function(){!this.model.get("isReplayAd")||this.model.get("topParentSelectorLost")||this.model.get("isReasonSecondsToCloseGlobal")?this.close():(this.player.startIdleMode(),this.createStateHandlers([{event:"loadingViewState:clicked",funcName:"_stopIdlemode",isListenOnce:!0}]))}},{key:"_stopIdlemode",value:function(){this.model.get("replayAdClick")!=v.default.REPLAY_AD_CLICK.ALL&&this.model.get("replayAdClick")!=v.default.REPLAY_AD_CLICK.RESTART_PLAYER||this.player.stopIdleMode()}},{key:"getTarget",value:function(){if(this.model.get("targetId"))return this.model.get("targetId").toString();if(this.model.get("isVpaidNoContainerMode"))return this.model.get("videoContainerSelector")?this.model.get("videoContainerSelector").toString():"body";var e=u.default.now().toString(),t=(0,m.default)("<div>");t.attr("id",e);var i=0,n=(0,m.default)("body");if(n.length>0&&this.model.get("isPlayerOutOfViewport")){var o=n[0].getBoundingClientRect();i=window.innerHeight+o.top*-1+100}this.model.set("topOffsetPosition",i),t.css({width:this.model.get("width")+"px",height:0,position:"absolute",top:i+"px",left:0}),"FEED_MANAGER"!==this.model.get("unitType")?t.css({display:"none"}):t.addClass("_cm-ad-feed-manager");var s=this.model.get("additionalCss");if(s){var r=s["z-index"]||s.zIndex;r&&t.css({"z-index":r})}var a=this.model.get("videoContainerSelector")||"body";return t.appendTo(a),this.playerDiv=t,e}},{key:"_alignPlayer",value:function(){var e=this.player.store.get("dataSaver"),t=this.player.store.get("forcecnvsmpg");if(e||t){var i=this.model.get("playerTextAlign");i&&this.playerDiv.css({"text-align":"left"})}}},{key:"_onFirstAdPlay",value:function(){this._dropAdFromPlayer(b.default.singleAd.name),this.log.info("first ad play - dropping single ads from player Q")}},{key:"_dropAdFromPlayer",value:function(e){this.player&&this.player.dropAds&&this.player.dropAds(e)}},{key:"_canGetAdjacCard",value:function(){var e=!(1!==this.model.get("startCard")&&this.model.get("startCard")||1!==this.model.get("permanentCard")&&this.model.get("permanentCard")),t=this.model.get("detachToSlider.isStartFromSlider")&&this.model.get("detachToSlider.isDetachToSlider"),i=!!u.default.getOrganicCard()&&e||t;return i}},{key:"updatePlacement",value:function(){this._updateWfParameter("pstn",this.model.get("placement"))}},{key:"_updateWfParameter",value:function(e,t){this.player&&this.player.updateWfParameter&&this.player.updateWfParameter(e,t)}}]),t}(w.default);e.exports=S},function(e,t,i){var n;!function(o,s){"use strict";var r="0.7.20",a="",l="?",d="function",c="undefined",u="object",h="string",p="major",f="model",m="name",g="type",v="vendor",y="version",b="architecture",_="console",w="mobile",T="tablet",A="smarttv",S="wearable",P="embedded",C={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2===0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===h?e.replace(/[^\d\.]/g,"").split(".")[0]:s},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={rgx:function(e,t){for(var i,n,o,r,a,l,c=0;c<t.length&&!a;){var h=t[c],p=t[c+1];for(i=n=0;i<h.length&&!a;)if(a=h[i++].exec(e))for(o=0;o<p.length;o++)l=a[++n],r=p[o],typeof r===u&&r.length>0?2==r.length?typeof r[1]==d?this[r[0]]=r[1].call(this,l):this[r[0]]=r[1]:3==r.length?typeof r[1]!==d||r[1].exec&&r[1].test?this[r[0]]=l?l.replace(r[1],r[2]):s:this[r[0]]=l?r[1].call(this,l,r[2]):s:4==r.length&&(this[r[0]]=l?r[3].call(this,l.replace(r[1],r[2])):s):this[r]=l?l:s;c+=2}},str:function(e,t){for(var i in t)if(typeof t[i]===u&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(C.has(t[i][n],e))return i===l?s:i}else if(C.has(t[i],e))return i===l?s:i;return e}},k={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},I={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[m,y],[/(opios)[\/\s]+([\w\.]+)/i],[[m,"Opera Mini"],y],[/\s(opr)\/([\w\.]+)/i],[[m,"Opera"],y],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[m,y],[/(konqueror)\/([\w\.]+)/i],[[m,"Konqueror"],y],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[m,"IE"],y],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[m,"Edge"],y],[/(yabrowser)\/([\w\.]+)/i],[[m,"Yandex"],y],[/(puffin)\/([\w\.]+)/i],[[m,"Puffin"],y],[/(focus)\/([\w\.]+)/i],[[m,"Firefox Focus"],y],[/(opt)\/([\w\.]+)/i],[[m,"Opera Touch"],y],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[m,"UCBrowser"],y],[/(comodo_dragon)\/([\w\.]+)/i],[[m,/_/g," "],y],[/(windowswechat qbcore)\/([\w\.]+)/i],[[m,"WeChat(Win) Desktop"],y],[/(micromessenger)\/([\w\.]+)/i],[[m,"WeChat"],y],[/(brave)\/([\w\.]+)/i],[[m,"Brave"],y],[/(qqbrowserlite)\/([\w\.]+)/i],[m,y],[/(QQ)\/([\d\.]+)/i],[m,y],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[m,y],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[m,y],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[m,y],[/(MetaSr)[\/\s]?([\w\.]+)/i],[m],[/(LBBROWSER)/i],[m],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[y,[m,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[y,[m,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[m,y],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[y,[m,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[m,/(.+)/,"$1 WebView"],y],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[m,/(.+(?:g|us))(.+)/,"$1 $2"],y],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[y,[m,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[m,"Sailfish Browser"],y],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[m,y],[/(dolfin)\/([\w\.]+)/i],[[m,"Dolphin"],y],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[m,"Chrome"],y],[/(coast)\/([\w\.]+)/i],[[m,"Opera Coast"],y],[/fxios\/([\w\.-]+)/i],[y,[m,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[y,[m,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[y,m],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[m,"GSA"],y],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[m,[y,E.str,k.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[m,y],[/(navigator|netscape)\/([\w\.-]+)/i],[[m,"Netscape"],y],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[m,y]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,C.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[b,/ower/,"",C.lowerize]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[b,C.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[f,v,[g,T]],[/applecoremedia\/[\w\.]+ \((ipad)/],[f,[v,"Apple"],[g,T]],[/(apple\s{0,1}tv)/i],[[f,"Apple TV"],[v,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[v,f,[g,T]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[f,[v,"Amazon"],[g,T]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[f,E.str,k.device.amazon.model],[v,"Amazon"],[g,w]],[/android.+aft([bms])\sbuild/i],[f,[v,"Amazon"],[g,A]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[f,v,[g,w]],[/\((ip[honed|\s\w*]+);/i],[f,[v,"Apple"],[g,w]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[v,f,[g,w]],[/\(bb10;\s(\w+)/i],[f,[v,"BlackBerry"],[g,w]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[f,[v,"Asus"],[g,T]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[v,"Sony"],[f,"Xperia Tablet"],[g,T]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[v,"Sony"],[g,w]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[v,f,[g,_]],[/android.+;\s(shield)\sbuild/i],[f,[v,"Nvidia"],[g,_]],[/(playstation\s[34portablevi]+)/i],[f,[v,"Sony"],[g,_]],[/(sprint\s(\w+))/i],[[v,E.str,k.device.sprint.vendor],[f,E.str,k.device.sprint.model],[g,w]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[v,[f,/_/g," "],[g,w]],[/(nexus\s9)/i],[f,[v,"HTC"],[g,T]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[f,[v,"Huawei"],[g,w]],[/(microsoft);\s(lumia[\s\w]+)/i],[v,f,[g,w]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[f,[v,"Microsoft"],[g,_]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[v,"Microsoft"],[g,w]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[f,[v,"Motorola"],[g,w]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[f,[v,"Motorola"],[g,T]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[v,C.trim],[f,C.trim],[g,A]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[v,"Samsung"],[g,A]],[/\(dtv[\);].+(aquos)/i],[f,[v,"Sharp"],[g,A]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[v,"Samsung"],f,[g,T]],[/smart-tv.+(samsung)/i],[v,[g,A],f],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[v,"Samsung"],f,[g,w]],[/sie-(\w*)/i],[f,[v,"Siemens"],[g,w]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[v,"Nokia"],f,[g,w]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[f,[v,"Acer"],[g,T]],[/android.+([vl]k\-?\d{3})\s+build/i],[f,[v,"LG"],[g,T]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[v,"LG"],f,[g,T]],[/(lg) netcast\.tv/i],[v,f,[g,A]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[f,[v,"LG"],[g,w]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[v,f,[g,T]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[f,[v,"Lenovo"],[g,T]],[/(lenovo)[_\s-]?([\w-]+)/i],[v,f,[g,w]],[/linux;.+((jolla));/i],[v,f,[g,w]],[/((pebble))app\/[\d\.]+\s/i],[v,f,[g,S]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[v,f,[g,w]],[/crkey/i],[[f,"Chromecast"],[v,"Google"]],[/android.+;\s(glass)\s\d/i],[f,[v,"Google"],[g,S]],[/android.+;\s(pixel c)[\s)]/i],[f,[v,"Google"],[g,T]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[f,[v,"Google"],[g,w]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[f,/_/g," "],[v,"Xiaomi"],[g,w]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[f,/_/g," "],[v,"Xiaomi"],[g,T]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[f,[v,"Meizu"],[g,w]],[/(mz)-([\w-]{2,})/i],[[v,"Meizu"],f,[g,w]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[f,[v,"OnePlus"],[g,w]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[f,[v,"RCA"],[g,T]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[f,[v,"Dell"],[g,T]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[f,[v,"Verizon"],[g,T]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[v,"Barnes & Noble"],f,[g,T]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[f,[v,"NuVision"],[g,T]],[/android.+;\s(k88)\sbuild/i],[f,[v,"ZTE"],[g,T]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[f,[v,"Swiss"],[g,w]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[f,[v,"Swiss"],[g,T]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[f,[v,"Zeki"],[g,T]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[v,"Dragon Touch"],f,[g,T]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[f,[v,"Insignia"],[g,T]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[f,[v,"NextBook"],[g,T]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[v,"Voice"],f,[g,w]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[v,"LvTel"],f,[g,w]],[/android.+;\s(PH-1)\s/i],[f,[v,"Essential"],[g,w]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[f,[v,"Envizen"],[g,T]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[v,f,[g,T]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[f,[v,"MachSpeed"],[g,T]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[v,f,[g,T]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[f,[v,"Rotor"],[g,T]],[/android.+(KS(.+))\s+build/i],[f,[v,"Amazon"],[g,T]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[v,f,[g,T]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[g,C.lowerize],v,f],[/[\s\/\(](smart-?tv)[;\)]/i],[[g,A]],[/(android[\w\.\s\-]{0,9});.+build/i],[f,[v,"Generic"]]],
engine:[[/windows.+\sedge\/([\w\.]+)/i],[y,[m,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[m,y],[/rv\:([\w\.]{1,9}).+(gecko)/i],[y,m]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[m,y],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[m,[y,E.str,k.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[m,"Windows"],[y,E.str,k.os.windows.version]],[/\((bb)(10);/i],[[m,"BlackBerry"],y],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[m,y],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[m,"Symbian"],y],[/\((series40);/i],[m],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[m,"Firefox OS"],y],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[m,y],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[m,"Chromium OS"],y],[/(sunos)\s?([\w\.\d]*)/i],[[m,"Solaris"],y],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[m,y],[/(haiku)\s(\w+)/i],[m,y],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[y,/_/g,"."],[m,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[m,"Mac OS"],[y,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[m,y]]},O=function(e,t){if("object"==typeof e&&(t=e,e=s),!(this instanceof O))return new O(e,t).getResult();var i=e||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:a),n=t?C.extend(I,t):I;return this.getBrowser=function(){var e={name:s,version:s};return E.rgx.call(e,i,n.browser),e.major=C.major(e.version),e},this.getCPU=function(){var e={architecture:s};return E.rgx.call(e,i,n.cpu),e},this.getDevice=function(){var e={vendor:s,model:s,type:s};return E.rgx.call(e,i,n.device),e},this.getEngine=function(){var e={name:s,version:s};return E.rgx.call(e,i,n.engine),e},this.getOS=function(){var e={name:s,version:s};return E.rgx.call(e,i,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};O.VERSION=r,O.BROWSER={NAME:m,MAJOR:p,VERSION:y},O.CPU={ARCHITECTURE:b},O.DEVICE={MODEL:f,VENDOR:v,TYPE:g,CONSOLE:_,MOBILE:w,SMARTTV:A,TABLET:T,WEARABLE:S,EMBEDDED:P},O.ENGINE={NAME:m,VERSION:y},O.OS={NAME:m,VERSION:y},typeof t!==c?(typeof e!==c&&e.exports&&(t=e.exports=O),t.UAParser=O):(n=function(){return O}.call(t,i,t,e),!(n!==s&&(e.exports=n)));var V=o&&(o.jQuery||o.Zepto);if(typeof V!==c&&!V.ua){var x=new O;V.ua=x.getResult(),V.ua.get=function(){return x.getUA()},V.ua.set=function(e){x.setUA(e);var t=x.getResult();for(var i in t)V.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function e(t,i,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},c=i(10),u=o(c),h=i(70),p=o(h),f=i(71),m=n(f),g=i(8),v=o(g),y=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._init(),i}return a(t,e),l(t,[{key:"_onPlayerReady",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onPlayerReady",this).call(this),(0,u.default)(".vpaid-player-container").css({height:0});var e=m.UAParser(window.navigator.userAgent);"IE"===e.browser.name&&e.browser.name&&(0,u.default)(".vpaid-player-container").addClass("vpaid-player-container-ie-fix")}},{key:"_canGetAdjacCard",value:function(){return!1}},{key:"getTarget",value:function(){if(this.model.get("targetId"))return this.model.get("targetId").toString();if(this.model.get("isVpaidNoContainerMode"))return this.model.get("videoContainerSelector")?this.model.get("videoContainerSelector").toString():"body";var e=v.default.now().toString(),t=(0,u.default)("<div>");t.attr("id",e);var i=0,n=(0,u.default)("body");if(n.length>0&&this.model.get("isPlayerOutOfViewport")){var o=n[0].getBoundingClientRect();i=window.innerHeight+o.top*-1+100}this.model.set("topOffsetPosition",i),t.css({width:this.model.get("width")+"px",height:0,position:"absolute",top:i+"px",left:0}),t.addClass("_cm-ad-feed-msn");var s=this.model.get("additionalCss");if(s){var r=s["z-index"]||s.zIndex;r&&t.css({"z-index":r})}var a=this.model.get("videoContainerSelector")||"body";return t.appendTo(a),this.playerDiv=t,e}},{key:"resize",value:function(e,t){var i=t||e;this.lastSize=this.lastSize||{},this.lastSize.width===i.width&&this.lastSize.height===i.height||this.player&&this.player.resize&&i&&i.width&&i.height&&(this.lastSize=v.default.extend({},i),this.player.resize(i.width,i.height),this.log.info("player was resize",i))}}]),t}(p.default);e.exports=y},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(10),h=o(u),p=i(11),f=o(p),m=i(16),g=o(m),v=i(21),y=n(v),b=i(25),_=o(b),w=i(74),T=o(w),A=function(e){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Eligibility";s(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.$parentElement=i,o.model.set("isInTab",!document.hidden),o.log=new g.default({unitType:"Service",className:n,version:o.model.get("version"),isDebug:o.model.get("isDebug")}),o.placeHolders=[],o.model.get("isUseObserver")&&o._initObserver(),o.bindEvent(),o._createPlaceHolders(),o._initEligibilityListener(),o}return a(t,e),l(t,[{key:"bindEvent",value:function(){this.model.listenTo(f.default,"window:tab:change",this._onTabEvent.bind(this)),this.createStateHandlers([{event:"containerViewState:rendered",funcName:"_setPlaceHolderToVideoView"},{event:"getAdState:gotAd",funcName:"_testEligibility"},{event:"componentVisibility",funcName:"_calculateEligibility"}])}},{key:"_setPlaceHolderToVideoView",value:function(){this.model.get("isUseObserver")?(this.observer.disconnect(),this._clearTempDivs(),this.observer.observe(this.model.get("containerViewPlaceHolder"))):(this._clearTempDivs(),this.placeHolders=[this.model.get("containerViewPlaceHolder")],this._calculateEligibility())}},{key:"_clearTempDivs",value:function(){if(this.model.get("frameType")!==_.default.FRAME_TYPE.plainPage&&this.model.get("isDataTrackDivHasDim"))for(var e in this.placeHolders)(0,h.default)(this.placeHolders[e]).hide()}},{key:"_initEligibilityListener",value:function(){this.model.get("isUseObserver")?this._registerObserverListeners():(this._calculateEligibility(),f.default.on("window:scroll:change",this._calculateEligibility.bind(this)),this.model.listenTo(this.model,"change:aspectRatioNum",this._calculateEligibility.bind(this)))}},{key:"_createPlaceHolders",value:function(){for(var e=this.$parentElement||(0,h.default)(this.model.get("parentSelector").toString()),t=0;t<e.length;t++){var i=e[t];if(!i.querySelector("#_cm-css-reset")){var n=this._createTempDiv(i);i.appendChild(n),this.placeHolders.push(n)}}}},{key:"_createTempDiv",value:function(){var e=document.createElement("div");return e.classList.add("_cm-div"),e.id="_cm-css-reset",this.model.get("isDataTrackDivHasDim")&&this.model.get("frameType")!==_.default.FRAME_TYPE.plainPage&&(0,h.default)(e).css({height:"1px !important",width:"1px !important",visibility:"hidden !important",position:"absolute !important"}),e.setAttribute("data-tracked","true"),e}},{key:"_onTabEvent",value:function(e){e===_.default.TAB_STATE.tabOut?(this.model.set("isViewable",!1),this.model.set("isInTab",!1),this.model.get("isIgnoreTabInIframe")&&this.model.get("frameType")!==_.default.FRAME_TYPE.plainPage||this.model.set("isEligibleToPlay",!1)):(this._calculateEligibility(),this.model.set("isInTab",!0))}},{key:"_registerObserverListeners",value:function(){for(var e=0;e<this.placeHolders.length;e++)this.observer.observe(this.placeHolders[e])}},{key:"_testEligibility",value:function(){if(this.inViewDiv){this.model.set("isEligibleToPlay",!0),this.model.set("isViewable",!this.model.get("isIgnoreTabInIframe")||this.model.get("frameType")===_.default.FRAME_TYPE.plainPage||this.model.get("isInTab"));var e=this.model.get("getAdState");this.model.get("eligiblePlaceholder")||e!==y.getAdState.gotAd||this.model.set("eligiblePlaceholder",this.inViewDiv),this.model.get("hadEligibility")||this.model.set("hadEligibility",!0)}else this.model.set("isEligibleToPlay",!1)}},{key:"_getInViewDiv",value:function(){for(var e=0;e<this.placeHolders.length;e++){var t=this.placeHolders[e],i=this._getDimensions(t),n=i.height||c.default.getVideoHeightByRatio(i.width,this.model.get("aspectRatioNum")),o=c.default.getViewPercent(t,i.width,n,this.model.get("scrollSelector"));this.model.get("printCurrentViewPercent")&&this.log.info("currViewPercent: ",o?o:0);var s=this.model.get("viewPercent")||100;if(this.model.set("isViewable",this.model.get("viewabilityPercent")<=o),this.model.set("isViewable100",o>=this.model.get("100viewPercent")),s<=o)return this.placeHolders[e]}}}]),t}(T.default);e.exports=A},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=n(d),u=i(10),h=n(u),p=i(12),f=i(11),m=n(f),g=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.model.set("isEligibleToPlay",!1),i.model.get("isTestParentSelector")&&i._bindScroll(),i.model.get("isInAppBridgeOn")&&window.taboolaBridge&&i._observeInAppIntersectionChange(),i.oldRect={},i}return a(t,e),l(t,[{key:"_bindScroll",value:function(){this._testTopParentSelector(),m.default.on("window:scroll:change",this._testTopParentSelector.bind(this))}},{key:"_initObserver",value:function(){var e={rootMargin:"0px",threshold:[0,this.model.get("viewPercent")/100,this.model.get("viewabilityPercent")/100,this.model.get("100viewPercent")/100]};if(this.model.get("stickyCard.isActive")){var t,i=this.model.get("stickyCard.observerThreshold");i&&(t=e.threshold).push.apply(t,o(i))}this.observer=new IntersectionObserver(this._observerCallback.bind(this),e),this.log.info("IntersectionObserver was created")}},{key:"bindEvent",value:function(){}},{key:"_getDimensions",value:function(e){var t=(0,h.default)(e),i=t.width()||this.model.get("width"),n=t.height()||this.model.get("height");return{width:i,height:n}}},{key:"_calculateEligibility",value:function(){this.model.get("isUseObserver")||(this.inViewDiv=this._getInViewDiv()),this._testEligibility()}},{key:"_onTabEvent",value:function(e){}},{key:"_getInViewDiv",value:function(){for(var e=0;e<this.placeHolders.length;e++){var t=this.placeHolders[e],i=this._getDimensions(t),n=c.default.getViewPercent(t,i.width,c.default.getVideoHeight(i.width),this.model.get("scrollSelector"));this.model.get("printCurrentViewPercent")&&this.log.info("currViewPercent: ",n?n:0);var o=this.model.get("viewPercent")||100;if(this.model.set("isViewable",this.model.get("viewabilityPercent")<=n),this.model.set("isViewable100",n>=this.model.get("100viewPercent")),this.model.set("isEligibleToStick",n<100),o<=n)return this.placeHolders[e]}}},{key:"_observerCallback",value:function(e,t){this.inViewDiv=void 0;for(var i=0;i<e.length;i++)if(this.model.set("isViewable100",100*e[i].intersectionRatio>=this.model.get("100viewPercent")),this.model.set("isViewable",this.model.get("viewabilityPercent")<=100*e[i].intersectionRatio),this.model.set("isEligibleToStick",e[i].intersectionRatio<1),e[i].intersectionRatio>=this.model.get("viewPercent")/100){this.inViewDiv=e[i];break}this._testEligibility()}},{key:"_testEligibility",value:function(){}},{key:"_testTopParentSelector",value:function(){var e=this._getTopParentSelector();this.topParentSelector||(this.topParentSelector=e),this.topParentSelector&&!e&&this.model.get("isCheckTopParentSelectorLost")&&(this.model.set("topParentSelectorLost",!0),this.observer&&this.observer.disconnect&&this.observer.disconnect())}},{key:"_getTopParentSelector",value:function(){var e=this.model.get("parentSelector");e=c.default.isArray(e)?e[0]:e,e=(0,h.default)(e)[0];var t=c.default.getTopOfEl(e);return t}},{key:"_observeInAppIntersectionChange",value:function(){window.taboolaBridge.on("intersectionChanged",this._onIntersectionChanged.bind(this)),window.taboolaBridge.active=!0}},{key:"_onIntersectionChanged",value:function(e){var t=e.rects.boundingClientRect,i={width:function(){return t.width},height:function(){return Math.abs(t.top-window.taboolaBridge.data.rootBounds.height)},top:function e(){var e=0;return t.top<0&&(e-=t.top),e}};this.model.set("scrollSelector",i),this._calculateEligibility()}}]),t}(p.StateManager);e.exports=g},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(10),h=o(u),p=i(11),f=o(p),m=i(16),g=o(m),v=i(21),y=n(v),b=i(74),_=o(b),w=i(25),T=n(w),A=function(e){function t(e,i,n){s(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.globalModel=n,o.model.set("isInTab",o.globalModel.get("isInTab")),o.log=new g.default({unitType:"Service",className:"SubFeedEligibility",version:o.model.get("version"),isDebug:o.model.get("isDebug")}),o.placeHolders=[(0,h.default)(i)[0]],o.isEligibile=null,o.isEligibileOldVal=null,o.bindEvent(),o.model.get("isUseObserver")?(o._initObserver(),o.observer.observe(o.placeHolders[0]),o.model.get("frameType")===T.FRAME_TYPE.amp&&o.setAMPObservers()):o._initEligibilityListener(),o}return a(t,e),l(t,[{key:"bindEvent",value:function(){this.globalModel.listenTo(this.globalModel,"change:isInTab",this._onTabEvent.bind(this)),this.createStateHandlers([{event:"getAdState",funcName:"_calculateEligibility"}])}},{key:"_initEligibilityListener",value:function(){"rendered"===this.model.get("containerViewState")?this._calculateEligibility():this.createStateHandlers([{event:"containerViewState:rendered",funcName:"_calculateEligibility"}]),f.default.on("window:scroll:change",this._calculateEligibility.bind(this))}},{key:"_onTabEvent",value:function(e,t){this.model.set("isInTab",t),t?this._calculateEligibility():this.model.set("isEligibleToPlay",!1)}},{key:"_getInViewDiv",value:function(){for(var e=0;e<this.placeHolders.length;e++){var t=this.placeHolders[e],i=this._getDimensions(),n=c.default.getViewPercent(t,i.width,i.height,this.model.get("scrollSelector"));this.model.get("printCurrentViewPercent")&&this.log.info(n);var o=this.model.get("viewPercent")||100;if(this.model.set("isViewable",this.model.get("viewabilityPercent")<=n),this.model.set("isViewable100",n>=this.model.get("100viewPercent")),this.model.set("isEligibleToStick",n<100),o<=n)return this.placeHolders[e]}}},{key:"_testEligibility",value:function(){this.inViewDiv?(this.isEligibile=!0,this.model.set("isEligibleToPlay",!0),!this.model.get("eligiblePlaceholder")&&c.default.isModel("getAdState",y.getAdState.gotAd,this)&&this.model.set("eligiblePlaceholder",this.inViewDiv)):(this.isEligibile=!1,this.model.set("isEligibleToPlay",!1)),this.isEligibileOldVal!==this.isEligibile&&(this.log.info("Sub unit eligiblity="+this.isEligibile,"subUnitId="+this.model.get("subUnitId")),this.isEligibileOldVal=this.isEligibile)}},{key:"resetPlaceHolders",value:function(){this.placeHolders=[]}},{key:"setAMPObservers",value:function(){var e=this.model.get("cardNumber"),t=(0,h.default)('[data-card-index="'+(e+.5)+'"]').get(0),i={rootMargin:"0px",threshold:[0]};this.AMPBelowObserver=new IntersectionObserver(this.AMPElemBelowCallback.bind(this),i),this.log.info("AMP IntersectionObserver was created"),this.AMPBelowObserver.observe(t)}},{key:"AMPElemBelowCallback",value:function(e){this.model.set("AMPElemBelowVisible",e[0].intersectionRatio>0)}}]),t}(_.default);e.exports=A},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=(n(l),i(10)),c=(n(d),i(12)),u=i(16),h=n(u),p=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new h.default({unitType:i.model.get("unitType"),className:"PreEligibility",version:i.model.get("version"),debug:i.model.get("isDebug")}),i.model.get("isEligibleToPlay")?i._onEnterCB():i.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_onEnterCB"}]),i}return r(t,e),a(t,[{key:"_onEnterCB",value:function(){this.model.set("preEligibility",!0)}}]),t}(c.StateManager);e.exports=p},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(10),u=n(c),h=i(11),p=n(h),f=i(16),m=n(f),g=i(74),v=n(g),y=function(e){function t(e,i){o(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.log=new m.default({unitType:"Service",className:"FeedEligibility",version:n.model.get("version"),isDebug:n.model.get("isDebug")}),n.placeHolder=(0,u.default)(n.model.get("parentSelector"))[0],n.bindEvent(),n.model.get("isUseObserver")?(n._initObserver(),n.observer.observe(n.placeHolder)):n._initEligibilityListener(),n}return r(t,e),a(t,[{key:"bindEvent",value:function(){this.createStateHandlers([{event:"getAdState",funcName:"_calculateEligibility"},{event:"feedxToggle",funcName:"_updateFeedSelector"},{event:"feedContainerChanged",funcName:"_updateFeedSelector"},{event:"isInTab",funcName:"_onTabEvent"}])}},{key:"_initEligibilityListener",value:function(){this._calculateEligibility(),p.default.on("window:scroll:change",this._calculateEligibility.bind(this))}},{key:"_onTabEvent",value:function(e,t){t?this._calculateEligibility():this.model.set("isEligibleToPlay",!1)}},{key:"_getInViewDiv",value:function(){var e=window.innerHeight,t=e+window.pageYOffset,i=d.default.getTopOfEl(this.placeHolder),n=i+1;if(n<=t)return this.placeHolder}},{key:"_observerCallback",value:function(e,t){this.inViewDiv=void 0;for(var i=0;i<e.length;i++)if(e[i].isIntersecting){this.inViewDiv=e[i];break}this._testEligibility()}},{key:"_testEligibility",value:function(){this.inViewDiv?this.model.set("isEligibleToPlay",!0):this.model.set("isEligibleToPlay",!1)}},{key:"_testTopParentSelector",value:function(){var e=this,t=!1,i=this.model.get("ParentSelector"),n=(0,u.default)(i);d.default.forEach(n,function(i){var n=d.default.getTopOfEl(i);n&&(e.hadValidParent=!0,t=!0)}),this.hadValidParent&&!t&&this.model.get("isCheckTopParentSelectorLost")&&(this.model.set("topParentSelectorLost",!0),this.observer&&this.observer.disconnect&&this.observer.disconnect())}},{key:"_updateFeedSelector",value:function(){this.placeHolder=(0,u.default)(this.model.get("parentSelector"))[0],this.observer&&this.observer.observe(this.placeHolder),this._calculateEligibility()}}]),t}(v.default);e.exports=y},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8),a=n(r),l=i(16),d=n(l),c=function(){function e(t){o(this,e),this.model=t,this.log=new d.default({unitType:this.model.get("unitType"),className:"playerLoaderService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this._createLoaders(),this._loadPlayer()}return s(e,[{key:"_createLoaders",value:function(){var e=this;this.loaders={SR:function(e){},AV:function(e){},DP:function(t){var i=e.model.get("player.urls.playerLocation");e.dependencies=[i+"/OvaMediaPlayer.js"],window.OvaMediaPlayer?t():a.default.loadJsArr(e.dependencies,t.bind(e))}}}},{key:"_loadPlayer",value:function(){var e=this.loaders[this.model.get("mobilePlayer")];this.model.get("isMobile")&&e?e(this._onPlayerLoaded.bind(this)):this.loaders.DP(this._onPlayerLoaded.bind(this))}},{key:"_onPlayerLoaded",value:function(){this.model.set("isPlayerLoaded",!0)}}]),e}();e.exports=c},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(12),u=i(7),h=n(u),p=i(21),f=n(p),m=i(16),g=n(m),v=i(11),y=n(v),b=i(22),_=n(b),w=i(80),T=n(w),A=i(29),S=n(A),P=function(e){function t(e,i){o(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.model=e,n.kibana=i,n.log=new g.default({unitType:n.model.get("unitType"),className:"adsManager",version:n.model.get("version"),isDebug:n.model.get("isDebug")}),n.model.set("adState",f.default.readyState),n.model.set("getAdState",f.default.getAdState.notCalled),n.model.set("adManagerState",f.default.adManagerState.empty,{silent:!0}),n.adsList=[],n.model.set("nextPredict",NaN),n.adId=0,n.currentAdIndex=-1,n.model.set("activeTag",!1),n.model.set("activeAd",!1),n.model.set("impressionCount",0),n.playPriorityHandler=new T.default({model:n.model}),n._bindEvents(),_.default.supportTool=_.default.supportTool||{},_.default.supportTool.dp={},n}return r(t,e),a(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"predictCounter",funcName:"adPredict"},{event:"getAdState:failed",funcName:"_onFailedToGetAd"},{event:"hasReadyAd:false",funcName:"_updateNextAd"},{event:"cancelRV:true",funcName:"_cancelAllRVCalls"},{event:"adState:playing",funcName:"_onFirstAdPlay",isListenOnce:!0},{event:"onadProgressionAfterBeginPredict",funcName:"_onadProgressionAfterBeginPredict"},{event:"onadProgressionBeforeEndPredictPredict",funcName:"_onadProgressionBeforeEndPredictPredict"}])}},{key:"adPredict",value:function(){if(!(this.countReadyAds(!1)>=this.model.get("maxVimpsInQueue"))){var e=this.model.get("nextPredict");this.firstGetAdFired||(this.log.info("First Get Ad Fired"),this.model.set("firstGetAdFired",!0),this.firstGetAdFired=!0),d.default.isArray(e)?d.default.forEach(e,this.createNewAd,this):this.createNewAd(e)}}},{key:"createNewAd",value:function(e){var t=this.model.get("nextPredictName"),i=this.model.get("nextAdProperties");if(!this.model.get("isAllowDuplicateKey")){var n=this.adsList.some(function(t,i,n){var o=t.adQState===f.default.adQState.readyState||t.adQState===f.default.adQState.impression;return o&&t.getAdKey===e});if(n)return}this.model.set("adId",this.adId);var o=new h.default({model:this.model,ppKey:e,adId:this.adId,impressionCb:this.onAdImpression.bind(this),completeCb:this.onAdComplete.bind(this),kibana:this.kibana,predictName:t,getAdProperties:i});this.adsList.push(o),this.adId++}},{key:"onAdImpression",value:function(e){e.setActiveTag(),this._updateNextAd(),this.model.set("adManagerState",f.default.adManagerState.hasAds),this.model.get("hadReady")||this.model.get("isEligibilityNomination")||this.model.get("isRvPriority")||(y.default.trigger("ready"),this.model.set("hadReady",!0));var t=e.getAdData();!this.model.get("isEligibleToPlay")&&this.model.get("lostEligibilityTime")&&e.fireSkipVimp1EligibilityLost(t.requiredViewability),this.model.get("activeAdData")&&e.fireSkipVimp1Vimp0Playing(!this.model.get("activeAdData.requiredViewability")&&t.requiredViewability)}},{key:"onAdComplete",value:function(e,t){if(this._removeAd(e.adId,!1),this.model.get("hasReadyAd")){var i=this.model.getStorage("nextAd");i.adId===e.adId&&this.model.set("hasReadyAd",!1)}t&&!this.model.get("hasReadyAd")&&(this.model.set("lastAutoKilledPredict",e.getAdKey),this.model.set("adState",e.adState))}},{key:"close",value:function(){this.model.set("adManagerState",f.default.adManagerState.stopped),this.model.set("closeState",f.default.closeState.adManagerStop)}},{key:"pauseGetAds",value:function(){this.model.set("adManagerState",f.default.adManagerState.paused),this.adsList=[],this.model.set("hasReadyAd",!1)}},{key:"_cancelAllRVCalls",value:function(){d.default.forEach(this.adsList,function(e){1===e.getAdKey&&(e.cancelGetAd(),this._removeAd(e.adId,!0))}.bind(this)),this.model.set("cancelRV",!1)}},{key:"_onFailedToGetAd",value:function(){var e=this.model.get("getAdCurrId"),t=d.default.find(this.adsList,function(t){return t.adId===e},this);this.model.set("lastFailedPredictProperties",t.getAdProperties),this.model.set("lastFailedPredict",t.getAdKey),this._removeAd(e,!0)}},{key:"_removeAd",value:function(e,t){d.default.size(this.adsList)>0&&(this.adsList=this.adsList.filter(function(t){return t.adId===e,t.adId!==e})),0===this.countReadyAds(t)&&this.model.set("adManagerState",f.default.adManagerState.empty)}},{key:"_updateNextAd",value:function(){var e=this,t=this.adsList.filter(function(t){return t.adQState===f.default.adQState.impression&&!t.isUsed&&e._isAllowAd(t)}),i=this._chooseBestAd(t),n=t[i];n&&this.playPriorityHandler.setNextAd(n);var o=n;this.model.get("hasReadyAd")&&("rpox"===this.model.get("playPriority.type")?d.default.each(this.adsList,function(e,t){i!==t&&e.adQState===f.default.adQState.impression&&o&&o.getAdData&&e.reportRpoxSkip(o.getAdData())}.bind(this)):"ppKey"===this.model.get("playPriority.type")&&d.default.each(this.adsList,function(e,t){i!==t&&e.adQState===f.default.adQState.impression&&o&&o.getAdData&&e.reportPpKeySkip(o.getAdData())}.bind(this)))}},{key:"_chooseBestAd",value:function(e){var t=this,i=0;if(1===d.default.size(e))return i;var n=this.model.get("playPriority.type")||"rpox";if("ppKey"===n)d.default.find(e,function(e,n){
e.getAdKey===t.model.get("playPriority.key")&&(i=n)});else if("function"===n){var o=this.model.get("playPriority.func");i=o(e)}else"rpox"===n&&(i=this.priorityByRpox(e));return i}},{key:"priorityByRpox",value:function(e){var t=0,i=(this.model,0);return d.default.each(e,function(e,n){e.rpox>=i&&(i=e.rpox,t=n)}),t}},{key:"_hasPlayingAd",value:function(){return!!this.model.get("activeTag")}},{key:"countReadyAds",value:function(e){var t=0;return d.default.forEach(this.adsList,function(i){e&&i.adQState!==f.default.adQState.readyState?t++:i.adQState===f.default.adQState.impression&&t++},this),t}},{key:"_onFirstAdPlay",value:function(){this.model.set("hadPlayedAd",!0)}},{key:"_isAllowAd",value:function(e){return this._isAllowSingleAd(e)}},{key:"_isAllowSingleAd",value:function(e){var t=e.adTypeConfig&&e.adTypeConfig.singleAd&&e.adTypeConfig.singleAd.isPlacementSingleAd;return!(t&&this.model.get("hadPlayedAd")||this.model.get("isPreventNextAd"))&&(!t||!this._isAdTypeDropped(S.default.singleAd.name))}},{key:"_isAdTypeDropped",value:function(e){var t=this.model.get("droppedAdTypes");return!!d.default.isArray(t)&&(t=t.filter(function(t){return e===t}),0!==t.length)}},{key:"_onadProgressionAfterBeginPredict",value:function(){var e=this,t=this.adsList.filter(function(t){return t.adId===e.model.get("lastActiveAd")});t[0]&&t[0].onadProgressionAfterBeginPredict()}},{key:"_onadProgressionBeforeEndPredictPredict",value:function(){var e=this,t=this.adsList.filter(function(t){return t.adId===e.model.get("lastActiveAd")});t[0]&&t[0].onadProgressionBeforeEndPredictPredict()}}]),t}(c.StateManager);e.exports=P},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(21),h=(n(u),i(8)),p=o(h),f=i(12),m=i(22),g=(o(m),i(26)),v=(o(g),i(11)),y=o(v),b=i(25),_=n(b),w=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.model));return i.model=e.model,i.log=new c.default({unitType:i.model.get("unitType"),className:"PlayPriorityHandler",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.isRvPriority=i.model.get("isRvPriority")&&i._isAllowedInFT(),i.isHadFirstSetAd=!1,i._bindEvents(),i}return a(t,e),l(t,[{key:"_isAllowedInFT",value:function(){return!!this.model.get("playPriority.isAllowInIframes")||this.model.get("frameType")===_.FRAME_TYPE.plainPage}},{key:"_bindEvents",value:function(){}},{key:"setNextAd",value:function(e){this.lastAd=e,this.isRvPriority&&!this.isHadFirstSetAd?this._handleRvPriority(e):this._setReadyAd(e)}},{key:"_setReadyAd",value:function(e){e.onAdSetToUnits(),this.lastSetAdId=e.adId,this.model.setNextAd(e),setTimeout(function(){this.model.set("hasReadyAd",!0)}.bind(this),0)}},{key:"_handleRvPriority",value:function(e){var t=e.adData.requiredViewability,i=!1;if(t)i=!0;else{var n=this._isAtDecisionPoint();i=this._shouldSetReadyAd(n)}i&&(this._setReadyAd(e),e._bringToFront(),this.isHadFirstSetAd=!0)}},{key:"_shouldSetReadyAd",value:function(e){if(!e)return!1;var t=!1;return t=this.model.get("playPriority.isAlwaysWaitForRv")?!this.model.get("playerHasRvInQ"):!this.model.get("playerHasRvInQ")||this.model.get("isSkippedDistancePredict")||this._isLoaderInRequiredPercentage()}},{key:"_isAtDecisionPoint",value:function(){if(!this.model.get("playPriority.checkForRvPriority"))return!1;var e=this.model.get("playPriority.checkForRvPriority"),t=this[_.CHECK_FOR_RV_PRIORITY[e]].bind(this);return t()}},{key:"_reCheckAd",value:function(e){this.isHadFirstSetAd||(this.hasListener=!1,this.setNextAd(this.lastAd))}},{key:"hasReachedEligibility",value:function(){return!(!this.model.get("isEligibleToPlay")&&!this.model.get("hadEligibility"))||(this.hasListener?void 0:(this._waitForEligibility(),this.hasListener=!0,!1))}},{key:"_waitForEligibility",value:function(){this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_reCheckAd",isListenOnce:!0}])}},{key:"hasReachedPixelsFromSelector",value:function(){if(void 0===this.model.get("playPriority.pixelsFromSelector"))return!1;var e=p.default.hasPassedPixelFromSelector(this.model.get("parentSelector"),this.model.get("scrollSelector"),this.model.get("playPriority.pixelsFromSelector"),this.model.get("isNeedValidateParentSelector"));return e||this.hasListener||(this.hasListener=!0,y.default.once("window:scroll:change",this._reCheckAd.bind(this))),e}},{key:"intersectionPercent",value:function(){if(void 0===this.model.get("playPriority.intersectionPercent"))return!1}},{key:"_activeSecondsToGetRVTime",value:function(){}},{key:"_secondsAfterGetAdRv",value:function(){}},{key:"beforeLoaderEnd",value:function(){return!!this._isLoaderInRequiredPercentage()||(this.createStateHandlers([{event:"loaderCurrCount",funcName:"_reCheckAd",isListenOnce:!0}]),!1)}},{key:"_isLoaderInRequiredPercentage",value:function(){return this.model.get("loaderCurrCount")>=this.model.get("playPriority.loaderPercent")}}]),t}(f.StateManager);e.exports=w},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(10),d=n(l),c=i(8),u=n(c),h=i(11),p=n(h),f=i(82),m=n(f),g=i(12),v=i(16),y=n(v),b=i(26),_=n(b),w=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new y.default({unitType:i.model.get("unitType"),className:"CardLocator",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.noAboveSelector=i.model.get("fmNoAboveSelector"),i.noBelowSelector=i.model.get("fmNoBelowSelector"),i._resetCardLocatorParams(),i.maxPPS=i.model.get("getCardMaxPPS"),i.scrollManager=new _.default,i._setMinDistance(),i._decisionCallbacks=[{callback:i._biggerThenLastCard,onFalseRunNext:!1},{callback:i._isCardInViewPort,onFalseRunNext:!1},{callback:i._biggerThenMinDistance,onFalseRunNext:!1},{callback:i._canHaveVideoBrotherAbove.bind(i),onFalseRunNext:!1},{callback:i._isAtViewPercent,onFalseRunNext:!1}],i._decisionCallbacksOutOfView=[{callback:i._biggerThenLastCard,onFalseRunNext:!1},{callback:i._biggerThenMinDistance,onFalseRunNext:!1},{callback:i._canHaveVideoBrotherOutOfView.bind(i),onFalseRunNext:!1},{callback:i._isCardInViewPortOutOfView,onFalseRunNext:!1}],i._isGetCardOnEligibility=i.model.get("isGetCardOnEligibility"),i._isGetCardOnEligibility&&(i._viewPercent=i.model.get("cardEligibilityPercent")),i._isStartFromSlider=i.model.get("detachToSlider.isStartFromSlider"),i._setFeedSelector(),i._startCard=parseInt(i.model.get("startCard"))||0,i._isOpenInViewPort=i.model.get("isOpenInViewPort"),i._permanentCard=i.model.get("permanentCard"),void 0===i._isOpenInViewPort&&(i._isOpenInViewPort=!0),i._initCardsObserver(),i}return r(t,e),a(t,[{key:"_setFeedSelector",value:function(){var e=this.model.get("parentSelector");this._feedContainer=(0,d.default)(e)[0],this._feedCardSelector=e+" "+this.model.get("feedCardSelector")+"[data-card-index]",this._lastCardElement=null}},{key:"_initCardsObserver",value:function(){this.model.get("isUseObserverForCardLocator")&&(this.cardObserver=new m.default(this.model,{targetEl:this._getCardsElemArr()}))}},{key:"_setMinDistance",value:function(){this._minDistance=this.model.get("cardsMinDistance");var e=(0,d.default)(window).height();this._minDistance<e&&(this._minDistance=e,this.model.set("cardsMinDistance",e))}},{key:"_bindListeners",value:function(){p.default.on("window:orientation:change",this._getCardOnDomEvent,this),p.default.on("window:resize:change",this._getCardOnDomEvent,this),p.default.on("window:scroll:change",this._getCardOnDomEvent,this),p.default.on("feed:resize:change",this._getCardOnDomEvent,this),this.maxPPS&&void 0===this.scrollEndIndex&&(this.scrollEndIndex=this.scrollManager.registerForScrollEnd(this._getCardOnDomEvent.bind(this))),this._listenersBinded=!0}},{key:"_unBindListeners",value:function(){p.default.off("window:orientation:change",this._getCardOnDomEvent,this),p.default.off("window:resize:change",this._getCardOnDomEvent,this),p.default.off("window:scroll:change",this._getCardOnDomEvent,this),p.default.off("feed:resize:change",this._getCardOnDomEvent,this),this.maxPPS&&void 0!==this.scrollEndIndex&&(this.scrollManager.deRegisterForScrollEnd(this._getCardOnDomEvent.bind(this)),this.scrollEndIndex=void 0),this._listenersBinded=!1}},{key:"_biggerThenLastCard",value:function(e){return!this._lastCardElement||this._getCardNumber(e)>this._getCardNumber(this._lastCardElement)}},{key:"_isCardInViewPort",value:function(e){return this.getViewPercentMethod(e)>0}},{key:"_isCardInViewPortOutOfView",value:function(e,t){var i=this.getViewPercentMethod(e),n=this.getViewPercentMethod(t);return i>0&&i<99.9&&n<=0}},{key:"_biggerThenMinDistance",value:function(e){return!this._lastCardElement||this._isMinDistancePassed(e)}},{key:"_isMinDistancePassed",value:function(e){var t=(0,d.default)(e)[0].offsetTop,i=(0,d.default)(this._lastCardElement)[0].offsetTop,n=i+(0,d.default)(this._lastCardElement).height();return!(t-n<this._minDistance)}},{key:"_canHaveVideoBrotherAbove",value:function(e,t){var i=!e.hasAttribute(this.noAboveSelector);if(!t)return i;var n=!t.hasAttribute(this.noBelowSelector);return i&&n}},{key:"_canHaveVideoBrotherOutOfView",value:function(e,t){var i=!e.hasAttribute(this.noBelowSelector);if(!t)return i;var n=!t.hasAttribute(this.noAboveSelector);return i&&n}},{key:"_isCurrentCardIsValid",value:function(e,t){var i=void 0;i=this._isOpenInViewPort?this._decisionCallbacks:this._decisionCallbacksOutOfView;for(var n=0;n<i.length;n++){var o=i[n],s=o.callback.call(this,e,t);if(s===!1&&o.onFalseRunNext===!1)return!1}return!0}},{key:"_getCardNumber",value:function(e){var t=(0,d.default)(e).data("card-index");return t}},{key:"_getCardOnDomEvent",value:function(e){this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS||(this._isOpenInViewPort?this._searchCard():this._searchCardPerf())}},{key:"_searchCard",value:function(e){var t=this.getCardsArray(this._feedCardSelector);if(this.observeCards(t),this._permanentCard&&this._permanentCard>0)return this._getPermanentCard(t);t=t.reverse(),e&&(this._lastCardElement=this._getLastCardInViewPort(t),this.log.info("Once out of view - Last card updated to - ",this._getCardNumber(this._lastCardElement)));for(var i=0;i<t.length;i++){var n=t[i],o=t[i+1];if(this._isCurrentCardIsValid(n,o)){if(this._insert="before",0===i&&!this._isCardInViewPort(t[1])){if(n.hasAttribute(this.noBelowSelector))continue;this._insert="after"}return this._updateLastCard(n),this._unBindListeners(),this.log.info("found valid card: "+this._lastCardElementId),this.model.set("hasValidCard",this._lastCardElementId),{cardElement:n,cardNumber:this._lastCardElementId,insert:this._insert}}}if(!this._isGetCardOnEligibility||this._isStartFromSlider&&!this._lastCardElement){var s=this._tryFirstCard(t[t.length-1]);if(s)return s;var r=this._tryLastCard(t[0]);if(r)return r}}},{key:"_searchCardPerf",value:function(){var e=this.getCardsArray(this._feedCardSelector);if(this.observeCards(e),this._permanentCard&&this._permanentCard>0)return this._getPermanentCard(e);e=e.reverse();for(var t=1;t<e.length;t++){var i=e[t],n=e[t-1];if(this._isCurrentCardIsValid(i,n)){if(i=e[t-1],this._insert="before",1===t){if(i.hasAttribute(this.noBelowSelector))continue;this._insert="after"}return this._updateLastCard(i),this._unBindListeners(),this.log.info("found valid card: "+this._lastCardElementId),this.model.set("hasValidCard",this._lastCardElementId),{cardElement:i,cardNumber:this._lastCardElementId,insert:this._insert}}}var o=this._tryFirstCard(e[e.length-1]);if(o)return o;var s=this._tryLastCardPerf(e[0]);return s?s:void 0}},{key:"_tryFirstCard",value:function(e){if(!this._lastCardElement&&this.isFeedNotInViewport()&&this._isCloseToTop()){if(!this._canHaveVideoBrotherAbove(e))return;return this._unBindListeners(),this._updateLastCard(e),this._insert="before",this.model.set("hasValidCard",this._lastCardElementId),{cardElement:this._lastCardElement,cardNumber:this._lastCardElementId,insert:this._insert}}}},{key:"_tryLastCard",value:function(e){if(this.isFeedNotInViewport()&&!this._isCloseToTop())return this._getIfLastCard(e)}},{key:"_tryLastCardPerf",value:function(e){if((this._isCardInViewPort(e)||this.isFeedNotInViewport())&&!this._isCloseToTop())return this._getIfLastCard(e)}},{key:"_getIfLastCard",value:function(e){if(!e.hasAttribute(this.noBelowSelector))return!this._lastCardElement||this._isMinDistancePassed(e)&&this._lastCardElement!==e?(this._unBindListeners(),this._updateLastCard(e),this._insert="after",this.model.set("hasValidCard",this._lastCardElementId),{cardElement:this._lastCardElement,cardNumber:this._lastCardElementId,insert:this._insert}):void 0}},{key:"_getCardByCardNumber",value:function(e){if(this.log.info("getCard by number was called. cardNumber = "+e),e==this._lastCardElementId)return this._unBindListeners(),this.model.set("hasValidCard",void 0,{silent:!0}),{cardElement:this._lastCardElement,cardNumber:this._lastCardElementId,insert:this._insert}}},{key:"_updateLastCard",value:function(e){this._lastCardElement=e,this._lastCardElementId=this._getCardNumber(e)}},{key:"getCard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.cardNumber)return this._getCardByCardNumber(e.cardNumber);if(this.isOpenOnCardFound)return void this.log.info("Has permanent card already - ",this._permanentCard);var t;return this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS?this.log.info("Can't get card scroll is to fast waiting for user to slow down"):(this.log.info("getCard was called"),t=this._isOpenInViewPort?this._searchCard(e.onceOutOfView):this._searchCardPerf()),t||this._listenersBinded||(this.log.info("Waiting for valid card - binding listeners"),this._bindListeners()),t}},{key:"_isCloseToTop",value:function(){var e=document.body,t=document.documentElement,i=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight),n=i/2,o=(0,d.default)(window).height()/2,s=(0,d.default)(window).scrollTop(),r=o+s;return r<=n}},{key:"isFeedNotInViewport",value:function(){var e=this._feedContainer&&this.getViewPercentMethod(this._feedContainer)<=0;return e}},{key:"_getPermanentCard",value:function(e){for(var t=0;t<e.length;t++)if(this._permanentCard===this._getCardNumber(e[t])){if(this._isGetCardOnEligibility&&!this._isAtViewPercent(e[t]))return;return this._unBindListeners(),this._lastCardElement=e[t],this._lastCardElementId=this._permanentCard,this._insert="before",this.isOpenOnCardFound=!0,this.model.set("hasValidCard",this._permanentCard),{cardElement:e[t],cardNumber:this._permanentCard,insert:this._insert}}}},{key:"_getLastCardInViewPort",value:function(e){for(var t=void 0,i=0;i<e.length;i++)if(this._isCardInViewPort(e[i])){t=e[i];break}return!t||this._getCardNumber(t)<this._lastCardElementId?this._lastCardElement:t}},{key:"_isAtViewPercent",value:function(e){if(!this._isGetCardOnEligibility)return!0;var t=(0,d.default)(window),i={top:t.scrollTop(),left:t.scrollLeft()};i.right=i.left+t.width(),i.bottom=i.top+t.height();var n=(0,d.default)(e).width(),o=u.default.getVideoHeight(n)+25;if(!n||!o)return!1;var s=(0,d.default)(e).offset();s.right=s.left+n,s.bottom=s.top+o;var r={top:Math.min(1,(s.bottom-i.top)/o),bottom:Math.min(1,(i.bottom-s.top)/o),left:Math.min(1,(s.right-i.left)/n),right:Math.min(1,(i.right-s.left)/n)},a=r.top*r.bottom*100;this.log.info("Video card view percent - ",a);var l=a>=this._viewPercent;return l}},{key:"_sliceByStartCard",value:function(e){return this._startCard>0?e.slice(this._startCard-1):e}},{key:"getCardsArray",value:function(e){var t=(0,d.default)(e),i=Array.prototype.slice.call(t);return this._sliceByStartCard(i)}},{key:"getViewPercentMethod",value:function(e){return this.model.get("isUseObserverForCardLocator")?this.cardObserver.getViewPercent(e):u.default.getViewPercent(e,e.offsetWidth,e.offsetHeight)}},{key:"_getCardsElemArr",value:function(){var e=this.getCardsArray(this._feedCardSelector);return e.push(this._feedContainer),e}},{key:"observeCards",value:function(e){this.cardObserver&&this.cardObserver.observe(e)}},{key:"_unObserveCards",value:function(e){this.cardObserver&&this.cardObserver.unobserve(e)}},{key:"updateFeedSelector",value:function(){this._unObserveCards(this._getCardsElemArr()),this._setFeedSelector(),this._resetCardLocatorParams(),this.observeCards(this._getCardsElemArr())}},{key:"_resetCardLocatorParams",value:function(){this._lastCardElement=null}},{key:"getSpecificCard",value:function(e){var t=this;if(this.lastSpecificCard===e)return p.default.off("window:scroll:change",this.getSpecificCard.bind(this,e)),void p.default.off("feed:resize:change",this.getSpecificCard.bind(this,e));var i=(0,d.default)('[data-card-index="'+e+'"]')[0];return i&&(this._isCurrentCardIsValid(i)||this._tryFirstCard(i))?(this._updateLastCard(i),setTimeout(function(){t.hasListenersForSpecific=!1},0),p.default.off("window:scroll:change",this.getSpecificCard.bind(this,e)),p.default.off("feed:resize:change",this.getSpecificCard.bind(this,e)),this._insert="before",this.lastSpecificCard=e,this.model.set("hasValidCard",this._lastCardElementId),{cardElement:i,cardNumber:e,insert:"before"}):void(this.hasListenersForSpecific||(this.hasListenersForSpecific=!0,p.default.on("window:scroll:change",this.getSpecificCard.bind(this,e)),p.default.on("feed:resize:change",this.getSpecificCard.bind(this,e))))}}]),t}(g.StateManager);e.exports=w},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(16),a=n(r),l=function(){function e(t,i){o(this,e),this.model=t,this.log=new a.default({unitType:this.model.get("unitType"),className:"ObserverService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.options=i,this.setObserver()}return s(e,[{key:"observe",value:function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)e[t].dataset.elViewPercent||this.observer.observe(e[t])}},{key:"unobserve",value:function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)this.observer.unobserve(e[t])}},{key:"setObserver",value:function(){this.setDefaults(),this.observer=new IntersectionObserver(this.observerCallback.bind(this),this.options);var e=this.options.targetEl;this.observe(e)}},{key:"setDefaults",value:function(){var e=this.options;e.threshold=e.threshold||[0,this.model.get("viewPercent")/100,this.model.get("viewabilityPercent")/100],e.rootMargin=e.rootMargin||"0px",e.targetEl=Array.isArray(e.targetEl)?e.targetEl:[e.targetEl]}},{key:"observerCallback",value:function(e,t){this.options.callback&&this.options.callback(e,t),e.forEach(function(e){e.target.dataset.elViewPercent=e.intersectionRatio.toString()})}},{key:"getViewPercent",value:function(e){return 100*parseFloat(e.dataset.elViewPercent)}},{key:"isElIntersectingViewport",value:function(e){return this.getViewPercent(e)>0}},{key:"isElViewPercentReached",value:function(e){return this.getViewPercent(e)>this.model.get("viewPercent")}},{key:"isElViewabilityPercentReached",value:function(e){return this.getViewPercent(e)>this.model.get("viewabilityPercent")}}]),e}();e.exports=l},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=(o(d),i(8)),u=o(c),h=i(11),p=o(h),f=i(12),m=i(16),g=o(m),v=i(21),y=(n(v),i(25)),b=o(y),_=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,document.hidden?i.model.set("isInTab",!1):i.model.set("isInTab",!0),i.log=new g.default({unitType:i.model.get("unitType"),className:"tabStatusService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.bindEvent(),i}return a(t,e),l(t,[{key:"bindEvent",value:function(){this.model.listenTo(p.default,"window:tab:change",this._onTabEvent.bind(this))}},{key:"_onTabEvent",value:function(e){this.model.set("tabState",u.default.find(Object.keys(b.default.TAB_STATE),function(t){return b.default.TAB_STATE[t]===e})),e===b.default.TAB_STATE.tabOut?this.model.set("isInTab",!1):this.model.set("isInTab",!0)}}]),t}(f.StateManager);e.exports=_},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(12),u=i(25),h=n(u),p=i(8),f=n(p),m=i(22),g=n(m),v=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new d.default({unitType:i.model.get("unitType"),className:"GDPRManager",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i._init(),i}return r(t,e),a(t,[{key:"_init",value:function(){var e=window.__cmp,t=h.default.UNIT_TYPES[this.model.get("unitType")],i=t===h.default.UNIT_TYPES.EXPANDABLE||t===h.default.UNIT_TYPES.EXPANDABLE_MOBILE,n=t===h.default.UNIT_TYPES["300X600"]||t===h.default.UNIT_TYPES["300X600_MOBILE"];(i||n)&&!this.model.get("isStayInIframe")&&this._isInFriendlyIframe()&&(e=f.default.getTopWindow().__cmp),"undefined"!=typeof e?(this.model.set("hasCMPonPage",!0),e("getConsentData",null,this._getConsentDataCB.bind(this))):(this.model.set("hasCMPonPage",!1),this.model.set("canStartPlayer",!0))}},{key:"_getConsentDataCB",value:function(e){var t=e.gdprApplies,i=e.consentData||"";this._setPlayerParams(t,i)}},{key:"_setPlayerParams",value:function(e,t){g.default.player?(g.default.player.set("gdprApplies",e),g.default.player.set("cdb",t)):(this.model.set("gdprApplies",e),this.model.set("consentDaisyBit",t),this.model.set("canStartPlayer",!0))}},{key:"_isInFriendlyIframe",value:function(){return this._isInIframe()&&cmTag.config.iframeData.isFriendlyIframe}},{key:"_isInIframe",value:function(){return cmTag.config.iframeData.inIframe||cmTag.config.iframeData.inDFP}}]),t}(c.StateManager);e.exports=v},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(21),h=n(u),p=i(8),f=(o(p),i(12)),m=i(22),g=(o(m),i(26)),v=o(g),y=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new c.default({unitType:i.model.get("unitType"),className:"RvHandler",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.model.set("rvHandlerState",h.readyState),i.maxPPS=i.model.get("predictors.bForce.maxPPS"),i.scrollManager=new v.default,i._bindEvents(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"gotRvAd:true",funcName:"_gotRvAd"}])}},{key:"onPreEligibility",value:function(){var e=this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS,t=this.model.get("rvHandlerState")!==h.rvHandlerState.working;if(e)return this.log.warning("Scroll speed is too high",this.scrollManager.pps),void this.scrollManager.registerForPPSChange(this._onPPSChange.bind(this));if(t){this.model.set("rvHandlerState",h.rvHandlerState.working),this.model.set("canGetRv",!0);var i=1e3*this.model.get("secondsToWaitForRV");this._startTimer(i)}}},{key:"_onPPSChange",value:function(){this.maxPPS&&Math.abs(this.scrollManager.pps)<=this.maxPPS&&(this.log.info("Scroll speed decreased - continue with bForce flow"),this.scrollManager.deRegisterForPPSChange(this._onPPSChange),this._onPPSDecreased())}},{key:"_onPPSDecreased",value:function(){this.model.get("lostEligibilityTime")?(this.log.info("lostEligibility - checking if gotNonRvAd",this.model.get("gotNonRvAd")),this.model.get("gotNonRvAd")&&(this.log.info("got non-RV ad - start listening to eligibility"),this.model.set("startListenToEligibility",!0))):(this.log.info("isEligibleToPlay - calling onPreEligibility"),this.onPreEligibility())}},{key:"_startTimer",value:function(e){this.model.set("rvHandlerTimerExpired",!1),this.timeout=setTimeout(this._onFailToGetAd.bind(this),e)}},{key:"_onFailToGetAd",value:function(){this.model.set("canGetRv",!1),this.model.set("playerHasRvInQ",!1),this.model.set("rvHandlerTimerExpired",!0),this.model.set("rvHandlerState",h.rvHandlerState.idle),this.log.info("Timer over - failed getting RV ad"),this.model.get("adManagerState")===h.adManagerState.hasAds&&this.model.set("startListenToEligibility",!0)}},{key:"_gotRvAd",value:function(){clearTimeout(this.timeout),this.timeout=void 0,this.model.set("rvHandlerState",h.rvHandlerState.idle),this.model.set("startListenToEligibility",!0),this.log.info("Got RV Ad - started listening to eligibility")}}]),t}(f.StateManager);e.exports=y},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(22),u=n(c),h=i(12),p=i(8),f=n(p),m=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.model));return i.version=e.version,i.model=e.model,i.oppsulaLoaded=!1,i.log=new d.default({unitType:i.model.get("unitType"),className:"OppsulaManager",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.oppsArr=[],i._bindEvents(),i.serviceLoader=u.default.serviceLoader,i._loadService(),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isOppsulaLoaded:true",funcName:"_sendOppsFromArr"}])}},{key:"_loadService",value:function(){this.serviceLoader.get("oppsula",this.version,this._onOppsulaLoaded.bind(this),this._onLoadOppsulaError.bind(this))}},{key:"_onOppsulaLoaded",value:function(e){this.oppsula=new e(this.model),this.oppsulaLoaded=!0,this.log.info("Oppsula Loaded",this.oppsula),this._sendOppsFromArr()}},{key:"_onLoadOppsulaError",value:function(){this.log.error("Error while loading Oppsula from service loader")}},{key:"send",value:function(e){this.oppsulaLoaded===!0?this.oppsula.send(e):this.oppsArr.push(e)}},{key:"_sendOppsFromArr",value:function(){0!==this.oppsArr.length&&(f.default.forEach(this.oppsArr,this.send,this),this.oppsArr=[])}}]),t}(h.StateManager),g=function(){var e;return function(t){return e||(e=new m(t)),e}}();e.exports=g},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){
function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(12),u=i(8),h=n(u),p=i(11),f=n(p),m=i(10),g=n(m),v=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.videoElements=[],i.log=new d.default({unitType:i.model.get("unitType"),className:"PublisherVideoDetector",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.pubVideoTagsSelector=i.model.get("publisherVideoSelector")||"video",i._registerHooks(),i.isPublisherVideoDetected(),i._bindEvents(),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){this.model.get("isDetectIframeVideos")&&this.createStateHandlers([{event:"adState:playing",funcName:"_detectIframeVideos"},{event:"adQState:q1",funcName:"_detectIframeVideos"},{event:"adQState:q2",funcName:"_detectIframeVideos"},{event:"adQState:q3",funcName:"_detectIframeVideos"}])}},{key:"isPublisherVideoDetected",value:function(){return this.pubVideoTags=(0,g.default)(this.pubVideoTagsSelector),this._findPubVideo(this.pubVideoTags),this.model.get("isDetectPubIframeVideo")&&this._iframeIterator(window.document,this._findPubVideo),!!this.model.get("publisherVideoDetected")&&(this._monitorPubVideos(),!0)}},{key:"_findPubVideo",value:function(e){(!this.model.get("publisherVideoDetected")&&e.length>0||h.default.isFunction(this.isPubVideoDetectedHook)&&this.isPubVideoDetectedHook())&&(this.model.set("publisherVideoDetected",!0),this.log.info("found Pub Video in:",e))}},{key:"_monitorPubVideos",value:function(){if(!this.model.get("isNoPubVideoInView")&&!this.isLookingForPubVideo){var e=(0,g.default)(this.pubVideoTagsSelector).last()[0],t=e&&e.getBoundingClientRect(),i=this.model.get("pubVidDetectorThreshold");t&&t.bottom<=i?(this.log.info("started Publisher Video Detector Timer"),this.isLookingForPubVideo=!0,setTimeout(this.isPubVideoInView.bind(this),this.model.get("publisherDetectorDelayInMs"))):f.default.once("window:scroll:change",this._monitorPubVideos.bind(this))}}},{key:"isPubVideoInView",value:function(){return this.pubVideoTags=(0,g.default)(this.pubVideoTagsSelector),this.model.set("isPubVideoViewable",!1),this._isViewableElements(this.pubVideoTags),this.isLookingForPubVideo=!1,this.model.get("isPubVideoViewable")?(this.log.info("Timeout - Publisher Video in View"),f.default.once("window:scroll:change",this._monitorPubVideos.bind(this)),!0):(this.model.set("isNoPubVideoInView",!0),this.log.info("No publisher video in view - can continue with regular flow"),!1)}},{key:"_detectIframeVideos",value:function(){this.model.get("publisherIframeVideoDetected")||(this.iframeWithVideos=[],this._getIframeWithVideos(window.document,"iframe",this.pubVideoTagsSelector),this._isViewableElements(this.iframeWithVideos))}},{key:"_iframeIterator",value:function(e,t){try{h.default.DOMIterator(e,"iframe",t.bind(this),this.pubVideoTagsSelector)}catch(e){}}},{key:"_getIframeWithVideos",value:function(e,t,i){try{var n=h.default.getIframeDocument(e)||e;if(!n)return;for(var o=n.querySelectorAll(t),s=0;s<o.length;s++){var r=h.default.getIframeDocument(o[s])||o[s],a=r.querySelectorAll(i).length>0;a&&!this._isCurrentUnit(o[s])&&this.iframeWithVideos.push(o[s]),h.default.DOMIterator(o[s],t,i)}}catch(e){return}}},{key:"_isCurrentUnit",value:function(e){var t=(0,g.default)(e).parents(),i=this.model.get("videoViewContainer");for(var n in t)if(t[n]===i)return!0;return!1}},{key:"_isViewableElements",value:function(e){if(e){for(var t=this.model.get("pubViewabilityPercent"),i=0;i<e.length;i++){var n=(0,g.default)(e[i]),o=parseInt(n.width()),s=parseInt(n.height()),r=h.default.getViewPercent(e[i],o,s,this.model.get("scrollSelector"));if(t<r){this.model.set("isPubVideoViewable",!0);var a="iframe"===e[i].tagName.toLowerCase();return void(a&&this.model.set("publisherIframeVideoDetected",!0))}}return h.default.isFunction(this.isPubVideoInViewHook)&&this.isPubVideoInViewHook()?void this.model.set("isPubVideoViewable",!0):void this.model.set("isPubVideoViewable",!1)}}},{key:"_registerHooks",value:function(){h.default.isFunction(this.model.get("isPubVideoDetectedHook"))&&(this.isPubVideoDetectedHook=this.model.get("isPubVideoDetectedHook")),h.default.isFunction(this.model.get("isPubVideoInViewHook"))&&(this.isPubVideoInViewHook=this.model.get("isPubVideoInViewHook"))}}]),t}(c.StateManager);e.exports=v},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(16),d=n(l),c=i(12),u=i(8),h=n(u),p=i(10),f=(n(p),function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new d.default({unitType:i.model.get("unitType"),className:"competitionDetector",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.competitionDetector=i.model.get("compToDetect"),i.competitionList=i._createCompetitionList(),i._startDetectCompetition(),i}return r(t,e),a(t,[{key:"_createCompetitionList",value:function(){var e=[];return h.default.forEach(this.competitionDetector,function(t){var i={};i.selector=t,i.isFound=!1,i.tries=0,e.push(i)}),e}},{key:"_startDetectCompetition",value:function(){h.default.forEach(this.competitionList,this._detectCompetition.bind(this))}},{key:"_detectCompetition",value:function(e){if(!e.isFound){var t=e.selector;e.tries++,document.querySelectorAll(t).length>0?(this.model.set("lastCompDetected",t),this.model.increaseCounter("compDetected"),e.isFound=!0):e.tries<=this.model.get("maxTriesForDetectingComp")&&setTimeout(this._detectCompetition.bind(this,e),1e3*this.model.get("timeBetweenDetectionCompSeconds"))}}}]),t}(c.StateManager));e.exports=f},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(10),d=n(l),c=i(8),u=n(c),h=i(12),p=i(16),f=n(p),m=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.adjacCardPlacement=i.model.get("adjacCardPlacement"),i.log=new f.default({unitType:i.model.get("unitType"),className:"organicCardInjector",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i._bindEvents(),i}return r(t,e),a(t,[{key:"_bindEvents",value:function(){}},{key:"injectOrganicCard",value:function(e){if(this.adjacCardPlacement=this.model.get("adjacCardPlacement")||this.adjacCardPlacement,!this._isCardOrganic(this.adjacCardPlacement)&&!this.isOrganicCardInjected){this.organicContainer=(0,d.default)(e)[0];var t=u.default.getOrganicCard();if(!t)return this.log.error("missing mode can't inject organic"),!1;if(!this.organicContainer)return this.log.error("missing container to inject an organic card"),!1;var i=document.createElement("div");i.id="taboola-adjacent-organic-card",i.classList.add("tbl-feed-card"),i.dataset.cardIndex=this.adjacCardPlacement-.25,this.organicContainer.insertAdjacentElement("afterend",i),window._taboola=window._taboola||[];var n=this._getPlacementName();return this.isOrganicCardInjected=!0,this.model.set("isOrganicCardInjected",!0),_taboola.push({mode:t,container:"taboola-adjacent-organic-card",placement:n,target_type:"mix"}),!0}}},{key:"_getPlacementName",value:function(){var e=(0,d.default)(this.model.get("parentSelector"))[0];if(e&&e.dataset&&e.dataset.parentPlacementName)return e.dataset.parentPlacementName+" | Card 0"}},{key:"_isCardOrganic",value:function(e){var t=(0,d.default)('[data-card-index="'+e+'"]')[0];return!(!t||!t.querySelector(".trc-content-organic"))}}]),t}(h.StateManager),g=function(){var e=void 0;return function(t){return e||(e=new m(t)),e}}();e.exports=g},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(10),c=(o(d),i(8)),u=(o(c),i(11)),h=(o(u),i(12)),p=i(16),f=o(p),m=i(21),g=n(m),v=i(25),y=n(v),b=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.model));return i.model=e.model,i.log=new f.default({unitType:i.model.get("unitType"),className:"viewabilityService",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.timers={},i.onViewability=e.onViewability||function(){},i}return a(t,e),l(t,[{key:"updateActiveAd",value:function(e){this.activeAdId!==e.adId&&(this.activeAd||this._bindEvents(),this.activeAd=e,this.activeAdId=e.adId,this.activeAd.supportVideoCurrentTimeEvents&&this.model.get("isUseNewViewabilityCalc")?this._bindPlay():this._startViewabilityTimers())}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_checkViewability"},{event:"isViewable:true",funcName:"_updateViewabilityTimes"},{event:"isViewable100",funcName:"_update100ViewabilityTime"},{event:"videoViewState:"+g.videoViewState.detached,funcName:"_update100ViewabilityTime"}])}},{key:"_bindPlay",value:function(){this.model.get("adState")===g.adState.playing?this._startTestingViewability():this.createStateHandlers([{event:"adState:"+g.adState.playing,funcName:"_startTestingViewability",isListenOnce:!0}])}},{key:"_startTestingViewability",value:function(){this._updateViewabilityTimes(),this._checkViewability(),this._bindPause()}},{key:"_updateViewabilityTimes",value:function(){this._updateViewabilityTime(),this._updateOneSecViewabilityTime(),this._update100ViewabilityTime()}},{key:"_updateViewabilityTime",value:function(){if(this.model.get("isViewable")||this.model.get("videoViewState")===g.videoViewState.detached){var e=this.model.get("activeAdCurrentTime");this.activeAdViewabilityTime=e+this.model.get("traceViewabilitySeconds")}else this.activeAdViewabilityTime=void 0}},{key:"_updateOneSecViewabilityTime",value:function(){if(this.model.get("isViewable")||this.model.get("videoViewState")===g.videoViewState.detached){var e=this.model.get("activeAdCurrentTime");this.activeAdOneSecViewabilityTime=e+1}else this.activeAdOneSecViewabilityTime=void 0}},{key:"_update100ViewabilityTime",value:function(){if(this.model.get("isViewable100")||this.model.get("videoViewState")===g.videoViewState.detached){var e=this.model.get("activeAdCurrentTime");this.activeAd100ViewabilityTime=e+this.model.get("traceViewabilitySeconds")}else this.activeAd100ViewabilityTime=void 0}},{key:"_checkViewability",value:function(){if(this.activeAd){var e=this.model.get("activeAdCurrentTime");this._checkNormalViewability(e),this._checkOneSecViewability(e),this._check100Viewability(e)}}},{key:"_checkNormalViewability",value:function(e){this._testViewability(this.model.get("isViewable"),e,this.activeAdViewabilityTime,this.activeAd.isViewed)&&this._onViewability()}},{key:"_checkOneSecViewability",value:function(e){this._testViewability(this.model.get("isViewable"),e,this.activeAdOneSecViewabilityTime,this.activeAd.isViewedOneS)&&this._onViewabilityOneS()}},{key:"_check100Viewability",value:function(e){this._testViewability(this.model.get("isViewable100"),e,this.activeAd100ViewabilityTime,this.activeAd.isViewed100)&&this._onViewability100()}},{key:"_testViewability",value:function(e,t,i,n){return(e||this.model.get("videoViewState")===g.videoViewState.detached)&&t>=i&&!n}},{key:"_bindPause",value:function(){this.model.get("adState")===g.adState.paused?this._stopAllViewability():this.createStateHandlers([{event:"adState:"+g.adState.paused,funcName:"_stopAllViewability",isListenOnce:!0}])}},{key:"_stopAllViewability",value:function(){this._bindPlay()}},{key:"_onViewability",value:function(){this.activeAd&&(this.activeAd.onViewability(),this.onViewability())}},{key:"_onViewabilityOneS",value:function(){this.activeAd&&this.activeAd.onViewabilityOneS()}},{key:"_onViewability100",value:function(){this.activeAd&&this.activeAd.onViewability100()}},{key:"_startViewabilityTimers",value:function(){this.model.get("isViewable")||this.model.get("videoViewState")===g.videoViewState.detached?this._startViewabilityTime():this.createStateHandlers([{event:"isViewable:true",funcName:"_startViewabilityTime"},{event:"isViewable:false",funcName:"_clearViewabilityTime"},{event:"videoViewState:detached",funcName:"_startViewabilityTime",isListenOnce:!0}]),(this.model.get("isViewable100")||this.model.get("videoViewState")===g.videoViewState.detached)&&this._startViewability100Time(),this.createStateHandlers([{event:"videoViewState:detached",funcName:"_startViewability100Time",isListenOnce:!0},{event:"isViewable100:true",funcName:"_startViewability100Time"},{event:"isViewable100:false",funcName:"_clearViewability100"},{event:"adState:"+g.adState.paused,funcName:"clearAllViewabilityTimers",isListenOnce:!0}])}},{key:"_startViewabilityTime",value:function(){if(!this.activeAd.isViewed&&this.activeAd){var e=this.model.get("traceViewabilitySeconds");this._startViewabilityTimer(y.TIMER_NAMES.viewability,this._onViewabilityOld.bind(this),e),this._startViewabilityTimer(y.TIMER_NAMES.viewabilityOneS,this._onViewabilityOneSOld.bind(this),1)}}},{key:"_startViewability100Time",value:function(){if(!this.activeAd.isViewed100&&this.activeAd){var e=this.model.get("traceViewability100Seconds");this._startViewabilityTimer(y.TIMER_NAMES.viewability100,this._onViewability100Old.bind(this),e)}}},{key:"_startViewabilityTimer",value:function(e,t,i){this.timers[e]||(this.timers[e]=setTimeout(t,1e3*i))}},{key:"clearAllViewabilityTimers",value:function(){this._clearViewabilityTime(),this._clearViewability100()}},{key:"_clearViewabilityTime",value:function(){this._clearViewabilityTimer(y.TIMER_NAMES.viewability),this._clearViewabilityTimer(y.TIMER_NAMES.viewabilityOneS)}},{key:"_clearViewability100",value:function(){this._clearViewabilityTimer(y.TIMER_NAMES.viewability100)}},{key:"_clearViewabilityTimer",value:function(e){this.timers[e]&&(clearTimeout(this.timers[e]),this.timers[e]=void 0)}},{key:"_onViewabilityOld",value:function(){this.timers[y.TIMER_NAMES.viewability]=void 0,this.activeAd.onViewability()}},{key:"_onViewabilityOneSOld",value:function(){this.timers[y.TIMER_NAMES.viewabilityOneS]=void 0,this.activeAd.onViewabilityOneS()}},{key:"_onViewability100Old",value:function(){this.timers[y.TIMER_NAMES.viewability100]=void 0,this.activeAd.onViewability100()}}]),t}(h.StateManager);e.exports=b},function(e,t,i){"use strict";var n=i(92),o="3.0.0";try{if(window.cmTag){var s=window.cmTag.config.ms||{};s.PMS=s.PMS||{},s.PMS[o]=n,window.cmTag.set("ms",s)}window.TRC&&(window.TRC.PMS=window.TRC.PMS||{},window.TRC.PMS[o]=n)}catch(e){}e.exports=n},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(93),r=(i(8),i(99)),a=function(){function e(t){n(this,e),this.opions=t}return o(e,[{key:"getPreset",value:function(e){var t=e.key,i=e.value,n=e.unitType,o=e.platform;if(s[t]&&s[t][i]){var a=s[t],l=s[t].strength||1,d=s[t].atr||{};return d=r(d,a[i].atr),a[i]&&a[i].units&&(d=this._getFromUnits(d,a[i].units,n,o)||d),{presetData:d,strength:l}}}},{key:"_getFromUnits",value:function(e,t,i,n){if(t[i]){var o=t[i].atr||{};return e=r(e,o),t[i].platform&&(e=this._getByPlatform(e,t[i].platform,n)||e),e}}},{key:"_getByPlatform",value:function(e,t,i){if(t[i]){var n=t[i].atr||{};return e=r(e,n)}}}]),e}();e.exports=a},function(e,t,i){"use strict";var n={};n.demo=i(94),n.level=i(95),n.isFireAllPixels=i(96),n.predictorsPresets=i(97),n.isDebug=i(98),e.exports=n},function(e,t){"use strict";var i={strength:101,atr:{},1:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause",isPWOV:!1}},2:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},3:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1184655,"midroll.pubId":133128,"midroll.pubTagId":1184655,"postroll.pubId":133128,"postroll.pubTagId":1184655,pubId:133128,pubTagId:1184655,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},isPWOV:!1}},4:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1046821,"midroll.pubId":133128,"midroll.pubTagId":1046821,"postroll.pubId":133128,"postroll.pubTagId":1046821,pubId:133128,pubTagId:1046821,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},5:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":1633025,"midroll.pubId":133128,"midroll.pubTagId":1633025,"postroll.pubId":133128,"postroll.pubTagId":1633025,pubId:133128,pubTagId:1633025,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause",isPWOV:!1}}};e.exports=i},function(e,t){"use strict";var i={atr:{},platform:{Desktop:{atr:{}},Mobile:{atr:{secondsBW:20,player:{settings:{queue_size:3,max_ready_vpaid:2}}}}}},n={strength:1,atr:{},2:{atr:{secondsToClose:120,noaop:1,secondsBW:20,player:{settings:{mintimwf:7e3,max_ready_vpaid:2,queue_size:3}}}},3:{atr:{secondsToClose:120,pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},units:{FEED_MANAGER:i,INLINE_INSTREAM_OLD:i,INLINE_INSTREAM_VFORCE:i,SLIDER_INSTREAM:i,SLIDER_OUTSTREAM:i,WIDGET_ITEM:i}},4:{atr:{pubId:292045,pubTagId:1565025,preroll:{pubId:292045,pubTagId:1565025},midroll:{pubId:292045,pubTagId:1565025},postroll:{pubId:292045,pubTagId:1565025}}}};e.exports=n},function(e,t){"use strict";var i={strength:101,atr:{},1:{atr:{pixels:{startWithABT:{isFire:!0},getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0},secondsToCloseTimer:{isFire:!0},secondsToCloseGlobalTimer:{isFire:!0},midrollCollapseTimer:{isFire:!0}}}},2:{atr:{pixels:{getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0}}}}};e.exports=i},function(e,t){"use strict";var i={strength:101,1:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}},2:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!1},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}},firstScroll:{isActive:!0,predictPoints:[0,0]}}}},3:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},4:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},5:{atr:{predictors:{multiAd:{isActive:!1},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},99:{atr:{predictors:{autoKill:{isActive:!1},getAdFail:{isActive:!1},multiAd:{isActive:!1},loading:{isActive:!1},repeat:{isActive:!1},playerReady:{isActive:!1},distancePercent:{isActive:!1},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}}};e.exports=i},function(e,t){"use strict";var i={strength:102,1:{atr:{player:{settings:{encwfrs:!1}}}}};e.exports=i},function(e,t,i){(function(t){"use strict";function i(e){return e instanceof t||e instanceof Date||e instanceof RegExp}function n(e){if(e instanceof t){var i=t.alloc?t.alloc(e.length):new t(e.length);return e.copy(i),i}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw new Error("Unexpected situation")}function o(e){var t=[];return e.forEach(function(e,s){"object"==typeof e&&null!==e?Array.isArray(e)?t[s]=o(e):i(e)?t[s]=n(e):t[s]=r({},e):t[s]=e}),t}function s(e,t){return"__proto__"===t?void 0:e[t]}var r=e.exports=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var e,t,a=arguments[0],l=Array.prototype.slice.call(arguments,1);return l.forEach(function(l){"object"!=typeof l||null===l||Array.isArray(l)||Object.keys(l).forEach(function(d){return t=s(a,d),e=s(l,d),e===a?void 0:"object"!=typeof e||null===e?void(a[d]=e):Array.isArray(e)?void(a[d]=o(e)):i(e)?void(a[d]=n(e)):"object"!=typeof t||null===t||Array.isArray(t)?void(a[d]=r({},e)):void(a[d]=r(t,e))})}),a}}).call(t,i(100).Buffer)},function(e,t,i){(function(e){"use strict";function n(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}function o(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return r.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=r.prototype):(null===e&&(e=new r(t)),e.length=t),e}function r(e,t,i){if(!(r.TYPED_ARRAY_SUPPORT||this instanceof r))return new r(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return a(this,e,t,i)}function a(e,t,i,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,i,n):"string"==typeof t?u(e,t,i):f(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t,i,n){return l(t),t<=0?s(e,t):void 0!==i?"string"==typeof n?s(e,t).fill(i,n):s(e,t).fill(i):s(e,t)}function c(e,t){if(l(t),e=s(e,t<0?0:0|m(t)),!r.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function u(e,t,i){if("string"==typeof i&&""!==i||(i="utf8"),!r.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(t,i);e=s(e,n);var o=e.write(t,i);return o!==n&&(e=e.slice(0,o)),e}function h(e,t){var i=t.length<0?0:0|m(t.length);e=s(e,i);for(var n=0;n<i;n+=1)e[n]=255&t[n];return e}function p(e,t,i,n){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===i&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,i):new Uint8Array(t,i,n),r.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=r.prototype):e=h(e,t),e}function f(e,t){if(r.isBuffer(t)){var i=0|m(t.length);return e=s(e,i),0===e.length?e:(t.copy(e,0,0,i),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||Q(t.length)?s(e,0):h(e,t);if("Buffer"===t.type&&Z(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),r.alloc(+e)}function v(e,t){if(r.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return Y(e).length;default:if(n)return $(e).length;t=(""+t).toLowerCase(),n=!0}}function y(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if(i>>>=0,t>>>=0,i<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return V(this,t,i);case"latin1":case"binary":return x(this,t,i);case"base64":return k(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function _(e,t,i,n,o){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=o?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(o)return-1;i=e.length-1}else if(i<0){if(!o)return-1;i=0}if("string"==typeof t&&(t=r.from(t,n)),r.isBuffer(t))return 0===t.length?-1:w(e,t,i,n,o);if("number"==typeof t)return t&=255,r.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):w(e,[t],i,n,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,i,n,o){function s(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}var r=1,a=e.length,l=t.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;r=2,a/=2,l/=2,i/=2}var d;if(o){var c=-1;for(d=i;d<a;d++)if(s(e,d)===s(t,c===-1?0:d-c)){if(c===-1&&(c=d),d-c+1===l)return c*r}else c!==-1&&(d-=d-c),c=-1}else for(i+l>a&&(i=a-l),d=i;d>=0;d--){for(var u=!0,h=0;h<l;h++)if(s(e,d+h)!==s(t,h)){u=!1;break}if(u)return d}return-1}function T(e,t,i,n){i=Number(i)||0;var o=e.length-i;n?(n=Number(n),n>o&&(n=o)):n=o;var s=t.length;if(s%2!==0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var r=0;r<n;++r){var a=parseInt(t.substr(2*r,2),16);if(isNaN(a))return r;e[i+r]=a}return r}function A(e,t,i,n){return K($(t,e.length-i),e,i,n)}function S(e,t,i,n){return K(G(t),e,i,n)}function P(e,t,i,n){return S(e,t,i,n)}function C(e,t,i,n){return K(Y(t),e,i,n)}function E(e,t,i,n){return K(q(t,e.length-i),e,i,n)}function k(e,t,i){return 0===t&&i===e.length?X.fromByteArray(e):X.fromByteArray(e.slice(t,i))}function I(e,t,i){i=Math.min(e.length,i);for(var n=[],o=t;o<i;){var s=e[o],r=null,a=s>239?4:s>223?3:s>191?2:1;if(o+a<=i){var l,d,c,u;switch(a){case 1:s<128&&(r=s);break;case 2:l=e[o+1],128===(192&l)&&(u=(31&s)<<6|63&l,u>127&&(r=u));break;case 3:l=e[o+1],d=e[o+2],128===(192&l)&&128===(192&d)&&(u=(15&s)<<12|(63&l)<<6|63&d,u>2047&&(u<55296||u>57343)&&(r=u));break;case 4:l=e[o+1],d=e[o+2],c=e[o+3],128===(192&l)&&128===(192&d)&&128===(192&c)&&(u=(15&s)<<18|(63&l)<<12|(63&d)<<6|63&c,u>65535&&u<1114112&&(r=u))}}null===r?(r=65533,a=1):r>65535&&(r-=65536,n.push(r>>>10&1023|55296),r=56320|1023&r),n.push(r),o+=a}return O(n)}function O(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var i="",n=0;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=ee));return i}function V(e,t,i){var n="";i=Math.min(e.length,i);for(var o=t;o<i;++o)n+=String.fromCharCode(127&e[o]);return n}function x(e,t,i){var n="";i=Math.min(e.length,i);for(var o=t;o<i;++o)n+=String.fromCharCode(e[o]);return n}function D(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var o="",s=t;s<i;++s)o+=z(e[s]);return o}function M(e,t,i){for(var n=e.slice(t,i),o="",s=0;s<n.length;s+=2)o+=String.fromCharCode(n[s]+256*n[s+1]);return o}function R(e,t,i){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,i,n,o,s){if(!r.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function L(e,t,i,n){t<0&&(t=65535+t+1);for(var o=0,s=Math.min(e.length-i,2);o<s;++o)e[i+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function F(e,t,i,n){t<0&&(t=4294967295+t+1);for(var o=0,s=Math.min(e.length-i,4);o<s;++o)e[i+o]=t>>>8*(n?o:3-o)&255}function B(e,t,i,n,o,s){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function j(e,t,i,n,o){return o||B(e,t,i,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,i,n,23,4),i+4}function U(e,t,i,n,o){return o||B(e,t,i,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,i,n,52,8),i+8}function H(e){if(e=W(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function W(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function $(e,t){t=t||1/0;for(var i,n=e.length,o=null,s=[],r=0;r<n;++r){if(i=e.charCodeAt(r),i>55295&&i<57344){if(!o){if(i>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(r+1===n){(t-=3)>-1&&s.push(239,191,189);continue}o=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),o=i;continue}i=(o-55296<<10|i-56320)+65536}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function G(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function q(e,t){for(var i,n,o,s=[],r=0;r<e.length&&!((t-=2)<0);++r)i=e.charCodeAt(r),n=i>>8,o=i%256,s.push(o),s.push(n);return s}function Y(e){
return X.toByteArray(H(e))}function K(e,t,i,n){for(var o=0;o<n&&!(o+i>=t.length||o>=e.length);++o)t[o+i]=e[o];return o}function Q(e){return e!==e}var X=i(101),J=i(102),Z=i(103);t.Buffer=r,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,r.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:n(),t.kMaxLength=o(),r.poolSize=8192,r._augment=function(e){return e.__proto__=r.prototype,e},r.from=function(e,t,i){return a(null,e,t,i)},r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})),r.alloc=function(e,t,i){return d(null,e,t,i)},r.allocUnsafe=function(e){return c(null,e)},r.allocUnsafeSlow=function(e){return c(null,e)},r.isBuffer=function(e){return!(null==e||!e._isBuffer)},r.compare=function(e,t){if(!r.isBuffer(e)||!r.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,o=0,s=Math.min(i,n);o<s;++o)if(e[o]!==t[o]){i=e[o],n=t[o];break}return i<n?-1:n<i?1:0},r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return r.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=r.allocUnsafe(t),o=0;for(i=0;i<e.length;++i){var s=e[i];if(!r.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},r.byteLength=v,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},r.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},r.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},r.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):y.apply(this,arguments)},r.prototype.equals=function(e){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===r.compare(this,e)},r.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},r.prototype.compare=function(e,t,i,n,o){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||i>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=i)return 0;if(n>=o)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var s=o-n,a=i-t,l=Math.min(s,a),d=this.slice(n,o),c=e.slice(t,i),u=0;u<l;++u)if(d[u]!==c[u]){s=d[u],a=c[u];break}return s<a?-1:a<s?1:0},r.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},r.prototype.indexOf=function(e,t,i){return _(this,e,t,i,!0)},r.prototype.lastIndexOf=function(e,t,i){return _(this,e,t,i,!1)},r.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var o=this.length-t;if((void 0===i||i>o)&&(i=o),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return T(this,e,t,i);case"utf8":case"utf-8":return A(this,e,t,i);case"ascii":return S(this,e,t,i);case"latin1":case"binary":return P(this,e,t,i);case"base64":return C(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;r.prototype.slice=function(e,t){var i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);var n;if(r.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=r.prototype;else{var o=t-e;n=new r(o,void 0);for(var s=0;s<o;++s)n[s]=this[s+e]}return n},r.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||R(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return n},r.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||R(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},r.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},r.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},r.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},r.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},r.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},r.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||R(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},r.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||R(e,t,this.length);for(var n=t,o=1,s=this[e+--n];n>0&&(o*=256);)s+=this[e+--n]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s},r.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},r.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},r.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},r.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),J.read(this,e,!0,23,4)},r.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),J.read(this,e,!1,23,4)},r.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),J.read(this,e,!0,52,8)},r.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),J.read(this,e,!1,52,8)},r.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t|=0,i|=0,!n){var o=Math.pow(2,8*i)-1;N(this,e,t,i,o,0)}var s=1,r=0;for(this[t]=255&e;++r<i&&(s*=256);)this[t+r]=e/s&255;return t+i},r.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t|=0,i|=0,!n){var o=Math.pow(2,8*i)-1;N(this,e,t,i,o,0)}var s=i-1,r=1;for(this[t+s]=255&e;--s>=0&&(r*=256);)this[t+s]=e/r&255;return t+i},r.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,1,255,0),r.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},r.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},r.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},r.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):F(this,e,t,!0),t+4},r.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},r.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*i-1);N(this,e,t,i,o-1,-o)}var s=0,r=1,a=0;for(this[t]=255&e;++s<i&&(r*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/r>>0)-a&255;return t+i},r.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*i-1);N(this,e,t,i,o-1,-o)}var s=i-1,r=1,a=0;for(this[t+s]=255&e;--s>=0&&(r*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/r>>0)-a&255;return t+i},r.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,1,127,-128),r.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},r.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},r.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},r.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):F(this,e,t,!0),t+4},r.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},r.prototype.writeFloatLE=function(e,t,i){return j(this,e,t,!0,i)},r.prototype.writeFloatBE=function(e,t,i){return j(this,e,t,!1,i)},r.prototype.writeDoubleLE=function(e,t,i){return U(this,e,t,!0,i)},r.prototype.writeDoubleBE=function(e,t,i){return U(this,e,t,!1,i)},r.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var o,s=n-i;if(this===e&&i<t&&t<n)for(o=s-1;o>=0;--o)e[o+t]=this[o+i];else if(s<1e3||!r.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+t]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+s),t);return s},r.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!r.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var a=r.isBuffer(e)?e:$(new r(e,n).toString()),l=a.length;for(s=0;s<i-t;++s)this[s+t]=a[s%l]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(t,function(){return this}())},function(e,t){"use strict";function i(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");i===-1&&(i=t);var n=i===t?0:4-i%4;return[i,n]}function n(e){var t=i(e),n=t[0],o=t[1];return 3*(n+o)/4-o}function o(e,t,i){return 3*(t+i)/4-i}function s(e){var t,n,s=i(e),r=s[0],a=s[1],l=new u(o(e,r,a)),d=0,h=a>0?r-4:r;for(n=0;n<h;n+=4)t=c[e.charCodeAt(n)]<<18|c[e.charCodeAt(n+1)]<<12|c[e.charCodeAt(n+2)]<<6|c[e.charCodeAt(n+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;return 2===a&&(t=c[e.charCodeAt(n)]<<2|c[e.charCodeAt(n+1)]>>4,l[d++]=255&t),1===a&&(t=c[e.charCodeAt(n)]<<10|c[e.charCodeAt(n+1)]<<4|c[e.charCodeAt(n+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t),l}function r(e){return d[e>>18&63]+d[e>>12&63]+d[e>>6&63]+d[63&e]}function a(e,t,i){for(var n,o=[],s=t;s<i;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r(n));return o.join("")}function l(e){for(var t,i=e.length,n=i%3,o=[],s=16383,r=0,l=i-n;r<l;r+=s)o.push(a(e,r,r+s>l?l:r+s));return 1===n?(t=e[i-1],o.push(d[t>>2]+d[t<<4&63]+"==")):2===n&&(t=(e[i-2]<<8)+e[i-1],o.push(d[t>>10]+d[t>>4&63]+d[t<<2&63]+"=")),o.join("")}t.byteLength=n,t.toByteArray=s,t.fromByteArray=l;for(var d=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,f=h.length;p<f;++p)d[p]=h[p],c[h.charCodeAt(p)]=p;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,n,o){var s,r,a=8*o-n-1,l=(1<<a)-1,d=l>>1,c=-7,u=i?o-1:0,h=i?-1:1,p=e[t+u];for(u+=h,s=p&(1<<-c)-1,p>>=-c,c+=a;c>0;s=256*s+e[t+u],u+=h,c-=8);for(r=s&(1<<-c)-1,s>>=-c,c+=n;c>0;r=256*r+e[t+u],u+=h,c-=8);if(0===s)s=1-d;else{if(s===l)return r?NaN:(p?-1:1)*(1/0);r+=Math.pow(2,n),s-=d}return(p?-1:1)*r*Math.pow(2,s-n)},t.write=function(e,t,i,n,o,s){var r,a,l,d=8*s-o-1,c=(1<<d)-1,u=c>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,r=c):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),t+=r+u>=1?h/l:h*Math.pow(2,1-u),t*l>=2&&(r++,l/=2),r+u>=c?(a=0,r=c):r+u>=1?(a=(t*l-1)*Math.pow(2,o),r+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,o),r=0));o>=8;e[i+p]=255&a,p+=f,a/=256,o-=8);for(r=r<<o|a,d+=o;d>0;e[i+p]=255&r,p+=f,r/=256,d-=8);e[i+p-f]|=128*m}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t){!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var o=function(){function e(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.cmTag||(window.cmTag={}),window.cmTag.testVideo=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"}),window.cmTag.autoPlayDetectorInstance?(window.cmTag.autoPlayDetectorInstance.callbacks.push(t),window.cmTag.autoPlayDetectorInstance.safelyRunCallbacks()):(this.isMobile=i.isMobile||/iPhone|iPad|Android/i.test(navigator.userAgent),this.timeout=i.timeout||250,this.autoPlaySupport={muted:!1,unmuted:!1},this.unmutedVideo=this.creatVideo(!1),this.mutedVideo=this.creatVideo(!0),this.callbacks=[t],this.testSupport(),window.cmTag.autoPlayDetectorInstance=this),window.cmTag.autoPlayDetectorInstance}return function(e,t,i){t&&n(e.prototype,t),i&&n(e,i)}(e,[{key:"creatVideo",value:function(e){var t=document.createElement("video");return t.tbData={isMuted:e},this.setVideoAttributes(t),this.setVideoStyle(t),e&&this.muteVideo(t),this.isMobile&&document.body.appendChild(t),t}},{key:"setVideoAttributes",value:function(e){e.src=URL.createObjectURL(window.cmTag.testVideo),e.type="video/mp4",e.setAttribute("playsinline",!0)}},{key:"setVideoStyle",value:function(e){e.style.left="0",e.style.top="0",e.style.height="0px",e.style.width="0px",e.style.position="absolute",e.style.display="none"}},{key:"muteVideo",value:function(e){e.muted=!0,e.setAttribute("muted",!0)}},{key:"testSupport",value:function(){this.testVideo(this.mutedVideo),this.isMobile?this.handleNotSupported(this.unmutedVideo,"Mobile"):this.testVideo(this.unmutedVideo)}},{key:"testVideo",value:function(e){var t=this;e.tbData.timeupdateHandler=this.handleSupported.bind(this,e),e.addEventListener("timeupdate",e.tbData.timeupdateHandler),e.tbData.timeout=setTimeout(this.handleNotSupported.bind(this,e,"no promise - timeout"),this.timeout);var i=e.tbData.promise=e.play();void 0===i||e.tbData.isResolved||i.then(function(){t.handleSupported(e)}).catch(function(i){t.handleNotSupported(e,i.message)})}},{key:"handleSupported",value:function(e){if(!e.tbData.isResolved)if(e.tbData.isMuted===e.muted){this.handleResolved(e);var t=e.tbData.isMuted?"muted":"unmuted";this.autoPlaySupport[t]={supported:!0},this.safelyRunCallbacks()}else this.handleNotSupported(e,"Muted by browser")}},{key:"handleNotSupported",value:function(e,t){if(!e.tbData.isResolved){this.handleResolved(e);var i=e.tbData.isMuted?"muted":"unmuted";this.autoPlaySupport[i]={supported:!1,error:t},this.safelyRunCallbacks()}}},{key:"handleResolved",value:function(e){e.tbData.isResolved=!0,this.removeTimeupdateEventListener(e),clearTimeout(e.tbData.timeout)}},{key:"removeTimeupdateEventListener",value:function(e){e.removeEventListener("timeupdate",e.tbData.timeupdateHandler),e.tbData.timeupdateHandler=void 0,delete e.tbData.timeupdateHandler}},{key:"safelyRunCallbacks",value:function(){var e=this;this.supportIsKnown()&&(this.callbacks.map(function(t){t(e.autoPlaySupport)}),this.callbacks=[])}},{key:"supportIsKnown",value:function(){return this.autoPlaySupport.muted&&this.autoPlaySupport.unmuted}}]),e}();try{if(window.cmTag){var s=window.cmTag.config.ms||{};s["video-autoplay-detector"]=s["video-autoplay-detector"]||{},s["video-autoplay-detector"]["1.0.0"]=o,window.cmTag.set("ms",s)}window.TRC&&(window.TRC["video-autoplay-detector"]=window.TRC["video-autoplay-detector"]||{},window.TRC["video-autoplay-detector"]["1.0.0"]=o)}catch(e){}}])},function(e,t,i){"use strict";var n=i(106);try{if(window.cmTag){var o=window.cmTag.config.ms||{};o.oppsula=o.oppsula||{},o.oppsula["1.3.4"]=n,window.cmTag.set("ms",o)}window.TRC&&(window.TRC.oppsula=window.TRC.oppsula||{},window.TRC.oppsula["1.3.4"]=n)}catch(e){}e.exports={}},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(107),r=i(109),a=i(108),l=i(110),d={},c=function(){function e(t,i){n(this,e);var o=this._getRedId(t)||this._getRedId(i)||"red_id";return d.hasOwnProperty(o)||(this.redId=o,this.store=new r(t,i),this.baseUrl=a.getOppsServletBaseUrl(this.store),this.xhr=new s(this.baseUrl,this.store.get("psthdrs")),this.opps=[],this.fireOppsInterval=null,this.stopped=!1,this.billableEvents=(this.store.get("bllblevt")||"").split(","),this._setFireOppsInterval(),this._setFireOppsBeforeUnload(),d[o]=this),d[o]}return o(e,[{key:"_getRedId",value:function(e){if(e)return e.get("redId")||e.get("red_id")}},{key:"send",value:function(e){e.tms=Math.floor((new Date).getTime()/1e3),this.stopped||(this._isBillableEvent(e.rst)||!this.store.get("cmbopps")?this.xhr.send(a.stringify([e]),e.rst):this.opps.push(e))}},{key:"_setFireOppsInterval",value:function(){this.stopped||this.fireOppsInterval||(this.fireOpps=this._fireOpps.bind(this),this.fireOppsInterval=setInterval(this.fireOpps,this.store.get("timbtopps")))}},{key:"destroy",value:function(){this.stopped||(window.removeEventListener("beforeunload",this._destroy),this.fireOppsInterval=clearInterval(this.fireOppsInterval),this._fireOpps(),this.stopped=!0,this.store&&this.store.destroy(),this.opps=this.store=this.fireOpps=this.xhr=this._destroy=void 0,d[this.redId]=void 0)}},{key:"_fireOpps",value:function(){this.stopped||(this.opps.length>0&&this.xhr.send(a.stringify(this.opps)),this.opps=[])}},{key:"_setFireOppsBeforeUnload",value:function(){this._destroy=this.destroy.bind(this),window.addEventListener("beforeunload",this._destroy)}},{key:"_isBillableEvent",value:function(e){return this.billableEvents.indexOf(""+e)>-1}},{key:"OppsID",get:function(){return l}}]),e}();e.exports=c},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=(i(108),function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;arguments.length>5&&void 0!==arguments[5]&&arguments[5];n(this,e),this.baseUrl=t,this.async=void 0==o||o,this.withCredentials=void 0==s||s,this.timeout=r||5e3,this.contentType=i||"application/x-www-form-urlencoded"}return o(e,[{key:"_onFail",value:function(){this.gotResponse||(this.gotResponse=!0)}},{key:"send",value:function(e,t){if(this.baseUrl){var i=""+this.baseUrl+(void 0!==t?"?rst="+t:""),n=new XMLHttpRequest;return e=e||"",n.open(e?"POST":"GET",i,!0),n.withCredentials=this.withCredentials,n.setRequestHeader("Content-type",this.contentType),n.async=this.async,n.timeout=this.timeout,n.gotResponse=!1,n.addEventListener("error",this._onFail),n.addEventListener("abort",this._onFail),n.addEventListener("timeout",this._onFail),n.addEventListener("readystatechange",function(e){if(4==this.readyState){if(this.gotResponse)return;this.gotResponse=!0}}),n.send(e),!0}}}]),e}());e.exports=s},function(e,t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={getOppsServletBaseUrl:function(e){var t=e.get("ms_data.opps_base_path");return""+this.setUrlPrefix(t)+(/.*\/$/g.test(t)?"":"/")+"OpportunityServlet"},setUrlPrefix:function(e){return"string"!=typeof e?e:(e=e.replace(/^(http[s]?:|ftp:)/g,""),0!==e.indexOf("//")&&(e="//"+e),e)},stringify:function(e,t){try{var n=[];return JSON.stringify(e,function(e,t){if(null!=t&&"object"==("undefined"==typeof t?"undefined":i(t))){if(n.indexOf(t)>-1)return;n.push(t)}return t},t)}catch(e){return""}},fireOpp:function(e){try{(new Image).src=e}catch(e){}},flattenParams:function(e){var t=[];for(var i in e)t.push(i+"="+e[i]);return t.join("&")}}},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=(i(108),function(){function e(t,i){n(this,e),this.unitModel=t,this.playerModel=i,this.data={psthdrs:"application/json",timbtopps:2e3}}return o(e,[{key:"get",value:function(e){return this._getFromPlayerModel(e)}},{key:"_getFromPlayerModel",value:function(e){var t=this.playerModel?this.playerModel.get(e):void 0;return void 0!==t?t:this._getFromUnitModel(e)}},{key:"_getFromUnitModel",value:function(e){var t=this.unitModel?this.unitModel.get(e):void 0;return void 0!==t?t:this._getFromData(e)}},{key:"_getFromData",value:function(e){return e=e.toString(),e.indexOf(".")===-1?this.data[e]:r.get(e,!1,this.data)}},{key:"set",value:function(e,t){e=e.toString(),r.set(e,t,this.data)}},{key:"destroy",value:function(){this.unitModel=this.playerModel=this.data=void 0}}]),e}()),r=function(){var e=function(e,t,i){for(var n,o=i||data,s=0;o&&(n=e[s]);s++)o=n in o?o[n]:t?o[n]={}:void 0;return o};return{set:function(t,i,n){var o=t.split("."),s=o.pop(),r=e(o,!0,n);return r&&s?r[s]=i:void 0},get:function(t,i,n){return e(t.split("."),i,n)},exists:function(e,t){return void 0!==this.get(e,!1,t)}}}();e.exports=s},function(e,t){"use strict";e.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,firstImpression:99,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,adLoaded:41,startAd:42,videoThrottle:43}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(112),s=n(o),r=i(114),a=n(r),l=i(115),d=n(l),c=i(116),u=n(c),h=i(117),p=n(h),f=i(118),m=n(f),g=i(119),v=n(g),y=i(120),b=n(y),_=i(121),w=n(_),T=i(122),A=n(T),S=i(123),P=n(S),C=i(124),E=n(C),k=i(125),I=n(k),O=i(10),V=n(O);e.exports=V.default.extend(!0,{},s.default,a.default,d.default,u.default,p.default,m.default,v.default,b.default,w.default,A.default,P.default,E.default,I.default)},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o);e.exports={"300X600":{desktop:s.default,mobile:s.default}}},function(e,t){"use strict";e.exports={level:{2:{noaop:1,"player.settings.max_ready_vpaid":2,"player.settings.queue_size":3,secondsBW:20},3:{}}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o);e.exports={CUSTOM:{desktop:s.default,mobile:s.default}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o);e.exports={EXPANDABLE:{desktop:s.default,mobile:s.default}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={INLINE_FEED:{desktop:{level:{2:{player:{settings:{mprdct:.0158,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981},4:{isMultiAd:!1},5:{isMultiAd:!1,pubId:208401,pubTagId:1047981,noaop:1,player:{settings:{mprdct:.0227,mintimwf:1e4}}}}},mobile:a.default.extend(!0,{},s.default,{level:{3:{pubId:208401,pubTagId:1047981},5:{pubId:208401,pubTagId:1047981}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={INLINE_INSTREAM_NEW_SINGLE:{desktop:a.default.extend(!0,{},s.default,{level:{2:{player:{settings:{mprdct:.025,mintimwf:7e3}},noaop:1,onOutOfView:"pause","player.settings.max_ready_vpaid":2,playerEndSeconds:240},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},4:{isMultiAd:!1},5:{isMultiAd:!1,pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981},noaop:1,player:{settings:{mprdct:.0289,mintimwf:1e4}}}}}),mobile:a.default.extend(!0,{},s.default,{level:{2:{"player.settings.max_ready_vpaid":2,playerEndSeconds:240,player:{settings:{mprdct:.015,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={INLINE_INSTREAM_OLD_VFORCE:{desktop:a.default.extend(!0,{},s.default,{level:{2:{onOutOfView:"pause","player.settings.max_ready_vpaid":2,playerEndSeconds:240},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}}),mobile:a.default.extend(!0,{},s.default,{level:{2:{onOutOfView:"pause","player.settings.max_ready_vpaid":2,playerEndSeconds:240
},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={INLINE_INSTREAM_SINGLE_NEW:{desktop:a.default.extend(!0,{},s.default,{level:{2:{player:{settings:{mprdct:.025,mintimwf:7e3}},noaop:1,onOutOfView:"pause","player.settings.max_ready_vpaid":2,playerEndSeconds:240},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}}),mobile:a.default.extend(!0,{},s.default,{level:{2:{"player.settings.max_ready_vpaid":2,playerEndSeconds:240,player:{settings:{mprdct:.015,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={INLINE_INSTREAM_SINGLE_OLD:{desktop:a.default.extend(!0,{},s.default,{level:{2:{player:{settings:{mprdct:.025,mintimwf:7e3}},noaop:1,onOutOfView:"pause","player.settings.max_ready_vpaid":2,playerEndSeconds:240},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}}),mobile:a.default.extend(!0,{},s.default,{level:{2:{"player.settings.max_ready_vpaid":2,playerEndSeconds:240,player:{settings:{mprdct:.015,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={INLINE_INSTREAM_VIEWABILITY_EXPAND:{desktop:a.default.extend(!0,{},s.default,{level:{2:{"player.settings.max_ready_vpaid":2,playerEndSeconds:240},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981},playerEndSeconds:120},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}}),mobile:a.default.extend(!0,{},s.default,{level:{2:{"player.settings.max_ready_vpaid":2,playerEndSeconds:240},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981},playerEndSeconds:120},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={SLIDER_INSTREAM:{desktop:a.default.extend(!0,{},s.default,{level:{2:{noaop:1,player:{settings:{mprdct:.025,mintimwf:7e3}}},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}}),mobile:a.default.extend(!0,{},s.default,{level:{2:{noaop:1,player:{settings:{mprdct:.021,mintimwf:7e3}}},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t){"use strict";e.exports={SLIDER_OUTSTREAM:{desktop:{level:{2:{noaop:1,player:{settings:{mprdct:.021,mintimwf:7e3}}},3:{pubId:208401,pubTagId:1047981},4:{vForce:{isActive:!0},isMultiAd:!1},5:{vForce:{isActive:!0},isMultiAd:!1,pubId:208401,pubTagId:1047981}}},mobile:{level:{2:{noaop:1,player:{settings:{mprdct:.0199,mintimwf:7e3}}},3:{pubId:208401,pubTagId:1047981},4:{vForce:{isActive:!0},isMultiAd:!1},5:{vForce:{isActive:!0},isMultiAd:!1,pubId:208401,pubTagId:1047981}}}}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={WIDGET_ITEM:{desktop:{level:{2:{pubId:169497,pubTagId:953497,player:{settings:{mprdct:.025,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},4:{pubId:169497,pubTagId:953497,isMultiAd:!1},5:{isMultiAd:!1,pubId:208401,pubTagId:1047981,noaop:1,player:{settings:{mprdct:.0258,mintimwf:1e4}}}}},mobile:a.default.extend(!0,{},s.default,{level:{2:{player:{settings:{mprdct:.0151,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981}}}})}}},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(113),s=n(o),r=i(10),a=n(r);e.exports={FEED_MANAGER:{desktop:{level:{2:{player:{settings:{mprdct:.025,mintimwf:7e3}},noaop:1},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},4:{isMultiAd:!1},5:{isMultiAd:!1,pubId:208401,pubTagId:1047981,noaop:1,player:{settings:{mprdct:.0227,mintimwf:1e4}}}}},mobile:a.default.extend(!0,{},s.default,{level:{2:{player:{settings:{mintimwf:7e3,mprdct:.015}}},3:{pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},5:{pubId:208401,pubTagId:1047981}}})}}},function(e,t){},,function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(8),a=o(r),l=i(25),d=o(l),c=i(10),u=o(c),h=i(71),p=n(h),f=a.default.flatten;a.default.mixin({parseBool:function(e){return"true"===e||e===!0||1===e||"1"===e},hasFlash:function(){function e(){try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return!1}}return"undefined"==typeof navigator.plugins||0==navigator.plugins.length?e():!!navigator.plugins["Shockwave Flash"]},el:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(e);for(var n in t)null!=t[n]&&(i[n]=t[n]);return i},loadJs:function(e,t){return document.head.appendChild(a.default.el("script",{src:e,onload:t}))},loadCss:function(e,t){return document.head.appendChild(a.default.el("link",{href:e,onload:t,rel:"stylesheet",type:"text/css"}))},loadJsArr:function(e,t){function i(){n--,0===n&&t()}var n;t&&(n=e.length);for(var o=0;o<e.length;o++)e[o].indexOf(".css")>-1?a.default.loadCss(e[o],i):a.default.loadJs(e[o],i)},getUrlVars:function(e){e=e||window;for(var t,i=[],n=e.location.href.slice(e.location.href.indexOf("?")+1).split("&"),o=0;o<n.length;o++)t=n[o].split("="),i.push(t[0]),i[t[0]]=t[1];return i},firePixelConditional:function(e,t,i,n){e&&a.default.firePixel(t,i,n)},firePixel:function(e,t,i){if(e){i&&(e=a.default.addParametersToUrl(e,i,e.indexOf("?")===-1)),cmTag.logger.pixel("firing pixel: "+t+" url: "+e);var n=document.createElement("IMG");n.src=e}},fireIframePixel:function(e,t){if(!e)return void cmTag.logger.pixel("fireIframePixel","Url empty.");cmTag.logger.pixel("firing pixel: "+t+" url: "+e);var i=document.createElement("iframe");i.src=e,i.style.display="none";var n=document.getElementsByTagName("body")[0];n||(n=document.getElementsByTagName("html")[0]),n||(n=document.getElementsByTagName("div")[0]),n?n.appendChild(i):cmTag.logger.debug("fireIframePixel","Failed to fire iframe pixel.")},getViewabilityPercent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.offsetWidth,n=e.getBoundingClientRect(),o={top:Math.max(0,n.top),bottom:Math.min(a.default.viewport().height,n.bottom),left:Math.max(0,n.left),right:Math.min(a.default.viewport().width,n.right)};return 100*(o.bottom-o.top)*(o.right-o.left)/(t*i)},isVisible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.offsetWidth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return a.default.getViewabilityPercent(e,t,i)>=n},viewport:function(){return{get height(){return a.default.viewport().object.document.documentElement.clientHeight},get width(){return a.default.viewport().object.document.documentElement.clientWidth},get object(){return top}}},getVideoHeight:function(e){var t=parseInt(9/16*e);return isNaN(t)?0:t},getVideoWidth:function(e){var t=parseInt(16/9*e);return isNaN(t)?0:t},getVideoBestSize:function(e,t){var i=this.getVideoHeight(e);return t>=i?t=i:e=this.getVideoWidth(t),{width:e,height:t}},getVideoHeightByRatio:function(e,t){var i=parseInt(1/t*e);return isNaN(i)?0:i},getVideoWidthByRatio:function(e,t){var i=parseInt(t*e);return isNaN(i)?0:i},isElementInHead:function(e){if(!e)return!1;for(;e!==document.body&&e!==document.head;)e=e.parentNode;return e===document.head},getViewPercent:function(e,t,i,n){var o,s=a.default.isEmpty(n)?(0,u.default)(this.getTopWindow()):(0,u.default)(n);o=window.taboolaBridge&&window.taboolaBridge.active?this.calcViewportPositionInApp(n):{top:0,left:0,right:s.width(),bottom:s.height()};var r=Number(i)||0,l=Number(t)||0,d=e.getBoundingClientRect(),c={top:d.top,left:d.left};if(c.right=c.left+l,c.bottom=c.top+r,o.right<c.left||o.left>c.right||o.bottom<c.top||o.top>c.bottom)return 0;var h={top:Math.min(1,(c.bottom-o.top)/r),bottom:Math.min(1,(o.bottom-c.top)/r),left:Math.min(1,(c.right-o.left)/l),right:Math.min(1,(o.right-c.left)/l)},p=h.left*h.right*h.top*h.bottom*100;return p},isViewable:function(e,t,i,n,o){var s=a.default.getViewPercent(e,t,i,o);return!(s<=0)&&(n=n||100,s>=n)},getViewPercentageDeltas:function(e,t,i){var n=(0,u.default)(window),o={top:n.scrollTop(),left:n.scrollLeft()};o.right=o.left+n.width(),o.bottom=o.top+n.height();var s=Number(i)||0,r=Number(t)||0,a=(0,u.default)(e).offset();a.right=a.left+r,a.bottom=a.top+s;var l={top:Math.min(1,(a.bottom-o.top)/s),bottom:Math.min(1,(o.bottom-a.top)/s),left:Math.min(1,(a.right-o.left)/r),right:Math.min(1,(o.right-a.left)/r)};return l},getValidSelectorElements:function(e,t,i){var n=[];return t=t||100,i=i||0,e&&a.default.isArray(e)&&(n=a.default.filter(e,function(e){var n=e.getBoundingClientRect();return n.width>=t&&n.height>=i&&!a.default.has(d.default.INVALID_SELECTOR_TAG_NAMES,e.tagName)})),n},filterObject:function(e,t){if(e){for(var i={},n=0;n<t.length;n++){var o=e[t[n]];void 0!==o&&(i[t[n]]=o)}return i}},stripObject:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;if(e){var r={};for(var l in e)if(!(l in t)){var d=e[l];n&&a.default.isElement(d)||i&&a.default.isFunction(d)||(o&&!a.default.isFunction(d)&&a.default.isObject(d)&&(d=s>0?this.stripObject(d,[],i,n,o,s--):"{stripElements} - value is Object, but max depth reached."),r[l]=d)}return r}},arrayToObj:function(e){if(e){for(var t={},i=0;i<e.length;i++)void 0!==e[i]&&(t[i]=e[i]);return t}},getTopOfEl:function(e){if(e){var t=e,i=0,n=0;if(document.getElementById||document.all){do for(n+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent,t=t.parentNode;t!=e;)n-=t.scrollLeft,i-=t.scrollTop,t=t.parentNode;while(e&&e.offsetParent)}else document.layers&&(i+=e.y,n+=e.x);return i}},getLeftOfEl:function(e){return window.pageXOffset+e.getBoundingClientRect().left},PrefixedEvent:function(e,t,i,n){var o=["webkit","moz","MS","o",""];i=i.toLowerCase(),a.default.each(o,function(o){e[t](o+i,n)})},oneAnimationEnd:function(e,t){var i=a.default.debounce(t,200);this.PrefixedEvent(e,"one","transitionend",i),this.PrefixedEvent(e,"one","animationend",i)},addParametersToUrl:function(e,t,i){var n=e;return n+=i?"?":"&",u.default.each(t,function(e,t){void 0!==t&&""!==t&&(n+=e+"="+t+"&")}),n},skipTransitionCss:function(e,t){e.addClass("none-transition"),e.css(t),this.flushCss(e[0]),e.removeClass("none-transition")},flushCss:function(e){e.offsetHeight},getTopWindow:function(){var e=window;try{for(;e.document!==e.top.document;)e=e.top;return e}catch(e){return window}},isInIframe:function(e){return!!e&&(e.inIframe||e.inDFP)},isInFriendlyIframe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cmTag.config.iframeData;return!!e&&(this.isInIframe(e)&&e.isFriendlyIframe)},hideDFPIframe:function(e){if(this.isInFriendlyIframe(e)){e.iframe.style.display="none";for(var t=e.iframe.parentNode;a.default.some(d.default.DFP_KEYWORDS,function(e){return t.id.indexOf(e)!==-1});)t.style.display="none",t=t.parentNode}},onceDocReady:function(e){return/complete|loaded|interactive/.test(document.readyState)&&document.body?e():(0,u.default)("document").one("DOMContentLoaded",e),this},crc32:function(e){if(!e||"string"!=typeof e)return 0;var t;e=this.utf8Encode(e);var i="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";"undefined"==typeof t&&(t=0);var n=0,o=0;t^=-1;for(var s=0,r=e.length;s<r;s++)o=255&(t^e.charCodeAt(s)),n="0x"+i.substr(9*o,8),t=t>>>8^n;return t^-1},utf8Encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},isMouseOver:function(e){return 0!==e.filter(":hover").length},rollNumbers:function(e){return!!e&&100*Math.random()<e},isFactor:function(e){return a.default.isNumber(e)&&e===a.default.random(1,e)},sendMail:function(e,t,i){function n(){emailjs.init("user_kHlYxxusLRTxC6yr3PjQl"),emailjs.send("gmail","units_support",e).then(t,i)}t=t||function(){},i=i||function(){},window.emailjs?n():a.default.loadJs("//cdn.emailjs.com/dist/email.min.js",n)},isValidEmail:function(e){return!0},hasAutoPlay:function(){var e=p.UAParser(window.navigator.userAgent);return!("iOS"===e.os.name&&parseInt(e.os.version)<10||"Android"===e.os.name&&"Chrome"===e.browser.name&&parseInt(e.browser.version)<53)},toCssObj:function(e){return"string"==typeof e?JSON.parse(e):e},isLayerVisible:function(e){function t(e,o,s,r,a,l,d){var c=e.parentNode,u=2;return!!n(e)&&(9===c.nodeType||"0"!==i(e,"opacity")&&"none"!==i(e,"display")&&"hidden"!==i(e,"visibility")&&("undefined"!=typeof o&&"undefined"!=typeof s&&"undefined"!=typeof r&&"undefined"!=typeof a&&"undefined"!=typeof l&&"undefined"!=typeof d||(o=e.offsetTop,a=e.offsetLeft,r=o+e.offsetHeight,s=a+e.offsetWidth,l=e.offsetWidth,d=e.offsetHeight),!c||("hidden"!==i(c,"overflow")&&"scroll"!==i(c,"overflow")||!(a+u>c.offsetWidth+c.scrollLeft||a+l-u<c.scrollLeft||o+u>c.offsetHeight+c.scrollTop||o+d-u<c.scrollTop))&&(e.offsetParent===c&&(a+=c.offsetLeft,o+=c.offsetTop),t(c,o,s,r,a,l,d))))}function i(e,t){return window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle?e.currentStyle[t]:void 0}function n(e){for(;e=e.parentNode;)if(e===document)return!0;return!1}return t(e)},getOffset:function(e,t){if(e&&Array.isArray(e)&&e[0]&&(e=e[0]),e){if(1===t)return(0,u.default)(e).offset();var i=e,n=e,o=0,s=0;if(document.getElementById||document.all){do for(s+=e.offsetLeft-e.scrollLeft,o+=e.offsetTop-e.scrollTop,e=e.offsetParent,n=n.parentNode;n!=e;)s-=n.scrollLeft,o-=n.scrollTop,n=n.parentNode;while(e&&e.offsetParent)}else document.layers&&(o+=e.y,s+=e.x);return{top:o,left:(0,u.default)(i).offset().left||s}}},flatten:function(e){var t={};for(var i in e)t[i]=e[i];return t},cssObjToString:function(e){var t=!!document.documentMode,i=!t&&!!window.StyleMedia,n=window.navigator.userAgent.indexOf("Firefox")>-1;return(t||i||n)&&(e=this.flatten(e)),JSON.stringify(e)},isModel:function(e,t,i){return i?i.model.get(e)===t:this.model.get(e)===t},generateGuid:function(e,t){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=i,o=[],s=0;for(t=t||n.length,e=e||22,s=0;s<e;s++)o[s]=n[0|Math.random()*t];return o.join("")},isObserverInBrowser:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="undefined"!=typeof IntersectionObserver,i=!1;t&&(i=IntersectionObserver.toString().indexOf("[native code]")!==-1);var n=i||e&&t;return n},isHeightValid:function(e){var t=!0;return e||(t=!1),t},isWidthValid:function(e){var t=!0;return e||(t=!1),t},setTrcObserver:function(e){s(TRC.intersections)&&TRC.intersections.observe&&TRC.intersections.observe(e)},getOffsetWithContainer:function(e,t,i){if(!i)return this.getOffset(e,t);var n=this.getOffset(e,t),o=this.getOffset((0,u.default)(i));return{top:n.top-o.top,left:n.left-o.left}},getIframeDocument:function(e){try{if(e.tagName&&"iframe"==e.tagName.toLowerCase())return e.contentWindow.console.error&&(e.contentWindow.console.error=function(){}),e.contentDocument}catch(e){return null}},DOMIterator:function(e,t,i,n){var o=this;try{var s=this.getIframeDocument(e)||e;if(!s)return;var r=s.querySelectorAll(t);r.forEach(function(e){o.DOMIterator(e,t,i,n)}),i(s.querySelectorAll(n))}catch(e){return}},isBrowserIE11:function(){var e=p.UAParser(window.navigator.userAgent),t=e.browser.name.toLowerCase();return t.indexOf("ie")!==-1&&"11"===e.browser.major},forceElementRedrawWithBorderChange:function(e,t){if(this.isBrowserIE11()&&!t){var i=(0,u.default)(e);i&&i.css&&(i.css("border","1px solid transparent"),setTimeout(function(){i&&i.css&&i.css("border","none")}.bind(i)))}},hasPassedPixelFromSelector:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments[3];if(e){var o=e.toString(),s=(0,u.default)(o),r=s;n&&(r=this.getValidSelectorElements(s));var a=r[0];t=(0,u.default)(t)[0];var l=void 0!==t,d=l?t.clientHeight:window.innerHeight,c=l?d+t.scrollTop:d+window.pageYOffset,h=i,p=this.getTopOfEl(a),f=p-h;return f<=c}},getViewportHeight:function(e){e=(0,u.default)(e)[0];var t=void 0!==e;return t?e.clientHeight:window.innerHeight},calcViewportPositionInApp:function(e){var t=window.taboolaBridge.data,i=t.boundingClientRect,n={top:i.y<0?0-i.y:0,left:0,right:i.width,bottom:i.y>t.rootBounds.height?0:Math.abs(i.y-t.rootBounds.height)};return n},getOrganicCard:function(){var e=TRCImpl.boxes||{};for(var t in e){var i=e[t]||{},n=i.isFeedCard,o=!1;if(i.itemsTypes&&i.itemsTypes["is-organic"]&&(o=i.itemsTypes["is-organic"]),o&&n&&i.boxes.length)return i.mode}},getRootElementFontSize:function(){return parseFloat(getComputedStyle(document.documentElement).fontSize)},convertRem:function(e){return e*this.getRootElementFontSize()},flattenArray:function(e,t){return f(e,t,!1)}})},function(e,t,i){"use strict";var n=i(8);n.mixin({createVpaidLog:function(e,t){var i=null,o=e,s=e.model,r=Date.now(),a=!1,l=["conversion","soundViolation","timeout","bfRon","adPlayTimeout","vastFilterdByRegex","queExpierd","queTrimmed","tagError","tagFlashError","vpaidFlashClientError","queueTrimmed","tillAdstartTimeout","timeoutAutoKill","error_vpaidGeneralError","error_vpaidLoadError","error_vpaidLoadTimeout","error_vpaidInitAdError","error_vpaidInitAdTimeout","error_vpaidStartAdError","error_vpaidStartAdTimeout","error_vpaidPlayError","adStopped"],d={BfRon:!0};delete t.conversionPixels,t.dp=(t.lp&&t.lp.length>0?t.lp[0]:"").replace(/http:\/\/|.com|https:\/\/|.com/g,"")||"na";var c={tag:t,created:(new Date).toISOString(),dp:t.dp,status:"new",unitType:s.get("unitType")};c.connectionType=-1;var u=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(u){var h=u.type||-1;c.connectionType=h}c.hasFetch=Boolean(window.fetch),c.url=window.location.href,screen&&(c.screen={},c.screen.Size=screen.width+"X"+screen.height||-1,c.screen.PixelDepth=screen.pixelDepth||-1,c.screen.orientation=screen.orientation?screen.orientation.type:"not-found");var p=s.get("session_started")||Date.now(),f=function(e,t){var i=Math.floor(Math.random()*(t-e+1))+e;return i},m=function(){if(null!==i)return i;var e=parseInt(s.get("gaFactor"))||1e3;if(1===e)return i=!0;e>100&&(e=100);var t=s.get("abTest")||"";t&&(e=50);var n=f(0,e);return i=n===e},g=function(e,t){var i="error_";return i+=t.errType?t.errType:e},v=function(e,t){var i=o.version,n=s.get("abTest")||"",r=new XMLHttpRequest,a=s.get("kbnul");r.open("POST",a+"/putes/mobileanalytics",!0);var l={event:e,timestamp:(new Date).toISOString(),version:i,abTest:n};l=Object.assign(l,t),r.send(JSON.stringify(l))},y=function(e,t){m()&&v(e,t)},b=function(){if(!a){var e=c.tag;a=!0,_(".tries"),"conversion"===c.status?(_(".conversions"),s.set(c.dp+".failsRow",0),s.set(e.lineItemId+".failsRow",0)):(_(".fails"),_(".failsRow"));var t=s.get(c.dp)||{fails:0,failsRow:0,conversions:0},i=Object.assign(s.get(e.lineItemId.toString()),{fails:0,failsRow:0,conversions:0});t.lineItems=t.lineItems||[],i.conversions=t.conversions=t.conversions||0,i.fails=t.fails=t.fails||0,i.failsRow=t.failsRow=t.failsRow||0,t.lineItems.indexOf(e.lineItemId)===-1&&t.lineItems.push(e.lineItemId),c.dpLog=t;var n=s.get("lineItems")||[];n.indexOf(e.lineItemId)===-1&&(n.push(e.lineItemId),s.set("lineItems",n)),s.set(e.lineItemId,i)}},_=function(e){var t=s.get(c.dp+e)||0,i=s.get(c.tag.lineItemId+e)||0;s.set(c.dp+e,t+1),s.set(c.tag.lineItemId+e,i+1)};return{push:function(e,t){if(c){if(t=t||{},e.indexOf("Error")>-1||"event_SoundViolation"===e)c.status=g(e,t);else if(this.eventToStatus.hasOwnProperty(e)&&"conversion"!==c.status)c.status=this.eventToStatus[e];else if(d.hasOwnProperty(e)){var i="is"+e;c[i]=!0}var n=Date.now()-p,o=Date.now()-r;if(t.time=o,t.globalTime=n,c.hasOwnProperty(e))return Array.isArray(!c[e])||(c[e]=[c[e]]),void c[e].push(t);c[e]=t,l.indexOf(c.status)!==-1&&b()}},saveToDb:function(){if(c){var e;try{e=n.getLoopTime()}catch(e){}e&&(c.loopTime=e),y("VpaidLog",c),t=null,c=null}},eventToStatus:{event_AdImpression:"conversion",event_SoundViolation:"soundViolation",vpaidGeneralError:"vpaidGeneralError",vpaidLoadError:"vpaidLoadError",vpaidLoadTimeout:"vpaidLoadTimeoutError",vpaidInitAdError:"vpaidInitAdError",vpaidInitAdTimeout:"vpaidInitAdTimeoutError",vpaidStartAdError:"vpaidStartAdError",vpaidStartAdTimeout:"vpaidStartAdTimeoutError",vpaidPlayError:"vpaidPlayError",event_AdLoaded:"adLoaded",fetchVast:"fetchVast",adStopped:"adStopped"}}}})},function(e,t,i){var n,o,s,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=i(8),l=i(11);(function(){var e,t,i,n,o,s,r,d=[].slice;i=function(e){var t,n;return!a.isObject(e)||a.isFunction(e)?e:e instanceof l.Collection||e instanceof l.Model?e:a.isDate(e)?new Date(e.getTime()):a.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):e instanceof HTMLElement?e:e instanceof CSSStyleDeclaration?JSON.stringify(r(e)):(n=a.isArray(e||a.isArguments(e)),t=function(e,t,o){return n?e.push(i(t)):e[o]=i(t),e},a.reduce(e,t,n?[]:{}))},r=function(e){var t=!!document.documentMode,i=!t&&!!window.StyleMedia;if(!t&&!i)return e;var n={};for(var o in e)n[o]=e[o];return n},s=function(e){return null!=e&&((e.prototype==={}.prototype||e.prototype===Object.prototype)&&a.isObject(e)&&!a.isArray(e)&&!a.isFunction(e)&&!a.isDate(e)&&!a.isRegExp(e)&&!a.isArguments(e))},t=function(e){return a.filter(a.keys(e),function(t){return s(e[t])})},e=function(e){return a.filter(a.keys(e),function(t){return a.isArray(e[t])})},o=function(i,n,s){var r,l,d,c,u,h,p,f,m,g;if(null==s&&(s=20),s<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),a.extend(i,n);for(h=a.intersection(t(i),t(n)),l=function(e){return n[e]=o(i[e],n[e],s-1)},p=0,m=h.length;p<m;p++)u=h[p],l(u);for(c=a.intersection(e(i),e(n)),r=function(e){return n[e]=a.union(i[e],n[e])},f=0,g=c.length;f<g;f++)d=c[f],r(d);return a.extend(i,n)},n=function(){var e,t,n,s;if(n=2<=arguments.length?d.call(arguments,0,s=arguments.length-1):(s=0,[]),t=arguments[s++],a.isNumber(t)||(n.push(t),t=20),n.length<=1)return n[0];if(t<=0)return a.extend.apply(this,n);for(e=n.shift();n.length>0;)e=o(e,i(n.shift()),t);return e},a.mixin({deepClone:i,isBasicObject:s,basicObjects:t,arrays:e,deepExtend:n})}).call(void 0),function(r){o=[i(8),i(11)],n=r,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s))}(function(t,i){function n(e){var i={},o=c.keyPathSeparator;for(var s in e){var r=e[s];if(r&&r.constructor===Object&&!t.isEmpty(r)){var a=n(r);for(var l in a){var d=a[l];i[s+o+l]=d}}else i[s]=r}return i}function o(e,i,n){for(var o=c.keyPathSeparator,s=i.split(o),r=e,a=0,l=s.length;a<l;a++){if(n&&!t.has(r,s[a]))return!1;if(r=r[s[a]],null==r&&a<l-1&&(r={}),"undefined"==typeof r)return!!n||r}return!!n||r}function s(e,i,n,o){o=o||{};for(var s=c.keyPathSeparator,r=i.split(s),a=e,l=0,d=r.length;l<d&&void 0!==a;l++){var u=r[l];l===d-1?o.unset?delete a[u]:a[u]=n:("undefined"!=typeof a[u]&&t.isObject(a[u])||(a[u]={}),a=a[u])}}function a(e){var i={};return"object"!==("undefined"==typeof e?"undefined":r(e))?e:(t.each(e,function(e,t,n){i[t]=l(e)}),i)}function l(e){if(e&&"["===e[0]&&"]"===e[e.length-1]){var i=void 0;try{i=JSON.parse(e)}catch(t){i=e}e=i}if(t.isArray(e)){var n=[];return t.each(e,function(e){n.push(l(e))}),n}return"object"!==("undefined"==typeof e?"undefined":r(e))||t.isElement(e)?"true"===e||e===!0||"false"!==e&&e!==!1&&(""===e?e:isNaN(e)?e:Number(e)):a(e)}function d(e,t){s(e,t,null,{unset:!0})}var c=i.Model.extend({constructor:function(e,i){var n,o=e||{};this.cid=t.uniqueId("c"),this.attributes={},i&&i.collection&&(this.collection=i.collection),i&&i.parse&&(o=this.parse(o,i)||{}),(n=t.result(this,"defaults"))&&(o=t.deepExtend({},n,o)),this.set(o,i),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(e){return t.deepClone(this.attributes)},get:function(e){return o(this.attributes,e)},set:function(e,i,l){var u,h,p,f,m,g,v,y;if(null==e)return this;if("object"===("undefined"==typeof e?"undefined":r(e))?(h=e,l=i||{}):(h={})[e]=i,h=a(h),l||(l={}),!this._validate(h,l))return!1;p=l.unset,m=l.silent,f=[],g=this._changing,this._changing=!0,g||(this._previousAttributes=t.deepClone(this.attributes),this.changed={}),y=this.attributes,v=this._previousAttributes,this.idAttribute in h&&(this.id=h[this.idAttribute]),h=n(h);for(u in h)i=h[u],t.isEqual(o(y,u),i)||f.push(u),t.isEqual(o(v,u),i)?d(this.changed,u):s(this.changed,u,i),p?d(y,u):s(y,u,i);if(!m){f.length&&(this._pending=!0);for(var b=c.keyPathSeparator,_=0,w=f.length;_<w;_++){var e=f[_];this.trigger("change:"+e,this,o(y,e),l);for(var T=e.split(b),A=T.length-1;A>0;A--){var S=t.first(T,A).join(b),P=S+b+"*";this.trigger("change:"+P,this,o(y,S),l),this.trigger("change:"+S,this,o(y,e),l)}}}if(g)return this;if(!m)for(;this._pending;)this._pending=!1,this.trigger("change",this,l);return this._pending=!1,this._changing=!1,this},clear:function(e){var i={},o=n(this.attributes);for(var s in o)i[s]=void 0;return this.set(i,t.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!t.isEmpty(this.changed):void 0!==o(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n(this.changed);var i=this._changing?this._previousAttributes:this.attributes;e=n(e),i=n(i);var o,s=!1;for(var r in e)t.isEqual(i[r],o=e[r])||((s||(s={}))[r]=o);return s},previous:function(e){return null!=e&&this._previousAttributes?o(this._previousAttributes,e):null},previousAttributes:function(){return t.deepClone(this._previousAttributes)}});return c.keyPathSeparator=".",i.DeepModel=c,e.exports=c,i})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8),a=n(r),l=i(10),d=n(l),c=i(11),u=n(c),h=i(25),p=n(h),f=function(){function e(t,i){o(this,e),this.window=t||window,this.$window=(0,d.default)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),
this.setScrollableSelector(i),this._timeBetweenEvents=100,this.keyPressMap={17:!1,18:!1,84:!1,86:!1},this._setScrollListener(),this._setMouseMoveListener(),this._setKeyPressListener(),this._setTabViewListener(),this._setOrientationChangeListener(),this._setResizeListener(),this._setTaboolaReadMoreListener()}return s(e,[{key:"_setScrollListener",value:function(){var e=a.default.throttle(this._trigger.bind(this,"window:scroll:change"),this._timeBetweenEvents);this.scrollSelector.addEventListener("scroll",e)}},{key:"_setMouseMoveListener",value:function(){var e=a.default.throttle(this._trigger.bind(this,"window:mouse:move"),this._timeBetweenEvents);this.window.addEventListener("mousemove",e)}},{key:"_setKeyPressListener",value:function(){var e=this;this.window.addEventListener("keyup",function(t){e._trigger.bind(e,"window:key:press"),t.keyCode in e.keyPressMap&&(e.keyPressMap[t.keyCode]=!1)}),this.window.addEventListener("keydown",function(t){t.keyCode in e.keyPressMap&&(e.keyPressMap[t.keyCode]=!0,e.keyPressMap[17]&&e.keyPressMap[18]&&e.keyPressMap[84]&&e.keyPressMap[86]&&(u.default.trigger("supportTool:event","open"),e.keyPressMap[17]=e.keyPressMap[18]=e.keyPressMap[84]=e.keyPressMap[86]=!1))})}},{key:"_setOrientationChangeListener",value:function(){var e=this,t=a.default.throttle(e._trigger.bind(e,"window:orientation:change"),this._timeBetweenEvents);window.addEventListener("orientationchange",t)}},{key:"_setResizeListener",value:function(){var e=this,t=a.default.throttle(e._handleResizeEvent.bind(e),this._timeBetweenEvents);window.addEventListener("resize",t)}},{key:"_setTabViewListener",value:function(){this.isTabOut=document.hidden,this.window.document.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this)),this.window.addEventListener("focus",this._handleTabEvents.bind(this),!0),this.window.addEventListener("blur",this._handleTabEvents.bind(this),!0)}},{key:"_handleResizeEvent",value:function(e){var t=this.$window.height(),i=t-this.windowHeight;this.windowHeight=t;var n=this.$window.width(),o=n-this.windowWidth;this.windowWidth=n,this._trigger("window:resize:change",{heightChange:i,widthChange:o})}},{key:"_handleVisibilityChange",value:function(e){this.isTabOut=document.hidden,this._handleTabEvents(e)}},{key:"_handleTabEvents",value:function(e){this.isTabOut?this._trigger("window:tab:change",p.default.TAB_STATE.tabOut):"focus"===e.type?this._trigger("window:tab:change",p.default.TAB_STATE.focus):this._trigger("window:tab:change",p.default.TAB_STATE.blur)}},{key:"_trigger",value:function(e,t){u.default.trigger(e,t)}},{key:"_setTaboolaReadMoreListener",value:function(){window._taboola=window._taboola||[],_taboola.push({listenTo:"readmore.click",handler:function(){u.default&&u.default.trigger("taboola:readmore:click")}})}},{key:"setScrollableSelector",value:function(e){"document"===e?this.scrollSelector=document:this.scrollSelector=a.default.isEmpty(e)?this.window:(0,d.default)(e)[0]}}]),e}(),m=function(){var e;return function(t,i){return e||(e=new f(t,i)),e}}();e.exports=m},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8),a=n(r),l={ALL:"ALL",P_VIDEO:"P_VIDEO",B_VIDEO:"B_VIDEO"},d=function(){function e(){o(this,e)}return s(e,[{key:"addUnit",value:function(e,t){a.default.isEmpty(window.cmTag.unitList)&&(window.cmTag.unitList={}),this.unitsList=window.cmTag.unitList||{},this.unitsList[e]=t,window.cmTag.unitList=this.unitsList,this._listenUnitsEvents(e)}},{key:"_listenUnitsEvents",value:function(e){var t=this.unitsList[e];t.on("change:generalPlayingUnitState",this._onPlayingChange.bind(this,e))}},{key:"_onPlayingChange",value:function(e,t,i){a.default.size(this.unitsList)>1&&(i===!0||i===!1)&&this._decidePlayOrPause()}},{key:"_findVideo",value:function(e,t){for(var i=a.default.sortBy(this.unitsList,function(e,t){return"CUSTOM"==e.get("unitType")}),n=0;n<i.length;n++){var o=i[n],s=o.get("redId"),r=null;switch(e){case l.ALL:r=!0;break;case l.P_VIDEO:r="CUSTOM"==this._getUnitType(s);break;case l.B_VIDEO:r="CUSTOM"!=this._getUnitType(s)}r&&t.bind(this,s)()}}},{key:"_decidePlayOrPause",value:function(){var e=this._countPlayingUnitsOnView();e.playingUnits>1&&e.eligibleUnits>1?this._decidePause():0==e.playingUnits&&e.eligibleUnits>0&&this._decidePlay()}},{key:"_decidePause",value:function(){this._findVideo(l.P_VIDEO,function(e){this._isUnitEligibleToPlay(e)&&this._isUnitPlaying(e)&&this._pauseUnit(e)})}},{key:"_decidePlay",value:function(){this._findVideo(l.P_VIDEO,function(e){this._isUnitEligibleToPlay(e)&&!this._isUnitPlaying(e)&&this._playUnit(e)}),this._playOutOfView()}},{key:"_playOutOfView",value:function(){var e=null;this._findVideo(l.B_VIDEO,function(t){null===e&&(e=!this._isUnitPlaying(t)&&this._isUnitEligibleToPlay(t))}),e&&this._findVideo(l.P_VIDEO,function(e){this._playUnit(e)})}},{key:"_pauseUnit",value:function(e){this.unitsList[e].set("multiUnitManager.state","pause")}},{key:"_playUnit",value:function(e){this.unitsList[e].set("multiUnitManager.state","play")}},{key:"_countPlayingUnitsOnView",value:function(){var e=this,t=0,i=0;return a.default.each(this.unitsList,function(n){var o=n.get("redId");e._isUnitAllowToPlay(o)&&e._isUnitPlaying(o)&&t++,e._isUnitEligibleToPlay(o)&&i++}),{playingUnits:t,eligibleUnits:i}}},{key:"_isUnitEligibleToPlay",value:function(e){return this.unitsList[e].get("isEligibleToPlay")||this.unitsList[e].get("isUnitEligible")||this.unitsList[e].get("isUnitViewable")}},{key:"_isUnitAllowToPlay",value:function(e){return"pause"!=this.unitsList[e].get("multiUnitManager.state")&&this._isUnitEligibleToPlay(e)}},{key:"_isUnitPlaying",value:function(e){return this.unitsList[e].get("generalPlayingUnitState")}},{key:"_getUnitType",value:function(e){return this.unitsList[e].get("unitType")}}]),e}();cmTag.multiUnitManager=cmTag.multiUnitManager||new d,e.exports=cmTag.multiUnitManager},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(11),r=i(8),a=function(){function e(t){n(this,e),this.callBacks={},this._mapCallbackNames(),this._setCallbacks(t)}return o(e,[{key:"_setCallbacks",value:function(e){this.isValidCallback(e,this.callbackNames.conversion)&&(this.callBacks.onConversion=e.onConversion,s.on("global:creativeEvent",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.conversion))),this.isValidCallback(e,this.callbackNames.fill)&&(this.callBacks.onFilledImpression=e.onFilledImpression,s.on("filledImpression",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.fill))),this.isValidCallback(e,this.callbackNames.impression)&&(this.callBacks.onImpression=e.onImpression,s.on("onImpression",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.impression))),this.isValidCallback(e,this.callbackNames.play)&&(this.callBacks.onPlay=e.onPlay,s.on("global:adState:playing",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.play))),this.isValidCallback(e,this.callbackNames.terminate)&&(this.callBacks.onTerminate=e.onTerminate,s.once("global:closeState:changed",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.terminate))),this.isValidCallback(e,this.callbackNames.passback)&&(this.callBacks.onPassback=e.onPassback,s.once("global:passback",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.passback)))}},{key:"_onGlobalCreativeEvent",value:function(e,t,i){t=t||{},this.callBacks[t.type]&&this.callBacks[t.type](i),t.name&&TRC&&TRC.dispatch&&TRC.dispatch("api::video."+t.name,e)}},{key:"isValidCallback",value:function(e,t){if("string"==typeof e[t.type]){var i=new Function("additionalData",e[t.type].split("function(){").pop().slice(0,-1));delete e[t.type],Object.defineProperty(e,t.type,{value:i})}return!(!r.isFunction(e[t.type])&&!this._isApiCallbackExist(t.name))}},{key:"_isApiCallbackExist",value:function(e){if(TRC&&TRC._taboolaClone)for(var t=0;t<TRC._taboolaClone.length;t++)if(TRC._taboolaClone[t].listenTo=="video."+e)return!0;return!1}},{key:"_mapCallbackNames",value:function(){this.callbackNames={conversion:{type:"onConversion",name:"conversion"},fill:{type:"onFilledImpression",name:"fill"},impression:{type:"onImpression",name:"impression"},play:{type:"onPlay",name:"play"},terminate:{type:"onTerminate",name:"terminate"},passback:{type:"onPassback",name:"passback"}}}}]),e}();e.exports=a},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(40),a=(i(25),i(16)),l=n(a),d=function(){function e(t){o(this,e),this.syncUrl=t.get("sync"),this.log=new l.default({unitType:t.get("unitType"),className:this.constructor.name,version:t.get("version"),isDebug:t.get("isDebug")}),this.timePredict=new r.timePredict({model:t,onPredict:this._syncCookies.bind(this)}),this._syncCookies()}return s(e,[{key:"_syncCookies",value:function(){var e=this;this.log.info("Cookie sync request",this.syncUrl);var t=document.createElement("iframe");t.style.display="none",t.src=this.syncUrl,t.onerror=function(){e._stopSync()},document.body.appendChild(t)}},{key:"_stopSync",value:function(){this.log.info("Stopping cookie sync"),this.timePredict.stop()}}]),e}();e.exports=d},function(e,t,i){"use strict";e.exports={beforeCMTag:i(136)}},function(e,t,i){"use strict";var n=i(8),o=i(137),s=i(138),r={init:function(e){o.set("Function","bind"),o.set("Event","constructor",!0),o.set("Array","forEach",!1),o.set("Array","every",!1),o.setWindowFunctions(e.nativeFunctions),new s,window.cmTag.customDataForTest={startWithABT:!1};var t=!!e.gaFactor&&n.isFactor(parseInt(e.gaFactor));t&&window.addEventListener("error",function(t){try{if(t.filename.indexOf("infra/cmTag")==-1)return;var i={timestamp:(new Date).toISOString(),message:t.message,lineNum:t.lineno,fullUrl:window.location.href,userAgent:window.navigator.userAgent,firedStartWithABT:window.cmTag.customDataForTest.startWithABT,unitType:e.unitType};t.error&&(i.callStack=t.error.stack);var n=new XMLHttpRequest,o="//vidanalytics.taboola.com";n.open("POST",o+"/putes/cm_units_error_logs",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var s=JSON.stringify(i);n.send(s)}catch(e){return}})}};e.exports=r.init},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=null,s=function(e){return/\{\s*\[native code\]\s*\}/.test(""+e)},r=function(){function e(){return i(this,e),o||(o=this),o}return n(e,[{key:"set",value:function(e,t,i){s(window[e].prototype[t])||(this.iframe||this.createIframe(),this.iframe.contentWindow[e].prototype[t]&&(window[e].prototype[t]=this.iframe.contentWindow[e].prototype[t],i&&(window[e]=this.iframe.contentWindow[e])))}},{key:"setWindowFunctions",value:function(e){if(e){this.iframe||this.createIframe();var t=e.split(",");t.forEach(function(e){var t=e.split(".");this.setWindowNestedFunctions(window,t)}.bind(this))}}},{key:"createIframe",value:function(){this.iframe=document.createElement("iframe"),this.iframe.style.width=0,this.iframe.style.height=0,this.iframe.style.visibility="hidden",this.iframe.style.display="none",document.body.appendChild(this.iframe)}},{key:"setWindowNestedFunctions",value:function(e,t){var i=t.shift();0==t.length?e[i]=this.iframe.contentWindow[i]:this.setWindowNestedFunctions(e[i],t)}}]),e}();e.exports=new r},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){i(this,e),this.arrayFrom()}return n(e,[{key:"arrayFrom",value:function(){Array.from||(Array.from=function(){var e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},i=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},n=Math.pow(2,53)-1,o=function(e){var t=i(e);return Math.min(Math.max(t,0),n)};return function(e){var i=this,n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var s,r=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof r){if(!t(r))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(s=arguments[2])}for(var a,l=o(n.length),d=t(i)?Object(new i(l)):new Array(l),c=0;c<l;)a=n[c],r?d[c]="undefined"==typeof s?r(a,c):r.call(s,a,c):d[c]=a,c+=1;return d.length=l,d}}())}}]),e}();e.exports=o},function(e,t,i){"use strict";var n=i(11),o=i(8),s=i(10),r=(i(140),i(141));e.exports=n.View.extend({className:"_cm-panel",id:"_cm-css-reset",events:{"click ._cm-close-button":"_onCloseButtonClick","click ._cm-panel-submit":"_onSubmitButtonClick"},container:s("body"),ui:{},initialize:function(e){this.render(),this.ui.name=this.$("._cm-panel-name"),this.ui.email=this.$("._cm-panel-email"),this.ui.details=this.$("._cm-panel-details"),this.ui.success=this.$("._cm-panel-notifications-success"),this.ui.error=this.$("._cm-panel-notifications-error"),this.ui.sending=this.$("._cm-panel-notifications-sending"),this.ui.btnSend=this.$("._cm-panel-submit"),this._hideText(),this._bindEvents()},render:function(){this.$el.append(r),this.container.append(this.el)},_bindEvents:function(){this.listenTo(this.model,"save:success",this._onSaveSuccess)},_onCloseButtonClick:function(){this.$el.hide(),n.trigger("supportTool:event","close")},_onSubmitButtonClick:function(){var e=this._validateForm();e&&(this.ui.btnSend[0].disabled=!0,this.model.set({name:this.ui.name.val(),email:this.ui.email.val(),details:this.ui.details.val()}),this.ui.sending.show(),this.model.save())},_validateForm:function(){return this.ui.email.val()&&o.isValidEmail(this.ui.email.val())?(this.ui.email.removeClass("_cm-panel-error"),!0):(this.ui.email.addClass("_cm-panel-error"),!1)},_onSaveSuccess:function(){this._hideText(),this.ui.success.show()},_hideText:function(){this.ui.success.hide(),this.ui.sending.hide(),this.ui.error.hide()}})},function(e,t){"use strict";function i(e){window.cmTag=window.cmTag||{},e=e||{},this.unitType=e.unitType,this.className=this.className||e.className}i.prototype.info=function(e,t){window.cmTag.logger.info("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},i.prototype.debug=function(e,t){window.cmTag.logger.info("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},i.prototype.error=function(e,t){window.cmTag.logger.error("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},e.exports=i},function(e,t){e.exports="<div class=_cm-panel-heading> <strong> <span>Taboola Video Support</span> </strong> <strong class=_cm-close-button>x</strong> </div> <div class=_cm-panel-body> <div class=_cm-panel-header>Use this form to report an issue with Taboola Video. </div> <div class=_cm-panel-row> <label>Name:</label> <input type=text class=_cm-panel-name> </div> <div class=_cm-panel-row> <label>Email:</label> <input type=email class=_cm-panel-email> </div> <div class=_cm-panel-row> <label>Details:</label> <textarea class=_cm-panel-details></textarea> </div> <div class=_cm-panel-row> <input type=button class=_cm-panel-submit value=Send> </div> <div class=_cm-panel-notifications> <div class=_cm-panel-notifications-sending>Sending message, please wait. </div> <div class=_cm-panel-notifications-success>Thank you! Your message has been successfully sent. </div> <div class=_cm-panel-notifications-error>Error - Something went wrong... Your message was not sent. </div> </div> </div>"},function(e,t,i){"use strict";var n=i(11),o=i(10),s=i(8);e.exports=n.DeepModel.extend({initialize:function(e){var t=o.extend(!0,{},e.creativeData),i=o.extend(!0,{},e.unitModel);delete t.iframeData,delete t.placementElement,delete i.iframeData,delete i.placementElement,this.set("creativeData",JSON.stringify(t)),this.set("unitModel",JSON.stringify(i)),this.set({userAgent:window.navigator.userAgent,date:new Date,url:window.location.href}),this.set("vpaidLogs",JSON.stringify(e.vpaidLogs)),e.dp&&this.set("demandPartner",e.dp)},save:function(){s.sendMail(this.attributes,this._onSaveSuccess.bind(this),this._onSaveError.bind(this))},_onSaveSuccess:function(){this.trigger("save:success")},_onSaveError:function(){this.trigger("save:error")}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(25),s=(n(o),i(11),i(8)),r=i(144),a=i(10);e.exports=r.extend({defaults:a.extend(!0,{},r.prototype.defaults,{animation:{onTransitionOpen:!1,onTransitionClose:!1,transitionAnimationTime:500,detach:500,firstDetach:1e3,slideOut:500,attach:500},customization:{adTitle:{}},organicCardPlacementName:"Organic card below video",openingEffect:1,onTimerClose:"close",bfFactor:0,noaop:2,wfDynamicPause:!1,wfManual:!0,runWfWhenEmpty:!0,viewPercent:20,allowedHeightChange:75,secondsBW:60,isObserveFeedParent:!1,parentSelector:".tbl-feed-container",isMultiActiveAds:!0,isAnimateOnClose:!1,feedCardSelector:".tbl-feed-card",isOpenInViewPort:!0,kibanaEventsToSend:"all",predictors:{autoKill:{isActive:!0},getAdFail:{isActive:!0},multiAd:{isActive:!0,predictPoints:{}},loading:{isActive:!0,predictPoints:"any"},repeat:{isActive:!0,predictPoints:"any"},playerReady:{isActive:!0,predictPoint:0},distancePercent:{isActive:!1,predictPoints:{}},distancePixels:{isActive:!1,predictPoints:{}}},playPriority:{type:"ppKey",key:1},vForce:{isActive:!0,getAdTimeoutSeconds:60},components:{disclosureText:{text:"ADVERTISEMENT"},CloseButtonView:{delay:3e3},adChoice:{isActive:!0,fallbackUrl:"https://popup.taboola.com/en",icon:"//cdn.taboola.com/static/c5/c5ef96bc-30ab-456a-b3d5-a84f367c6a46.svg",position:"above",title:{isActive:!1,text:"Sponsored Video by Taboola",style:{},logoStyle:{},adViewStyle:{}},videoAd:{isActive:!1,text:"Ad",style:{},logoStyle:{}},slider:{isActive:!0,text:"Ad",style:{},logoStyle:{}}},volume:{isActive:!1,expandedText:"Unmute",timeToMinimize:2e3,style:{border:{},mute:{},unmute:{},text:{}}}},hasCloseButton:!1,detachToSlider:{isStartFromSlider:!1,isDetachToSlider:!1,isDetachAbove:!1,isDetachBelow:!0,width:400,height:400,position:{horizontal:"right",vertical:"bottom",horizontalOffset:0,verticalOffset:0},liquidSize:{isActive:!1,widthPercent:33,minWidth:200,heightPercent:30,maxHeight:350},customCss:null,animation:!0,hasCloseButton:!0,onOutOfView:"pause",isCheckForFirstOnPage:!0,isCheckForTopCard:!0,components:{disclosureText:{text:"ADVERTISEMENT",isActive:!1}}},category:"blankblack5",isMultiAd:!0,pubId:169497,pubTagId:953497,preroll:{pubId:169497,pubTagId:953497},midroll:{pubId:169497,pubTagId:953497},postroll:{pubId:169497,pubTagId:953497},secondsToClose:200,secondsToCloseFeed:20,contentTimerSeconds:20,isMobile:!1,onOutOfView:"pause",unitTitle:"",vertical:"_#VERTICAL#_",player:{hasControls:!1,urls:{blankLocation:"{{player.urls.contentVideosLocation}}/blackScreen5.mp4"},bfFactor:0,settings:{vakll:24e4,time_between_waterfall:1,mintimwf:1e4,bfFactor:0,ad_loaded_method:!0,wf_manual:!1,wf_dynmc_ps:!1,vforce2:"vforce2",isMultiVpaidUnit:!0,mprdct:.025}},maxVideoCards:100,minTopForVideo:10,minLeftForVideo:10,verticalWidthThreshold:350,isFireSP:{32:!0},isPlayerOutOfViewport:!1,isToggleIframeContent:!1,cardEligibilityPercent:50,continueToPlayInNexCard:{isActive:!1},stickyCard:{detachFromTopDistance:0,attachPercent:100,offset:{top:0,left:0},observerThreshold:[.01,.99],maxAspectRatio:.8,restrictions:{maxWidth:800,rv:!0,adPercent:{percent:28,secondsToClose:2}}}}),initialize:function(){r.prototype.initialize.call(this),this.loadContent(),window.TRC&&window.TRC.isAMP===!0&&(this.set("detachToSlider.isDetachToSlider",!1),this.set("detachToSlider.isStartFromSlider",!1),this.set("stickyCard.isActive",!1)),this.get("detachToSlider.isStartFromSlider")&&this.set("isRvPriority",!1),(this.get("detachToSlider.isStartFromSlider")||this.get("detachToSlider.isDetachToSlider")||this.get("permanentCard"))&&this.set("getCardMaxPPS",void 0),this.get("stickyCard.isActive")&&(this.set("detachToSlider.isDetachAbove",!1),this.set("detachToSlider.isDetachBelow",!0),this.set("detachToSlider.isDetachToSlider",!0),this.set("detachToSlider.isStartFromSlider",!1),this.set("videoContainerSelector",this.get("parentSelector")))},loadContent:function(){"mrss"===this.get("contentLoadType")?a.ajax({url:this.get("player.urls.contentLocation"),dataType:"xml",success:this._onMrssLoad.bind(this)}):"direct"===this.get("contentLoadType")?this.set("player.playlist",[{id:0,title:"",link:"",url:this.get("player.urls.contentLocation")||this.get("pVideoUrl"),type:"video/mp4",image:""}]):(window.category=this.get("category"),s.loadJs(this.get("player.urls.contentLocation"),this._onContentLoad.bind(this)))},_onMrssLoad:function(e){var t=[];a(e).find("item").each(function(e,i){var i=a(i),n={};n.id=e,n.title=i.find("title").text(),n.link=i.find("link").text(),n.url=i.find("media\\:content,content").attr("url"),n.type=i.find("media\\:content,content").attr("type"),n.image=i.find("media\\:thumbnail,thumbnail").attr("url"),t.push(n)}),this.set("player.playlist",t)},_onContentLoad:function(){window.playlist.forEach(function(e,t,i){i[t].image=this.get("player.urls.contentImagesLocation")+"/"+e.image,i[t].title=e.title.replace(/([A-Z])/g,"$1").replace(/^./,function(e){return e.toUpperCase()}),i[t].url=this.get("player.urls.contentVideosLocation")+"/"+i[t].filename,i[t].name=i[t].filename,i[t].type="video/mp4"},this),this.set("player.playlist",window.playlist)}})},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var s=i(145),r=o(s),a=i(21),l=n(a),d=i(85),c=o(d),u=(i(40),i(25)),h=o(u),p=(i(11),i(8)),f=(i(146),i(10));e.exports=r.default.extend({defaults:f.extend(!0,{},r.default.prototype.defaults,{bfFactor:0,isMultiAd:!0,kibanaEventsToSend:"all",runWfWhenEmpty:!0,viewPercent:20,wfDynamicPause:!1,isCheckTopParentSelectorLost:!0,predictors:{isGet1OnlyAfterAdLoaded:!1,autoKill:{isActive:!0},bForce:{isActive:!1,predictPoints:1},getAdFail:{isActive:!0,allowedPredictPoints:"any"},multiAd:{isActive:!0,predictPoints:{}},emptyQueue:{isActive:!0,predictPoints:"any"},loading:{isActive:!0,predictPoints:"any"},repeat:{isActive:!0,predictPoints:"any"},playerReady:{isActive:!0,predictPoint:0},distancePercent:{isActive:!1,predictPoints:{}},distancePixels:{isActive:!1,predictPoints:{}},firstScroll:{isActive:!1,predictPoints:0},fullEligibility:{isActive:!1,predictPoints:1,maxPPS:1,checkPredictsSeconds:.5},intersection:{isActive:!1},feedX:{isActive:!0,predictPoints:"any"}},playPriority:{type:"ppKey",key:1,checkForRvPriority:"onEligibility"},vForce:{isActive:!0,getAdTimeoutSeconds:60,secondsToGetAdFail:{0:60,1:60}},player:{urls:{blankLocation:"{{player.urls.contentVideosLocation}}/blackScreen60.mp4",contentLocation:"{{urls.base}}/content{{player.versions.content}}.js",contentImagesLocation:"{{player.urls.contentVideosLocation}}/img"},hasAdControls:!0,settings:{queue_size:6,max_ready_vpaid:3,mprdct:.025},playlist:[]},rboxCssSelectors:{title:".video-label.video-title",description:".video-label.video-description",branding:".video-label-box .branding"},secondsToWaitForRV:5,timeBetweenDetectionCompSeconds:5,maxTriesForDetectingComp:10,renderLearnMore:!0,nativeAdMapping:{title:"title",ctaButtone:"ctatext",description:"desc",branding:"sponsored",icon:"icon"}}),initialize:function(){r.default.prototype.initialize.call(this),this.set("player.playlist",[{url:this.get("player.urls.blankLocation"),name:"Blank",title:"Blank",type:"video/mp4"}]),this.get("isEligibilityNomination")&&(this._initBforce(),this.RvHandler=new c.default(this)),this.get("frameType")!==h.default.FRAME_TYPE.plainPage?(this.set("predictors.distancePixels.isActive",!1),this.set("predictors.distancePixels.isStartWF",!1),this.set("predictors.distancePercent.isActive",!1),this.set("predictors.distancePercent.isStartWF",!1)):(this.set("predictors.intersection.isActive",!1),this.set("predictors.intersection.isStartWF",!1)),window.category=this.get("category"),p.loadJs(this.get("player.urls.contentLocation"),this._onContentLoad.bind(this))},_initBforce:function(){this.set("startListenToEligibility",!1),this.listenTo(this,"change:preEligibility",this._onPreEligibility.bind(this)),this.listenTo(this,"change:playerHasRvInQ",this._onHasPotentialAd.bind(this)),this.listenTo(this,"change:gotNonRvAd",this._onHasPotentialAd.bind(this))},_onHasPotentialAd:function(){var e=this.get("rvHandlerState")!==l.rvHandlerState.working;e&&this.get("preEligibility")&&(this.get("playerHasRvInQ")?this.RvHandler.onPreEligibility():this.get("gotNonRvAd")&&this.set("startListenToEligibility",!0))},_onPreEligibility:function(){var e=this.get("rvHandlerState")!==l.rvHandlerState.working;e&&(this.get("playerHasRvInQ")?this.RvHandler.onPreEligibility():this.get("gotNonRvAd")&&this.set("startListenToEligibility",!0))},getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("pubId"),this.get("pubTagId"))),e},_onContentLoad:function(){window.playlist.forEach(function(e,t,i){i[t].image=this.get("player.urls.contentImagesLocation")+"/"+e.image,i[t].title=e.title.replace(/([A-Z])/g,"$1").replace(/^./,function(e){return e.toUpperCase()}),i[t].url=this.get("player.urls.contentVideosLocation")+"/"+i[t].filename,i[t].name=i[t].filename,i[t].type="video/mp4"},this),this.set("player.playlist",window.playlist)},isVerticalVideoEnabled:function(e){var t=e||this.get("videoPlaceholderSize.width");return t<=this.get("verticalWidthThreshold")}})},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var s=i(8),r=o(s),a=i(11),l=o(a),d=i(130),c=(o(d),i(140)),u=o(c),h=i(22),p=o(h),f=i(71),m=n(f),g=i(25),v=o(g);e.exports=l.default.DeepModel.extend({STATE:{READY:0,GOT_AD:1,PLAYING:2,PAUSED:3,PAUSED_BY_USER:4,STOPPED_BY_USER:5,DETACHED:6,ATTACHED:7,DONE:8,PLAYER_READY:9,PLAYER_CLOSE:10,PLAYER_STOP:11,AD_STOPPED:12,OPT_OUT:13,OPEN_WITH_PAUSE:14,WAITING_FOR_EXPAND:15,REPEAT_STAND_BY:16,REPEAT_SPINNING:17},defaults:{abTest:"",adMaxPlaySeconds:181,adTitle:"Video",adVolume:"auto",aspectRatio:"16:9",aspectRatioNum:"{{defaultAspectRatioNum}}",defaultAspectRatioNum:16/9,autoPlay:!0,baseReportD:"basebanner.com",cfr:0,country:"",clickTestSeconds:.5,defaultAdParameters:"",defaultTagTimeout:20,gaFactor:1e4,gaFrameSrc:"{{urls.base}}/release-r1/assets/ga.html#page={{gaVertical}}&category={{gaVertical}}",gaVertical:"source",height:0,interruptLoading:!0,ip:"",isAllowDuplicateKey:!0,isDebug:!1,isFirePixel:!0,isHideIframe:!1,isMobile:!1,isMobileMacros:!1,isPlayerViewable:!1,isProtectedInIframe:!0,isRepeat:!0,isResponsive:!0,isCallIDLE:!1,isShowOnAd:!1,isShowOnAdLocation:"begin",isSoundOnHover:!1,isUnitEligible:!1,isUnitViewable:!1,isUseObserver:!1,isUseNonNativeObserver:!1,kbnul:"//vidanalytics.taboola.com",lineItemId:"",loaderImage:"",logViewabilityCalc:!1,mfp:4,mobilePlayer:"DP",mobileSpriteTimeoutSeconds:20,mute:!0,noaop:2,noDebugReport:!1,openingEffect:0,originId:15,placement:"",playerContainer:"body",playerEndSeconds:0,playerVolume:0,printCurrentViewPercent:!1,predefinedSettings:{level:1},repeat:!0,retriesLWF:5,reportTimerSeconds:10,ronPercent:5,secondsBW:10,secondsInView:2,secondsLWF:.1,secondsToClose:0,secondsToCloseGlobal:0,sortOrderType:0,state:null,timeBetweenAds:1,totalTimeout:60,traceViewabilitySeconds:2,traceViewability100Seconds:2,ulog:[""],vastRetry:2,version:"158_allow_sec",vertical:"source",viewabilityPercent:50,volumeMuted:!0,wfManual:!1,volume:"onHover",width:0,maxVimpsInQueue:2,autoplayDetectorTimeoutSec:1,useSwfVideoJs:!0,isPWOV:!1,frameType:v.default.FRAME_TYPE.plainPage,"100viewPercent":100,mpgclrslv:["gcdn.2mdn.net"],cnvsldrt:5,gtvid:"//cnv.tcsrv.com/getvid?url",playerTextAlign:!0,cookieMatchActive:!1,predictors:{time:{repeat:3}},fmNoAboveSelector:"no-vabove",fmNoBelowSelector:"no-vbelow",vForce:{isActive:!1,getAdTimeoutSeconds:10},detach:{width:320,position:{horizontal:"right",vertical:"bottom"}},customization:{unitContainer:{},adTitle:{},placeHolder:{},playerView:{}},midrollCollapse:{isActive:!1,time:5},pixels:{D2DFallback:{id:31468623,type:5},conversion:{id:31425418,type:2},close:{id:31579687,type:5},timeout:{id:31574457,type:5},optOut:{id:31530958,type:5},optOutNever:{id:31419288,type:5},addImpresion:{id:31579657,type:5},eligible:{id:31579697,type:16},networkError:{type:42},lostEligibility:{type:43},fraudDetection:{type:32},clickthrough:{type:44},error:{id:31608187,type:5},quarterly1:{id:31608197,type:5},quarterly2:{id:31608207,type:5},quarterly3:{id:31608217,type:5},complete:{id:31608237,type:5},render:{id:31608177,type:5},startWithABT:{id:31589837,type:45,isFire:!1},repeatClick:{type:46},renderOnDemand:{type:51},stopUnit:{type:52},getAdAny:{type:53,isFire:!1},getAdNoRV:{type:54,isFire:!1},getAd:{type:55,isFire:!1},secondsToCloseTimer:{type:56,isFire:!1},secondsToCloseGlobalTimer:{type:57,isFire:!1},midrollCollapseTimer:{type:58,isFire:!1},attach:{type:61},detach:{type:62},D2DClick:{type:63},D2DClickSuspicious:{type:68},TRCResetCloseUnit:{type:64},sliderFeedStartWithABT:{type:65},onParentSelectorLost:{type:66},adChoice:{type:67},noCMPonPage:{type:72},hasCMPonPage:{type:73},rvHandlerTimerExpired:{type:74},onPlayerHasRVinQ:{type:75},skippedDistancePredict:{type:76},publisherVideoDetected:{type:78},publisherIframeVideoDetected:{type:79},compDetectedOnPage:{type:80},feedxToggle:{type:82},testPixels:{type:100},fullEligibilityPredict:{type:77,isFire:!1},progressLoaderInit:{type:83},progressLoaderMove:{type:84},progressLoaderClose:{type:85},organicCardInjected:{type:86},organicCardInjectionFail:{type:87},terminateOnResize:{type:89},unitDelayed:{type:93},unitLoadAfterDelay:{type:94},autoplaySoundOn:{type:95},generalError:{type:96},exploreMore:{type:98},passbackFunctionCalled:{type:99},onUnitDimensionsFound:{type:116},url:"//conv{{dataCenter}}mp.{{baseReportD}}/st"},closeButton:{hasCloseButton:!0,secondsToCloseButton:5},urls:{base:"//vidstat.taboola.com",staticImage:""},player:{versions:{vplayer:"v10.4.8",content:"26_1_18m"},urls:{vplayerLocation:"{{urls.base}}/vpaid/vPlayer",vpaidLocation:"{{player.urls.vplayerLocation}}/vpaidjs/{{player.versions.vplayer}}/main-vpaid.js",playerLocation:"{{player.urls.vplayerLocation}}/player/{{player.versions.vplayer}}",contentVideosLocation:"//vidstat.taboola.com/vid",oppsBasePath:"//opps.{{baseReportD}}",oppsRequest:"{{player.urls.oppsBasePath}}/OpportunityServlet",wfBasePath:"//wf.{{baseReportD}}",wfRequest:"{{player.urls.wfBasePath}}/VideoBidRequestHandlerServlet"},settings:{dlgverr:!0
},b2b:1,bfFactor:15,hasAdControls:!0,hasBFeature:!0,hasControls:!0,isBypassFlash:!0,isFire99:!0,isFlashPlayer:!0,minVpaidRunTime:4},components:{D2DFallbackView:{pubId:127968,pubTagId:756668,height:"{{height}}",width:"{{width}}",location:"//15.{{baseReportD}}/WhiteLabelBidRequestHandlerServlet"},OptOut:{hasOptOut:!0,pubId:0,pubTagId:0,imageLocation:"{{urls.base}}/fp/img/closeVideo.png"},CloseButtonView:{hasCloseButton:!1,delay:1500,imageLocation:"{{urls.base}}/assets/x-close-24.png"},TimerView:{hasTimer:!1,time:3,countdownAction:"closeButton"},DetachButtonView:{hasDetuchView:!1,time:1,imageLocation:"{{urls.base}}/assets/ContractButton32.png"},Repeat:{isActive:!1,repalyIcon:"{{urls.base}}/assets/replay-button.svg",replayHoverIcon:"{{urls.base}}/assets/replay-button-hover.svg",learnMoreIcon:"{{urls.base}}/assets/learn-more-button.svg",learnMoreHoverIcon:"{{urls.base}}/assets/learn-more-button-hover.svg",backgroundImage:"{{urls.base}}/assets/blurry-image.png"},PosterView:{isActive:!1,imageLocation:"{{urls.base}}/img/play_image_4.jpg",defaultLocation:"{{urls.base}}/img/play_image_3.jpg"},Loading:{type:"img",imgUrl:"{{urls.base}}/assets/loading2.png",staticUrl:"{{urls.base}}/assets/repeat1.PNG"},contentVideo:{loadingImgae:"{{components.Loading.imgUrl}}",muteImgUrl:"{{urls.base}}/assets/video_controls/desk_muted2.svg",unmuteImgUrl:"{{urls.base}}/assets/video_controls/desk_playing2.svg",pauseImgUrl:"{{urls.base}}/assets/video_controls/pause2.svg"}},content:{playClicked:!0},fd:{pm:{factor:0,timeoutPeriod:1200,url:"https://data.ad-score.com/score/cors?s=1&pid=1000026&tid=12&l1={{cipid}}&l2={{CMP_ID}}&l3={{creativeId}}&l4={{tagId}}&p1={{EX_ID}}&uid={{USER_ID}}&uip={{IP}}&ref={{referrer}}&cb={{redId}}&",pluginUrl:"//js.ad-score.com/score.min.js?pid=1000026#tid=12&l1={{cipid}}&l2={{CMP_ID}}&l3={{creativeId}}&l4={{tagId}}&p1={{EX_ID}}&uid={{USER_ID}}&uip={{IP}}&ref={{referrer}}&cb={{redId}}"}},noSoundBrowsers:{chrome:{minVersion:66},safari:{minVersion:11},firefox:{minVersion:66}},microServices:{base_url:"//vidstat.taboola.com/",async:!0,oppsula:{version:"1.2.8"},videoElement:{version:"2.0.0"},autoplayDetector:{version:"1.0.0"}},ms_data:{opps_base_path:"//opps.{{baseReportD}}"},style:{videoBackgroundColor:"black"}},storage:{},initialize:function(){this.log=new u.default({unitType:this.get("unitType"),className:"BaseUnitModel"}),this._parseFrameType();var e=this.get("demo");e&&this.set("preset.demo",e),this.get("isDebug")&&this.set("preset.isDebug",1);var t=this.get("isFireAllPixels");t&&this.set("preset.isFireAllPixels",t);var i=this.get("predictorsPresets");i&&this.set("preset.predictorsPresets",i);var n=this._getSettingsByConditions();this.set(n.preset);var o=this._getPresets(p.default.pms);this.log.info("Presets Settings: ",[o.weakerThenSetByCon,o.strongerThenSetByCon]);for(var s in o.weakerThenSetByCon)this.set(o.weakerThenSetByCon[s].presetData);this.set(n.settings);for(var a in o.strongerThenSetByCon)this.set(o.strongerThenSetByCon[a].presetData);this._setUrlParameters(),this._processPushArray(),this.get("baseReport")&&this.get("oppsBasePath)")&&this.set("oppsBasePath",this.get("baseReport")),this.set("isUseObserverChanged",!1),this.get("isUseObserver")&&!r.default.isObserverInBrowser(this.get("isUseNonNativeObserver"))&&(this.set("isUseObserver",!1),this.set("isUseObserverChanged",!0)),this.get("isUseObserverForCardLocator")&&!r.default.isObserverInBrowser(this.get("isUseNonNativeObserver"))&&this.set("isUseObserverForCardLocator",!1),this.volume=this.get("volume"),this.set("volume","off"),this._bindEvents(),this.log.info("unit model created:",this.attributes),this._handleABTest(),(this.get("isApiPassbackExist")||this.get("onPassback"))&&(this.set("dlywf",!1),this.set("player.settings.rvfrquesttsemttr","any"))},get:function(e){var t=l.default.DeepModel.prototype.get.call(this,e);if(!t||"string"!=typeof t)return t;for(var i=t.match(/\{\{(.*?)\}\}/g);i;){for(var n=0;n<i.length;n++){var o=i[n].substr(2,i[n].length-4),s=l.default.DeepModel.prototype.get.call(this,o);s||(s=""),t=t.replace(i[n],s)}i=t.match(/\{\{(.*?)\}\}/g)}return t},getPixel:function(e){!this.pixel&&this._createPixel();var t=this.get(e);return"pixels.conversion"===e&&l.default.trigger("global:creativeEvent",{type:"conversion"}),this.pixel({type:t.type||"",pixelId:t.id,timestamp:Date.now()})},_createPixel:function(){var e=this.get("pixels.url")+"?cijs=convusmp&ttype={{type}}&cisd=convusmp&cipid="+this.get("cipid")+"&crid="+this.get("creativeId")+"&dast="+this.get("dast")+"&cmcv=&pix={{pixelId}}&cb={{timestamp}}&uv="+this.get("unitVersion")+"&tms={{timestamp}}";this.get("abTest")&&(e+="&abt="+this.get("abTest")),this.get("referrerUrl")&&(e+="&ru="+this.get("referrerUrl")),e+="&ft="+this.get("frameType"),e=this._addPixelParameter("tagCpmFloor","cft",e),e=this._addPixelParameter("unitId","blid",e),e=this._addPixelParameter("unitName","unm",e),e=this._addPixelParameter("debugKey1","dk1",e),e=this._addPixelParameter("debugKey2","dk2",e),e=this._addPixelParameter("order","order",e),this.pixel=r.default.template(e)},_addPixelParameter:function(e,t,i){return(this.get(e)||0===this.get(e)||this.get(e)===!1)&&(i+="&"+t+"="+this.get(e)),i},getImpressionPixel:function(){this.get("player.isFire99")},_getSchedule:function(e,t,i){return{roll_type:e,url:this.get("player.urls.vpaidLocation"),volume:"on"===this.get("volume")?100:0,mute:"on"!==this.get("volume"),oid:this.get("originId"),mfp:this.get("mfp"),sortOrderType:this.get("sortOrderType"),ad_parameters:JSON.stringify(this.get("demandConfig")),pubid:t,tagid:i,defaultTagTimeout:this.get("defaultTagTimeout"),totaltimeout:this.get("totalTimeout"),noaop:this.get("noaop"),skip_vast:!0}},_handleABTest:function(){if(this.get("abTest")&&this.get("pixels.startWithABT.isFire")){window.cmTag.customDataForTest.startWithABT=!0;var e=window.performance.timeOrigin?window.performance.timeOrigin:"",t={debug:"pn:!sqg:!torgn:"+e+"!ts:"+Date.now()};r.default.firePixel(this.getPixel("pixels.startWithABT"),"AB Test started",t)}},_processPushArray:function(){var e=this.get("pushedArr")||[];"FEED_MANAGER"!==this.get("unitType")&&"INLINE_FEED"!==this.get("unitType")||this._setFeedManagerSubType(e);var t={};if(e){e.forEach(function(e){var i=Object.keys(e)[0];t[i]||(t[i]=[]),t[i].push(e[i])});for(var i in t){var n=t[i],o=this.get(i);o&&n.push(o);var s=n.sort().join("!");this.set(i,s)}}},_setFeedManagerSubType:function(e){var t=this.get("stickyCard.isActive"),i=this.get("detachToSlider.isDetachBelow"),n=this.get("detachToSlider.isDetachAbove"),o=this.get("detachToSlider.isStartFromSlider"),s=this.get("detachToSlider.isDetachToSlider"),r="FEED_MANAGER"===this.get("unitType")?"ufm":"uf";t||o||s?t||!o||s?t||o||!s?!t&&o&&s?r+="_vD":t&&i&&!n?r+="_vE":t&&!i&&n?r+="_vF":t&&i&&n&&(r+="_vG"):r+="_vC":r+="_vB":r+="_vA",e.push({abTest:r})},_removeSoundOnHover:function(){var e=m.UAParser(window.navigator.userAgent),t=e.browser.name.toLowerCase(),i=parseInt(e.browser.version),n=void 0,o=this.get("noSoundBrowsers");o&&o[t]&&(n=o[t].minVersion),i>=n&&this.set("volume","off")},setStorage:function(e,t){this.storage[e]=t},getStorage:function(e){return this.storage[e]},setNextAd:function(e){this.setStorage("nextAd",e)},getNextAd:function(){var e=this.getStorage("nextAd");return e&&(this.log.info("NEXT AD TYPE = "+parseInt(e.adData.requiredViewability?"1":"0"),e),e.isUsed=!0),this.setStorage("nextAd",void 0),setTimeout(this.set.bind(this,"hasReadyAd",!1),0),e},peekNextAd:function(){return this.getStorage("nextAd")},_bindEvents:function(){this.on("change:getAdState",this._onAdImpression)},_onAdImpression:function(){var e=this.get("getAdState");"gotAd"!==e||this._gotAd||(this.log.info("Triggering filledImpression event."),l.default.trigger("filledImpression",{lineItemId:this.get("lineItemId"),placement:this.get("placement"),redId:this.get("redId")}),this._gotAd=!0)},_setUrlParameters:function(){for(var e=this._getWindow(),t=void 0,i=void 0,n=void 0,o=e.location.href.slice(e.location.href.indexOf("?")+1).split("&"),s=0;s<o.length;s++)t=o[s].split("="),i=t[0],0===i.indexOf("cm_")&&(i=i.slice(3),n=decodeURIComponent(t[1]),this.set(i,n))},_getWindow:function(){var e=this.get("isStayInIframe"),t=this.get("iframeData");return e===!0&&r.default.isInFriendlyIframe(t)||!r.default.getTopWindow?window:r.default.getTopWindow()},_getPresets:function(e){var t={strongerThenSetByCon:[],weakerThenSetByCon:[]},i=this.get("isMobile"),n=i?"Mobile":"Desktop";for(var o in this.get("preset")){var s=e.getPreset({key:o,value:this.get("preset."+o),unitType:this.get("unitName"),platform:n});s&&(s.strength>100?t.strongerThenSetByCon.push(s):t.weakerThenSetByCon.push(s))}return t.strongerThenSetByCon=r.default.sortBy(t.strongerThenSetByCon,"strength"),t.weakerThenSetByCon=r.default.sortBy(t.weakerThenSetByCon,"strength"),t},increaseCounter:function(e){var t=this.get(e);t?t++:t=1,this.set(e,t)},decreaseCounter:function(e){var t=this.get(e);!t||t<=0||(t--,this.set(e,t))},_parseFrameType:function(){var e=v.default.FRAME_TYPE.plainPage;"undefined"!=typeof window.taboolaMobile?e=v.default.FRAME_TYPE.inApp:window.TRC&&window.TRC.isAMP?e=v.default.FRAME_TYPE.amp:r.default.isInIframe(this.get("iframeData"))&&(e=r.default.isInFriendlyIframe(this.get("iframeData"))?v.default.FRAME_TYPE.friendlyIframe:v.default.FRAME_TYPE.nonFriendlyIframe),this.set("frameType",e),this.set("player.settings.frameType",e)},_getSettingsByConditions:function(){var e={};e.preset={},e.settings={};var t=this.get("settingsByConditions");if(t&&t.length>0)for(var i=0;i<t.length;i++){var n=t[i].conditions,o=t[i].settings,s=this._checkConditions(n);if(s)for(var r in o)r.indexOf("preset")!==-1?e.preset[r]=o[r]:e.settings[r]=o[r]}return e},_checkConditions:function(e){for(var t=!0,i=0;i<e.length;i++)if(e[i].val&&"function"==typeof e[i].val){var n=e[i].val(this);this.get(e[i].key)!==n&&(t=!1)}else this.get(e[i].key)!==e[i].val&&(t=!1);return t},fireUnitDelayedPixel:function(){r.default.firePixel(this.getPixel("pixels.unitDelayed"),"unit delayed")},fireUnitLoadAfterDelayPixel:function(){r.default.firePixel(this.getPixel("pixels.unitLoadAfterDelay"),"unit delayed")},isLoadcomponent:function(e,t){return this.get("displayFiller."+t)===e},appendArray:function(e,t,i){var n=this.get(e);r.default.isArray(n)||(n=new Array),i&&n.includes(t)||(n.push(t),this.set(e,n))},handleAutoPlayData:function(e){this.log.info("autoplayDetector returned",e),this.set("AutoPlayDetectorData",e),e&&e.unmuted&&e.unmuted.supported?(this.set("volume",this.volume),this.set("autoplaySoundOn",!0)):(this.set("volume","off"),this.set("autoplaySoundOn",!1)),this.log.info("Unit set volume to: ",this.get("volume"))}})},function(e,t,i){"use strict";var n=(i(11),i(8),i(147)),o=i(10);e.exports=n.extend({defaults:o.extend(!0,{},n.prototype.defaults,{additionalCss:{},appendType:"beforeend",isMultiSelect:!0,isSelectorFallback:!0,isSoundOnHover:!0,isViewable:!1,onAdDone:"none",onOutOfView:"detach",parentPosition:"beforeend",placeholderCss:{},unitTitle:"ADVERTISEMENT",viewPercent:20,detach:{onBackToView:"return"},rescan:{isActive:!1,intervalSeconds:5},components:{TimerView:{hasTimer:!0}},animation:{onTransitionOpen:!0,onTransitionClose:!0}})})},function(e,t,i){"use strict";var n=i(145),o=(i(8),i(10));e.exports=n.extend({defaults:o.extend(!0,{},n.prototype.defaults,{isSoundOnHover:!0,loaderImage:"",noaop:5,secondsBW:60,timeBetweenAds:60,closeButton:{hasCloseButton:!0,secondsToCloseButton:5},player:{urls:{blankLocation:"{{player.urls.contentVideosLocation}}/blackScreen60.mp4"},hasAdControls:!0}}),initialize:function(){n.prototype.initialize.call(this),this.set("player.playlist",[{url:this.get("player.urls.blankLocation"),name:"Blank",title:"Blank",type:"video/mp4"}])},getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("pubId"),this.get("pubTagId"))),e}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(25),s=(n(o),i(11),i(8)),r=i(144),a=i(10);i(71);e.exports=r.extend({defaults:a.extend(!0,{},r.prototype.defaults,{animation:{onTransitionOpen:!1,onTransitionClose:!1,transitionAnimationTime:500,detach:500,firstDetach:1e3,slideOut:500,attach:500},organicCardPlacementName:"Organic card below video",onTimerClose:"close",openingEffect:1,bfFactor:0,noaop:2,wfDynamicPause:!1,wfManual:!0,runWfWhenEmpty:!0,viewPercent:20,allowedHeightChange:75,isMultiActiveAds:!0,parentSelector:".tbl-feed-container:not(.tbl-feedx-container)",isObserveFeedParent:!1,feedCardSelector:".tbl-feed-card",isOpenInViewPort:!0,kibanaEventsToSend:"all",predictors:{autoKill:{isActive:!0},getAdFail:{isActive:!0},multiAd:{isActive:!0,predictPoints:{}},loading:{isActive:!0,predictPoints:"any"},repeat:{isActive:!0,predictPoints:"any"},playerReady:{isActive:!0,predictPoint:0},distancePercent:{isActive:!1,predictPoints:{}},distancePixels:{isActive:!1,predictPoints:{}}},playPriority:{type:"ppKey",key:1},vForce:{isActive:!0,getAdTimeoutSeconds:60},components:{disclosureText:{text:"ADVERTISEMENT"},CloseButtonView:{delay:3e3},adChoice:{isActive:!0,fallbackUrl:"https://popup.taboola.com/en",icon:"http://cdn.taboola.com/static/c5/c5ef96bc-30ab-456a-b3d5-a84f367c6a46.svg",position:"above",title:{isActive:!1,text:"Sponsored Video by Taboola",style:{},logoStyle:{},adViewStyle:{}},videoAd:{isActive:!1,text:"Ad",style:{},logoStyle:{}},slider:{isActive:!0,text:"Ad",style:{},logoStyle:{}}},volume:{isActive:!1,expandedText:"Unmute",timeToMinimize:2e3,style:{border:{},mute:{},unmute:{},text:{}}}},hasCloseButton:!1,detachToSlider:{isStartFromSlider:!1,isDetachToSlider:!1,isDetachAbove:!1,isDetachBelow:!0,width:250,height:250,position:{horizontal:"right",vertical:"bottom",horizontalOffset:0,verticalOffset:0},liquidSize:{isActive:!1,widthPercent:33,minWidth:200,heightPercent:30,maxHeight:350},customCss:null,animation:!0,hasCloseButton:!0,onOutOfView:"pause",isCheckForFirstOnPage:!0,isCheckForTopCard:!0,components:{disclosureText:{text:"ADVERTISEMENT"}}},category:"blankblack5",isMultiAd:!0,pubId:198827,pubTagId:1020237,preroll:{pubId:198827,pubTagId:1020237},midroll:{pubId:198827,pubTagId:1020237},postroll:{pubId:198827,pubTagId:1020237},secondsToClose:200,secondsToCloseFeed:20,contentTimerSeconds:20,isMobile:!1,onOutOfView:"pause",unitTitle:"",vertical:"_#VERTICAL#_",player:{hasControls:!1,urls:{blankLocation:"{{player.urls.contentVideosLocation}}/blackScreen5.mp4"},bfFactor:0,settings:{vakll:24e4,time_between_waterfall:1,mintimwf:1e4,bfFactor:0,ad_loaded_method:!0,wf_manual:!1,wf_dynmc_ps:!1,vforce2:"vforce2",isMultiVpaidUnit:!0,mprdct:.015}},maxVideoCards:100,verticalWidthThreshold:350,isFireSP:{32:!0},minTopForVideo:10,minLeftForVideo:10,isPlayerOutOfViewport:!1,isToggleIframeContent:!1,cardEligibilityPercent:50,continueToPlayInNexCard:{isActive:!0},stickyCard:{detachFromTopDistance:0,attachPercent:100,offset:{top:0,left:0},observerThreshold:[.01,.99],maxAspectRatio:.8,restrictions:{maxWidth:800,rv:!0,adPercent:{percent:30,secondsToClose:3}}}}),initialize:function(){if(r.prototype.initialize.call(this),this.loadContent(),window.TRC&&window.TRC.isAMP===!0&&(this.set("detachToSlider.isDetachToSlider",!1),this.set("detachToSlider.isStartFromSlider",!1),this.set("stickyCard.isActive",!1)),this.get("detachToSlider.isStartFromSlider")&&this.set("isRvPriority",!1),(this.get("detachToSlider.isStartFromSlider")||this.get("detachToSlider.isDetachToSlider")||this.get("permanentCard"))&&this.set("getCardMaxPPS",void 0),this.get("isCheckInAppPlayerSize")){var e=a(this.get("parentSelector")).width();this.set("width",e),this.set("height",s.getVideoHeight(e))}this.get("stickyCard.isActive")&&(this.set("detachToSlider.isDetachAbove",!1),this.set("detachToSlider.isDetachBelow",!0),this.set("detachToSlider.isDetachToSlider",!0),this.set("detachToSlider.isStartFromSlider",!1),this.set("videoContainerSelector",this.get("parentSelector")))},loadContent:function(){"mrss"===this.get("contentLoadType")?a.ajax({url:this.get("player.urls.contentLocation"),dataType:"xml",success:this._onMrssLoad.bind(this)}):"direct"===this.get("contentLoadType")?this.set("player.playlist",[{id:0,title:"",link:"",url:this.get("player.urls.contentLocation")||this.get("pVideoUrl"),type:"video/mp4",image:""}]):(window.category=this.get("category"),s.loadJs(this.get("player.urls.contentLocation"),this._onContentLoad.bind(this)))},_onMrssLoad:function(e){var t=[];a(e).find("item").each(function(e,i){var i=a(i),n={};n.id=e,n.title=i.find("title").text(),n.link=i.find("link").text(),n.url=i.find("media\\:content,content").attr("url"),n.type=i.find("media\\:content,content").attr("type"),n.image=i.find("media\\:thumbnail,thumbnail").attr("url"),t.push(n)}),this.set("player.playlist",t)},_onContentLoad:function(){window.playlist.forEach(function(e,t,i){i[t].image=this.get("player.urls.contentImagesLocation")+"/"+e.image,i[t].title=e.title.replace(/([A-Z])/g,"$1").replace(/^./,function(e){return e.toUpperCase()}),i[t].url=this.get("player.urls.contentVideosLocation")+"/"+i[t].filename,i[t].name=i[t].filename,i[t].type="video/mp4"},this),this.set("player.playlist",window.playlist)}})},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(10),h=o(u),p=i(12),f=i(150),m=o(f),g=i(131),v=o(g),y=i(16),b=o(y),_=i(208),w=o(_),T=i(77),A=o(T),S=i(71),P=(n(S),i(209)),C=o(P),E=i(21),k=o(E),I=i(6),O=i(25),V=o(O),x=i(11),D=o(x),M=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.model=e.model,i.initialModel=i.createSubModel(),i.initialModel.set("detachToSlider",i.model.get("detachToSlider")),i.controllersArray=[],i.model.set("subAdsEligibility",{}),i.log=new b.default({unitType:i.model.get("unitType"),className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.impCount=0,i._addStyleToHeader(),i._createTimers(),i._setSubUnitType(),i.model.set("height",c.default.getVideoHeight(i.model.get("width"))),i.isSuperSlider=i.model.get("detachToSlider.isStartFromSlider")&&i.model.get("detachToSlider.isDetachToSlider"),i._bindEvents(),i.windowEventManager=(0,v.default)(),i.shouldReport=c.default.isFactor(i.model.get("gaFactor")),i.shouldReport&&i.model.get("isReportToKibana")&&(i.model.set("gaFactor",1),i.kibana=new I.Kibana({model:i.model})),i.adsManager=new I.AdsManager(i.model,i.kibana),i.model.get("isDetectPubVideo")&&(i.pubVidDetector=new I.PublisherVideoDetector(i.model)),i.seerService=new I.Seer(i.model),i.playerLoader=new I.PlayerLoader(i.model),i.playerService=new I.PlayerSubUnit(i.model),i.pixelsService=new I.Pixels(i.model),i.competitionDetector=new I.CompetitionDetector(i.model),i.feedEventManager=new w.default(i.model,i.model.get("parentSelector"));var n=i.model.get("detachToSlider.isStartFromSlider");return i.tabStatusService=new I.TabStatus(i.model),n?i.model.set("isEligibleToPlay",!0):i.FeedEligibilityService=new A.default(i.model,i.model.get("parentSelector")),i.isWaitingForRV=!1,i.cardLocator=new I.CardLocator(i.model),i.log.info("Feed Manager created",i.model),i.isSliderOn=i.model.get("detachToSlider").isStartFromSlider||i.model.get("detachToSlider").isDetachToSlider,i.model.set("isSliderOn",i.isSliderOn),i.firstCardCalled=!1,i.animation=i.model.get("animation"),i.ContinuePLayAdInNextCard=new C.default(i.model),i._removeCardForDemo(),i}return a(t,e),l(t,[{key:"_createTimers",value:function(){this._createSecondsToCloseTimer(),this._createSecondsToCloseGlobalTimer(),this._createSecondsToPassbackTimer()}},{key:"_onLoadingClick",value:function(){this._createSecondsToCloseGlobalTimer()}},{key:"_createSecondsToCloseTimer",value:function(){var e=this.model.get("secondsToClose");if(e>0){var t={startCondition:{stateToListen:!0,state:"firstGetAdFired"},stopCondition:{stateToListen:k.default.adQState.impression,state:"adQState"},isStartOnce:!0};this.secondsToCloseTimer=new I.Timer(this.model,t,this.terminate.bind(this,!1,"secondsToClose"),1e3*e)}}},{key:"_createSecondsToCloseGlobalTimer",value:function(){this.secondsToCloseGlobalTimer&&this.secondsToCloseGlobalTimer.stop(this.model,void 0,{},!0);var e=this.model.get("secondsToCloseGlobal");if(e>0){var t={startCondition:{stateToListen:"",state:""}};"showReplay"===this.model.get("onTimerClose")||"close"===this.model.get("onTimerClose")?this.secondsToCloseGlobalTimer=new I.Timer(this.model,t,this.pause.bind(this,"secondsToCloseGlobal"),1e3*this.model.get("secondsToCloseGlobal")):this.secondsToCloseGlobalTimer=new I.Timer(this.model,t,this.terminate.bind(this,!1,"secondsToCloseGlobal"),1e3*e),this.secondsToCloseGlobalTimer.start(this.model,"")}}},{key:"_createSecondsToPassbackTimer",value:function(){if(this.model.get("secondsToPassback")){var e={startCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:!0,state:"isFirstAdLoaded"}};this.passBackTimer=new I.Timer(this.model,e,this._triggerPassback.bind(this,"Passback"),1e3*this.model.get("secondsToPassback")),this.passBackTimer.start(this.model,"")}}},{key:"subAdsEligibilityChange",value:function(){return this.log.info("subAdsEligibilityChange, is continueToPlayInNexCard",this.model.get("continueToPlayInNexCard.isActive")),this.model.get("continueToPlayInNexCard.isActive")&&!this.model.get("isSliderOn")&&(this.log.info("subAdsEligibilityChange "),this._isContinuaPLayAdInNextCard())?(this.ContinuePLayAdInNextCard._startWatchDivLeaveVeiwPort(this.controllersArray[this.model.get("lastCardOutOfViewport")].videoView.getEl()),void this.createStateHandlers([{event:"elementOutOfView",funcName:"_onTempAdOutOffView",isListenOnce:!0},{event:"temAdCondition:true",funcName:"_onAdCondition",isListenOnce:!0}])):void this._getCard("subAdsEligibility")}},{key:"_hasViableSubUnits",value:function(){var e=this.model.get("subAdsEligibility");for(var t in e)if(e[t]===!0)return!0;return!1}},{key:"createSubFeedController",value:function(e,t,i){if(this.log.info("videoCardIniOptions ",e),this.log.info("Creating Sub Unit: card number: "+e.cardNumber+" adId:"+t.adId),this.log.info("Last Ad ID = "+this.model.get("lastAdID")+" Next Ad ID = "+t.adId),this.model.get("lastAdID")!==t.adId||this.tempActiveAd){this.model.set("lastAdID",t.adId),this.controllersArray.length>1&&(t.isUsed=!0),0===this.controllersArray.length&&t.vpaidWrapper.nonVideoVpaid&&this._setIniModelToNoslider();var n=this.getSubModel();0===this.controllersArray.length&&this._setIniModelToNoslider(),n.set("parentSelector",this.model.get("parentSelector")),n.set("isSuperSlider",this.isSuperSlider);var o=void 0;if(this.model.get("isNeedAdjacCard")&&!n.get("isSuperSlider")){var s=!1;if(c.default.getOrganicCard()&&(o=this.createVideoCardPlaceHolder(e),n.set("adjacCardPlacement",this.model.get("adjacCardPlacement")),n.set("isNeedAdjacCard",!0),this.organicCardInjector=new I.OrganicCardInjector(this.model),s=this.organicCardInjector.injectOrganicCard("#"+o)),!s)return this.model.set("organicInjectorFail",!0),void this.overKill("organic card injection fail")}else o=this.createVideoCardPlaceHolder(e);n.set("width",(0,h.default)("#"+o).width()),n.set("cardNumber",e.cardNumber-.5),n.set("subAdId",o),n.set("subUnitId",this.controllersArray.length),i&&(n.set("isCardBelongToTempAd",!0),n.set("tempAdCondition",this.tempActiveAdCondition),n.set("isOpenInViewPort",!1)),this.log.info("!!@ newModel",n.get("tempAdCondition"));var r=new m.default({model:n,globalModel:this.model,container:"#"+o,ad:t});this.controllersArray.push(r),this.tempActiveAd&&setTimeout(function(){this.tempActiveAd=void 0}.bind(this))}}},{key:"_getCard",value:function(e){if(this._isGettingNewCardAvailable()){this.firstCardCalled=!0,this.log.info("Requesting New Card, Reason: "+e);var t;this.model.get("isNeedAdjacCard")&&!this.hadAdjac?t=this.cardLocator.getSpecificCard(this.model.get("adjacCardPlacement")):this.model.get("isSliderClosed")?(t=this.cardLocator.getCard({onceOutOfView:!0}),this.model.set("isSliderClosed",!1)):t=this.cardLocator.getCard(),t?this._onCardReturn(t):this._waitForCard()}}},{key:"_isGettingNewCardAvailable",value:function(){return this.isWaitingForCard?void this.log.info("Waiting for card, don't get cards "):this._hasViableSubUnits()?(this.log.info("Has Viable SubUnits, don't get cards "),!1):this.controllersArray.length===this.model.get("maxVideoCards")?(this.log.info("Max number of cards reached , don't get cards "),!1):this.model.get("hasReadyAd")||this.tempActiveAd?!this.model.get("isSliderOn")||!this.firstCardCalled||(this.log.info("Slider is active, don't get cards "),!1):(this.log.info("Don't have ready ads, don't get cards "),!1)}},{key:"_waitForCard",value:function(){this.log.info("No Card available waiting for card"),this.isWaitingForCard=!0,this.createStateHandlers([{event:"hasValidCard",funcName:"_onNewCardAvailable",isListenOnce:!0}])}},{key:"_onCardReturn",value:function(e){if(this.videoCardIniOptions=e,this.model.get("isNeedAdjacCard")){if(e.cardNumber!==this.model.get("adjacCardPlacement"))return void this._getCard("card found but need Adjac");this.hadAdjac=!0}if(this.isWaitingForCard=!1,this.log.info("Got New Card",e),!this._hasViableSubUnits())if(this.tempActiveAd)this.controllersArray[this.model.get("lastCardOutOfViewport")].videoView.extractAd(),this.createSubFeedController(e,this.tempActiveAd,!0);else{var t=this.getReadyAd();t&&this.createSubFeedController(e,t)}}},{key:"newAdLoaded",value:function(){this.log.info("newAdLoaded")}},{key:"_onNewCardAvailable",value:function(){this.log.info("newCardAvailable");var e=this.cardLocator.getCard({cardNumber:this.model.get("hasValidCard")});this._onCardReturn(e)}},{key:"createSubModel",value:function(){return h.default.extend(!0,{},this.model)}},{key:"getSubModel",value:function(){return h.default.extend(!0,{},this.initialModel)}},{key:"addNewSub",value:function(){setTimeout(function(){this.createSubFeedController(),this.addNewSub()}.bind(this),4e4)}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"subAdsEligibility",funcName:"subAdsEligibilityChange"},{event:"hasReadyAd:true",funcName:"onHasReadyAd"},{event:"closeState",funcName:"_closeStateChange"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"},{event:"feedxToggle",funcName:"_onFeedContainerChanged"},{event:"feedContainerChanged",funcName:"_onFeedContainerChanged"}]),"undefined"!=typeof TRC&&TRC.listen&&TRC.listen("trcReset",this._onTRCReset.bind(this)),this.isSuperSlider&&this.createStateHandlers([{event:"isSuperSliderClosed:true",funcName:"_SuperSliderClose",listenOnce:!0}])}},{key:"_closeStateChange",value:function(){this.log.warning("CloseState changed to: ",this.model.get("closeState")),this.model.get("closeState")===k.default.closeState.terminate?this.adService?this.adService.close():this.model.set("closeState",k.default.closeState.adManagerStop):this.model.get("closeState")===k.default.closeState.adManagerStop&&this.playerService&&(this.playerService.close(),this.model.off(),D.default.off())}},{key:"onHasReadyAd",value:function(){var e=this;this.log.info("onHasReadyAd"),!this.model.get("isDetectPubVideo")||this.pubVidDetector&&!this.pubVidDetector.isPubVideoInView()?this._getCard("on Ad Impression"):D.default.once("window:scroll:change",function(){e.onHasReadyAd()})}},{key:"createVideoCardPlaceHolder",value:function(e){var t=(0,h.default)("<div>");this.isSuperSlider?this.isSuperSlider=!1:(t.addClass("tbl-feed-card"),t.addClass("cm-video-card"));var i=.5;"before"===e.insert&&(i=-.5);var n=("cm_place_holder_"+(e.cardNumber+i)).replace(".","");return t.attr("id",n),t.css({width:"100%"}),(0,h.default)(e.cardElement)[e.insert](t),n}},{key:"getReadyAd",value:function(){if(this.model.get("hasReadyAd"))return this.model.getNextAd()}},{key:"pause",value:function(e){"secondsToCloseGlobal"===e&&this.model.get("isReplayAd")&&this.model.set("isReasonSecondsToCloseGlobal",!0),this.log.info("Pause Timer reason: "+e+" Cards Number: "+this.controllersArray.length),this.adsManager&&this.adsManager.pauseGetAds();for(var t=0;t<this.controllersArray.length;t++)this.controllersArray[t].pause(e);this._setTimerReason(e)}},{key:"terminate",value:function(e,t){this.log.info("Terminate reason: "+t);for(var i=0;i<this.controllersArray.length;i++)this.controllersArray[i].terminate(e,t);this.model.set("closeState",k.default.closeState.terminate),this._setTimerReason(t)}},{key:"overKill",value:function(e){this.log.info("overKill reason: "+e),this.adsManager.pauseGetAds(),this.playerService.playerDiv&&this.playerService.playerDiv.hide();for(var t=0;t<this.controllersArray.length;t++)this.controllersArray[t].overKill(e);this.model.set("closeState",k.default.closeState.terminate),this._setTimerReason(e),this.model.off(),this.secondsToCloseGlobalTimer&&this.secondsToCloseGlobalTimer.stop(this.model,"",{},!0)}},{key:"_removeCardForDemo",value:function(){if(this.model.get("isCloseScOnConversion")){var e=document.getElementsByClassName("trc-content-sponsored");e.length>0&&(e[e.length-1].parentElement.parentElement.parentElement.style.display="none")}}},{key:"_setTimerReason",value:function(e){this.model.get("closeTimer")===e?this.model.trigger("change:closeTimer",this.model,e):this.model.set("closeTimer",e)}},{key:"_onTRCReset",value:function(){this.model.set("TRCResetCloseUnit",!0),this.overKill("TRCRest"),this._resetFmOnPage()}},{key:"_onParentSelectorLost",value:function(){this.overKill("parentSelectorLost"),this._resetFmOnPage()}},{key:"_resetFmOnPage",value:function(){setTimeout(function(){this.model.off(),window.isCmTagFMOnPage=!1}.bind(this),500)}},{key:"_setSubUnitType",value:function(){var e=this.model.get("stickyCard.isActive"),t=this.model.get("detachToSlider.isDetachBelow"),i=this.model.get("detachToSlider.isDetachAbove"),n=this.model.get("detachToSlider.isStartFromSlider"),o=this.model.get("detachToSlider.isDetachToSlider");e||n||o?e||!n||o?e||n||!o?!e&&n&&o?this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.SLIDER_TO_FEED_TO_SLIDER):e&&t&&!i?this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.FEED_STICKY_BELOW):e&&!t&&i?this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.FEED_STICKY_ABOVE):e&&t&&i&&this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.FEED_STICKY_BELOW_ABOVE):this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.FEED_TO_SLIDER):this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.SLIDER_TO_FEED):this.model.set("subUnitType",V.default.SUB_UNIT_TYPE.FEED)}},{key:"_addStyleToHeader",value:function(){var e="#_cm-css-reset._cm-ad video { visibility: hidden !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.appendChild(document.createTextNode(e)),t.appendChild(i)}},{key:"_SuperSliderClose",value:function(){this.closedSuperSliderController=this.controllersArray.splice(0,1)[0]}},{key:"_setIniModelToNoslider",value:function(){this.initialModel.set("detachToSlider.isStartFromSlider",!1),this.initialModel.set("detachToSlider.isDetachToSlider",!1)}},{key:"_onTempAdOutOffView",value:function(){this.log.info("_onTempAdOutOffView"),
this.model.set("elementOutOfView",!1);var e=this._isFutureCardExist();return this.tempActiveAd.onShouldCardSwap(),e.createNewCard===!0?void this._getCard("continueToPlayInNexCard"):0===e.futureCardIndex||e.futureCardIndex?(this.controllersArray[this.model.get("lastCardOutOfViewport")].videoView.extractAd(this.tempActiveAdCondition),this.controllersArray[e.futureCardIndex].videoView.injectAd(this.tempActiveAd,this.tempActiveAdCondition),void this.log.info("@Opp fire _onCardReturn rv:",this.tempActiveAd)):void 0}},{key:"_isContinuaPLayAdInNextCard",value:function(){return this.log.info("lastCardOutOfViewport: ",this.model.get("lastCardOutOfViewport")),!(0!==this.model.get("lastCardOutOfViewport")&&!this.model.get("lastCardOutOfViewport"))&&this._isActiveAdPassesCondition()}},{key:"_isActiveAdPassesCondition",value:function(){var e=this._getTempActiveAd();if(!e)return!1;if(!e.isPWOV()){var t=this._getCondition(e);if(!t)return!1;this.log.info("!!!_isActiveAdPassesCondition",t);var i=this._checkAdCondition(e,t);return i?(this.tempActiveAd=e,this.tempActiveAdCondition=t):(this.tempActiveAd=void 0,this.tempActiveAdCondition=void 0),this.log.info("!!!_isActiveAdPassesCondition isPassesCondition",i),this.log.info("!!!_isActiveAdPassesCondition tempActiveAd",this.tempActiveAd),this.log.info("!!!_isActiveAdPassesCondition tempActiveAdCondition",this.tempActiveAdCondition),i}}},{key:"_getCondition",value:function(e){var t=e.adData.requiredViewability?[1]:[0];e.vpaidWrapper.isCPCV&&t.push("CPCV");for(var i=null,n=0;n<t.length;n++)if(i=this.model.get("continueToPlayInNexCard")[t[n]]?this.model.get("continueToPlayInNexCard")[t[n]]:i,"completion"==this.model.get("continueToPlayInNexCard")[t[n]])return"completion";return i}},{key:"_isFutureCardExist",value:function(){var e={futureCardIndex:void 0,createNewCard:!1};this.log.info("!!!@@@ lastCardOutOfViewport",this.model.get("lastCardOutOfViewport"));var t=this.controllersArray[this.model.get("lastCardOutOfViewport")],i=t.videoView.getEl().getBoundingClientRect().top>0;if(i&&0===this.model.get("lastCardOutOfViewport"))return e;if(!i){for(var n=this.model.get("lastCardOutOfViewport");n<this.controllersArray.length;n++)if(!this.controllersArray[n].videoView.getActiveAd()&&this.controllersArray[n].videoView.getModel().get("isCardBelongToTempAd"))return e.futureCardIndex=n,e;return e.createNewCard=!0,e}for(var o=this.model.get("lastCardOutOfViewport")-1;o>-1;o--)if(!this.controllersArray[o].videoView.getActiveAd()&&this.controllersArray[o].videoView.getModel().get("isCardBelongToTempAd"))return e.futureCardIndex=o,e;return e}},{key:"_checkAdCondition",value:function(e,t){return this.log.info("!!!_checkAdCondition condition:",t),this.log.info("!!!_checkAdCondition isViewabilityFired",e.isViewabilityFired),"viewability"!==t||!e.isViewabilityFired}},{key:"_getTempActiveAd",value:function(){if(this.log.info("check if posible temp ad",this.model.get("lastCardOutOfViewport")),this.controllersArray[this.model.get("lastCardOutOfViewport")].videoView)return this.controllersArray[this.model.get("lastCardOutOfViewport")].videoView.getActiveAd()}},{key:"_onAdCondition",value:function(){this.log.info("add condition done");for(var e=0;e<this.controllersArray.length;e++)this.controllersArray[e].videoView.getModel().get("isCardBelongToTempAd")&&this.controllersArray[e].videoView.onTempAdEnd();this.model.set("temAdCondition",!1),this.tempActiveAd=void 0}},{key:"_onFeedContainerChanged",value:function(){this.playerService.updatePlacement(),this.model.set("hasValidCard",void 0,{silent:!0}),this._closeHiddenFeedSubUnits(),this.cardLocator.updateFeedSelector(),this.model.set("subAdsEligibility",{},{silent:!0}),this.model.set("isSliderClosed",!1,{silent:!0}),this.isWaitingForCard=!1,this.firstCardCalled=!1,this._getCard("feedContainerChanged")}},{key:"_closeHiddenFeedSubUnits",value:function(){this.closedSuperSliderController&&this.closedSuperSliderController.terminateOnContainerChange();for(var e=0;e<this.controllersArray.length;e++){var t=this.controllersArray[e],i=t.model.get("closeState"),n=t.parentSelector!==this.model.get("parentSelector");!i&&n&&t.terminateOnContainerChange()}}},{key:"_triggerPassback",value:function(){this.model.get("isFirstAdLoaded")||(this.log.info("Passback timer done"),D.default.trigger("global:passback",{isApiPassbackExist:this.model.get("isApiPassbackExist")}),this.model.set("closeState",k.default.closeState.terminate))}}]),t}(p.StateManager);e.exports=M},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=(o(d),i(11)),u=(o(c),i(10)),h=(o(u),i(21)),p=n(h),f=i(151),m=o(f),g=i(152),v=o(g),y=i(202),b=o(y),_=i(204),w=o(_),T=i(206),A=o(T),S=i(70),P=(o(S),i(6)),C=i(25),E=(o(C),function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.globalModel=e.globalModel,i.model=e.model,i.container=e.container,i.parentSelector=i.model.get("parentSelector"),i.model.set("renderWasCalled",!1),i.ad=e.ad,i.closeButtonDelayd=!1,i.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerStateReady"},{event:"playerState:restarted",funcName:"_onPlayerStateReady"},{event:"isEligibleToPlay:true",funcName:"_onFirstEligibility",listenOnce:!0},{event:"detachToSlider.isDetachToSlider.singleAd:false",funcName:"_onUpdateSliderConfig",listenOnce:!0},{event:"detachToSlider.isDetachToSlider.adjacent:false",funcName:"_onUpdateSliderConfig",listenOnce:!0}]),i.ad.setSubModel(i.model),i.model.get("isSuperSlider")&&i.createStateHandlers([{event:"isSuperSliderClosed",funcName:"_SuperSliderClose",listenOnce:!0}]),i.isVVDetachable=i.model.get("detachToSlider.isStartFromSlider")||i.model.get("detachToSlider.isDetachToSlider"),i.SubFeedEligibilityService=new P.SubFeedEligibility(i.model,i.container,i.globalModel),i.model.set("videoViewContainer",i.ad.vpaidWrapper.adTarget),i.containerView=new v.default({model:i.model}),i.render(e.container),i.globalModel.get("components.nativeAd.isActive")&&(i.nativeAdView=new b.default({model:i.model,globalModel:i.globalModel,container:i.container})),setTimeout(i._createVideoView.bind(i),100),i}return a(t,e),l(t,[{key:"_createVideoView",value:function(){this.model.get("isUseFloatingView")?this.videoView=new A.default({model:this.model,adjs:this.ad,globalModel:this.globalModel}):this.videoView=new w.default({model:this.model},this.ad,this.globalModel)}},{key:"render",value:function(e){this.model.get("renderWasCalled")||(this.containerView.render(e,this.ad.adId),this.log.info("render was called with container: "+e,"subUnitId="+this.model.get("subUnitId")),setTimeout(function(){this.model.set("renderWasCalled",!0)}.bind(this),100))}},{key:"terminate",value:function(e,t){this._setTimerReason(t),e&&this.isVVDetachable?(this.videoView.permanentAttach(),this.videoView.checkAndClose()):this.model.set("closeState",p.closeState.terminate)}},{key:"terminateOnContainerChange",value:function(){this.SubFeedEligibilityService.resetPlaceHolders(),this.isTerminatedByFeedX=!0,this.containerView.closeAndRemove(),this.videoView.closeAndRemove()}},{key:"overKill",value:function(e){this.model.set("closeState",p.closeState.terminate),this.videoView.permanentClose(),this.containerView._runAnimation(!1),this.model.off()}},{key:"pause",value:function(e){this.log.info("pause: ",e),this._setTimerReason(e),this.isTerminatedByFeedX||this.videoView.onTimerEnd(e)}},{key:"_createTimers",value:function(){}},{key:"_onFirstEligibility",value:function(){this.model.set("gotFirstEligibility",!0)}},{key:"_SuperSliderClose",value:function(){this.overKill("Close SuperSlider")}},{key:"_onUpdateSliderConfig",value:function(){this.model.get("isSuperSlider")||this.model.set("detachToSlider.isDetachToSlider",!1)}}]),t}(m.default));e.exports=E},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(16),u=n(c),h=i(12),p=i(21),f=n(p),m=i(63),g=n(m),v=i(11),y=n(v),b=i(6),_=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e.model,i.model.set("height",d.default.getVideoHeight(i.model.get("width"))),i.log=new u.default({unitType:i.model.get("unitType"),className:i.constructor.name||"UnitController",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.containerView=void 0,i.videoView=void 0,i.adService=void 0,i.playerService=void 0,i.isClosedByUser=!1,i.createStateHandlers([{event:"closeState",funcName:"handleCloseState"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"}]),i.model.listenTo(i.model,"ad:stoppedByUser",i.terminate.bind(i,!0)),i._createTimers(),setTimeout(function(){this.competitionDetector=new b.CompetitionDetector(this.model)}.bind(i),0),i}return r(t,e),a(t,[{key:"_createTimers",value:function(){if(this.model.get("isMultiAd")&&this.model.get("midrollTimeout")>0){var e={startCondition:{stateToListen:f.default.adManagerState.empty,state:"adManagerState"},stopCondition:{stateToListen:f.default.adManagerState.hasAds,state:"adManagerState"}};this.getAdTimer=new g.default(this.model,e,this.terminate.bind(this,!1,"midrollCollapse"),1e3*this.model.get("midrollTimeout"))}else if(this.model.get("isMultiAd")&&this.model.get("secondsToCloseFeed")>0){var t={startCondition:{stateToListen:f.default.adManagerState.empty,state:"adManagerState"},stopCondition:{stateToListen:f.default.adManagerState.hasAds,state:"adManagerState"}};this.getAdTimer=new g.default(this.model,t,this.pause.bind(this,"midrollCollapse"),1e3*this.model.get("secondsToCloseFeed"))}var i=this.model.get("secondsToClose");if(i>0){var n={startCondition:{stateToListen:!0,state:"firstGetAdFired"},stopCondition:{stateToListen:f.default.adQState.impression,state:"adQState"},isStartOnce:!0};this.secondsToCloseTimer=new g.default(this.model,n,this.terminate.bind(this,!1,"secondsToClose"),1e3*i)}var o=this.model.get("secondsToCloseGlobal");if(o>0){var s={startCondition:{stateToListen:"",state:""}};"showReplay"===this.model.get("onTimerClose")?this.secondsToCloseGlobalTimer=new g.default(this.model,s,this.pause.bind(this,"secondsToCloseGlobal"),1e3*this.model.get("secondsToCloseGlobal")):this.secondsToCloseGlobalTimer=new g.default(this.model,s,this.terminate.bind(this,!1,"secondsToCloseGlobal"),1e3*o),this.secondsToCloseGlobalTimer.start(this.model,"")}this._createSecondsToPassbackTimer()}},{key:"terminate",value:function(e,t){this.log.info("Terminate reason: "+t),this.isClosedByUser=e,this._setTimerReason(t),this.model.set("closeState",f.default.closeState.terminate)}},{key:"_setTimerReason",value:function(e){this.model.set("closeTimer",e)}},{key:"handleCloseState",value:function(e,t){switch(this.log.info("handleCloseState",t),y.default.trigger("global:closeState:changed"),t){case f.default.closeState.terminate:this.containerView?this.containerView.close():this.model.set("closeState",f.default.closeState.containerViewClosed);break;case f.default.closeState.containerViewClosed:this.videoView?this.videoView.close(this.isClosedByUser):this.model.set("closeState",f.default.closeState.videoViewClosed);break;case f.default.closeState.videoViewClosed:this.adService?this.adService.close():this.model.set("closeState",f.default.closeState.adManagerStop);break;case f.default.closeState.adManagerStop:this.playerService&&(this.playerService.close(),this._stopListening())}}},{key:"_stopListening",value:function(){this.model.off(),y.default.off()}},{key:"pause",value:function(e){this._setTimerReason(e),this.adService&&this.adService.pauseGetAds()}},{key:"_onParentSelectorLost",value:function(){this.overKill("parentSelectorLost")}},{key:"overKill",value:function(e){this.log.info("overKill reason: "+e),this.adService&&this.adService.pauseGetAds(),this.adsManager&&this.adsManager.pauseGetAds(),this.model.set("closeState",f.default.closeState.terminate),this._setTimerReason(e)}},{key:"_createSecondsToPassbackTimer",value:function(){if(this.model.get("secondsToPassback")){var e={startCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:!0,state:"isFirstAdLoaded"}};this.passBackTimer=new g.default(this.model,e,this._triggerPassback.bind(this,"Passback"),1e3*this.model.get("secondsToPassback")),this.passBackTimer.start(this.model,"")}}},{key:"_triggerPassback",value:function(){this.model.get("isFirstAdLoaded")||(this.log.info("Passback timer done"),y.default.trigger("global:passback",{isApiPassbackExist:this.model.get("isApiPassbackExist")}),this.model.set("closeState",f.default.closeState.terminate))}}]),t}(h.StateManager);e.exports=_},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(10),h=o(u),p=i(11),f=o(p),m=i(21),g=n(m),v=i(16),y=o(v),b=i(12),_=i(153),w=o(_),T=i(154),A=o(T),S=i(155),P=i(25),C=o(P),E=i(201),k=o(E),I="_cm-feed-manager",O={title:"._cm-ad-title",placeholder:"._cm-feed-manager-video-placeHolder"},V=function(e){function t(){return s(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"initialize",value:function(e){this.log=new y.default({unitType:this.model.get("unitType"),className:"SubFeedContainerView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.titlePosition=this.model.get("components.adChoice.position"),this.template=this.titlePosition===C.default.TITLE_POSITION.ABOVE?w.default:A.default,this.subUnitId=this.model.get("subUnitId"),this.model.set("containerViewState",g.readyState),this.listenTo(this.model,"change:closeState",this._onCloseStateChange.bind(this)),this.isAnimateOnOpen=this.model.get("animation.onTransitionOpen"),this.isAnimateOnClose=this.model.get("isAnimateOnClose")||this.model.get("animation.onTransitionClose")&&"close"===this.model.get("onTimerClose"),this.openCloseAmnimation={transition:"height "+this.model.get("animation.transitionAnimationTime")+"ms"},this.noAmnimationCss={transition:"none"};var t=this.model.get("detachToSlider");this.isSuperSliderMode=t.isStartFromSlider&&t.isDetachToSlider,this.animationStartEndPoint={height:"0"},this.animationUtil=(0,k.default)(this.model)}},{key:"_bindWindowEvents",value:function(){this.listenTo(f.default,"window:orientation:change",this._orientationChange.bind(this)),this.listenTo(f.default,"window:resize:change",this._onwindoResize.bind(this)),this.listenTo(this.model,"change:isAdClosed",this._onAdClosed.bind(this)),this.listenTo(f.default,"window:scroll:change",this._onPlaceHolderDomChange.bind(this,!1)),this.listenTo(f.default,"feed:resize:change",this._onPlaceHolderDomChange.bind(this,!1)),this.listenTo(f.default,"taboola:readmore:click",this._onPlaceHolderDomChange.bind(this,!0)),this.listenTo(this.model,"change:aspectRatioNum",this._onPlaceHolderDomChange.bind(this,!0)),this.listenTo(this.model,"change:isAdClosedByTimer",this._onAdClosed.bind(this))}},{key:"render",value:function(e,t){this.log.info("rendering subunit:",this.subUnitId),this.container=e,this.$container=(0,h.default)(this.container),this.renderTemplate(),this._customize(),this.el.id="_cm-video-unit",this.$el.addClass("ContainerView_"+t),this._addAdChoiceTitle(),(0,h.default)(e).append(this.el),this._adjustWideFeed(),this.isAnimateOnOpen&&this._runAnimation(!0,null),this._onPlaceHolderDomChange(),this.model.set("containerViewPlaceHolder",this.ui.placeholder[0]),this._bindWindowEvents(),this.model.set("containerViewState",g.containerViewState.rendered),this._triggerRenderEvent()}},{key:"_onAdClosed",value:function(e,t){t&&this.isAnimateOnClose&&this._runAnimation(!1,this.closeAndRemove.bind(this))}},{key:"terminate",value:function(e,t){this.terminated||(this.stopListening(f.default,"window:scroll:change"),this.stopListening(f.default,"feed:resize:change"),this.model.set("closeState",g.closeState.closeUnit),this.terminated=!0)}},{key:"hide",value:function(){this.$el.hide(),this.$container.hide()}},{key:"remove",value:function(){this.$el.remove(),this.$container.remove()}},{key:"close",value:function(){this.log.info("close"),this.isClosed||(this.isClosed=!0,"WIDGET_ITEM"===this.model.get("unitType")?(this._runAnimation(!1,this.hide.bind(this)),this.model.set("closeState",g.closeState.containerViewClosed)):setTimeout(function(){this.model.set("closeState",g.closeState.containerViewClosed)}.bind(this),1500))}},{key:"closeAndRemove",value:function(){this.terminate(),this.remove()}},{key:"_onCloseStateChange",value:function(){switch(this.model.get("closeState")){case g.closeState.closeUnit:this.close()}}},{key:"_customize",value:function(){var e=this.model.get("customization.unitContainer"),t=this.model.get("customization.placeHolder"),i=this.model.get("customization.adTitle");this._customizeFeed(),this.$el.css(c.default.toCssObj(e)),this.ui.title.css(c.default.toCssObj(i)),this.ui.placeholder.css(c.default.toCssObj(t))}},{key:"_addAdChoiceTitle",value:function(){this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.title.isActive")&&(this.adChoice=new S.AdChoiceView({model:this.model,container:this.ui.title,parent:this.el,type:C.default.AD_CHOICE_TYPE.TITLE}))}},{key:"_customizeFeed",value:function(){this.ui.title.text(this.model.get("unitTitle"))}},{key:"_onwindoResize",value:function(){this._onPlaceHolderDomChange()}},{key:"_onPlaceHolderDomChange",value:function(){this.terminated||(this._calcPlaceholderSize(),this._calcPlaceholderPosition())}},{key:"_calcPlaceholderSize",value:function(){this.isAnimatioRunning||(this.isSuperSliderMode?this._calcPlaceholderSizeFeed(!1,this.$container.width()):this._calcPlaceholderSizeFeed())}},{key:"_runAnimation",value:function(e,t){if(e&&this.isSuperSliderMode)return void this.$el.css({display:"none"});if(this.isAnimatioRunning=!0,e){this.$el.css(this.animationStartEndPoint);var i=this.ui.placeholder.width(),n=this._getVideoHeightByRatio(i);this.model.set("videoPlaceholderSize",{width:i,height:n}),this.animationUtil.expand({$el:this.$el,timeMS:this.model.get("animation.transitionAnimationTime"),height:this.model.get("height"),cb:this.postAnimation.bind(this,this._calcPlaceholderSizeFeed.bind(this,!0))})}else this.animationUtil.collapse({$el:this.$el,timeMS:this.model.get("animation.transitionAnimationTime"),height:0,cb:this.postAnimation.bind(this,t)})}},{key:"postAnimation",value:function(e){this._removeAnimation(),e&&e()}},{key:"_removeAnimation",value:function(){this.isAnimatioRunning=!1,this.$el.css(this.noAmnimationCss)}},{key:"_calcPlaceholderSizeFeed",value:function(e,t){var i=this.ui.placeholder.width()||t,n=this._getVideoHeightByRatio(i);return i&&n?((e||this.model.get("videoPlaceholderSize.width")!==i||this.model.get("videoPlaceholderSize.height")!==n)&&(this.model.set("width",i),this.model.set("height",n),this.$el.css({height:n+this.ui.title.height(),width:i}),this.titlePosition===C.default.TITLE_POSITION.BELOW&&this.ui.placeholder.css({height:n}),this.model.set("videoPlaceholderSize",{width:i,height:n}),this.model.get("videoViewState")!==g.videoViewState.detached&&this.model.trigger("change:videoPlaceholderSize",this.model,this.model.get("videoPlaceholderSize"))),void this._adjustWideFeed()):void this.log.error("_calcPlaceholderSizeFeed calculated width=0 or height=0",{width:i,height:n,subUnitId:this.subUnitId})}},{key:"_getVideoHeightByRatio",value:function(e){return this.model.isVerticalVideoEnabled(e)?c.default.getVideoHeightByRatio(e,this.model.get("aspectRatioNum")):c.default.getVideoHeight(e)}},{key:"_calcPlaceholderPosition",value:function(){var e=c.default.getOffsetWithContainer(this.ui.placeholder,this.model.get("offsetGetterType"),this.model.get("videoContainerSelector")),t=this.model.get("videoPlaceholderPosition");t&&t.top===e.top&&t.left===e.left||this.model.set("videoPlaceholderPosition",{top:e.top,left:e.left})}},{key:"_adjustWideFeed",value:function(){var e=this.model.get("maxVideoWidth"),t=this.$el.parent();if(e&&t){var i=t.width();i>=e?(this._setMaxVideoSize(e),this.$el.addClass("_cm-wide-feed"),this.model.set("adjustWideFeed",!0)):(this.$el.removeClass("_cm-wide-feed"),this._setMaxVideoSize(i),this.model.set("adjustWideFeed",!1))}}},{key:"_setMaxVideoSize",value:function(e){var t=c.default.getVideoHeight(e)+this.ui.title.height();this.$el.css({maxHeight:t,maxWidth:e})}},{key:"_orientationChange",value:function(){this._onPlaceHolderDomChange()}},{key:"_updateBrandingStyle",value:function(){var e=document.querySelector(".videoCube"),t=e.querySelector(".video-label-box .video-title");this.model.set("customization.titleContainer.title",c.default.cssObjToString(getComputedStyle(t)));var i=e.querySelector(".video-label-box .branding");this.model.set("customization.titleContainer.branding",c.default.cssObjToString(getComputedStyle(i)))}},{key:"_triggerRenderEvent",value:function(){var e=this.model.get("cardNumber");e&&f.default.trigger("newCardRendered",{cardNumber:Math.abs(e),isSlider:e<0,subUnitType:this.model.get("subUnitType")})}},{key:"_SuperSliderClose",value:function(){this.isSuperSliderMode=!1,this.terminate()}},{key:"className",get:function(){return I}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=O},set:function(e){return this.UI=e}}]),t}(b.StateManagerView);e.exports=V},function(e,t){e.exports="<div class=_cm-ad-title></div> <div class=_cm-feed-manager-video-placeHolder> </div>"},function(e,t){e.exports="<div class=_cm-feed-manager-video-placeHolder> </div> <div class=_cm-ad-title></div>"},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.adLoadingProgressSubUnitView=t.ExpandableContentVideoView=t.StaticBannerView=t.AdLoadingProgress=t.VolumeButtonView=t.AdChoiceView=t.DisclosureTextView=t.BrandingTitleView=t.TimerView=t.RepeatView=t.PlayListView=t.OptOutView=t.LoadingView=t.DetachButtonView=t.D2DFallbackView=t.CleanCloseButtonView=t.CloseButtonView=t.SubFeedCloseButtonView=t.ContentVideoView=t.ContentVideoControlsView=t.ClickThroughView=t.BrandLogoView=t.PosterView=void 0;var o=i(156),s=n(o),r=i(157),a=n(r),l=i(159),d=n(l),c=i(160),u=n(c),h=i(162),p=n(h),f=i(163),m=n(f),g=i(165),v=n(g),y=i(166),b=n(y),_=i(169),w=n(_),T=i(171),A=n(T),S=i(177),P=n(S),C=i(178),E=n(C),k=i(180),I=n(k),O=i(182),V=n(O),x=i(184),D=n(x),M=i(187),R=n(M),N=i(188),L=n(N),F=i(190),B=n(F),j=i(192),U=n(j),H=i(194),W=n(H),z=i(196),$=n(z),G=i(198),q=n(G),Y=i(200),K=n(Y);t.PosterView=s.default,t.BrandLogoView=a.default,t.ClickThroughView=d.default,t.ContentVideoControlsView=q.default,t.ContentVideoView=W.default,t.SubFeedCloseButtonView=p.default,t.CloseButtonView=u.default,t.CleanCloseButtonView=R.default,t.D2DFallbackView=m.default,t.DetachButtonView=v.default,t.LoadingView=b.default,t.OptOutView=w.default,t.PlayListView=A.default,t.RepeatView=P.default,t.TimerView=E.default,t.BrandingTitleView=I.default,t.DisclosureTextView=V.default,t.AdChoiceView=D.default,t.VolumeButtonView=L.default,t.AdLoadingProgress=B.default,t.StaticBannerView=U.default,t.ExpandableContentVideoView=$.default,t.adLoadingProgressSubUnitView=K.default},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(11),s=n(o),r=i(16),a=n(r),l=i(10);n(l);e.exports=s.default.View.extend({className:"_cm-poster",id:"_cm-css-reset",initialize:function(e){this.log=new a.default({unitType:"Component",className:"PosterView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.render()},render:function(){this.staticBanner=document.createElement("img"),this.staticBanner.addEventListener("error",this._onError.bind(this));var e=this.model.get("components.PosterView.imageLocation");this.staticBanner.src=e,this.staticBanner.height=this.model.get("height"),this.staticBanner.width=this.model.get("width"),this.staticBanner.onclick=this._onClick.bind(this),this.$el.hide(),this.$el.append(this.staticBanner),this.container.prepend(this.$el)},_onError:function(){s.default.trigger("error",this.staticBanner,"imageLoadError"),this.$el.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_onClick:function(e){this.trigger("cm:banner:click")}})},function(e,t,i){"use strict";var n=i(11),o=i(8),s=i(140),r=i(158);e.exports=n.View.extend({className:"_cm-brand-logo",events:{"click ":"_onClick"},initialize:function(e){this.log=new s({unitType:e.unitType,className:"branLogoView"}),this.model=e.model,this.container=e.container,this.options=this.model.get("components.BrandLogo")||{},this.options.imageSrc=this.model.get("components.BrandLogo.imageSrc"),this.openUrl=this._getOpenUrl(),this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=o.template(r),this.$el.append(this.template(this.options)),this.options.style&&this.$el.css(this.options.style),this.options.imageStyle&&this.$el.find("a>img").css(this.options.imageStyle),this.container.appendChild(this.el)},_onClick:function(){window.open(this.openUrl,"_blank")},_getOpenUrl:function(){var e=this.model.get("clickUrl"),t=this.options.logoLander,i=this.options.fallBackClickUrl,n="",o=this._getClickUrlQueryStrings(t);return n=e&&e.length>0&&e.indexOf("_#")===-1?decodeURIComponent(e)+encodeURIComponent(i)+o:i+o},_getClickUrlQueryStrings:function(e){var t="?ttype=1&cipid="+this.model.get("cipid")+"&ttype=1&crid="+this.model.get("creativeId")+"&dast="+this.model.get("dast")+"&tgtf="+encodeURIComponent(e);return t},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}})},function(e,t){e.exports="<a href=javascript:void(0);> <img src={{imageSrc}}> </a>"},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(11),s=n(o),r=i(16),a=n(r);e.exports=s.default.View.extend({className:"_cm-click-through",initialize:function(e){this.log=new a.default({unitType:"Component",className:"ClickThrough",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.link=e.link,this.render()},render:function(){this.$el.click(this.onClick.bind(this)),this.container.appendChild(this.el)},onClick:function(){this.link&&window.open(this.link,"_blank")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},updateLink:function(e){this.link=e}})},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var s=i(14),r=i(161),a=o(r),l=i(71),d=n(l),c=i(11),u=i(8),h=i(140),p=i(21);e.exports=c.View.extend({className:"_cm-close-area",id:"_cm-close-area",events:{"click ":"_onClick"},initialize:function(e){this.log=new h({unitType:e.unitType,className:"closeButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=s.createStateHandlers,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){this._rendered=!0,this.$el.append(a.default);var e=d.UAParser(window.navigator.userAgent),t=e.browser.name.toLowerCase();t.indexOf("firefox")===-1&&t.indexOf("ie")===-1&&t.indexOf("edge")===-1||this.$el.addClass("_cm-close-ie-fix"),this.container.appendChild(this.el),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&("detached"===this.model.get("videoViewState")?this.show():this.hide())}},_bindEvents:function(){this.model.get("vForce.isActive")?this.listenTo(this.model,"change:adState",this._onStateChange):this.listenTo(this.model,"change:state",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){var e=this.model.get("components.CloseButtonView.delay");setTimeout(this.render.bind(this),e)},_onClick:function(e){e.stopPropagation(),this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||u.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),c.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser",p.closeState.terminate)},_onStateChange:function(e,t){t!==e.STATE.PLAYING&&t!==p.adState.playing||this._onPlaying()},_onVideoViewStateChange:function(e,t){switch(t){case"detached":this.show();break;case"attached":this.hide()}},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}})},function(e,t){
e.exports='<?xml version="1.0" encoding="utf-8"?> <svg version=1.1 id=_x2014__x5F_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox="0 0 99 99" xml:space=preserve> <style type=text/css>.st0{fill:#fff}</style> <g> <g stroke=null id=svg_1> <g stroke=null id=svg_2> <path stroke=null id=svg_3 d="m82.77256,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964l-65.57555,-69.42328c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341c2.49406,-2.6404 6.53931,-2.6404 9.03337,0l65.57555,69.45548c2.49406,2.6404 2.49406,6.92301 0,9.56341c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class=st0 /> </g> <g stroke=null id=svg_4> <path stroke=null id=svg_5 d="m17.19702,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341l65.57555,-69.42328c2.49406,-2.6404 6.53931,-2.6404 9.03337,0c2.49406,2.6404 2.49406,6.92301 0,9.56341l-65.57555,69.45548c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class=st0 /> </g> </g> </g> </svg>'},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(14),s=i(161),r=n(s),a=i(11),l=i(8),d=i(140),c=i(21);e.exports=a.View.extend({className:"_cm-close-area",id:"_cm-close-area",closeButtonRenderd:!1,events:{"click ":"_onClick"},initialize:function(e){this.log=new d({unitType:e.unitType,className:"closeButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=o.createStateHandlers,this.render(),this.hide()},render:function(){this._rendered||(this._rendered=!0,this.isInDelay=!1,this.$el.append(r.default),this.container.appendChild(this.el))},_bindEvents:function(){this.listenTo(this.model,"change:state",this._onStateChange),this.listenTo(this.model,"change:adState",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.model.get("detachToSlider.hasCloseButton")&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){return this.model.get("videoViewState")!==c.videoViewState.attached||this.model.get("hasCloseButton")?void this._startRender():void(this.isInDelay&&(this.closeButtonRenderd=!1,clearTimeout(this.delayTimeout)))},_startRender:function(){if(this.closeButtonRenderd)this.show();else{this.closeButtonRenderd=!0;var e=this.model.get("components.CloseButtonView.delay");this.isInDelay=!0,this.delayTimeout=setTimeout(this.render.bind(this),e)}},_onClick:function(){this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||l.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),a.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser")},_onStateChange:function(e,t){switch(t){case"playing":this._onPlaying()}},_onVideoViewStateChange:function(e,t){"detached"===t&&!this.closeButtonRenderd&&this.model.get("detachToSlider.hasCloseButton")&&this._startRender(),"attached"!==t||this.model.get("hasCloseButton")||this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(64),s=n(o),r=i(11),a=i(10),l=i(8),d=i(140),c=i(164);e.exports=r.View.extend({className:"_cm-d2d-fallback",initialize:function(e){this.log=new d({unitType:e.unitType,className:"D2dFallbackView"}),this.model=e.model,this.container=e.container,this.isTrusted=!0,this.shouldReport=l.isFactor(this.model.get("gaFactor")),this.shouldReport&&this.model.get("isReportToKibana")&&(this.model.set("gaFactor",1),this.kibana=new s.default({model:this.model})),this.pubId=e.pubId?e.pubId:this.model.get("components.D2DFallbackView.pubId"),this.pubTagId=e.pubTagId?e.pubTagId:this.model.get("components.D2DFallbackView.pubTagId"),this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append(c),this._customize(),a(this.container).append(this.$el),this.iframe=this.$el.find("iframe")[0],this.iframe.contentWindow?this._writeIframe():this.iframe.onload=this._writeIframe.bind(this),l.firePixel(this.model.getPixel("pixels.D2DFallback"),"D2DFallback")},_writeIframe:function(){this.iframe.onload=this.iFrameOnLoad.bind(this);var e=this.iframe.contentWindow.document;e.open(),e.write('<script type="text/javascript" src="'+this.buildFallbackURL()+'"></script>'),e.close(),e.onclick=this._onClick.bind(this)},iFrameOnLoad:function(){var e=a(this.iframe.contentWindow.document.body),t=a("div",e);t.length>0&&this.model.set("d2dLoaded",!0)},buildFallbackURL:function(){var e=this.model.get("components.D2DFallbackView.location")+"?oid=15&width="+this.model.get("components.D2DFallbackView.width")+("&height="+this.model.get("components.D2DFallbackView.height"))+("&pubid="+this.pubId)+("&tagid="+this.pubTagId)+("&pstn="+this.model.get("components.D2DFallbackView.pstn"))+("&cirf="+this.model.get("referrer"))+"&noaop=1&revmod=INSERT_CONTENT_TYPE&encoded=1&cb=INSERT_CACHEBUSTER&keywords=INSERT_COMMA_SEPARATED_KEYWORDS&urlonly=1&callback=document.write";return e},hide:function(e){this.log.info("D2D hide:",e),e?this.$el.css({display:"none"}):this.$el.css({display:"block"})},show:function(){this.$el.css({display:"block"})},_onClick:function(e){this.isTrusted=!0,e.isTrusted?window.setTimeout(this._onTimeoutEnd.bind(this),1e3*this.model.get("clickTestSeconds")):(l.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"),this.kibana&&this.kibana.onD2DClick(e.isTrusted))},_onTimeoutEnd:function(){document.hidden?l.firePixel(this.model.getPixel("pixels.D2DClick"),"D2DClick"):(l.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"),this.kibana&&this.kibana.onD2DClick(!0,!1))},_customize:function(){var e=this.model.get("components.D2DFallbackView.additionalCss");this.$el.css(l.toCssObj(e))},updateD2D:function(e,t){this.iframe&&this.pubId!=e&&this.pubTagId!=t&&(this.pubId=e,this.pubTagId=t,this._writeIframe())},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide(!0)},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide(!0)}})},function(e,t){e.exports="<iframe style=width:100%;height:100% frameborder=0 border=0 padding=0 scrolling=no marginwidth=0 marginheight=0></iframe>"},function(e,t,i){"use strict";var n=i(11),o=(i(8),i(140));e.exports=n.View.extend({className:"_cm-detach",events:{"click ":"_onClick"},initialize:function(e){this.log=new o({unitType:e.unitType,className:"detachButtonView"}),this.container=e.container,this._rendered=!1},render:function(){if(!this._rendered){var e=this.model.get("components.DetachButtonView.imageLocation");this.$el.css("background-image",'url("'+e+'") !important'),this.container.appendChild(this.el)}},_onClick:function(){this.$el.trigger("cm:detach:click")},hide:function(){this.$el.hide()}})},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var s=i(11),r=o(s),a=i(16),l=o(a),d=i(10),c=o(d),u=i(167),h=o(u),p=i(168),f=o(p),m=i(21),g=n(m),v=i(25),y=o(v);e.exports=r.default.View.extend({className:"_cm-loading",id:"_cm-css-reset",initialize:function(e){this.log=new l.default({unitType:"Component",className:"LoadingView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),e.globalModel&&(this.globalModel=e.globalModel),this.container=e.container,this.isStartWithReplay=e.isStartWithReplay,this.isReplayable=e.isReplayable,this._createStatesAction(),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange.bind(this,this.adStateActions)),this.listenTo(this.model,"change:adManagerState",this._onAdStateChange.bind(this,this.getAdStateActions)),this.globalModel&&this.listenTo(this.globalModel,"change:adManagerState",this._onGlobalModelAdStateChange.bind(this,this.getAdStateActions))},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),stopped:this._stop.bind(this)},this.getAdStateActions={stopped:this._stop.bind(this)}},_onGlobalModelAdStateChange:function(e,t,i){if(i==g.adManagerState.stopped){var n=e[i];n&&n()}},_onAdStateChange:function(e,t,i){var n=e[i];n&&n()},render:function(){this.$el.append(h.default),this.loadingDiv=this.$el.find("._cm-loading-div"),"css"==this.model.get("components.Loading.type")?this.loadCss():"img"==this.model.get("components.Loading.type")&&this.loadImage(),this._applyAdditionalCss(),this.isStartWithReplay&&this.$el.css("background","transparent"),this.$el.hide(),this.container.appendChild(this.el),this._renderReapet(),this.currentActiveImage=this.innerDisplay},_renderReapet:function(){this.repeatEl=(0,c.default)(f.default),this._setBackground(),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this.repeatEl.hide(),this.loadingDiv.append(this.repeatEl)},_setRepeatIcon:function(){this.reapeatWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var e=this.repeatEl.find("._cm-repeat-button"),t=this.repeatEl.find("._cm-repeat-button-hover"),i=this.model.get("components.Repeat.repalyIcon"),n=this.model.get("components.Repeat.replayHoverIcon");this._setButtonSrc(e,t,i,n)},_setLearnMoreIcon:function(){var e=this.repeatEl.find("._cm-learn-more-button"),t=this.repeatEl.find("._cm-learn-more-button-hover"),i=this.model.get("components.Repeat.learnMoreIcon"),n=this.model.get("components.Repeat.learnMoreHoverIcon");this._setButtonSrc(e,t,i,n),this.model.get("adClickThroughUrl")?this.repeatEl.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_setButtonSrc:function(e,t,i,n){e.attr("src",i),t.attr("src",n)},_setBackground:function(){var e=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+e+'") !important')},loadCss:function(){var e=document.createElement("div");e.className="_cm-loading-icon",this.loadingDiv.append(e),this.innerDisplay=(0,c.default)(e)},loadImage:function(){var e=document.createElement("img");e.src=this.model.get("components.Loading.imgUrl"),e.className="_cm_loader_img",this.loadingDiv.append(e),this.innerDisplay=(0,c.default)(e)},hide:function(){this.isRepeatShowing=!1,this.$el.hide(),this._setModel("loadingViewState",g.loadingViewState.hiding)},show:function(){this.isStartWithReplay&&this._showRe(),this.$el.show(),this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height()),this._setModel("loadingViewState",g.loadingViewState.showing)},showRepeat:function(){this._stop()},_onRepeatClick:function(e){e.stopPropagation(),this.log.info("User click"),this.clickEventRegistered=!1,this._setModel("loadingViewState",g.loadingViewState.clicked),this.repeatEl.hide(),this.innerDisplay.show(),this.currentActiveImage=this.innerDisplay,this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height())},_onLearnMoreClick:function(e){window.open(this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_onAdPlaying:function(){this.hide()},_onVideoComplete:function(){this.model.get("displayFiller.betweenAds")!=y.default.DISPLAY_FILLER.BETWEEN_ADS.CONTENT&&this.show()},_stop:function(){this.model.get("isAdClosedByTimer")||this.model.get("closeState")||(this.clickEventRegistered||(this.reapeatWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.show(),this.innerDisplay.hide(),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.reapeatWrapper.hide(),this.repeatEl.show())},_showRe:function(){this.isRepeatShowing||(this.innerDisplay.hide(),this.clickEventRegistered||(this.reapeatWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.reapeatWrapper.hide(),this.repeatEl.show(),this.isRepeatShowing=!0)},_setLoadingViewSize:function(e,t){this.loadingDiv.css({width:e,height:t})},_setModel:function(e,t){this.globalModel&&this.globalModel.set(e,t),this.model.set(e,t)},_applyAdditionalCss:function(){var e=this.model.get("additionalCss");if(e){var t=e["z-index"]||e.zIndex;t&&this.$el.css({"z-index":e["z-index"]})}},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.repeatEl.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())}})},function(e,t){e.exports="<div class=_cm-loading-div> </div>"},function(e,t){e.exports="<div id=_cm-css-reset class=_cm-repeat-div> <div class=_cm-repeat-view-wrapper> <div class=_cm-repeat-buttons-wrapper> <img class=_cm-repeat-button> <img class=_cm-repeat-button-hover> </div> <div class=_cm-learn-more-buttons-wrapper> <img class=_cm-learn-more-button> <img class=_cm-learn-more-button-hover> </div> </div> </div>"},function(e,t,i){"use strict";var n=i(11),o=i(8),s=i(10),r=i(140),a=i(21),l=i(170);e.exports=n.View.extend({events:{"click ._cm-opt-button":"toggleDialog","click ._cm-cancel":"hideDialog","click ._cm-submit":"submitDialog"},id:"_cm-opt-out-view",className:"_cm-opt-out-view",initialize:function(e){this.log=new r({unitType:e.unitType,className:"optOut"}),this.container=e.container,this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append(l),s(this.container).prepend(this.$el),this.ui={},this.ui.Dialog=this.$el.find("._cm-opt-dialog"),this.hideDialog()},toggleDialog:function(){"none"===this.ui.Dialog.get(0).style.display?this.showDialog():this.hideDialog()},showDialog:function(){this.$el.trigger("cm:optout:dialog:show"),this.ui.Dialog.show()},hideDialog:function(){this.$el.trigger("cm:optout:dialog:hide"),this.ui.Dialog.hide()},submitDialog:function(){var e=this.el.querySelector("._cm-opt-text").value,t=this.model.getPixel("pixels.optOutNever")+"&userComplaint="+e;o.firePixel(t,"Never OptOut"),this.hideDialog(),this.model.set("state",this.model.STATE.OPT_OUT),this.model.set("closeState",a.closeState.terminate),this.$el.trigger("cm:optout:submit")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()}})},function(e,t){e.exports='<div class=_cm-opt-out> <div class=_cm-opt-button></div> <div class=_cm-opt-dialog> <div id="" class=_cm-opt-message> Never show me Video ads </div> <textarea class=_cm-opt-text placeholder="What was the problem with this ad?"></textarea> <div> <button type=button class=_cm-cancel>Cancel</button> <button type=button class=_cm-submit>Send</button> </div> </div> </div>'},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(10),s=n(o),r=i(8),a=(n(r),i(11)),l=n(a),d=i(172),c=n(d),u=i(16),h=n(u),p=i(174),f=n(p),m=i(175),g=(n(m),i(176)),v=n(g);e.exports=l.default.View.extend({errorCount:0,className:"_cm-playlist",initialize:function(e){this.log=new h.default({unitType:"playlist",className:"PlayListView"}),this.playListCollection=new f.default,this.container=e.container,this._playlist=e.playlist,this._height=e.height||350,this._itemCount=parseInt(this._height/74),this._itemCount=Math.min(this._playlist.length,this._itemCount),this._playlist=this._playlist.slice(0,this._itemCount),this._height=Math.min(this._height,74*this._itemCount),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(l.default,"change:player:content",this._onContentChanged),this.listenTo(this.model,"change:state",this._onStateChange),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},render:function(){this.$el.append(v.default),(0,s.default)(this.container).append(this.$el),this._playlist_list=this.$el.find("._cm-playlist-list"),this.$el.css({height:parseInt(this._height)})},_setPlayList:function(){this.playListCollection.length>0||(this.playListCollection.add(this._playlist),this.playListCollection.forEach(function(e){new c.default({model:e,container:this._playlist_list})},this),this.playListCollection.first().set("active",!0))},_onStateChange:function(e,t){switch(t){case e.STATE.PLAYER_READY:this._setPlayList()}},_itemSelected:function(e){e.set("clicked",!1),this._playItem(e),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},_playItem:function(e){if(!this._playlist_list.hasClass("unclickable")){var t=this.playListCollection.findWhere({active:!0});t&&t.set("active",!1),e.set("active",!0),this.$el.trigger("_cm-unit-play",e.attributes)}},_onContentChanged:function(e){this.log.important("On content changed",e);var t=this.playListCollection.findWhere({active:!0});t&&t.set("active",!1),t=this.playListCollection.findWhere({id:e.id}),t&&t.set("active",!0)},playNext:function(){var e=this.playListCollection.findWhere({active:!0}),t=this.playListCollection.indexOf(e)+1;t>=this._itemCount&&(t=0),this._playItem(this.playListCollection.at(t))},setUnclickable:function(e){e?this._playlist_list.addClass("unclickable"):this._playlist_list.removeClass("unclickable")}})},function(e,t,i){"use strict";var n=i(11),o=i(8),s=i(10),r=i(140),a=i(173);e.exports=n.View.extend({errorCount:0,events:{"click ._cm-playlist-item":"_onItemClick"},initialize:function(e){this.log=new r({unitType:"playlist-item",className:"PlayListView"}),this.model=e.model,this.container=e.container,this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:active",this.setActive)},render:function(){var e={image:this.model.get("image"),title:this.model.get("title")},t=o.template(a)(e);this.$el.append(t),s(this.container).append(this.$el),this._item=this.$el.find("._cm-playlist-item")},_onItemClick:function(e){this.model.set("clicked",!0)},setActive:function(e,t){t?this._item.addClass("active"):this._item.removeClass("active")}})},function(e,t){e.exports="<li class=_cm-playlist-item> <img class=_cm-playlist-img src={{image}}> <span class=_cm-playlist-text>{{title}}</span> </li>"},function(e,t,i){"use strict";var n=i(11),o=i(175);e.exports=n.Collection.extend({model:o})},function(e,t,i){"use strict";var n=i(11);e.exports=n.DeepModel.extend({defaults:{id:0,filename:"",image:"",title:"",vidlength:"",active:!1,clicked:!1}})},function(e,t){e.exports="<ul class=_cm-playlist-list> </ul>"},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var s=i(11),r=o(s),a=i(16),l=o(a),d=i(10),c=o(d),u=i(8),h=o(u),p=i(21),f=n(p),m=i(168);e.exports=r.default.View.extend({className:"_cm-repeat",id:"_cm-css-reset",initialize:function(e){this.log=new l.default({unitType:"Component",className:"RepeatView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.active=!1,this._createStatesAction(),this._bindEvents(),this._render()},_render:function(){this.repeatEl=(0,c.default)(m),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this._setBackground(),this.$el.hide(),this.$el.append(this.repeatEl),this.container.appendChild(this.el)},_setRepeatIcon:function(){this.repeatWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var e=this.repeatEl.find("._cm-repeat-button"),t=this.repeatEl.find("._cm-repeat-button-hover"),i=this.model.get("components.Repeat.repalyIcon"),n=this.model.get("components.Repeat.replayHoverIcon");this._setButtonSrc(e,t,i,n),this.repeatWrapper.click(this._onClick.bind(this))},_setLearnMoreIcon:function(){var e=this.repeatEl.find("._cm-learn-more-button"),t=this.repeatEl.find("._cm-learn-more-button-hover"),i=this.model.get("components.Repeat.learnMoreIcon"),n=this.model.get("components.Repeat.learnMoreHoverIcon");this._setButtonSrc(e,t,i,n),this.model.get("adClickThroughUrl")?this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_setButtonSrc:function(e,t,i,n){e.attr("src",i),t.attr("src",n)},_setBackground:function(){var e=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+e+'") !important')},hide:function(){this.$el.hide(),this.active=!1,this.isSpinning=!1,this.model.set("repeatState",f.repeatState.hiding)},show:function(){this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.repeatWrapper&&this.model.get("dontRenderRepeatButton")&&this.repeatWrapper.hide(),this.$el.show(),this.active=!0,this.model.set("repeatState",f.repeatState.showing)},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange)},_onClick:function(e){e.stopPropagation(),this.isSpinning||this.model.getPixel&&h.default.firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel"),this.model.set("repeatState",f.repeatState.clicked),this.trigger("cm:repeat:click")},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),repeating:this._onAdPlaying.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onAdPlaying:function(){var e=this;setTimeout(function(){e.hide()},100)},_onVideoComplete:function(){this.show()},_onLearnMoreClick:function(e){window.open(this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())}})},function(e,t,i){"use strict";var n=i(11),o=(i(8),i(10),i(140)),s=i(179);e.exports=n.View.extend({className:"_cm-timer",initialize:function(e){this.log=new o({unitType:e.unitType,className:"timerView"}),this.container=e.container,this._time=Number(e.time)||Number(this.model.get("components.TimerView.time")),this._isHide=e.isHide,this._stepTime=1,this.render()},render:function(){this.$el.append(s),this.hide(),this.container.appendChild(this.el),this.$el.find("._cm-timer-circle ._cm-timer-mask, ._cm-timer-circle ._cm-timer-fill").css("transition","transform "+this._stepTime+"s linear"),this._innerText=this.$el.find("._cm-timer-inset>span")},startTimer:function(){return this.log.info("Timer start"),0===this._time?void this._finish():(this._currentTimer=this._stepTime,this._innerText.text(parseInt(this._time)),this._setDegree(180/this._time*this._currentTimer),void window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime))},_timerUpdate:function(){if(this._innerText.text(parseInt(this._time-this._currentTimer)),this._currentTimer+=this._stepTime,this._currentTimer>this._time)return void this._finish();var e=180/this._time,t=e*this._currentTimer;this._setDegree(t),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)},_setDegree:function(e){this.$el.find("._cm-timer-circle ._cm-timer-fill, ._cm-timer-circle ._cm-timer-mask._cm-timer-full").css("transform","rotate("+e+"deg)"),this.$el.find("._cm-timer-circle ._cm-timer-fill._cm-timer-fix").css("transform","rotate("+2*e+"deg)")},_finish:function(){this._isHide&&this.hide(),this.$el.trigger("cm:timer:finish")},hide:function(){this.$el.hide()}})},function(e,t){e.exports='<div class=_cm-timer-circle> <div class="_cm-timer-mask _cm-timer-full"> <div class=_cm-timer-fill></div> </div> <div class="_cm-timer-mask _cm-timer-half"> <div class=_cm-timer-fill></div> <div class="_cm-timer-fill _cm-timer-fix"></div> </div> </div> <div class=_cm-timer-inset> <span></span> </div>'},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(11),s=n(o),r=i(16),a=n(r),l=i(10),d=n(l),c=i(8),u=n(c),h=i(181);e.exports=s.default.View.extend({className:"_cm-branding-title",id:"_cm-css-reset",events:{},initialize:function(e){this.log=new a.default({unitType:"Component",className:"BrandingTitleView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.render(),this.bindEvents()},bindEvents:function(){this.model.listenTo(this.model,"change:customization.titleContainer.branding",this._customize.bind(this))},render:function(){this.template=u.default.template(h),this.$el.append(this.template(this.model.attributes)),this._customize(),this.container.appendChild(this.el),this.model.get("isFitToSize")&&this._fitToSize()},_customize:function(){var e=this.model.get("customization.titleContainer.title"),t=this.model.get("customization.titleContainer.branding");e&&(e=u.default.toCssObj(e),e.height="auto",this.$el.find("._cm-branding-view-title-text").css(e)),t&&(t=u.default.toCssObj(t),t.height="auto",this.$el.find("._cm-branding-view-branding-text").css(t))},_fitToSize:function(){var e=(0,d.default)(this.container),t=e.height(),i=this.model.get("videoPlaceholderSize");t&&i&&(Number(i.height)+this.$el.height()>=t?Number(i.height)+this.$el.find("._cm-branding-view-title-text").height()<t?this.$el.find("._cm-branding-view-branding-text").hide():this.$el.hide():this.$el.show())}})},function(e,t){e.exports="<span class=_cm-branding-view-title-text>{{titleContainer.titleText}}</span> <span class=_cm-branding-view-branding-text>{{titleContainer.BrandingText}}</span>"},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(14),s=i(183),r=n(s),a=i(11),l=(i(8),i(140));e.exports=a.View.extend({className:"_cm-disc-text",id:"_cm-css-reset",initialize:function(e){this.log=new l({unitType:e.unitType,className:"disclosureTextView"}),this.disclosureText=r.default,this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=o.createStateHandlers},render:function(){this._rendered||(this._rendered=!0,this.container.appendChild(this.el),"detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.isActive")?this.show():this.hide():this.model.get("components.disclosureText.isActive")?this.show():this.hide())},_bindEvents:function(){(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onVideoViewStateChange:function(e,t){switch(t){case"detached":0==this.model.get("detachToSlider.components.disclosureText.isActive")?this.hide():this.show();break;case"attached":this.model.get("components.disclosureText.isActive")?this.show():this.hide()}},hide:function(){this.$el.hide()},show:function(){var e="detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.text"):this.model.get("components.disclosureText.text");this.$el[0].innerHTML="",this.$el.append(this.disclosureText.replace("{text}",e)),this.$el.show()}})},function(e,t){e.exports='<div class="title text opt-out-hidden">{text}</div>'},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var o=i(25),s=n(o),r=i(21),a=n(r),l=i(71),d=n(l),c=i(11),u=i(8),h=i(10),p=i(140),f=i(185),m=i(186);e.exports=c.View.extend({events:{click:"_openAdChoice"},className:"_cm-ad-choice",initialize:function(e){this.log=new p({unitType:this.model.get("unitType"),className:"AdChoice"}),this.log.info("Ad Choice "+e.type+" initialized."),this.container=e.container,this.parentPlaceholder=e.parent,this.placementType=e.type,this.shouldHandelDetachAttach=s.UNIT_TYPES[this.model.get("unitType")]===s.UNIT_TYPES.FEED_MANAGER&&this.placementType!==s.AD_CHOICE_TYPE.TITLE,this.placementModel=this._getAdChoicePlacementModel(e.type),this.titlePosition=this.model.get("components.adChoice.position"),this.icon=this.model.get("components.adChoice.icon"),this._translateText(),this._bindEvents(),this.render(),this._firstVideoViewStateHandle(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=u.template(f),this.$el.append(this.template(this.placementModel)),this.$el.children("._cm-ad-choice-logo").css({background:"url("+this.icon+") no-repeat"}),this.placementModel.isActive&&(this.placementModel.adViewStyle&&this.$el.css(u.toCssObj(this.placementModel.adViewStyle)),this.$el.find("._cm-ad-choice-text").css(u.toCssObj(this.placementModel.style)),this.$el.find("._cm-ad-choice-logo").css(u.toCssObj(this.placementModel.logoStyle))),this._setAdChoiceUrl(),this._alignTitle(),h(this.container).append(this.el)},_bindEvents:function(){this.shouldHandelDetachAttach&&(this.log.info("Ad Choice "+this.placementType+" is listening to videoViewState"),this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this))),this.listenTo(this.model,"change:adPlayingWithAdChoice",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:adjustWideFeed",this._onAdjustWideFeed.bind(this));var e=d.UAParser(window.navigator.userAgent);"IE"!==e.browser.name&&"Edge"!==e.browser.name||this.listenTo(this.model,"change:isExpandEnded",this._onExpandEnded.bind(this))},_onExpandEnded:function(){this.log.info("onExpandEnded - IE or Edge detected");var e=this;this.$el.hide(),window.setTimeout(function(){e.$el.show()},0)},_getAdChoicePlacementModel:function(e){var t;switch(e){case s.AD_CHOICE_TYPE.TITLE:t=this.model.get("components.adChoice.title");break;case s.AD_CHOICE_TYPE.VIDEO_AD:t=this.model.get("components.adChoice.videoAd");break;case s.AD_CHOICE_TYPE.SLIDER:t=this.model.get("components.adChoice.slider");break;default:t={text:"",style:{},logoStyle:{}}}return t},_getSCardSelector:function(){var e=void 0;switch(s.UNIT_TYPES[this.model.get("unitType")]){case s.UNIT_TYPES.WIDGET_ITEM:e='*[data-placement-name="'+this.model.get("placement")+'"]';break;case s.UNIT_TYPES.FEED_MANAGER:e=".tbl-feed-container .trc-content-sponsored";break;case s.UNIT_TYPES.INLINE_INSTREAM:e=".trc_rbox_container .trc-content-sponsored";break;case s.UNIT_TYPES.INLINE:e=".trc_rbox_container .trc-content-sponsored";break;case s.UNIT_TYPES.SLIDER_INSTREAM:e=".trc_rbox_container .trc-content-sponsored";break;default:e=""}return e},_setAdChoiceUrl:function(){this._selector=this._getSCardSelector();var e=this._extractUrl(this._selector);h("._cm-ad-choice-text",this.$el).attr("href",e),h("._cm-ad-choice-logo",this.$el).attr("href",e)},_extractUrl:function(e){var t,i,n=h(e)[0];if(n)if(h(window).width()<=768||this.model.get("isMobile")?(t=h(n).find("a.trc_mobile_adc_link"),this._isOpenNewTab=!0):t=h(n).find("a.trc_desktop_adc_link"),t.length>0){var o=h(t[0]).attr("href");i=o.replace(/(Card)(\D*)(\d+)/,"Card "+this.model.get("cardNumber"))}else i=this.model.get("components.adChoice.fallbackUrl");else(h(window).width()<=768||this.model.get("isMobile"))&&(this._isOpenNewTab=!0),
i=this.model.get("components.adChoice.fallbackUrl");return i},_alignTitle:function(){if(this.placementType===s.AD_CHOICE_TYPE.TITLE&&this._selector){var e=getComputedStyle(h(this._selector)[0]);e&&"rtl"===e.direction&&h(this.container).css("text-align","left !important")}},_firstVideoViewStateHandle:function(){s.UNIT_TYPES[this.model.get("unitType")]===s.UNIT_TYPES.FEED_MANAGER&&this.placementType!==s.AD_CHOICE_TYPE.TITLE&&this._handleVideoViewState()},_handleVideoViewState:function(){switch(this.model.get("videoViewState")){case a.videoViewState.attached:this._onAttach();break;case a.videoViewState.detached:this._onDetach()}},_onAttach:function(){switch(this.placementType){case s.AD_CHOICE_TYPE.VIDEO_AD:this._show();break;case s.AD_CHOICE_TYPE.SLIDER:this._hide()}},_onDetach:function(){switch(this.placementType){case s.AD_CHOICE_TYPE.VIDEO_AD:this._hide();break;case s.AD_CHOICE_TYPE.SLIDER:this._show()}this._updateAdChoicesVisibility()},_openAdChoice:function(e){this._firePixel("pixels.adChoice","adChoice click pixel."),window.TRC&&(this._isOpenNewTab||window.TRC.aboutUs&&window.TRC.aboutUs.open&&window.TRC.aboutUs.open(e))},_firePixel:function(e,t){var i=this.model.getPixel(e);u.firePixel(i,t)},_show:function(){this.placementModel.isActive&&!this.model.get("adPlayingWithAdChoice")&&this.$el.show(),this._validateComponentVisibilityStatus(!0)},_hide:function(){this.placementModel.isActive&&this.$el.hide(),this._validateComponentVisibilityStatus(!1)},_validateComponentVisibilityStatus:function(e){var t=this.componentsVisibilityListener&&this.model.get(this.componentsVisibilityListener);"undefined"!=typeof t&&e!==t&&this.model.set(this.componentsVisibilityListener,e)},_updateAdChoicesVisibility:function(){this.model.get("adPlayingWithAdChoice")&&this.placementType!==s.AD_CHOICE_TYPE.TITLE?this._hide():this._show()},_onAdPlayingWithAdChoiceChange:function(){this.shouldHandelDetachAttach?this._handleVideoViewState():this._updateAdChoicesVisibility()},_onAdjustWideFeed:function(){var e=this.model.get("adjustWideFeed");this.titlePosition===s.TITLE_POSITION.BELOW&&(e?h(this.parentPlaceholder).addClass("_cm-wide-feed-title-below"):h(this.parentPlaceholder).removeClass("_cm-wide-feed-title-below"))},_translateText:function(){this.model.get("components.adChoice.isTranslateText")&&this.model.get("language")&&this.model.set("components.adChoice.videoAd.text",m[this.model.get("language").toUpperCase()])},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this._hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this._show():this._hide()}})},function(e,t){e.exports="<a class=_cm-ad-choice-text target=_blank>{{text}}</a> <a class=_cm-ad-choice-logo target=_blank></a>"},function(e,t){"use strict";e.exports={"AR-EG":"","AR-AE":"","AR-SA":"","CS-CZ":"Reklama","DA-DK":"Annonce","DE-DE":"Anzeige","DE-AT":"Anzeige","DE-CH":"Anzeige","EL-GR":"Ad","EN-AE":"Ad","EN-AU":"Ad","EN-CA":"Ad","EN-GB":"Ad","EN-IE":"Ad","EN-IN":"Ad","EN-SG":"Ad","EN-PH":"Ad","EN-MY":"Ad","EN-NZ":"Ad","EN-US":"Ad","EN-ZA":"Ad","EN-XL":"Ad","ES-ES":"Publicidad","ES-AR":"Patrocinado","ES-CO":"Patrocinado","ES-CL":"Patrocinado","ES-PE":"Patrocinado","ES-MX":"Patrocinado","ES-US":"Patrocinado","ES-XL":"Patrocinado","ES-VE":"Patrocinado","EN-ID":"Ad","FI-FI":"Mainos","FR-FR":"Sponsoris","FR-BE":"Sponsoris","FR-CA":"Pub","FR-CH":"Sponsoris","HE-IL":"","HI-IN":"","HU-HU":"Hird.","ID-ID":"Ad","IT-IT":"Ann.","JA-JP":"PR","KO-KR":"AD","NB-NO":"Annonse","NL-NL":"Adv","NL-BE":"Adv","PL-PL":"Reklama","PT-BR":"Publicidade","PT-PT":"Pub","RU-RU":"","SV-SE":"Annons","TH-TH":"Ad","TR-TR":"R","VI-VN":"Ad","ZH-CN":"","ZH-TW":"","ZH-HK":""}},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(12),c=i(161),u=o(c),h=i(71),p=n(h),f=(i(11),i(140)),m="_cm-close-area",g="_cm-close-area",v=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new f({unitType:e.unitType,className:"closeButtonView"}),i._setInitialParameters(e),e.isSkipRender||i.render(),i.bindEvents(),i}return a(t,e),l(t,[{key:"_setInitialParameters",value:function(e){this.container=e.container,this._rendered=!1,this.currModel=e.globalModel?e.globalModel:this.model}},{key:"render",value:function(){if(!this._rendered){this._rendered=!0,this.el.id=g,this.$el.addClass(m),this.$el.append(u.default);var e=p.UAParser(window.navigator.userAgent),t=e.browser.name.toLowerCase();t.indexOf("firefox")===-1&&t.indexOf("ie")===-1&&t.indexOf("edge")===-1||this.$el.addClass("_cm-close-ie-fix"),this.container.appendChild(this.el)}}},{key:"bindEvents",value:function(){var e=this;this.$el.on("click",function(){e._onClick()}),this.listenTo(this.currModel,"change:closeButton.isShowing",this.setButtonVisible.bind(this))}},{key:"_onClick",value:function(){this.currModel.trigger("change:closeButtonClick",!0)}},{key:"setButtonVisible",value:function(e,t){t?this.show():this.hide()}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this.$el.show()}}]),t}(d.StateManagerView);e.exports=v},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var o=i(25),s=n(o),r=i(21),a=n(r),l=i(71),d=n(l),c=i(11),u=i(8),h=i(10),p=i(140),f=i(189),m={display:"inline !important"},g={display:"none !important"},v={transition:"width 2000ms !important",width:"32px !important"},y={width:"32px !important"};e.exports=c.View.extend({className:"_cm-volume-area",id:"_cm-css-reset",events:{click:"_toggleVolume"},initialize:function(e){this._setInitialParameters(e),this._isHandleDetach(),this._hasCloseButton(),this._initVolumeState(),this._createStatesAction(),this._setMinimizeOnClickCallback(),this._bindEvents(),this.render(),this.log.info("Volume Button initialized.")},_bindEvents:function(){this.listenTo(this.currModel,"change:volumeMuted",this._onVolumeChange.bind(this)),this.listenTo(this.currModel,"startVolumeAnimation",this._minimizeAfterRender.bind(this)),this._handleDetach&&this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this)),this.currModel.on("lastVolumeStateCheck",this._onLastVolumeStateCheck,this),this.model.on("change:viewTopComponent",this.setButtonVisible,this),this.listenTo(this.model,"change:adQState",this._onAdStateChange)},_setComponentsVisibilityListener:function(){this.listenTo(this.currModel,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.currModel.get(this.componentsVisibilityListener)||this.hide()},render:function(){this._initTemplate(),this._setPosition(),this._styleCustomization(),this._checkIfMinimized(),this._renderComponent()},_initTemplate:function(){var e=u.template(f),t=e(this._settings);this.$el.append(t)},_renderComponent:function(){var e=this,t=d.UAParser(window.navigator.userAgent);"IE"===t.browser.name||"Edge"===t.browser.name?setTimeout(function(){h(e.container).append(e.el)},200):h(this.container).append(this.el)},_setInitialParameters:function(e){this.log=new p({unitType:this.model.get("unitType"),className:"volumeButtonView"}),this.container=e.container,this.currModel=e.globalModel?e.globalModel:this.model,this._settings=this.model.get("components.volume"),this._isMuted=!0,this._unitType=s.UNIT_TYPES[this.model.get("unitType")],this._isAlwaysBottom=this.model.get("components.volume.isAlwaysBottom"),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},_initVolumeState:function(){void 0===this.currModel.get("volumeMuted")&&this.currModel.set("volumeMuted",!0)},_setMinimizeOnClickCallback:function(){this._minimizeOnClick=u.once(this._minimize.bind(this,v))},_onLastVolumeStateCheck:function(){this._onVolumeChange()},_toggleVolume:function(){this._isMuted?(this._unMute(),this._fireUnmute()):(this._mute(),this._fireMute()),this._minimizeOnClick(),this.currModel.set("volumeUserInteraction",!0)},_mute:function(){this._showMute(),this._hideUnmute(),this._isMuted=!0},_unMute:function(){this._hideMute(),this._showUnmute(),this._isMuted=!1},_fireMute:function(){this.currModel.set("volumeMuted",!0),this.currModel.set("onUnMuteClicked",!1)},_fireUnmute:function(){this.currModel.set("volumeMuted",!1),this.currModel.set("onUnMuteClicked",!0)},_onVolumeChange:function(){var e=this.currModel.get("volumeMuted");e?this._mute():this._unMute()},_minimizeAfterRender:function(){this.currModel.get("volumeMustBeMinimized")?this._minimize(y):setTimeout(function(){this._isMinimized||this._minimize(v)}.bind(this),this._settings.timeToMinimize)},_minimize:function(e){h("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(e),this._isMinimized=!0,this.currModel.set("volumeMustBeMinimized",!0)},_hideMute:function(){h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(g)},_showMute:function(){h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(m)},_hideUnmute:function(){h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(g)},_showUnmute:function(){h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(m)},_setPosition:function(){this.hasCloseButton||this._isAlwaysBottom?this.$el.addClass("_cm-volume-area-bottom"):this.$el.addClass("_cm-volume-area-top"),this._handleDetach&&this._handleVideoViewState()},_isHandleDetach:function(){this._handleDetach=!1,this._unitType===s.UNIT_TYPES.FEED_MANAGER&&this.model.get("hasCloseButton")===!1&&this.model.get("detachToSlider.hasCloseButton")===!0&&(this._handleDetach=!0)},_hasCloseButton:function(){this._unitType!==s.UNIT_TYPES.FEED_MANAGER&&this._unitType!==s.UNIT_TYPES.INLINE_INSTREAM&&this._unitType!==s.UNIT_TYPES.MSN_WIDGET||(this.hasCloseButton=this.model.get("closeButton.hasCloseButton")),this._unitType!==s.UNIT_TYPES.WIDGET_ITEM&&this._unitType!==s.UNIT_TYPES.EXPANDABLE&&this._unitType!==s.UNIT_TYPES.EXPANDABLE_MOBILE||(this.hasCloseButton=this.model.get("components.CloseButtonView.hasCloseButton")),this._unitType===s.UNIT_TYPES.SLIDER_INSTREAM,this._unitType===s.UNIT_TYPES.EXPANDABLE},_handleVideoViewState:function(){if(!this._isAlwaysBottom){var e=this.model.get("videoViewState");e===a.videoViewState.attached&&(this.$el.addClass("_cm-volume-area-top"),this.$el.removeClass("_cm-volume-area-bottom")),e===a.videoViewState.detached&&this.hasCloseButton&&(this.$el.addClass("_cm-volume-area-bottom"),this.$el.removeClass("_cm-volume-area-top"))}},_styleCustomization:function(){this._settings.style&&(u.isEmpty(this._settings.style.border)||h("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(this._settings.style.border),u.isEmpty(this._settings.style.mute)||h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(this._settings.style.mute),u.isEmpty(this._settings.style.unmute)||h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(this._settings.style.unmute),u.isEmpty(this._settings.style.text)||h("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-text").css(this._settings.style.text))},_checkIfMinimized:function(){this._unitType===s.UNIT_TYPES.FEED_MANAGER&&this.currModel.get("volumeMinimized")&&this._minimize(y)},setButtonVisible:function(){this.log.info("_onTopComponentChange",this.model.get("viewTopComponent")),this.model.get("viewTopComponent")===s.FLOATING_VIEW_TOP_COMPONENT.video?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_createStatesAction:function(){this.adStateActions={q0:this.show.bind(this),completed:this.hide.bind(this),repeating:this.show.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onComponentsVisibilityChange:function(){this.currModel.get(this.componentsVisibilityListener)?this.show():this.hide()}})},function(e,t){e.exports='<div class=_cm-volume-border> <svg class=_cm-volume-mute data-name=_1 xmlns=http://www.w3.org/2000/svg viewBox="0 0 351.22 266.75"> <defs> <style>.cls-1{fill:#fff}</style> </defs> <g id=_Group_ data-name=&lt;Group&gt;> <g id=_Group_2 data-name=&lt;Group&gt;> <path class=cls-1 d=M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z transform="translate(-155.91 -178.44)"/> </g> </g> <path class=cls-1 d=M486.13,381.62a20.93,20.93,0,0,1-14.85-6.15l-97.62-97.62a21,21,0,1,1,29.69-29.7L501,345.77a21,21,0,0,1-14.85,35.85Z transform="translate(-155.91 -178.44)"/> <path class=cls-1 d=M388.5,381.62a21,21,0,0,1-14.84-35.85l97.62-97.62a21,21,0,1,1,29.7,29.7l-97.63,97.62A20.93,20.93,0,0,1,388.5,381.62Z transform="translate(-155.91 -178.44)"/> </svg> <svg class=_cm-volume-unmute data-name=_1 xmlns=http://www.w3.org/2000/svg viewBox="0 0 311.81 266.75"> <defs> <style>.cls-1{fill:#fff}</style> </defs> <g id=_Group_ data-name=&lt;Group&gt;> <path id=_Path_ data-name=&lt;Path&gt; class=cls-1 d=M465.85,290.12A124.1,124.1,0,0,0,453.19,253a127.55,127.55,0,0,0-21.66-29.51c-3.38-3.47-7.4-5.23-12.25-4.6a13.27,13.27,0,0,0-11.5,9.27c-1.87,5.38-.66,10.26,3.23,14.43,1,1.05,2,2,2.95,3.1a96.67,96.67,0,0,1,25.09,55.19,95.28,95.28,0,0,1-1.17,29.52,96.57,96.57,0,0,1-26.52,50.23,13.74,13.74,0,0,0-4.23,12.12,13.25,13.25,0,0,0,9.2,11.27c5.3,1.85,10.15.74,14.31-3.08.82-.74,1.57-1.56,2.33-2.36a125,125,0,0,0,34.74-87.88A131.18,131.18,0,0,0,465.85,290.12Z transform="translate(-155.91 -178.44)"/> <path id=_Path_2 data-name=&lt;Path&gt; class=cls-1 d=M420.23,307.35a87,87,0,0,0-6.32-28.82A88,88,0,0,0,395,249.69a14,14,0,0,0-24.29,11.22,16.39,16.39,0,0,0,4.73,8.92c13.86,14.79,19.22,32.3,16.05,52.27a58.5,58.5,0,0,1-16.83,32.54A14,14,0,0,0,388.48,378c3.13-.88,5.44-2.88,7.6-5.18,16.05-17.16,23.94-37.57,24.15-61C420.23,310.31,420.29,308.83,420.23,307.35Z transform="translate(-155.91 -178.44)"/> <path id=_Path_3 data-name=&lt;Path&gt; class=cls-1 d=M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z transform="translate(-155.91 -178.44)"/> </g> </svg> <div class=_cm-volume-text>{{expandedText}}</div> </div> '},function(e,t,i){"use strict";var n=i(11),o=i(8),s=i(10),r=i(140),a=i(191);e.exports=n.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(e){this.model.set("progressLoaderInit",!0),this._setInitialParameters(e),this._bindEvents(),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show()),this.render(),this.log.info("ad-loading-progress initialize")},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenTo(this.currModel,"change:isFirstAdLoaded",this._onFirstAdLoaded.bind(this)),this.listenToOnce(this.currModel,"change:hasReadyAd",this._onAdImpression.bind(this)),this.listenTo(this.currModel,"ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(e){this.log=new r({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.currModel=e.globalModel?e.globalModel:this.model,this.$el=s(this.el),this.viewPercent=this.currModel.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.currModel.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.currModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/50,this.showProgress=this.currModel.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this.model.get("eligiblePlaceholder")?this._renderComponent():this.model.once("change:eligiblePlaceholder",this._renderComponent.bind(this))},_renderComponent:function(){this.container=this.model.get("eligiblePlaceholder");var e={width:this.model.get("width")+3+"px",height:this.model.get("height")+2+"px"};this.$el.css(e),this.$el.css(this._getPosition(this.model.get("eligiblePlaceholder"))),s("body").append(this.el),this.$el.css(),s("._cm-ad-loading-progress_title_span").text(this.currModel.get("components.adLoadingProgress.title")),this.showProgress&&s("._cm-ad-loading-progress-container").css({display:"block"})},_initTemplate:function(){var e=o.template(a),t=e(this._settings);this.$el.append(t),this.$loadingPercentElement=s("._cm-ad-loading-progress_percent_span")},_onFirstAdLoaded:function(){this.log.info("FirstAd _onFirstAdLoaded loaded"),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show())},_startWatchingViewPort:function(){this.listenTo(n,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1));var e=this.$el.parent().height();this.$el.parent().height(e+1)},_calculateViewPortIntersection:function(){if(!this.stopWatchingViewPort){var e=o.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.currModel.get("scrollSelector"));this.log.info("currViewPercent: ",e?e:0),this.viewPercent<=e&&(this._startLoadingTimer(),this.stopWatchingViewPort=!0)}},_onAdImpression:function(){this.model.get("progressLoaderTimerReached")&&this.model.set("eligiblePlaceholder",!1),this.close()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this.log.info("Loading timer progress reached"),this.currModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress(),s("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})}.bind(this),this.progressTik)},_calculateLoadingProgress:function(){s("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=2,this.currModel.set("loaderCurrCount",this.count))},_restart:function(){this.container=this.model.get("eligiblePlaceholder"),this._renderComponent(),this._hide(),this.currModel.set("progressLoaderTimerReached",!1),s("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,s("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.stopWatchingViewPort=!1,this._show()},_show:function(){this.$el.css({display:"flex"})},_hide:function(){this.$el.css({display:"none"})},close:function(){this.model.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(n,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive".false)},_customize:function(){var e=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(o.toCssObj(e))},_getPosition:function(e){var t=e.getBoundingClientRect(),i=document.body.getBoundingClientRect(),n=t.top-i.top,o=t.left;return{top:n-1+"px",left:o+"px"}}})},function(e,t){e.exports="<div class=_cm-ad-loading-progress-container> <div class=_cm-ad-loading-progress-bar-container> <div class=_cm-ad-loading-progress-title> <span class=_cm-ad-loading-progress_title_span></span> <span class=_cm-ad-loading-progress_percent_span>0%</span> </div> <div class=_cm-ad-loading-progress-bar> <div class=_cm-ad-loading-progress-bar-loaded> </div> </div> </div> </div>"},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=(o(d),i(11)),u=(o(c),i(10)),h=(o(u),i(21)),p=(n(h),i(16)),f=o(p),m=i(193),g=o(m),v=i(12),y={id:"_cm-static-banner-view",className:"_cm-static-banner-view"},b=function(e){function t(){return s(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"initialize",value:function(e){this.log=new f.default({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.template=g.default,this._render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()}},{key:"_render",value:function(){this._validateImgSrc(),this.renderTemplate(),this._setDimensions(),this.$el.click(this._onClick.bind(this)),this.container.appendChild(this.el)}},{key:"_validateImgSrc",value:function(){this.model.get("urls.staticImage")||this.model.set("urls.staticImage",this.model.get("loaderImage"))}},{key:"_setDimensions",value:function(){this.$el.css({width:"100%",height:"100%"}),this.$el.find("img").css({width:"100%",height:"100%"})}},{key:"_onClick",value:function(){this.model.increaseCounter("staticClicks")}},{key:"show",value:function(){this.$el.show()}},{key:"hide",value:function(){this.$el.hide()}},{key:"_setComponentsVisibilityListener",value:function(){this.createStateHandlers([{event:this.componentsVisibilityListener,funcName:"_onComponentsVisibilityChange"}]),this.model.get(this.componentsVisibilityListener)||this.hide()}},{key:"_onComponentsVisibilityChange",value:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()}},{key:"className",get:function(){return this.ui.className}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=y},set:function(e){return this.UI=e}}]),t}(v.StateManagerView);e.exports=b},function(e,t){e.exports="<img src={{urls.staticImage}}> "},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(12),c=i(155),u=i(21),h=o(u),p=i(25),f=n(p),m=i(16),g=n(m),v=i(10),y=n(v),b=i(8),_=n(b),w=i(195),T=n(w),A="_cm-content-video",S="_cm-css-reset",P=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new g.default({unitType:i.model.get("unitType"),className:"ContentVideoView",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.model=e.model,i.container=e.container,i.$el.css({display:"none"}),(0,y.default)(i.container).append(i.$el),i.model.get("repeat")&&i.model.set("components.contentVideo.isRepeat",!0),i.handleMouseActivity(),i.bindRenderShowEvents(),i}return a(t,e),l(t,[{key:"bindRenderShowEvents",value:function(){var e=[];this.model.get("displayFiller.beforeAd")===f.default.DISPLAY_FILLER.BEFORE_AD.CONTENT&&e.push({event:"player.playlist",funcName:"render"}),this.model.get("displayFiller.betweenAds")===f.default.DISPLAY_FILLER.BETWEEN_ADS.CONTENT&&e.push({event:"adQState:completed",funcName:"render"}),this.model.get("displayFiller.onTimeout")===f.default.DISPLAY_FILLER.ON_TIMEOUT.CONTENT&&e.push({event:"closeTimer:midrollCollapse",funcName:"render"}),e.length>0&&e.push({event:"closeState",funcName:"onCloseState"}),this.createStateHandlers(e)}},{key:"render",value:function(){this.video||(this.$el.append(T.default),this.el.id=S,this._customize(),this.playList=this.model.get("player.playlist"),this.currentTrackIndex=0,this.initVideo(),this._addVideoControls(),this.initLoadingBackground(),this.bindEvents()),this.show()}},{key:"_addVideoControls",value:function(){this.videoControls=new c.ContentVideoControlsView({container:this.el,model:this.model,video:this.video})}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"mute:true",funcName:"mute"},{event:"mute:false",funcName:"unMute"},{event:"content.playClicked:true",funcName:"play"},{event:"content.pauseClicked:true",funcName:"pause"},{event:"adQState:q0",funcName:"hide"}])}},{key:"initVideo",value:function(){this.video=this.$el.find("video")[0],this.model.get("contentClickUrl")&&(this.video.onclick=this.contentClickThru.bind(this),this.video.style.cursor="pointer"),this.video.src=this.playList[this.currentTrackIndex].url,this.video.addEventListener("ended",this.onEnd.bind(this)),this.video.addEventListener("loadeddata",this.onLoaded.bind(this)),this.video.addEventListener("playing",this.onPlaying.bind(this)),this.video.muted=!0,this.video.setAttribute("muted",""),this.video.setAttribute("playsinline","")}},{key:"initLoadingBackground",value:function(){return this.$loadingImg=this.$el.find("._cm-background-loading"),!this.$loadingImg.index()===-1?void this.log.warning("No loading background found!"):void this.$loadingImg.css({backgroundImage:'url("'+this.model.get("components.contentVideo.loadingImgae")+'")'})}},{key:"show",value:function(){this.isTerminated||(this.log.info("Content video show"),this.$el.css({display:"block"}),this.isHidden=!1,this.play())}},{key:"hide",value:function(){this.isTerminated||(this.log.info("Content video hide"),this.$el.css({display:"none"}),this.isHidden=!0,this.pause())}},{key:"play",value:function(){var e=this;if(!this.video)return void this.log.warning("Play was called without video render!");if(this.model.get("content.playClicked")||!this.model.get("content.pauseClicked")){this.model.set("content.playClicked",!1),this.model.set("content.startProgressBar",!0);var t=this.video.play();void 0!==t&&t.catch(function(t){e.log.info("Auto-play was prevented",t)}).then(function(){e.log.info("Auto-play content video started")})}}},{key:"pause",value:function(){this.video?(this.model.set("content.startProgressBar",!1),this.video.pause()):this.log.warning("Pause was called without video render!")}},{key:"mute",value:function(){this.video.muted=!0,this.video.setAttribute("muted",""),this.model.set("mute",!0)}},{key:"unMute",value:function(){this.video.muted=!1,this.video.removeAttribute("muted"),this.model.set("mute",!1)}},{key:"onLoaded",value:function(){this.$loadingImg&&this.$loadingImg.hide()}},{key:"onPlaying",value:function(){}},{key:"onEnd",value:function(){this.$loadingImg&&this.$loadingImg.show(),this.model.get("components.contentVideo.isRepeat")&&(this.playList.length-1===this.currentTrackIndex&&(this.currentTrackIndex=-1),this.video.src=this.playList[++this.currentTrackIndex].url,this.play())}},{key:"handleMouseActivity",value:function(){"onHover"===this.model.get("volume")&&(this.el.onmouseenter=this.onMouseEnter.bind(this),this.el.onmouseleave=this.onMouseLeave.bind(this))}},{key:"onMouseEnter",value:function(){this.unMute()}},{key:"onMouseLeave",value:function(){this.mute()}},{key:"contentClickThru",value:function(){window.open(this.model.get("contentClickUrl"))}},{key:"_customize",value:function(){var e=this.model.get("components.contentVideo.additionalCss");this.$el.css(_.default.toCssObj(e))}},{key:"checkEligible",value:function(){this.isEligibleToPlay()?this.play():this.pause()}},{key:"isEligibleToPlay",value:function(){return!this.isHidden&&(this.model.get("isInTab")?!!this.model.get("isEligibleToPlay")||this.model.get("videoViewState")===h.videoViewState.detached:this.model.get("videoViewState")===h.videoViewState.detached&&"play"===this.model.get("detachToSlider").onOutOfView)}},{key:"onCloseState",value:function(){if(!this.isTerminated)return this.model.get("closeState")===h.closeState.terminate?void this.terminate():void(this.model.isLoadcomponent("content","onTimeout")?this.video?this.show():this.render():this.hide())}},{key:"terminate",value:function(){this.log.info("Terminate"),this.isTerminated=!0,this.video&&(this.hide(),this.mute()),this.log.info("Content is terminated.")}},{key:"className",get:function(){return A}}]),t}(d.StateManagerView);e.exports=P},function(e,t){e.exports="<div class=cm_video_content_wrapper> <div class=_cm-background-loading></div> <video class=cm_video_content_video_element></video> </div> "},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(194),d=n(l),c=i(16),u=n(c),h=i(197),p=(n(h),
i(22)),f=n(p),m=i(10),g=n(m),v="_cm-css-reset",y=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.log=new u.default({unitType:i.model.get("unitType"),className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.currentTrackIndex=0,i._loadVideoElementService(),i.componentsVisibilityListener=e.componentsVisibilityListener,i.componentsVisibilityListener&&i._setComponentsVisibilityListener(),i}return r(t,e),a(t,[{key:"_loadVideoElementService",value:function(){var e=this.model.get("microServices.videoElement.version");f.default.serviceLoader.get("video-element",e,this._onVideoElementLoaded.bind(this),this._onVideoElementError.bind(this))}},{key:"_onVideoElementLoaded",value:function(e){this.video=new e(this._getVideoElementOptions()),this.log.info("Video Element Loaded",this.video),this.render()}},{key:"_onVideoElementError",value:function(){this.log.error("Error while loading videoElement from service loader")}},{key:"render",value:function(){this.el.id=v,this._customize(),this.initVideo(),this._addVideoControls(),this.initLoadingBackground(),this.bindEvents(),this._resizeVideoElement()}},{key:"initVideo",value:function(){this.playList=this.model.get("player.playlist"),this._updateVideoSrc(),this._setVideoElementAttributes(),this._bindVideoElementsEvents(),this.$el.append(this.video)}},{key:"_updateVideoSrc",value:function(){var e=[];this.playList.forEach(function(t){e.push({url:t.url,originalType:t.type})}),this.video.appendVideoSources(e),this.log.info("appended video sources:",e)}},{key:"_setVideoElementAttributes",value:function(){this.video.muted=!0,this.video.setAttribute("muted",""),this.video.setAttribute("playsinline",""),this.video.setAttribute("preload","auto"),this.video.style.cursor="pointer"}},{key:"_bindVideoElementsEvents",value:function(){this.video.addEventListener("ended",this.onEnd.bind(this)),this._bindVideoClickEvent()}},{key:"_bindVideoClickEvent",value:function(){this.model.get("contentClickUrl")&&(this.video.onclick=this.contentClickThru.bind(this))}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"mute:true",funcName:"mute"},{event:"mute:false",funcName:"unMute"},{event:"content.playClicked:true",funcName:"play"},{event:"content.pauseClicked:true",funcName:"pause"},{event:"player.playlist",funcName:"_updatePlaylist"}])}},{key:"onEnd",value:function(){}},{key:"bindRenderShowEvents",value:function(){}},{key:"_resizeVideoElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.model.get("width"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.model.get("height");(0,g.default)(this.video).css({width:e,height:t}),this.video.resize&&this.video.resize(e,t)}},{key:"_updatePlaylist",value:function(){this.playList=this.model.get("player.playlist"),this._updateVideoSrc()}},{key:"_setComponentsVisibilityListener",value:function(){this.listenTo(this.model,"change:"+this.componentsVisibilityListener,this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()}},{key:"_onComponentsVisibilityChange",value:function(){this.model.get(this.componentsVisibilityListener)?(this._resizeVideoElement(),this.show()):this.hide()}},{key:"show",value:function(){this.isTerminated||(this.log.info("Content video show"),this.$el.css({display:"block"}),this.isHidden=!1,this.checkEligible())}},{key:"checkEligible",value:function(){this.isEligibleToPlay()?(this.video.load(),this.play()):this.pause()}},{key:"_getVideoElementOptions",value:function(){return{isMobile:this.model.get("isMobile"),isMultiVpaidUnit:!1,canvas:{dataSaverServerSide:this.model.get("player.settings.dataSaver"),disableWebGl:!0,parent:this.el,repeat:!1}}}}]),t}(d.default);e.exports=y},function(e,t){!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=2)}([function(e,t,i){"use strict";function n(){n.init.call(this)}function o(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function s(e,t,i,n){var s,r,a;if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i);if(void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),r=e._events),a=r[t]),void 0===a)a=r[t]=i,++e._eventsCount;else if("function"==typeof a?a=r[t]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),0<(s=o(e))&&a.length>s&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,function(e){console&&console.warn&&console.warn(e)}(l)}return e}function r(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},o=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,h(this.listener,this.target,e))}.bind(n);return o.listener=i,n.wrapFn=o}function a(e,t,i){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?i?[o.listener||o]:[o]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(o):d(o,o.length)}function l(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function d(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}var c,u="object"==typeof Reflect?Reflect:null,h=u&&"function"==typeof u.apply?u.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};c=u&&"function"==typeof u.ownKeys?u.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var p=Number.isNaN||function(e){return e!=e};((e.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var f=10;Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e||e<0||p(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");f=e}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||p(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return o(this)},n.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var s;if(0<t.length&&(s=t[0]),s instanceof Error)throw s;var r=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw r.context=s,r}var a=o[e];if(void 0===a)return!1;if("function"==typeof a)h(a,this,t);else{var l=a.length,c=d(a,l);for(i=0;i<l;++i)h(c[i],this,t)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return s(this,e,t,!1)},n.prototype.prependListener=function(e,t){return s(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,r(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,r(this,e,t)),this},n.prototype.off=n.prototype.removeListener=function(e,t){var i,n,o,s,r;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(o=-1,s=i.length-1;0<=s;s--)if(i[s]===t||i[s].listener===t){r=i[s].listener,o=s;break}if(o<0)return this;0===o?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,o),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,r||t)}return this},n.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var o,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(o=s[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},n.prototype.listeners=function(e){return a(this,e,!0)},n.prototype.rawListeners=function(e){return a(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):l.call(e,t)},n.prototype.listenerCount=l,n.prototype.eventNames=function(){return 0<this._eventsCount?c(this._events):[]}},function(e,t,i){var n;!function(o,s){"use strict";var r="function",a="undefined",l="object",d="model",c="name",u="type",h="vendor",p="version",f="architecture",m="console",g="mobile",v="tablet",y="smarttv",b="wearable",_={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:s},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},w={rgx:function(){for(var e,t,i,n,o,d,c,u=0,h=arguments;u<h.length&&!d;){var p=h[u],f=h[u+1];if(typeof e==a)for(n in e={},f)f.hasOwnProperty(n)&&(typeof(o=f[n])==l?e[o[0]]=s:e[o]=s);for(t=i=0;t<p.length&&!d;)if(d=p[t++].exec(this.getUA()))for(n=0;n<f.length;n++)c=d[++i],typeof(o=f[n])==l&&0<o.length?2==o.length?typeof o[1]==r?e[o[0]]=o[1].call(this,c):e[o[0]]=o[1]:3==o.length?typeof o[1]!=r||o[1].exec&&o[1].test?e[o[0]]=c?c.replace(o[1],o[2]):s:e[o[0]]=c?o[1].call(this,c,o[2]):s:4==o.length&&(e[o[0]]=c?o[3].call(this,c.replace(o[1],o[2])):s):e[o]=c||s;u+=2}return e},str:function(e,t){for(var i in t)if(typeof t[i]==l&&0<t[i].length){for(var n=0;n<t[i].length;n++)if(_.has(t[i][n],e))return"?"===i?s:i}else if(_.has(t[i],e))return"?"===i?s:i;return e}},T={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},A={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[c,p],[/(opios)[\/\s]+([\w\.]+)/i],[[c,"Opera Mini"],p],[/\s(opr)\/([\w\.]+)/i],[[c,"Opera"],p],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[c,p],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[c,"IE"],p],[/(edge)\/((\d+)?[\w\.]+)/i],[c,p],[/(yabrowser)\/([\w\.]+)/i],[[c,"Yandex"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],p],[/(micromessenger)\/([\w\.]+)/i],[[c,"WeChat"],p],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[p,[c,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,/(.+)/,"$1 WebView"],p],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[p,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[c,p],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[c,"UCBrowser"],p],[/(dolfin)\/([\w\.]+)/i],[[c,"Dolphin"],p],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[c,"Chrome"],p],[/;fbav\/([\w\.]+);/i],[p,[c,"Facebook"]],[/fxios\/([\w\.-]+)/i],[p,[c,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[p,[c,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[p,c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[p,w.str,T.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[c,p],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],p],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,_.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[f,/ower/,"",_.lowerize]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[f,_.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[d,h,[u,v]],[/applecoremedia\/[\w\.]+ \((ipad)/],[d,[h,"Apple"],[u,v]],[/(apple\s{0,1}tv)/i],[[d,"Apple TV"],[h,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[h,d,[u,v]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[d,[h,"Amazon"],[u,v]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[d,w.str,T.device.amazon.model],[h,"Amazon"],[u,g]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[d,h,[u,g]],[/\((ip[honed|\s\w*]+);/i],[d,[h,"Apple"],[u,g]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[h,d,[u,g]],[/\(bb10;\s(\w+)/i],[d,[h,"BlackBerry"],[u,g]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[d,[h,"Asus"],[u,v]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[h,"Sony"],[d,"Xperia Tablet"],[u,v]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[h,"Sony"],[d,"Xperia Phone"],[u,g]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[h,d,[u,m]],[/android.+;\s(shield)\sbuild/i],[d,[h,"Nvidia"],[u,m]],[/(playstation\s[34portablevi]+)/i],[d,[h,"Sony"],[u,m]],[/(sprint\s(\w+))/i],[[h,w.str,T.device.sprint.vendor],[d,w.str,T.device.sprint.model],[u,g]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[h,d,[u,v]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[h,[d,/_/g," "],[u,g]],[/(nexus\s9)/i],[d,[h,"HTC"],[u,v]],[/(nexus\s6p)/i],[d,[h,"Huawei"],[u,g]],[/(microsoft);\s(lumia[\s\w]+)/i],[h,d,[u,g]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[d,[h,"Microsoft"],[u,m]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[h,"Microsoft"],[u,g]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[d,[h,"Motorola"],[u,g]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[d,[h,"Motorola"],[u,v]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[h,_.trim],[d,_.trim],[u,y]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[h,"Samsung"],[u,y]],[/\(dtv[\);].+(aquos)/i],[d,[h,"Sharp"],[u,y]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[h,"Samsung"],d,[u,v]],[/smart-tv.+(samsung)/i],[h,[u,y],d],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[h,"Samsung"],d,[u,g]],[/sie-(\w+)*/i],[d,[h,"Siemens"],[u,g]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[h,"Nokia"],d,[u,g]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[d,[h,"Acer"],[u,v]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[h,"LG"],d,[u,v]],[/(lg) netcast\.tv/i],[h,d,[u,y]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[d,[h,"LG"],[u,g]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[d,[h,"Lenovo"],[u,v]],[/linux;.+((jolla));/i],[h,d,[u,g]],[/((pebble))app\/[\d\.]+\s/i],[h,d,[u,b]],[/android.+;\s(glass)\s\d/i],[d,[h,"Google"],[u,b]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[d,/_/g," "],[h,"Xiaomi"],[u,g]],[/android.+a000(1)\s+build/i],[d,[h,"OnePlus"],[u,g]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,_.lowerize],h,d]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[p,[c,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,p],[/rv\:([\w\.]+).*(gecko)/i],[p,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,p],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[p,w.str,T.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[p,w.str,T.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],p],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[c,p],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[c,"Symbian"],p],[/\((series40);/i],[c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],p],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[c,p],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],p],[/(sunos)\s?([\w\.]+\d)*/i],[[c,"Solaris"],p],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[c,p],[/(haiku)\s(\w+)/i],[c,p],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[c,"iOS"],[p,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[c,"Mac OS"],[p,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[c,p]]},S=function(e,t){if(!(this instanceof S))return new S(e,t).getResult();var i=e||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),n=t?_.extend(A,t):A;return this.getBrowser=function(){var e=w.rgx.apply(this,n.browser);return e.major=_.major(e.version),e},this.getCPU=function(){return w.rgx.apply(this,n.cpu)},this.getDevice=function(){return w.rgx.apply(this,n.device)},this.getEngine=function(){return w.rgx.apply(this,n.engine)},this.getOS=function(){return w.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};S.VERSION="0.7.12",S.BROWSER={NAME:c,MAJOR:"major",VERSION:p},S.CPU={ARCHITECTURE:f},S.DEVICE={MODEL:d,VENDOR:h,TYPE:u,CONSOLE:m,MOBILE:g,SMARTTV:y,TABLET:v,WEARABLE:b,EMBEDDED:"embedded"},S.ENGINE={NAME:c,VERSION:p},S.OS={NAME:c,VERSION:p},typeof t!=a?(typeof e!=a&&e.exports&&(t=e.exports=S),t.UAParser=S):i(3)?(n=function(){return S}.call(t,i,t,e))===s||(e.exports=n):o.UAParser=S;var P=o.jQuery||o.Zepto;if(typeof P!=a){var C=new S;P.ua=C.getResult(),P.ua.get=function(){return C.getUA()},P.ua.set=function(e){C.setUA(e);var t=C.getResult();for(var i in t)P.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){e.exports=i(4)},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e){function t(e,t){for(var i in t)e.style[i]=t[i]}var i=e.dataset.url;if(!i)throw"VideoElement has no `data-url` attribute";this.container=e,t(this.container,{display:"inline-block",position:"relative",minWidth:"80px",minHeight:"80px"}),this.canvas=document.createElement("canvas"),this.canvas.width=960,this.canvas.height=540,t(this.canvas,{display:"block",width:"100%"}),this.container.appendChild(this.canvas),this.playButton=document.createElement("div"),this.playButton.innerHTML=d.PLAY_BUTTON,t(this.playButton,{zIndex:2,position:"absolute",top:"0",bottom:"0",left:"0",right:"0",maxWidth:"75px",maxHeight:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.playButton);var n={canvas:this.canvas};for(var o in e.dataset)try{n[o]=JSON.parse(e.dataset[o])}catch(t){n[o]=e.dataset[o]}if(this.player=new M.Player(i,n),!n.poster||n.autoplay||this.player.options.streaming||(n.decodeFirstFrame=!1,this.poster=new Image,this.poster.src=n.poster,this.poster.addEventListener("load",this.posterLoaded),t(this.poster,{display:"block",zIndex:1,position:"absolute",top:0,left:0,bottom:0,right:0}),this.container.appendChild(this.poster)),this.player.options.streaming||this.container.addEventListener("click",this.onClick.bind(this)),(n.autoplay||this.player.options.streaming)&&(this.playButton.style.display="none"),this.player.audioOut&&!this.player.audioOut.unlocked){var s=this.container;(n.autoplay||this.player.options.streaming)&&(this.unmuteButton=document.createElement("div"),this.unmuteButton.innerHTML=d.UNMUTE_BUTTON,t(this.unmuteButton,{zIndex:2,position:"absolute",bottom:"10px",right:"20px",width:"75px",height:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.unmuteButton),s=this.unmuteButton),this.unlockAudioBound=this.onUnlockAudio.bind(this,s),s.addEventListener("touchstart",this.unlockAudioBound,!1),s.addEventListener("click",this.unlockAudioBound,!0)}}function c(e,t){this.options=t||{},e.match(/^wss?:\/\//)?(this.source=new M.Source.WebSocket(e,t),t.streaming=!0):(!1!==t.progressive?this.source=new M.Source.AjaxProgressive(e,t):this.source=new M.Source.Ajax(e,t),t.streaming=!1),this.maxAudioLag=t.maxAudioLag||.25,this.loop=!1!==t.loop,this.autoplay=!!t.autoplay||t.streaming,this.onFinished=t.onfinished,this.demuxer=new M.Demuxer.TS(t),this.source.connect(this.demuxer),!1!==t.video&&(this.video=new M.Decoder.MPEG1Video(t),this.renderer=!t.disableGl&&M.Renderer.WebGL.IsSupported()?new M.Renderer.WebGL(t):new M.Renderer.Canvas2D(t),this.demuxer.connect(M.Demuxer.TS.STREAM.VIDEO_1,this.video),this.video.connect(this.renderer)),!1!==t.audio&&M.AudioOutput.WebAudio.IsSupported()&&(this.audio=new M.Decoder.MP2Audio(t),this.audioOut=new M.AudioOutput.WebAudio(t),this.demuxer.connect(M.Demuxer.TS.STREAM.AUDIO_1,this.audio),this.audio.connect(this.audioOut)),Object.defineProperty(this,"currentTime",{get:this.getCurrentTime,set:this.setCurrentTime}),Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),(this.unpauseOnShow=!1)!==t.pauseWhenHidden&&document.addEventListener("visibilitychange",this.showHide.bind(this)),this.source.start(),this.autoplay&&this.play()}function u(e,t){"object"===l(e)?(this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.byteLength=this.bytes.length):(this.bytes=new Uint8Array(e||1048576),this.byteLength=0),this.mode=t||u.MODE.EXPAND,this.index=0}function h(e,t){this.url=e,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.onReadyCblk=t.onload,this.errHandler=t.errHndlr}function p(e,t){this.url=e,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.fileSize=0,this.loadedSize=0,this.chunkSize=t.chunkSize||1048576,this.isLoading=!1,this.loadStartTime=0,this.throttled=!1!==t.throttled}function f(e,t){this.url=e,this.socket=null,this.callbacks={connect:[],data:[]},this.destination=null,this.reconnectInterval=t.reconnectInterval||5,this.shouldAttemptReconnect=!!this.reconnectInterval,this.completed=!1,this.established=!1,this.progress=0}function m(e){this.bits=null,this.leftoverBytes=null,this.guessVideoFrameEnd=!0,this.pidsToStreamIds={},this.pesPacketInfo={},this.startTime=0,this.currentTime=0}function g(e){this.destination=null,this.canPlay=!1,this.collectTimestamps=!e.streaming,this.timestamps=[],this.timestampIndex=0,this.startTime=0,this.decodedTime=0,Object.defineProperty(this,"currentTime",{get:this.getCurrentTime})}function v(e){M.Decoder.Base.call(this,e);var t=e.videoBufferSize||524288,i=e.streaming?M.BitBuffer.MODE.EVICT:M.BitBuffer.MODE.EXPAND;this.bits=new M.BitBuffer(t,i),this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.currentFrame=0,this.decodeFirstFrame=!1!==e.decodeFirstFrame}function y(e){M.Decoder.Base.call(this,e);var t=e.audioBufferSize||131072,i=e.streaming?M.BitBuffer.MODE.EVICT:M.BitBuffer.MODE.EXPAND;this.bits=new M.BitBuffer(t,i),this.left=new Float32Array(1152),this.right=new Float32Array(1152),this.sampleRate=44100,this.D=new Float32Array(1024),this.D.set(y.SYNTHESIS_WINDOW,0),this.D.set(y.SYNTHESIS_WINDOW,512),this.V=new Float32Array(1024),this.U=new Int32Array(32),this.VPos=0,this.allocation=[new Array(32),new Array(32)],this.scaleFactorInfo=[new Uint8Array(32),new Uint8Array(32)],this.scaleFactor=[new Array(32),new Array(32)],this.sample=[new Array(32),new Array(32)];for(var n=0;n<2;n++)for(var o=0;o<32;o++)this.scaleFactor[n][o]=[0,0,0],this.sample[n][o]=[0,0,0]}function b(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0;var t={preserveDrawingBuffer:!!e.preserveDrawingBuffer,alpha:!1,depth:!1,stencil:!1,antialias:!1};if(this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),!this.gl)throw new Error("Failed to get WebGL Context");var i=this.gl,n=null,o=i.createBuffer(),s=new Float32Array([0,0,0,1,1,0,1,1]);i.bindBuffer(i.ARRAY_BUFFER,o),i.bufferData(i.ARRAY_BUFFER,s,i.STATIC_DRAW),this.program=this.createProgram(b.SHADER.VERTEX_IDENTITY,b.SHADER.FRAGMENT_YCRCB_TO_RGBA),n=i.getAttribLocation(this.program,"vertex"),i.enableVertexAttribArray(n),i.vertexAttribPointer(n,2,i.FLOAT,!1,0,0),this.textureY=this.createTexture(0,"textureY"),this.textureCb=this.createTexture(1,"textureCb"),this.textureCr=this.createTexture(2,"textureCr"),this.loadingProgram=this.createProgram(b.SHADER.VERTEX_IDENTITY,b.SHADER.FRAGMENT_LOADING),n=i.getAttribLocation(this.loadingProgram,"vertex"),i.enableVertexAttribArray(n),i.vertexAttribPointer(n,2,i.FLOAT,!1,0,0),this.shouldCreateUnclampedViews=!this.allowsClampedTextureData()}function _(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0,this.context=this.canvas.getContext("2d")}function w(e){this.context=w.CachedContext=w.CachedContext||new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.destination=this.gain,this.startTime=0,this.buffer=null,this.wallclockStartTime=0,this.volume=1,this.enabled=!0,this.unlocked=!w.NeedsUnlocking(),Object.defineProperty(this,"enqueuedTime",{get:this.getEnqueuedTime})}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var I=i(1),O=i(0),V=function(){function e(t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i=s(this,r(e).call(this))).params=t,i.os=i.params.userAgent.os.name,i.osVersion=parseInt(i.params.userAgent.os.version),i.browserName=i.params.userAgent.browser.name,i.browserMajorVersion=parseInt(i.params.userAgent.browser.major),i.params.userAgent.ua&&-1<i.params.userAgent.ua.indexOf("UCBrowser")&&(i.browserName="UCBrowser"),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,
configurable:!0}}),t&&a(e,t)}(e,O.EventEmitter),function(e,t,i){t&&o(e.prototype,t),i&&o(e,i)}(e,[{key:"isAutoplaySupported",value:function(){var e=this._isAutoplaySupportedByOS();e&&"Android"===this.os&&(e=!this._isDataSaverOn()),this._emitDetectionResult(e)}},{key:"_isAutoplaySupportedByOS",value:function(){switch(this.os){case"Android":return this.isAutoplaySupportedAndroid();case"iOS":return this.isAutoplaySupportedIOS();default:return!1}}},{key:"isAutoplaySupportedIOS",value:function(){if(this.osVersion<10)return!1;switch(this.browserName){case"Firefox":return 7<=this.browserMajorVersion;default:return!0}}},{key:"isAutoplaySupportedAndroid",value:function(){switch(this.browserName){case"Chrome":case"Chrome WebView":return 53<=parseInt(this.browserMajorVersion);case"Firefox":return 49<=parseInt(this.browserMajorVersion);case"Android Browser":return 7<=parseInt(this.browserMajorVersion);case"Silk":return 71<=parseInt(this.browserMajorVersion);case"Opera":case"MIUI Browser":case"Yandex":case"UCBrowser":return!0;default:return!1}}},{key:"_isDataSaverOn",value:function(){return this.params.canvas.dataSaverServerSide}},{key:"_emitDetectionResult",value:function(e){this.emit("detectIsAutoplaySupported",e)}}]),e}(),x="content",D={decodeUrl:!1,secureMediaFiles:!1,isMobile:!1,autoplay:!0,userAgent:{},isMultiVpaidUnit:!1,logToBI:function(){},videoState:x,canvas:{onAutoplayDetected:function(){},dataSaverServerSide:!1,dataSaverUrl:"//vidutils.taboola.com",disableWebGl:!1,parent:document.body,defaultVolume:.4,aspectRatio:"16:9",canvasLoadRate:5,mpegServerBaseUrl:"//mpg.taboola.com/getts?url",ignoreAutoplayDetection:!1,additionalCss:{},repeat:!1}},M={Player:null,VideoElement:null,BitBuffer:null,Source:{},Demuxer:{},Decoder:{},Renderer:{},AudioOutput:{},Now:function(){return window.performance?window.performance.now()/1e3:Date.now()/1e3},CreateVideoElements:function(){for(var e=document.querySelectorAll(".jsmpeg"),t=0;t<e.length;t++)new M.VideoElement(e[t])},Fill:function(e,t){if(e.fill)e.fill(t);else for(var i=0;i<e.length;i++)e[i]=t}};"complete"===document.readyState?M.CreateVideoElements():document.addEventListener("DOMContentLoaded",M.CreateVideoElements),M.VideoElement=(d.prototype.onUnlockAudio=function(e,t){this.unmuteButton&&(t.preventDefault(),t.stopPropagation()),this.player.audioOut.unlock(function(){this.unmuteButton&&(this.unmuteButton.style.display="none"),e.removeEventListener("touchstart",this.unlockAudioBound),e.removeEventListener("click",this.unlockAudioBound)}.bind(this))},d.prototype.onClick=function(e){this.player.isPlaying?(this.player.pause(),this.playButton.style.display="block"):(this.player.play(),this.playButton.style.display="none",this.poster&&(this.poster.style.display="none"))},d.PLAY_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 200 200" alt="Play video"><circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"/><polygon points="70, 55 70, 145 145, 100" fill="#fff"/></svg>',d.UNMUTE_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 75 75"><polygon class="audio-speaker" stroke="none" fill="#fff" points="39,13 22,28 6,28 6,47 21,47 39,62 39,13"/><g stroke="#fff" stroke-width="5"><path d="M 49,50 69,26"/><path d="M 69,50 49,26"/></g></svg>',d),M.Player=(c.prototype.showHide=function(e){"hidden"===document.visibilityState?(this.unpauseOnShow=this.wantsToPlay,this.pause()):this.unpauseOnShow&&this.play()},c.prototype.play=function(e){this.animationId=requestAnimationFrame(this.update.bind(this)),this.wantsToPlay=!0},c.prototype.pause=function(e){cancelAnimationFrame(this.animationId),this.wantsToPlay=!1,this.isPlaying=!1,this.audio&&this.audio.canPlay&&(this.audioOut.stop(),this.seek(this.currentTime))},c.prototype.getVolume=function(){return this.audioOut?this.audioOut.volume:0},c.prototype.setVolume=function(e){this.audioOut&&(this.audioOut.volume=e)},c.prototype.stop=function(e){this.pause(),this.seek(0),this.video&&!1!==this.options.decodeFirstFrame&&this.video.decode()},c.prototype.seek=function(e){var t=this.audio&&this.audio.canPlay?this.audio.startTime:this.video.startTime;this.video&&this.video.seek(e+t),this.audio&&this.audio.seek(e+t),this.startTime=M.Now()-e},c.prototype.getCurrentTime=function(){return this.audio&&this.audio.canPlay?this.audio.currentTime-this.audio.startTime:this.video.currentTime-this.video.startTime},c.prototype.setCurrentTime=function(e){this.seek(e)},c.prototype.update=function(){this.animationId=requestAnimationFrame(this.update.bind(this)),this.source.established?(this.isPlaying||(this.isPlaying=!0,this.startTime=M.Now()-this.currentTime),this.options.streaming?this.updateForStreaming():this.updateForStaticFile()):this.renderer&&this.renderer.renderProgress(this.source.progress)},c.prototype.updateForStreaming=function(){if(this.video&&this.video.decode(),this.audio){for(;this.audioOut.enqueuedTime>this.maxAudioLag&&(this.audioOut.resetEnqueuedTime(),this.audioOut.enabled=!1),this.audio.decode(););this.audioOut.enabled=!0}},c.prototype.updateForStaticFile=function(){var e=this,t=!1,i=0;if(this.audio&&this.audio.canPlay){for(;!t&&this.audio.decodedTime-this.audio.currentTime<.25;)t=!this.audio.decode();this.video&&this.video.currentTime<this.audio.currentTime&&(t=!this.video.decode()),i=this.demuxer.currentTime-this.audio.currentTime}else if(this.video){var n=M.Now()-this.startTime+this.video.startTime,o=n-this.video.currentTime,s=1/this.video.frameRate;this.video&&0<o&&(2*s<o&&(this.startTime+=o),t=!this.video.decode()),i=this.demuxer.currentTime-n}this.source.resume(i),t&&this.source.completed&&(this.loop?this.seek(0):(this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){e.onFinished()},500),this.pause()))},c),M.BitBuffer=(u.prototype.resize=function(e){var t=new Uint8Array(e);0!==this.byteLength&&(this.byteLength=Math.min(this.byteLength,e),t.set(this.bytes,0,this.byteLength)),this.bytes=t,this.index=Math.min(this.index,this.byteLength<<3)},u.prototype.evict=function(e){var t=this.index>>3,i=this.bytes.length-this.byteLength;return this.index===this.byteLength<<3||i+t<e?(this.byteLength=0,void(this.index=0)):void(0!=t&&(this.bytes.copyWithin?this.bytes.copyWithin(0,t,this.byteLength):this.bytes.set(this.bytes.subarray(t,this.byteLength)),this.byteLength=this.byteLength-t,this.index-=t<<3))},u.prototype.write=function(e){var t="object"===l(e[0]),i=0,n=this.bytes.length-this.byteLength;if(t)for(var o=i=0;o<e.length;o++)i+=e[o].byteLength;else i=e.byteLength;if(n<i)if(this.mode===u.MODE.EXPAND){var s=Math.max(2*this.bytes.length,i-n);this.resize(s)}else this.evict(i);if(t)for(o=0;o<e.length;o++)this.appendSingleBuffer(e[o]);else this.appendSingleBuffer(e)},u.prototype.appendSingleBuffer=function(e){e=e instanceof Uint8Array?e:new Uint8Array(e),this.bytes.set(e,this.byteLength),this.byteLength+=e.length},u.prototype.findNextStartCode=function(){for(var e=this.index+7>>3;e<this.byteLength;e++)if(0==this.bytes[e]&&0==this.bytes[e+1]&&1==this.bytes[e+2])return this.index=e+4<<3,this.bytes[e+3];return this.index=this.byteLength<<3,-1},u.prototype.findStartCode=function(e){for(var t=0;;)if((t=this.findNextStartCode())===e||-1===t)return t;return-1},u.prototype.nextBytesAreStartCode=function(){var e=this.index+7>>3;return e>=this.byteLength||0==this.bytes[e]&&0==this.bytes[1+e]&&1==this.bytes[2+e]},u.prototype.peek=function(e){for(var t=this.index,i=0;e;){var n=8-(7&t),o=n<e?n:e,s=n-o;i=i<<o|(this.bytes[t>>3]&255>>8-o<<s)>>s,t+=o,e-=o}return i},u.prototype.read=function(e){var t=this.peek(e);return this.index+=e,t},u.prototype.skip=function(e){return this.index+=e},u.prototype.rewind=function(e){this.index=Math.max(this.index-e,0)},u.prototype.has=function(e){return(this.byteLength<<3)-this.index>=e},u.MODE={EVICT:1,EXPAND:2},u),M.Source.Ajax=(h.prototype.connect=function(e){this.destination=e},h.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200===this.request.status&&(this.onLoad(this.request.response),this.onReadyCblk()),500!==this.request.status&&502!==this.request.status||this.errHandler({err:"error status ".concat(this.request.status," received for url:").concat(this.url)})}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("GET",this.url),this.request.responseType="arraybuffer",this.request.send()},h.prototype.resume=function(e){},h.prototype.abort=function(){this.request.abort()},h.prototype.onProgress=function(e){this.progress=e.loaded/e.total},h.prototype.onLoad=function(e){this.established=!0,this.completed=!0,this.progress=1,this.destination&&this.destination.write(e)},h),M.Source.AjaxProgressive=(p.prototype.connect=function(e){this.destination=e},p.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&(this.fileSize=parseInt(this.request.getResponseHeader("Content-Length")),this.loadNextChunk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("HEAD",this.url),this.request.send()},p.prototype.resume=function(e){!this.isLoading&&this.throttled&&e<8*this.loadTime+2&&this.loadNextChunk()},p.prototype.abort=function(){this.request.abort()},p.prototype.loadNextChunk=function(){var e=this.loadedSize,t=Math.min(this.loadedSize+this.chunkSize-1,this.fileSize-1);e>=this.fileSize?this.completed=!0:(this.isLoading=!0,this.loadStartTime=M.Now(),this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200<=this.request.status&&this.request.status<300?this.onChunkLoad(this.request.response):this.request.readyState===this.request.DONE&&this.loadFails++<3&&this.loadNextChunk()}.bind(this),0===e&&(this.request.onprogress=this.onProgress.bind(this)),this.request.open("GET",this.url+"?"+e+"-"+t),this.request.setRequestHeader("Range","bytes="+e+"-"+t),this.request.responseType="arraybuffer",this.request.send())},p.prototype.onProgress=function(e){this.progress=e.loaded/e.total},p.prototype.onChunkLoad=function(e){this.established=!0,this.progress=1,this.loadedSize+=e.byteLength,this.loadFails=0,this.isLoading=!1,this.destination&&this.destination.write(e),this.loadTime=M.Now()-this.loadStartTime,this.throttled||this.loadNextChunk()},p),M.Source.WebSocket=(f.prototype.connect=function(e){this.destination=e},f.prototype.abort=function(){this.shouldAttemptReconnect=!1,this.socket.close()},f.prototype.start=function(){this.shouldAttemptReconnect=!!this.reconnectInterval,this.progress=0,this.established=!1,this.socket=new WebSocket(this.url),this.socket.binaryType="arraybuffer",this.socket.onmessage=this.onMessage.bind(this),this.socket.onopen=this.onOpen.bind(this),this.socket.onerror=this.onClose.bind(this),this.socket.onclose=this.onClose.bind(this)},f.prototype.resume=function(e){},f.prototype.onOpen=function(){this.progress=1,this.established=!0},f.prototype.onClose=function(){this.shouldAttemptReconnect&&setTimeout(function(){this.start()}.bind(this),1e3*this.reconnectInterval)},f.prototype.onMessage=function(e){this.destination&&this.destination.write(e.data)},f),M.Demuxer.TS=(m.prototype.connect=function(e,t){this.pesPacketInfo[e]={destination:t,currentLength:0,totalLength:0,pts:0,buffers:[]}},m.prototype.write=function(e){if(this.leftoverBytes){var t=e.byteLength+this.leftoverBytes.byteLength;this.bits=new M.BitBuffer(t),this.bits.write([this.leftoverBytes,e])}else this.bits=new M.BitBuffer(e);for(;this.bits.has(1504);)this.parsePacket();var i=this.bits.byteLength-(this.bits.index>>3);this.leftoverBytes=0<i?this.bits.bytes.subarray(this.bits.index>>3):null},m.prototype.parsePacket=function(){var e=188+(this.bits.index>>3);if(71!==this.bits.read(8))throw"Sync Token not found";this.bits.read(1);var t=this.bits.read(1),i=(this.bits.read(1),this.bits.read(13)),n=(this.bits.read(2),this.bits.read(2)),o=(this.bits.read(4),this.pidsToStreamIds[i]);if(t&&o&&(m=this.pesPacketInfo[o])&&m.currentLength&&this.packetComplete(m),1&n){if(2&n){var s=this.bits.read(8);this.bits.skip(s<<3)}if(t&&this.bits.nextBytesAreStartCode()){this.bits.skip(24),o=this.bits.read(8),this.pidsToStreamIds[i]=o;var r=this.bits.read(16);this.bits.skip(8);var a=this.bits.read(2);this.bits.skip(6);var l=this.bits.read(8),d=this.bits.index+(l<<3);if(m=this.pesPacketInfo[o]){var c=0;if(2&a){this.bits.skip(4);var u=this.bits.read(3);this.bits.skip(1);var h=this.bits.read(15);this.bits.skip(1);var p=this.bits.read(15);this.bits.skip(1),c=(1073741824*u+32768*h+p)/9e4,this.currentTime=c,-1===this.startTime&&(this.startTime=c)}var f=r?r-l-3:0;this.packetStart(m,c,f)}this.bits.index=d}var m;if(o&&(m=this.pesPacketInfo[o])){var g=this.bits.index>>3,v=!t&&2&n;(this.packetAddData(m,g,e)||this.guessVideoFrameEnd&&v)&&this.packetComplete(m)}}this.bits.index=e<<3},m.prototype.packetStart=function(e,t,i){e.totalLength=i,e.currentLength=0,e.pts=t},m.prototype.packetAddData=function(e,t,i){return e.buffers.push(this.bits.bytes.subarray(t,i)),e.currentLength+=i-t,0!==e.totalLength&&e.currentLength>=e.totalLength},m.prototype.packetComplete=function(e){e.destination.write(e.pts,e.buffers),e.totalLength=0,e.currentLength=0,e.buffers=[]},m.STREAM={PACK_HEADER:186,SYSTEM_HEADER:187,PROGRAM_MAP:188,PRIVATE_1:189,PADDING:190,PRIVATE_2:191,AUDIO_1:192,VIDEO_1:224,DIRECTORY:255},m),M.Decoder.Base=(g.prototype.connect=function(e){this.destination=e},g.prototype.write=function(e,t){this.collectTimestamps&&(0===this.timestamps.length&&(this.startTime=e,this.decodedTime=e),this.timestamps.push({index:this.bits.byteLength<<3,time:e})),this.bits.write(t),this.canPlay=!0},g.prototype.seek=function(e){if(this.collectTimestamps){for(var t=this.timestampIndex=0;t<this.timestamps.length&&!(this.timestamps[t].time>e);t++)this.timestampIndex=t;var i=this.timestamps[this.timestampIndex];i?(this.bits.index=i.index,this.decodedTime=i.time):(this.bits.index=0,this.decodedTime=this.startTime)}},g.prototype.decode=function(){this.advanceDecodedTime(0)},g.prototype.advanceDecodedTime=function(e){if(this.collectTimestamps){for(var t=-1,i=this.timestampIndex;i<this.timestamps.length&&!(this.timestamps[i].index>this.bits.index);i++)t=i;if(-1!==t&&t!==this.timestampIndex)return this.timestampIndex=t,void(this.decodedTime=this.timestamps[this.timestampIndex].time)}this.decodedTime+=e},g.prototype.getCurrentTime=function(){return this.decodedTime},g),M.Decoder.MPEG1Video=(((v.prototype=Object.create(M.Decoder.Base.prototype)).constructor=v).prototype.write=function(e,t){if(M.Decoder.Base.prototype.write.call(this,e,t),!this.hasSequenceHeader){if(-1===this.bits.findStartCode(v.START.SEQUENCE))return!1;this.decodeSequenceHeader(),this.decodeFirstFrame&&this.decode()}},v.prototype.decode=function(){return!!this.hasSequenceHeader&&(-1!==this.bits.findStartCode(v.START.PICTURE)?(this.decodePicture(),this.advanceDecodedTime(1/this.frameRate),!0):(this.bits.byteLength,this.bits.index,!1))},v.prototype.readHuffman=function(e){for(var t=0;0<=(t=e[t+this.bits.read(1)])&&0!==e[t];);return e[t+2]},v.prototype.frameRate=30,v.prototype.decodeSequenceHeader=function(){var e=this.bits.read(12),t=this.bits.read(12);if(this.bits.skip(4),this.frameRate=v.PICTURE_RATE[this.bits.read(4)],this.bits.skip(30),e===this.width&&t===this.height||(this.width=e,this.height=t,this.initBuffers(),this.destination&&this.destination.resize(e,t)),this.bits.read(1)){for(var i=0;i<64;i++)this.customIntraQuantMatrix[v.ZIG_ZAG[i]]=this.bits.read(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.bits.read(1)){for(i=0;i<64;i++){var n=v.ZIG_ZAG[i];this.customNonIntraQuantMatrix[n]=this.bits.read(8)}this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}this.hasSequenceHeader=!0},v.prototype.initBuffers=function(){this.intraQuantMatrix=v.DEFAULT_INTRA_QUANT_MATRIX,this.nonIntraQuantMatrix=v.DEFAULT_NON_INTRA_QUANT_MATRIX,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.currentY=new Uint8ClampedArray(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new Uint8ClampedArray(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new Uint8ClampedArray(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new Uint8ClampedArray(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new Uint8ClampedArray(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new Uint8ClampedArray(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer)},v.prototype.currentY=null,v.prototype.currentCr=null,v.prototype.currentCb=null,v.prototype.pictureType=0,v.prototype.forwardY=null,v.prototype.forwardCr=null,v.prototype.forwardCb=null,v.prototype.fullPelForward=!1,v.prototype.forwardFCode=0,v.prototype.forwardRSize=0,v.prototype.forwardF=0,v.prototype.decodePicture=function(e){if(this.currentFrame++,this.bits.skip(10),this.pictureType=this.bits.read(3),this.bits.skip(16),!(this.pictureType<=0||this.pictureType>=v.PICTURE_TYPE.B)){if(this.pictureType===v.PICTURE_TYPE.PREDICTIVE){if(this.fullPelForward=this.bits.read(1),this.forwardFCode=this.bits.read(3),0===this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}for(var t=0;(t=this.bits.findNextStartCode())===v.START.EXTENSION||t===v.START.USER_DATA;);for(;t>=v.START.SLICE_FIRST&&t<=v.START.SLICE_LAST;)this.decodeSlice(255&t),t=this.bits.findNextStartCode();if(-1!==t&&this.bits.rewind(32),this.destination&&this.destination.render(this.currentY,this.currentCr,this.currentCb),this.pictureType===v.PICTURE_TYPE.INTRA||this.pictureType===v.PICTURE_TYPE.PREDICTIVE){var i=this.forwardY,n=this.forwardY32,o=this.forwardCr,s=this.forwardCr32,r=this.forwardCb,a=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=i,this.currentY32=n,this.currentCr=o,this.currentCr32=s,this.currentCb=r,this.currentCb32=a}}},v.prototype.quantizerScale=0,v.prototype.sliceBegin=!1,v.prototype.decodeSlice=function(e){for(this.sliceBegin=!0,this.macroblockAddress=(e-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.bits.read(5);this.bits.read(1);)this.bits.skip(8);for(;this.decodeMacroblock(),!this.bits.nextBytesAreStartCode(););},v.prototype.macroblockAddress=0,v.prototype.mbRow=0,v.prototype.mbCol=0,v.prototype.macroblockType=0,v.prototype.macroblockIntra=!1,v.prototype.macroblockMotFw=!1,v.prototype.motionFwH=0,v.prototype.motionFwV=0,v.prototype.motionFwHPrev=0,v.prototype.motionFwVPrev=0,v.prototype.decodeMacroblock=function(){for(var e=0,t=this.readHuffman(v.MACROBLOCK_ADDRESS_INCREMENT);34===t;)t=this.readHuffman(v.MACROBLOCK_ADDRESS_INCREMENT);for(;35===t;)e+=33,t=this.readHuffman(v.MACROBLOCK_ADDRESS_INCREMENT);if(e+=t,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=e;else{if(this.macroblockAddress+e>=this.mbSize)return;for(1<e&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureType===v.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));1<e;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),e--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth;var i=v.MACROBLOCK_TYPE[this.pictureType];this.macroblockType=this.readHuffman(i),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.bits.read(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var n=0!=(2&this.macroblockType)?this.readHuffman(v.CODE_BLOCK_PATTERN):this.macroblockIntra?63:0,o=0,s=32;o<6;o++)0!=(n&s)&&this.decodeBlock(o),s>>=1},v.prototype.decodeMotionVectors=function(){var e,t,i=0;this.macroblockMotFw?(0!==(e=this.readHuffman(v.MOTION))&&1!==this.forwardF?(i=this.bits.read(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwHPrev+=t,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),0!==(e=this.readHuffman(v.MOTION))&&1!==this.forwardF?(i=this.bits.read(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwVPrev+=t,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureType===v.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},v.prototype.copyMacroblock=function(e,t,i,n,o){var s,r,a,l,d,c,u,h,p,f,m,g,v,y,b,_,w,T,A,S=this.currentY32,P=this.currentCb32,C=this.currentCr32;if(r=(s=this.codedWidth)-16,a=e>>1,l=t>>1,d=1==(1&e),c=1==(1&t),u=((this.mbRow<<4)+l)*s+(this.mbCol<<4)+a,p=(h=this.mbRow*s+this.mbCol<<2)+(s<<2),d)if(c)for(;h<p;){for(m=i[u]+i[u+s],u++,f=0;f<4;f++)v=m+(g=i[u]+i[u+s])+2>>2&255,v|=(m=i[++u]+i[u+s])+g+2<<6&65280,v|=m+(g=i[++u]+i[u+s])+2<<14&16711680,m=i[++u]+i[u+s],u++,v|=m+g+2<<22&4278190080,S[h++]=v;h+=r>>2,u+=r-1}else for(;h<p;){for(m=i[u++],f=0;f<4;f++)v=m+(g=i[u++])+1>>1&255,v|=(m=i[u++])+g+1<<7&65280,v|=m+(g=i[u++])+1<<15&16711680,v|=(m=i[u++])+g+1<<23&4278190080,S[h++]=v;h+=r>>2,u+=r-1}else if(c)for(;h<p;){for(f=0;f<4;f++)v=i[u]+i[u+s]+1>>1&255,v|=i[++u]+i[u+s]+1<<7&65280,v|=i[++u]+i[u+s]+1<<15&16711680,v|=i[++u]+i[u+s]+1<<23&4278190080,u++,S[h++]=v;h+=r>>2,u+=r}else for(;h<p;){for(f=0;f<4;f++)v=i[u],v|=i[++u]<<8,v|=i[++u]<<16,v|=i[++u]<<24,u++,S[h++]=v;h+=r>>2,u+=r}if(r=(s=this.halfWidth)-8,a=e/2>>1,l=t/2>>1,d=1==(e/2&1),c=1==(t/2&1),u=((this.mbRow<<3)+l)*s+(this.mbCol<<3)+a,p=(h=this.mbRow*s+this.mbCol<<1)+(s<<1),d)if(c)for(;h<p;){for(y=n[u]+n[u+s],w=o[u]+o[u+s],u++,f=0;f<2;f++)_=y+(b=n[u]+n[u+s])+2>>2&255,A=w+(T=o[u]+o[u+s])+2>>2&255,_|=(y=n[++u]+n[u+s])+b+2<<6&65280,A|=(w=o[u]+o[u+s])+T+2<<6&65280,_|=y+(b=n[++u]+n[u+s])+2<<14&16711680,A|=w+(T=o[u]+o[u+s])+2<<14&16711680,y=n[++u]+n[u+s],w=o[u]+o[u+s],u++,_|=y+b+2<<22&4278190080,A|=w+T+2<<22&4278190080,C[h]=_,P[h]=A,h++;h+=r>>2,u+=r-1}else for(;h<p;){for(y=n[u],w=o[u],u++,f=0;f<2;f++)_=y+(b=n[u])+1>>1&255,A=w+(T=o[u++])+1>>1&255,_|=(y=n[u])+b+1<<7&65280,A|=(w=o[u++])+T+1<<7&65280,_|=y+(b=n[u])+1<<15&16711680,A|=w+(T=o[u++])+1<<15&16711680,_|=(y=n[u])+b+1<<23&4278190080,A|=(w=o[u++])+T+1<<23&4278190080,C[h]=_,P[h]=A,h++;h+=r>>2,u+=r-1}else if(c)for(;h<p;){for(f=0;f<2;f++)_=n[u]+n[u+s]+1>>1&255,A=o[u]+o[u+s]+1>>1&255,_|=n[++u]+n[u+s]+1<<7&65280,A|=o[u]+o[u+s]+1<<7&65280,_|=n[++u]+n[u+s]+1<<15&16711680,A|=o[u]+o[u+s]+1<<15&16711680,_|=n[++u]+n[u+s]+1<<23&4278190080,A|=o[u]+o[u+s]+1<<23&4278190080,u++,C[h]=_,P[h]=A,h++;h+=r>>2,u+=r}else for(;h<p;){for(f=0;f<2;f++)_=n[u],A=o[u],_|=n[++u]<<8,A|=o[u]<<8,_|=n[++u]<<16,A|=o[u]<<16,_|=n[++u]<<24,A|=o[u]<<24,u++,C[h]=_,P[h]=A,h++;h+=r>>2,u+=r}},v.prototype.dcPredictorY=0,v.prototype.dcPredictorCr=0,v.prototype.dcPredictorCb=0,v.prototype.blockData=null,v.prototype.decodeBlock=function(e){var t,i=0;if(this.macroblockIntra){var n,o;if(0<(o=e<4?(n=this.dcPredictorY,this.readHuffman(v.DCT_DC_SIZE_LUMINANCE)):(n=4===e?this.dcPredictorCr:this.dcPredictorCb,this.readHuffman(v.DCT_DC_SIZE_CHROMINANCE)))){var s=this.bits.read(o);this.blockData[0]=0!=(s&1<<o-1)?n+s:n+(-1<<o|s+1)}else this.blockData[0]=n;e<4?this.dcPredictorY=this.blockData[0]:4===e?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,t=this.intraQuantMatrix,i=1}else t=this.nonIntraQuantMatrix;for(var r,a,l,d=0;;){var c=0,u=this.readHuffman(v.DCT_COEFF);if(1===u&&0<i&&0===this.bits.read(1))break;65535===u?(c=this.bits.read(6),0===(d=this.bits.read(8))?d=this.bits.read(8):128===d?d=this.bits.read(8)-256:128<d&&(d-=256)):(c=u>>8,d=255&u,this.bits.read(1)&&(d=-d));var h=v.ZIG_ZAG[i+=c];i++,d<<=1,this.macroblockIntra||(d+=d<0?-1:1),0==(1&(d=d*this.quantizerScale*t[h]>>4))&&(d-=0<d?1:-1),2047<d?d=2047:d<-2048&&(d=-2048),this.blockData[h]=d*v.PREMULTIPLIER_MATRIX[h]}e<4?(r=this.currentY,l=this.codedWidth-8,a=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&e)&&(a+=8),0!=(2&e)&&(a+=this.codedWidth<<3)):(r=4===e?this.currentCb:this.currentCr,l=(this.codedWidth>>1)-8,a=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1===i?(v.CopyValueToDestination(this.blockData[0]+128>>8,r,a,l),this.blockData[0]=0):(v.IDCT(this.blockData),v.CopyBlockToDestination(this.blockData,r,a,l),M.Fill(this.blockData,0)):1===i?(v.AddValueToDestination(this.blockData[0]+128>>8,r,a,l),this.blockData[0]=0):(v.IDCT(this.blockData),v.AddBlockToDestination(this.blockData,r,a,l),M.Fill(this.blockData,0)),i=0},v.CopyBlockToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]=e[o+0],t[i+1]=e[o+1],t[i+2]=e[o+2],t[i+3]=e[o+3],t[i+4]=e[o+4],t[i+5]=e[o+5],t[i+6]=e[o+6],t[i+7]=e[o+7]},v.AddBlockToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]+=e[o+0],t[i+1]+=e[o+1],t[i+2]+=e[o+2],t[i+3]+=e[o+3],t[i+4]+=e[o+4],t[i+5]+=e[o+5],t[i+6]+=e[o+6],t[i+7]+=e[o+7]},v.CopyValueToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]=e,t[i+1]=e,t[i+2]=e,t[i+3]=e,t[i+4]=e,t[i+5]=e,t[i+6]=e,t[i+7]=e},v.AddValueToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]+=e,t[i+1]+=e,t[i+2]+=e,t[i+3]+=e,t[i+4]+=e,t[i+5]+=e,t[i+6]+=e,t[i+7]+=e},v.IDCT=function(e){for(var t,i,n,o,s,r,a,l,d,c,u,h,p,f,m,g,v,y,b=0;b<8;++b)t=e[32+b],i=e[16+b]+e[48+b],n=e[40+b]-e[24+b],r=e[8+b]+e[56+b],a=e[24+b]+e[40+b],d=(p=(473*(o=e[8+b]-e[56+b])-196*n+128>>8)-(s=r+a))-(362*(r-a)+128>>8),f=(c=(l=e[0+b])-t)+(u=(362*(e[16+b]-e[48+b])+128>>8)-i),m=(h=l+t)+i,g=c-u,v=h-i,y=-d-(473*n+196*o+128>>8),e[0+b]=s+m,e[8+b]=p+f,e[16+b]=g-d,e[24+b]=v-y,e[32+b]=v+y,e[40+b]=d+g,e[48+b]=f-p,e[56+b]=m-s;for(b=0;b<64;b+=8)t=e[4+b],i=e[2+b]+e[6+b],n=e[5+b]-e[3+b],r=e[1+b]+e[7+b],a=e[3+b]+e[5+b],d=(p=(473*(o=e[1+b]-e[7+b])-196*n+128>>8)-(s=r+a))-(362*(r-a)+128>>8),f=(c=(l=e[0+b])-t)+(u=(362*(e[2+b]-e[6+b])+128>>8)-i),m=(h=l+t)+i,g=c-u,v=h-i,y=-d-(473*n+196*o+128>>8),e[0+b]=s+m+128>>8,e[1+b]=p+f+128>>8,e[2+b]=g-d+128>>8,e[3+b]=v-y+128>>8,e[4+b]=v+y+128>>8,e[5+b]=d+g+128>>8,e[6+b]=f-p+128>>8,e[7+b]=m-s+128>>8},v.PICTURE_RATE=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],v.ZIG_ZAG=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),v.DEFAULT_INTRA_QUANT_MATRIX=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),v.DEFAULT_NON_INTRA_QUANT_MATRIX=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),v.PREMULTIPLIER_MATRIX=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),v.MACROBLOCK_ADDRESS_INCREMENT=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),v.MACROBLOCK_TYPE_INTRA=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),v.MACROBLOCK_TYPE_PREDICTIVE=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),v.MACROBLOCK_TYPE_B=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),v.MACROBLOCK_TYPE=[null,v.MACROBLOCK_TYPE_INTRA,v.MACROBLOCK_TYPE_PREDICTIVE,v.MACROBLOCK_TYPE_B],v.CODE_BLOCK_PATTERN=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),v.MOTION=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),v.DCT_DC_SIZE_LUMINANCE=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),v.DCT_DC_SIZE_CHROMINANCE=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),v.DCT_COEFF=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),
v.PICTURE_TYPE={INTRA:1,PREDICTIVE:2,B:3},v.START={SEQUENCE:179,SLICE_FIRST:1,SLICE_LAST:175,PICTURE:0,EXTENSION:181,USER_DATA:178},v),M.Decoder.MP2Audio=(((y.prototype=Object.create(M.Decoder.Base.prototype)).constructor=y).prototype.decode=function(){var e=this.bits.index>>3;if(e>=this.bits.byteLength)return!1;var t=this.decodeFrame(this.left,this.right);return this.bits.index=e+t<<3,!!t&&(this.destination&&this.destination.play(this.sampleRate,this.left,this.right),this.advanceDecodedTime(this.left.length/this.sampleRate),!0)},y.prototype.getCurrentTime=function(){var e=this.destination?this.destination.enqueuedTime:0;return this.decodedTime-e},y.prototype.decodeFrame=function(e,t){var i=this.bits.read(11),n=this.bits.read(2),o=this.bits.read(2),s=!this.bits.read(1);if(i!==y.FRAME_SYNC||n!==y.VERSION.MPEG_1||o!==y.LAYER.II)return 0;var r=this.bits.read(4)-1;if(13<r)return 0;var a=this.bits.read(2),l=y.SAMPLE_RATE[a];if(3===a)return 0;n===y.VERSION.MPEG_2&&(a+=4,r+=14);var d=this.bits.read(1),c=(this.bits.read(1),this.bits.read(2)),u=0;u=c===y.MODE.JOINT_STEREO?this.bits.read(2)+1<<2:(this.bits.skip(2),c===y.MODE.MONO?0:32),this.bits.skip(4),s&&this.bits.skip(16);var h=144e3*y.BIT_RATE[r]/(l=y.SAMPLE_RATE[a])+d|0,p=0,f=0;if(n===y.VERSION.MPEG_2)p=2,f=30;else{var m=c===y.MODE.MONO?0:1,g=y.QUANT_LUT_STEP_1[m][r];f=63&(p=y.QUANT_LUT_STEP_2[g][a]),p>>=6}f<u&&(u=f);for(var v=0;v<u;v++)this.allocation[0][v]=this.readAllocation(v,p),this.allocation[1][v]=this.readAllocation(v,p);for(v=u;v<f;v++)this.allocation[0][v]=this.allocation[1][v]=this.readAllocation(v,p);var b=c===y.MODE.MONO?1:2;for(v=0;v<f;v++){for(_=0;_<b;_++)this.allocation[_][v]&&(this.scaleFactorInfo[_][v]=this.bits.read(2));c===y.MODE.MONO&&(this.scaleFactorInfo[1][v]=this.scaleFactorInfo[0][v])}for(v=0;v<f;v++){for(var _=0;_<b;_++)if(this.allocation[_][v]){var w=this.scaleFactor[_][v];switch(this.scaleFactorInfo[_][v]){case 0:w[0]=this.bits.read(6),w[1]=this.bits.read(6),w[2]=this.bits.read(6);break;case 1:w[0]=w[1]=this.bits.read(6),w[2]=this.bits.read(6);break;case 2:w[0]=w[1]=w[2]=this.bits.read(6);break;case 3:w[0]=this.bits.read(6),w[1]=w[2]=this.bits.read(6)}}c===y.MODE.MONO&&(this.scaleFactor[1][v][0]=this.scaleFactor[0][v][0],this.scaleFactor[1][v][1]=this.scaleFactor[0][v][1],this.scaleFactor[1][v][2]=this.scaleFactor[0][v][2])}for(var T=0,A=0;A<3;A++)for(var S=0;S<4;S++){for(v=0;v<u;v++)this.readSamples(0,v,A),this.readSamples(1,v,A);for(v=u;v<f;v++)this.readSamples(0,v,A),this.sample[1][v][0]=this.sample[0][v][0],this.sample[1][v][1]=this.sample[0][v][1],this.sample[1][v][2]=this.sample[0][v][2];for(v=f;v<32;v++)this.sample[0][v][0]=0,this.sample[0][v][1]=0,this.sample[0][v][2]=0,this.sample[1][v][0]=0,this.sample[1][v][1]=0,this.sample[1][v][2]=0;for(var P=0;P<3;P++){for(this.VPos=this.VPos-64&1023,_=0;_<2;_++){y.MatrixTransform(this.sample[_],P,this.V,this.VPos),M.Fill(this.U,0);for(var C=512-(this.VPos>>1),E=this.VPos%128>>1;E<1024;){for(var k=0;k<32;++k)this.U[k]+=this.D[C++]*this.V[E++];E+=96,C+=32}for(E=1120-E,C-=480;E<1024;){for(k=0;k<32;++k)this.U[k]+=this.D[C++]*this.V[E++];E+=96,C+=32}for(var I=0===_?e:t,O=0;O<32;O++)I[T+O]=this.U[O]/2147418112}T+=32}}return this.sampleRate=l,h},y.prototype.readAllocation=function(e,t){var i=y.QUANT_LUT_STEP_3[t][e],n=y.QUANT_LUT_STEP4[15&i][this.bits.read(i>>4)];return n?y.QUANT_TAB[n-1]:0},y.prototype.readSamples=function(e,t,i){var n=this.allocation[e][t],o=this.scaleFactor[e][t][i],s=this.sample[e][t],r=0;if(n){if(63===o)o=0;else{var a=o/3|0;o=y.SCALEFACTOR_BASE[o%3]+(1<<a>>1)>>a}var l=n.levels;n.group?(r=this.bits.read(n.bits),s[0]=r%l,r=r/l|0,s[1]=r%l,s[2]=r/l|0):(s[0]=this.bits.read(n.bits),s[1]=this.bits.read(n.bits),s[2]=this.bits.read(n.bits));var d=65536/(l+1)|0;r=((l=(l+1>>1)-1)-s[0])*d,s[0]=r*(o>>12)+(r*(4095&o)+2048>>12)>>12,r=(l-s[1])*d,s[1]=r*(o>>12)+(r*(4095&o)+2048>>12)>>12,r=(l-s[2])*d,s[2]=r*(o>>12)+(r*(4095&o)+2048>>12)>>12}else s[0]=s[1]=s[2]=0},y.MatrixTransform=function(e,t,i,n){var o,s,r,a,l,d,c,u,h,p,f,m,g,v,y,b,_,w,T,A,S,P,C,E,k,I,O,V,x,D,M,R,N;o=e[0][t]+e[31][t],s=.500602998235*(e[0][t]-e[31][t]),r=e[1][t]+e[30][t],a=.505470959898*(e[1][t]-e[30][t]),l=e[2][t]+e[29][t],d=.515447309923*(e[2][t]-e[29][t]),c=e[3][t]+e[28][t],u=.53104259109*(e[3][t]-e[28][t]),h=e[4][t]+e[27][t],p=.553103896034*(e[4][t]-e[27][t]),f=e[5][t]+e[26][t],m=.582934968206*(e[5][t]-e[26][t]),g=e[6][t]+e[25][t],v=.622504123036*(e[6][t]-e[25][t]),y=e[7][t]+e[24][t],b=.674808341455*(e[7][t]-e[24][t]),_=e[8][t]+e[23][t],w=.744536271002*(e[8][t]-e[23][t]),T=e[9][t]+e[22][t],A=.839349645416*(e[9][t]-e[22][t]),S=e[10][t]+e[21][t],P=.972568237862*(e[10][t]-e[21][t]),C=e[11][t]+e[20][t],E=1.16943993343*(e[11][t]-e[20][t]),k=e[12][t]+e[19][t],I=1.48416461631*(e[12][t]-e[19][t]),O=e[13][t]+e[18][t],V=2.05778100995*(e[13][t]-e[18][t]),x=e[14][t]+e[17][t],D=3.40760841847*(e[14][t]-e[17][t]),N=o+(M=e[15][t]+e[16][t]),M=.502419286188*(o-M),o=r+x,x=.52249861494*(r-x),r=l+O,O=.566944034816*(l-O),l=c+k,k=.64682178336*(c-k),c=h+C,C=.788154623451*(h-C),h=f+S,S=1.06067768599*(f-S),f=g+T,T=1.72244709824*(g-T),g=y+_,_=5.10114861869*(y-_),y=N+g,g=.509795579104*(N-g),N=o+f,o=.601344886935*(o-f),f=r+h,h=.899976223136*(r-h),r=l+c,c=2.56291544774*(l-c),l=y+r,y=.541196100146*(y-r),r=N+f,f=1.30656296488*(N-f),N=l+r,l=.707106781187*(l-r),r=y+f,r+=y=.707106781187*(y-f),f=g+c,g=.541196100146*(g-c),c=o+h,h=1.30656296488*(o-h),o=f+c,c=.707106781187*(f-c),f=g+h,o+=f+=g=.707106781187*(g-h),f+=c,c+=g,h=M+_,M=.509795579104*(M-_),_=x+T,x=.601344886935*(x-T),T=O+S,S=.899976223136*(O-S),O=k+C,C=2.56291544774*(k-C),k=h+O,h=.541196100146*(h-O),O=_+T,T=1.30656296488*(_-T),_=k+O,O=.707106781187*(k-O),k=h+T,T=.707106781187*(h-T),h=M+C,M=.541196100146*(M-C),C=x+S,S=1.30656296488*(x-S),x=h+C,C=.707106781187*(h-C),h=M+S,_+=x+=h+=M=.707106781187*(M-S),x+=k+=T,k+=h+=C,h+=O,O+=C+=M,C+=T,T+=M,S=s+(R=10.1900081235*(e[15][t]-e[16][t])),s=.502419286188*(s-R),R=a+D,a=.52249861494*(a-D),D=d+V,V=.566944034816*(d-V),d=u+I,u=.64682178336*(u-I),I=p+E,p=.788154623451*(p-E),E=m+P,P=1.06067768599*(m-P),m=v+A,A=1.72244709824*(v-A),v=b+w,b=5.10114861869*(b-w),w=S+v,v=.509795579104*(S-v),S=R+m,R=.601344886935*(R-m),m=D+E,E=.899976223136*(D-E),D=d+I,I=2.56291544774*(d-I),d=w+D,w=.541196100146*(w-D),D=S+m,m=1.30656296488*(S-m),S=d+D,D=.707106781187*(d-D),d=w+m,m=.707106781187*(w-m),w=v+I,I=.541196100146*(v-I),v=R+E,E=1.30656296488*(R-E),R=w+v,v=.707106781187*(w-v),w=I+E,R+=w+=E=.707106781187*(I-E),w+=v,I=v+E,v=s+b,s=.509795579104*(s-b),b=a+A,a=.601344886935*(a-A),A=V+P,P=.899976223136*(V-P),V=u+p,p=2.56291544774*(u-p),u=v+V,v=.541196100146*(v-V),V=b+A,A=1.30656296488*(b-A),b=u+V,V=.707106781187*(u-V),u=v+A,A=.707106781187*(v-A),v=s+p,s=.541196100146*(s-p),p=a+P,P=1.30656296488*(a-P),a=v+p,p=.707106781187*(v-p),v=s+P,S+=b+=a+=v+=s=.707106781187*(s-P),b+=R,R+=a+=u+=A,a+=d+=m,d+=u+=v+=p,u+=w,w+=v+=V,v+=D,D+=V+=p+=s,V+=I,I+=p+=A,p+=m,m+=A+=s,A+=E,E+=s,i[n+48]=-N,i[n+49]=i[n+47]=-S,i[n+50]=i[n+46]=-_,i[n+51]=i[n+45]=-b,i[n+52]=i[n+44]=-o,i[n+53]=i[n+43]=-R,i[n+54]=i[n+42]=-x,i[n+55]=i[n+41]=-a,i[n+56]=i[n+40]=-r,i[n+57]=i[n+39]=-d,i[n+58]=i[n+38]=-k,i[n+59]=i[n+37]=-u,i[n+60]=i[n+36]=-f,i[n+61]=i[n+35]=-w,i[n+62]=i[n+34]=-h,i[n+63]=i[n+33]=-v,i[n+32]=-l,i[n+0]=l,i[n+31]=-D,i[n+1]=D,i[n+30]=-O,i[n+2]=O,i[n+29]=-V,i[n+3]=V,i[n+28]=-c,i[n+4]=c,i[n+27]=-I,i[n+5]=I,i[n+26]=-C,i[n+6]=C,i[n+25]=-p,i[n+7]=p,i[n+24]=-y,i[n+8]=y,i[n+23]=-m,i[n+9]=m,i[n+22]=-T,i[n+10]=T,i[n+21]=-A,i[n+11]=A,i[n+20]=-g,i[n+12]=g,i[n+19]=-E,i[n+13]=E,i[n+18]=-M,i[n+14]=M,i[n+17]=-s,i[n+15]=s,i[n+16]=0},y.FRAME_SYNC=2047,y.VERSION={MPEG_2_5:0,MPEG_2:2,MPEG_1:3},y.LAYER={III:1,II:2,I:3},y.MODE={STEREO:0,JOINT_STEREO:1,DUAL_CHANNEL:2,MONO:3},y.SAMPLE_RATE=new Uint16Array([44100,48e3,32e3,0,22050,24e3,16e3,0]),y.BIT_RATE=new Uint16Array([32,48,56,64,80,96,112,128,160,192,224,256,320,384,8,16,24,32,40,48,56,64,80,96,112,128,144,160]),y.SCALEFACTOR_BASE=new Uint32Array([33554432,26632170,21137968]),y.SYNTHESIS_WINDOW=new Float32Array([0,-.5,-.5,-.5,-.5,-.5,-.5,-1,-1,-1,-1,-1.5,-1.5,-2,-2,-2.5,-2.5,-3,-3.5,-3.5,-4,-4.5,-5,-5.5,-6.5,-7,-8,-8.5,-9.5,-10.5,-12,-13,-14.5,-15.5,-17.5,-19,-20.5,-22.5,-24.5,-26.5,-29,-31.5,-34,-36.5,-39.5,-42.5,-45.5,-48.5,-52,-55.5,-58.5,-62.5,-66,-69.5,-73.5,-77,-80.5,-84.5,-88,-91.5,-95,-98,-101,-104,106.5,109,111,112.5,113.5,114,114,113.5,112,110.5,107.5,104,100,94.5,88.5,81.5,73,63.5,53,41.5,28.5,14.5,-1,-18,-36,-55.5,-76.5,-98.5,-122,-147,-173.5,-200.5,-229.5,-259.5,-290.5,-322.5,-355.5,-389.5,-424,-459.5,-495.5,-532,-568.5,-605,-641.5,-678,-714,-749,-783.5,-817,-849,-879.5,-908.5,-935,-959.5,-981,-1000.5,-1016,-1028.5,-1037.5,-1042.5,-1043.5,-1040,-1031.5,1018.5,1e3,976,946.5,911,869.5,822,767.5,707,640,565.5,485,397,302.5,201,92.5,-22.5,-144,-272.5,-407,-547.5,-694,-846,-1003,-1165,-1331.5,-1502,-1675.5,-1852.5,-2031.5,-2212.5,-2394,-2576.5,-2758.5,-2939.5,-3118.5,-3294.5,-3467.5,-3635.5,-3798.5,-3955,-4104.5,-4245.5,-4377.5,-4499,-4609.5,-4708,-4792.5,-4863.5,-4919,-4958,-4979.5,-4983,-4967.5,-4931.5,-4875,-4796,-4694.5,-4569.5,-4420,-4246,-4046,-3820,-3567,3287,2979.5,2644,2280.5,1888,1467.5,1018.5,541,35,-499,-1061,-1650,-2266.5,-2909,-3577,-4270,-4987.5,-5727.5,-6490,-7274,-8077.5,-8899.5,-9739,-10594.5,-11464.5,-12347,-13241,-14144.5,-15056,-15973.5,-16895.5,-17820,-18744.5,-19668,-20588,-21503,-22410.5,-23308.5,-24195,-25068.5,-25926.5,-26767,-27589,-28389,-29166.5,-29919,-30644.5,-31342,-32009.5,-32645,-33247,-33814.5,-34346,-34839.5,-35295,-35710,-36084.5,-36417.5,-36707.5,-36954,-37156.5,-37315,-37428,-37496,37519,37496,37428,37315,37156.5,36954,36707.5,36417.5,36084.5,35710,35295,34839.5,34346,33814.5,33247,32645,32009.5,31342,30644.5,29919,29166.5,28389,27589,26767,25926.5,25068.5,24195,23308.5,22410.5,21503,20588,19668,18744.5,17820,16895.5,15973.5,15056,14144.5,13241,12347,11464.5,10594.5,9739,8899.5,8077.5,7274,6490,5727.5,4987.5,4270,3577,2909,2266.5,1650,1061,499,-35,-541,-1018.5,-1467.5,-1888,-2280.5,-2644,-2979.5,3287,3567,3820,4046,4246,4420,4569.5,4694.5,4796,4875,4931.5,4967.5,4983,4979.5,4958,4919,4863.5,4792.5,4708,4609.5,4499,4377.5,4245.5,4104.5,3955,3798.5,3635.5,3467.5,3294.5,3118.5,2939.5,2758.5,2576.5,2394,2212.5,2031.5,1852.5,1675.5,1502,1331.5,1165,1003,846,694,547.5,407,272.5,144,22.5,-92.5,-201,-302.5,-397,-485,-565.5,-640,-707,-767.5,-822,-869.5,-911,-946.5,-976,-1e3,1018.5,1031.5,1040,1043.5,1042.5,1037.5,1028.5,1016,1000.5,981,959.5,935,908.5,879.5,849,817,783.5,749,714,678,641.5,605,568.5,532,495.5,459.5,424,389.5,355.5,322.5,290.5,259.5,229.5,200.5,173.5,147,122,98.5,76.5,55.5,36,18,1,-14.5,-28.5,-41.5,-53,-63.5,-73,-81.5,-88.5,-94.5,-100,-104,-107.5,-110.5,-112,-113.5,-114,-114,-113.5,-112.5,-111,-109,106.5,104,101,98,95,91.5,88,84.5,80.5,77,73.5,69.5,66,62.5,58.5,55.5,52,48.5,45.5,42.5,39.5,36.5,34,31.5,29,26.5,24.5,22.5,20.5,19,17.5,15.5,14.5,13,12,10.5,9.5,8.5,8,7,6.5,5.5,5,4.5,4,3.5,3.5,3,2.5,2.5,2,2,1.5,1.5,1,1,1,1,.5,.5,.5,.5,.5,.5]),y.QUANT_LUT_STEP_1=[[0,0,1,1,1,2,2,2,2,2,2,2,2,2],[0,0,0,0,0,0,1,1,1,2,2,2,2,2]],y.QUANT_LUT_STEP_2=[[(y.QUANT_TAB={A:91,B:94,C:8,D:12}).C,y.QUANT_TAB.C,y.QUANT_TAB.D],[y.QUANT_TAB.A,y.QUANT_TAB.A,y.QUANT_TAB.A],[y.QUANT_TAB.B,y.QUANT_TAB.A,y.QUANT_TAB.B]],y.QUANT_LUT_STEP_3=[[68,68,52,52,52,52,52,52,52,52,52,52],[67,67,67,66,66,66,66,66,66,66,66,49,49,49,49,49,49,49,49,49,49,49,49,32,32,32,32,32,32,32],[69,69,69,69,52,52,52,52,52,52,52,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36]],y.QUANT_LUT_STEP4=[[0,1,2,17],[0,1,2,3,4,5,6,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17],[0,1,3,5,6,7,8,9,10,11,12,13,14,15,16,17],[0,1,2,4,5,6,7,8,9,10,11,12,13,14,15,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],y.QUANT_TAB=[{levels:3,group:1,bits:5},{levels:5,group:1,bits:7},{levels:7,group:0,bits:3},{levels:9,group:1,bits:10},{levels:15,group:0,bits:4},{levels:31,group:0,bits:5},{levels:63,group:0,bits:6},{levels:127,group:0,bits:7},{levels:255,group:0,bits:8},{levels:511,group:0,bits:9},{levels:1023,group:0,bits:10},{levels:2047,group:0,bits:11},{levels:4095,group:0,bits:12},{levels:8191,group:0,bits:13},{levels:16383,group:0,bits:14},{levels:32767,group:0,bits:15},{levels:65535,group:0,bits:16}],y),M.Renderer.WebGL=(b.prototype.resize=function(e,t){this.width=0|e,this.height=0|t,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)},b.prototype.createTexture=function(e,t){var i=this.gl,n=i.createTexture();return i.bindTexture(i.TEXTURE_2D,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.uniform1i(i.getUniformLocation(this.program,t),e),n},b.prototype.createProgram=function(e,t){var i=this.gl,n=i.createProgram();return i.attachShader(n,this.compileShader(i.VERTEX_SHADER,e)),i.attachShader(n,this.compileShader(i.FRAGMENT_SHADER,t)),i.linkProgram(n),i.useProgram(n),n},b.prototype.compileShader=function(e,t){var i=this.gl,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(n));return n},b.prototype.allowsClampedTextureData=function(){var e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,1,1,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8ClampedArray([0])),0===e.getError()},b.prototype.renderProgress=function(e){var t=this.gl,i=t.getUniformLocation(this.loadingProgram,"progress");t.uniform1f(i,e),t.drawArrays(t.TRIANGLE_STRIP,0,4)},b.prototype.render=function(e,t,i){if(this.enabled){var n=this.gl,o=this.width+15>>4<<4,s=this.height,r=o>>1,a=s>>1;this.shouldCreateUnclampedViews&&(e=new Uint8Array(e.buffer),t=new Uint8Array(t.buffer),i=new Uint8Array(i.buffer)),this.updateTexture(n.TEXTURE0,this.textureY,o,s,e),this.updateTexture(n.TEXTURE1,this.textureCb,r,a,t),this.updateTexture(n.TEXTURE2,this.textureCr,r,a,i),n.drawArrays(n.TRIANGLE_STRIP,0,4)}},b.prototype.updateTexture=function(e,t,i,n,o){var s=this.gl;s.activeTexture(e),s.bindTexture(s.TEXTURE_2D,t),s.texImage2D(s.TEXTURE_2D,0,s.LUMINANCE,i,n,0,s.LUMINANCE,s.UNSIGNED_BYTE,o)},b.IsSupported=function(){try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas");return!(!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},b.SHADER={FRAGMENT_YCRCB_TO_RGBA:["precision mediump float;","uniform sampler2D textureY;","uniform sampler2D textureCb;","uniform sampler2D textureCr;","varying vec2 texCoord;","mat4 rec601 = mat4(","1.16438,  0.00000,  1.59603, -0.87079,","1.16438, -0.39176, -0.81297,  0.52959,","1.16438,  2.01723,  0.00000, -1.08139,","0, 0, 0, 1",");","void main() {","float y = texture2D(textureY, texCoord).r;","float cb = texture2D(textureCb, texCoord).r;","float cr = texture2D(textureCr, texCoord).r;","gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;","}"].join("\n"),FRAGMENT_LOADING:["precision mediump float;","uniform float progress;","varying vec2 texCoord;","void main() {","float c = ceil(progress-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),VERTEX_IDENTITY:["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},b),M.Renderer.Canvas2D=(_.prototype.resize=function(e,t){this.width=0|e,this.height=0|t,this.canvas.width=this.width,this.canvas.height=this.height,this.imageData=this.context.getImageData(0,0,this.width,this.height),M.Fill(this.imageData.data,255)},_.prototype.renderProgress=function(e){var t=this.canvas.width,i=this.canvas.height,n=this.context;n.fillStyle="#222",n.fillRect(0,0,t,i),n.fillStyle="#fff",n.fillRect(0,i-i*e,t,i*e)},_.prototype.render=function(e,t,i){this.YCbCrToRGBA(e,t,i,this.imageData.data),this.context.putImageData(this.imageData,0,0)},_.prototype.YCbCrToRGBA=function(e,t,i,n){if(this.enabled)for(var o,s,r,a,l,d=this.width+15>>4<<4,c=d>>1,u=0,h=d,p=d+(d-this.width),f=0,m=c-(this.width>>1),g=0,v=4*this.width,y=4*this.width,b=this.width>>1,_=this.height>>1,w=0;w<_;w++){for(var T=0;T<b;T++){o=t[f],s=i[f],f++,r=o+(103*o>>8)-179,a=(88*s>>8)-44+(183*o>>8)-91,l=s+(198*s>>8)-227;var A=e[u++],S=e[u++];n[g]=A+r,n[g+1]=A-a,n[g+2]=A+l,n[g+4]=S+r,n[g+5]=S-a,n[g+6]=S+l,g+=8;var P=e[h++],C=e[h++];n[v]=P+r,n[v+1]=P-a,n[v+2]=P+l,n[v+4]=C+r,n[v+5]=C-a,n[v+6]=C+l,v+=8}u+=p,h+=p,g+=y,v+=y,f+=m}},_),M.AudioOutput.WebAudio=(w.prototype.play=function(e,t,i){if(this.enabled){if(!this.unlocked){var n=M.Now();return this.wallclockStartTime<n&&(this.wallclockStartTime=n),void(this.wallclockStartTime+=t.length/e)}this.gain.gain.value=this.volume;var o=this.context.createBuffer(2,t.length,e);o.getChannelData(0).set(t),o.getChannelData(1).set(i);var s=this.context.createBufferSource();s.buffer=o,s.connect(this.destination);var r=this.context.currentTime,a=o.duration;this.startTime<r&&(this.startTime=r,this.wallclockStartTime=M.Now()),s.start(this.startTime),this.startTime+=a,this.wallclockStartTime+=a}},w.prototype.stop=function(){this.gain.gain.value=0},w.prototype.getEnqueuedTime=function(){return Math.max(this.wallclockStartTime-M.Now(),0)},w.prototype.resetEnqueuedTime=function(){this.startTime=this.context.currentTime,this.wallclockStartTime=M.Now()},w.prototype.unlock=function(e){if(this.unlocked)e&&e();else{this.unlockCallback=e;var t=this.context.createBuffer(1,1,22050),i=this.context.createBufferSource();i.buffer=t,i.connect(this.destination),i.start(0),setTimeout(this.checkIfUnlocked.bind(this,i,0),0)}},w.prototype.checkIfUnlocked=function(e,t){e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE?(this.unlocked=!0,this.unlockCallback&&(this.unlockCallback(),this.unlockCallback=null)):t<10&&setTimeout(this.checkIfUnlocked.bind(this,e,t+1),100)},w.NeedsUnlocking=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},w.IsSupported=function(){return window.AudioContext||window.webkitAudioContext},w.CachedContext=null,w);var R=function(e,t){return new M.Player(e,t)},N=function(){function e(t,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(n=S(this,P(e).call(this))).video=t,n.params=i,n.target=n.params.canvas.parent,n.logToBI=n.params.logToBI,n.createCanvas(),n.modifyVideo(t),n.shouldAutoPlay=!1,n.canvasCss=i.canvas.additionalCss||{},n.bypass=!1,n.clntRedirRslvWhiteList=n.params.clientRedirRslvWhiteList||[],n.ready=!1,n.loop=!1,n.vidAttr={},t.muted=!0,n.status="LOADING",n.quartiles=[{event:"AdVideoFirstQuartile",percentage:.25},{event:"AdVideoMidpoint",percentage:.5},{event:"AdVideoThirdQuartile",percentage:.75}],n.logToBI("canvas",{ctor:!0}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(e,O.EventEmitter),function(e,t,i){t&&A(e.prototype,t),i&&A(e,i)}(e,[{key:"emitStartAd",value:function(){var e=this;this.stratAdCalled=!0,this._playTimeout=setTimeout(function(){e._play()},2e3)}},{key:"backToVideoTag",value:function(e){var t=this;if(!this.bypass&&this.src){this.bypass=!0;var i=this.jsmpeg.currentTime,n=this.video.style,o=this.video.parentElement||this.target,s=parseInt(this.canvas.style.zIndex),r=this.jsmpeg.loop;this.newVid=o.insertBefore(document.createElement("video"),this.canvas),this.newVid.className="mc-loud-video",this.newVid.setAttribute("playsinline",""),this.newVid.setAttribute("autoplay",""),r&&this.newVid.setAttribute("loop",""),this.newVid.style.height=n.height,this.newVid.style.width=n.width,this.newVid.style.top=n.top?n.top:"0",this.newVid.style.left=n.left?n.left:"0",this.newVid.style.background="#000000",this.newVid.style.zIndex=s,this.newVid.style.display="none",this.newVid.src=this.src,this.newVid.volume="muteChanged"===e.type?this.params.canvas.defaultVolume:0,this.newVid.muted=0===this.newVid.volume,this.newVid.addEventListener("ended",function(e){t.dispatchDOM("ended")},!1),this.newVid.addEventListener("click",function(e){t.dispatchDOM("click",e)}),this.newVid.addEventListener("durationchange",function n(){if(0!==t.newVid.duration){t.newVid.removeEventListener("durationchange",n);var o=t.jsmpeg&&0<t.jsmpeg.currentTime?t.jsmpeg.currentTime:i;(0===t.newVid.currentTime||t.newVid.currentTime<o)&&(t.newVid.currentTime=o,t.newVid.addEventListener("timeupdate",function i(){t.newVid.currentTime>o&&(t.newVid.removeEventListener("timeupdate",i),t.tuTicker=clearInterval(t.tuTicker),t.jsmpeg.stop(),t.jsmpeg=void 0,t.newVid.style.display="block",t.canvas.style.display="none",t.video.style.display="none","playChanged"!==e.type&&!t.video.paused||t._pause(),t.emit("newVidCreated",t.newVid))}))}}),this.newVid.addEventListener("timeupdate",function(){t.dispatchDOM("canvas-timeupdate")}),this.newVid.currentTime=i,this.newVid.play().then(function(){t.newVid.currentTime=i}),this.isCanvasFinished=!1}}},{key:"mpegFinish",value:function(){this.isCanvasFinished||(this.emit("canvasEnded"),this.dispatchDOM("ended"),this.isCanvasFinished=!0)}},{key:"onLoad",value:function(){var e=this;if(!this.loaded){this.loaded=!0;var t=parseInt(this.video.clientWidth),i=parseInt(this.video.clientHeight);this.onResize(t,i),setTimeout(function(){e.ready=!0,e.emit("ready"),e.dispatchDOM("loadedmetadata")},0)}}},{key:"createCanvas",value:function(){var e=this,t=document.createElement("canvas");t.className="mc-canvas",this.params.isMultiVpaidUnit&&function(e,t){e.className.indexOf(t)<0&&(e.className+=" ".concat(t)),e.className=e.className.split(" ").join(" ")}(t,"multi-vpaids");var i=this.video.parentElement||this.target;this.canvas=i.appendChild(t),i.className+=" mpegcnv";var n=this;i._appendChild=i.appendChild,i.appendChild=function(e){i.insertBefore(e,n.canvas)},this.video&&this.video.addEventListener("resize",function(e){n.onResize(e.target.clientWidth,e.target.clientHeight)}),this.canvas.addEventListener("click",function(t){e.dispatchDOM("click",t)})}},{key:"_getAspectRatio",value:function(){var e=this.params.canvas.aspectRatio;if(e&&e.indexOf(":")){var t=e.split(":");if(2===t.length&&t[0]&&t[1])return t}return!1}},{key:"onResize",value:function(e,t){var i,n;if(e||t){var o=this._getAspectRatio();o?e?(t=t||this.video.clientHeight,n=e,i=Math.floor(parseFloat(e)*parseInt(o[1])/parseInt(o[0]))):(e=this.video.clientWidth,i=t,n=Math.floor(parseFloat(t)*parseInt(o[0])/parseInt(o[1]))):(n=e,i=t),this.newVid?(this.newVid.style.width="".concat(e,"px"),this.newVid.style.height="".concat(t,"px")):this.jsmpeg&&this.canvas&&(this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.width=n+"px",this.canvas.style.height=i+"px",this.canvas.style.marginTop=(t-i)/2+"px",this.canvas.style.marginLeft=(e-n)/2+"px"),this.height=t,this.width=e}}},{key:"hookProp",value:function(e,t,i,n){var o="alt_"+t;e.hasOwnProperty(o)||(e[o]="",Object.defineProperty(e,t,{get:function(){return i?i():this[o]},set:function(i){this[o]=i,n&&n(i)&&e.setAttribute(t,i)}}))}},{key:"hookMethod",value:function(e,t,i){this.hooks||(this.hooks=[]),this.hooks[t]=e[t];var n=this;e[t]=function(){var e={};if(i(arguments,e)){if(!n.hooks.hasOwnProperty(t)||"function"!=typeof n.hooks[t])return!1;var o=n.hooks[t].apply(this,arguments);return e.res?e.res:o}}}},{key:"dispatchDOM",value:function(e,t){if(this.video){var i=new Event(e);this.video.dispatchEvent(i)}}},{key:"errHndlr",value:function(e){this.logToBI("jsmpegError",e),this.emit("canvasError")}},{key:"isUrlInRslvWhiteList",value:function(e){if(!this.clntRedirRslvWhiteList.length)return!0;for(var t=0;t<this.clntRedirRslvWhiteList.length;++t)if(-1<e.indexOf(this.clntRedirRslvWhiteList[t]))return!0;return!1}},{key:"setSrc",value:function(e){if((e=e.trim())&&!this.hasVidUrl){this.logToBI("canvasUrl",{url:e},!1,!1),this.hasVidUrl=!0,this.video&&this.video._vidSetAttr("src",e),this.src=e;var t=this.params.canvas.canvasLoadRate,i=parseInt(this.video.clientWidth),n=parseInt(this.video.clientHeight),o={loadeReadyRate:t,canvas:this.canvas,audio:!1,centerVertically:!0,autoplay:this.shouldAutoPlay,loop:this.loop||!1,pcy:n,pcx:i,onload:this.onLoad.bind(this),errHndlr:this.errHndlr.bind(this),onfinished:this.mpegFinish.bind(this),progressive:!1,canvasCss:this.canvasCss,disableGl:this.params.canvas.disableWebGl},s=this.params.canvas.mpegServerBaseUrl+"="+encodeURIComponent(e);return(/\.mpg$/.test(e)||/\.mpeg$/.test(e))&&(s=e),this.jsmpeg=new R(s,o,this),this._setVideoDuration(this.src),!1}}},{key:"_play",value:function(){var e=this;this.blockActions||(clearTimeout(this._playTimeout),this._timeUpdateTicker(),this.ready?(this.newVid?this.newVid.play():this.jsmpeg.play(),this.dispatchDOM("playing"),this.status="PLAYING",this._render()):this.on("ready",function(){e.emit("play"),e._play()}))}},{key:"_timeUpdateTicker",value:function(){var e=this;clearInterval(this.tuTicker),this.tuTicker=setInterval(function(){e.dispatchDOM("timeupdate"),e.dispatchDOM("canvas-timeupdate"),0<e.quartiles.length&&e.video.currentTime/e.video.duration>=e.quartiles[0].percentage&&e.logToBI("canvas_quartiles",{event:e.quartiles.shift().event})},250)}},{key:"_pause",value:function(){this.stopped||(this.status="PAUSED",this._render(),this.newVid?this.newVid.pause():this.jsmpeg&&this.jsmpeg.pause())}},{key:"muteButtonClick",value:function(e){if(!this.stopped){var t=!!this.newVid&&!this.newVid.muted;this.logToBI("canvasMuteToggle",{muted:t}),this.newVid?(this.newVid.volume=t?0:this.params.canvas.defaultVolume,this.newVid.muted=0===this.newVid.volume):this.backToVideoTag({type:"muteChanged"})}}},{key:"playButtonClick",value:function(e){if(!this.stopped){var t="PLAYING"===this.status?"PAUSED":"PLAYING";if(this.logToBI("canvasPlayToggle",{status:t,view:this.newVid?"newVid":"canvas"}),this.status=t,this.newVid){var i=this.newVid||this.jsmpeg;"PLAYING"===this.status?i.play():i.pause(),this._render()}else this.backToVideoTag({type:"playChanged"})}}},{key:"modifyVideo",value:function(e){var t=this;if(!this.stopped){var i=this;e._vidSetAttr=e.setAttribute,e.getAttribute=function(e,i){return t.vidAttr[e]},e.setAttribute=function(n,o){if(!i.stopped)return t.vidAttr[n]=o,"volume"===n&&(t._volume=o),t.logToBI("hookSetAttribute",{key:n,val:o}),"src"===n?void t.setSrc(o):e._vidSetAttr(n,o)},this.hookMethod(e,"play",function(){if(!i.stopped)return i._play(),i.dispatchDOM("playing"),!1}),this.hookMethod(e,"pause",function(){if(!i.stopped)return i._pause(),!0}),this.hookMethod(e,"stop",function(){if(!i.stopped)return i.jsmpeg.stop(),!0}),this.hookProp(e,"paused",function(){return"PAUSED"===this.status}.bind(this),null),this.hookProp(e,"src",null,this.setSrc.bind(this)),this.hookProp(this.video,"volume",function(){return t.newVid?t.newVid.volume:t._volume},function(e){return t._volume=e,!0}),this.hookProp(e,"currentTime",function(){var e=i.newVid||i.jsmpeg;return e?e.currentTime:0},null),this.hookProp(e,"duration",function(){if(i.duration)return i.duration},function(e){i.duration=e})}}},{key:"_setVideoDuration",value:function(e){var t=this,i=document.createElement("video");i.src=e,i.addEventListener("loadedmetadata",function(){t.video&&(t.video.duration=i.duration),i.src="",i=void 0}),i.load()}},{key:"_render",value:function(){this.newVid||this.canvas}},{key:"hide",value:function(){this.stopped||(this.canvas.style.display="none",this._render())}},{key:"show",value:function(){this.stopped||(this.canvas.style.display="block",this._render())}},{key:"removeDomMember",value:function(e){e.parentNode.removeChild(e)}},{key:"restartAd",value:function(){var e=this;this.stopped||(this.newVid?(this.newVid.currentTime=0,this.newVid.play()):this.jsmpeg&&(this.blockActions=!0,this.jsmpeg.stop(),setTimeout(function(){e.jsmpeg.play()},20),setTimeout(function(){e.blockActions=!1},2e3)))}},{key:"destroy",value:function(){clearTimeout(this._playTimeout),clearInterval(this.tuTicker),this.jsmpeg=void 0;var e=this._events;for(var t in e)this.removeAllListeners(t);this.removeDomMember(this.canvas),this.canvas=void 0}}]),e}(),L=D,F=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=document.createElement("video"),this._initVideoElementParams(t),this._addVideoElementMethods(),this._addVideoElementProperties(),this._addVideoEvents(),this._loopThroughMediaSources(),this.video.videoState=t.videoState||x,this.video}return function(e,t,i){t&&k(e.prototype,t),i&&k(e,i)}(e,[{key:"_shouldDetectAutoplay",value:function(){return this.params.isMobile&&!this.params.canvas.ignoreAutoplayDetection}},{key:"_initVideoElementParams",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(this.params=E({},L,t),this.params.canvas=E({},L.canvas,t.canvas),this.params.secureMediaFiles=this.params.secureMediaFiles&&"https:"===window.location.protocol,this.params.userAgent=I.UAParser(window.navigator.userAgent),this.params.isMobile)if(this.params.logToBI("videoElement",{forceCanvas:this.params.canvas.force},!1,!1),this.params.canvas.force){if(this.params.videoState===x&&this.params.canvas.useAutoplayForContent)return;this._initCanvas()}else this._shouldDetectAutoplay()&&this._detectAutoplay()}},{key:"_detectAutoplay",value:function(){var e=new V(this.params);e.on("detectIsAutoplaySupported",this._onIsAutoplaySupportedDetected.bind(this)),e.isAutoplaySupported()}},{key:"_onIsAutoplaySupportedDetected",value:function(e){this.params.autoplay=e,this.video.forceCanvas=!this.params.autoplay,this.params.canvas.onAutoplayDetected(this.params.autoplay),this.params.logToBI("videoElement",{isAutoplaySupported:e},!1,!1),"iOS"===this.params.userAgent.os.name?this._initVideoOnIOS():"Android"!==this.params.userAgent.os.name||this.params.autoplay||this._initCanvas()}},{key:"_initVideoOnIOS",value:function(){this.video.removeAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0}},{key:"_initCanvas",value:function(){this.canvasInited||(this.canvasInited=!0,this.video.forceCanvas=!0,this.canvas=new N(this.video,this.params),this._addCanvasMethods(),this._registerToCanvasEvents())}},{key:"_addCanvasMethods",value:function(){this._addMuteButtonClickedMethod(),this._addPlayButtonClickedMethod(),this._addResizeMethod(),this._addIsCanvasLoadedMethod(),this._addUseResumeCallbackMethod(),this._addEmitStartAdMethod(),this._addShowCanvasMetnod(),this._addHideCanvasMetnod()}},{key:"_registerToCanvasEvents",value:function(){this._registerToCanvasReadyEvent(),this._registerToCanvasNewVidCreatedEvent(),this._registerToCanvasPlayEvent(),this._registerToCanvasEndedEvent(),this._registerToCanvasErrorEvent()}},{key:"_registerToCanvasReadyEvent",value:function(){var e=this;this._onCanvasReady=function(){e.video.canvasReady=!0,e._dispatchEvent("canvasReady")},this.canvas.on("ready",this._onCanvasReady)}},{key:"_registerToCanvasNewVidCreatedEvent",value:function(){var e=this;this._onNewVidCreated=function(t){t.style.pointerEvents="all",t.style.zIndex=t.style.zIndex||e.zIndex,e.newVidCreated=!0,e._dispatchEvent("canvasRemoved",{videoElement:t}),e._removeCanvasMethods(),e._unregisterFromCanvasEvents()},this.canvas.on("newVidCreated",this._onNewVidCreated)}},{key:"_registerToCanvasPlayEvent",value:function(){var e=this;this._onCanvasPlay=function(){e.newVidCreated||e._dispatchEvent("canvasPlay")},this.canvas.on("play",this._onCanvasPlay)}},{key:"_registerToCanvasEndedEvent",value:function(){var e=this;this._onCanvasEnded=function(){e.newVidCreated||e._dispatchEvent("canvasEnded")},this.canvas.on("canvasEnded",this._onCanvasEnded)}},{key:"_registerToCanvasErrorEvent",value:function(){var e=this;this._onCanvasError=function(){e.newVidCreated||e._dispatchEvent("canvasError")},this.canvas.on("canvasError",this._onCanvasError)}},{key:"_addVideoElementMethods",value:function(){this._addClearVideoSourcesMethod(),this._addDestroyMethod(),this._addRestartMethod(),this._addAppendSourceMethod(),
this._addAppendVideoSourcesMethod(),this._addRegisterProgressEventsMethod(),this._addRegisterTickingEventsMethod(),this._addProtectVideoPauseMethod(),this._addGetSrcMethod(),this._addHookMutedPropertyMethod(),this._addSupressErrorEventsMethod()}},{key:"_addClearVideoSourcesMethod",value:function(){this.video.clearVideoSources=function(){for(;this.childNodes.length;)this.removeChild(this.childNodes[0])}}},{key:"_addDestroyMethod",value:function(){var e=this;this.video.destroy=function(){this.pause(),this.clearVideoSources(),this.src="",e.canvas&&e.canvas.destroy()}}},{key:"_addRestartMethod",value:function(){this.video.restart=function(){this.currentTime=0,this.play()}}},{key:"_addAppendSourceMethod",value:function(){this.video.appendSource=function(e,t){if(this.forceCanvas)this.setAttribute("src",e),this.setAttribute("type",t);else{var i=document.createElement("source");i.src=e,i.setAttribute("type",t),this.appendChild(i)}this.relevantSources++}}},{key:"_addAppendVideoSourcesMethod",value:function(){var e=this;this.video.appendVideoSources=function(t){var i=null;this.clearVideoSources();for(var n=0;n<t.length;n++){var o=t[n],s=o.url;this.canPlayType(o.originalType)&&(e.params.decodeUrl&&(s=decodeURI(s)),e.params.secureMediaFiles&&(s=s.replace("http:","https:")),i||((i=o).mediaUrl=s),this.appendSource(s,o.originalType))}return i}}},{key:"_addRegisterProgressEventsMethod",value:function(){this.video.registerProgressEvents=function(e){this._progressEvents={};for(var t=0;t<e.length;t++){var i="precentage"===e[t].offsetType?e[t].offset:e[t].offset/this.duration;this._progressEvents[i]={offset:i,fired:!1}}}}},{key:"_addRegisterTickingEventsMethod",value:function(){this.video.registerTickingEvents=function(e){this._ticker=e}}},{key:"_addProtectVideoPauseMethod",value:function(){this.video.protectPause=function(){this._play=this.play,this.play=function(){this.resumeInvoked&&this._play()}}}},{key:"_addGetSrcMethod",value:function(){this.video.getSrc=function(){if(this.src)return this.src;for(var e=0;e<this.childNodes.length;e++){var t=this.childNodes[e];if("source"===t.nodeName.toLowerCase()&&t.src)return t.src}return""}}},{key:"_addHookMutedPropertyMethod",value:function(){this.params.isMobile&&(this.video.hookMutedProperty=function(){this.__defineSetter__("_muted",this.__lookupSetter__("muted")),this.__defineSetter__("muted",function(e){return this.mutedChangeByUserGesture?(this._muted=e,void this.__defineSetter__("muted",this.__lookupSetter__("_muted"))):void(this._muted=!0)})})}},{key:"_addSupressErrorEventsMethod",value:function(){this.video.supressErrorEvents=function(){this._addEventListener=this.addEventListener,this.addEventListener=function(e,t){"error"!==e&&this._addEventListener(e,t)}}}},{key:"_addMuteButtonClickedMethod",value:function(){var e=this;this.video.muteButtonClicked=function(){e.canvas&&e.canvas.muteButtonClick()}}},{key:"_addPlayButtonClickedMethod",value:function(){var e=this;this.video.playButtonClicked=function(){e.canvas&&e.canvas.playButtonClick()}}},{key:"_addResizeMethod",value:function(){var e=this;this.video.resize=function(){if(e.canvas){var t=1<arguments.length?arguments:arguments[0],i=t[0],n=t[1];e.canvas.onResize(i,n)}}}},{key:"_addIsCanvasLoadedMethod",value:function(){var e=this;this.video.isCanvasLoaded=function(){return e.canvas&&e.canvas.loaded}}},{key:"_addUseResumeCallbackMethod",value:function(){var e=this;this.video.useResumeCallback=function(){return e.canvas}}},{key:"_addEmitStartAdMethod",value:function(){var e=this;this.video.emitStartAd=function(){return e.canvas.emitStartAd()}}},{key:"_addShowCanvasMetnod",value:function(){var e=this;this.video.showCanvas=function(){return e.canvas.show()}}},{key:"_addHideCanvasMetnod",value:function(){var e=this;this.video.hideCanvas=function(){return e.canvas.hide()}}},{key:"_addVideoElementProperties",value:function(){this._addTbVersionProperty(),this._addProgressPrecentageProperty(),this._addRemainingTimeProperty(),this._addRelevantSourcesProperty(),this._addBufferSizeProperty(),this._addResumeInvokedProperty(),this._addMutedChangeByUserGestureProperty(),this._addVideoStateProperty(),this._addForceCanvasProperty()}},{key:"_addTbVersionProperty",value:function(){Object.defineProperty(this.video,"TB__VERSION",{get:function(){return"2.0.0"}})}},{key:"_addProgressPrecentageProperty",value:function(){Object.defineProperty(this.video,"progressPrecentage",{get:function(){return this.currentTime/this.duration}})}},{key:"_addRemainingTimeProperty",value:function(){Object.defineProperty(this.video,"remainingTime",{get:function(){return this.duration-this.currentTime}})}},{key:"_addRelevantSourcesProperty",value:function(){Object.defineProperty(this.video,"relevantSources",{get:function(){return this._relevantSources||0},set:function(e){this._relevantSources=e}})}},{key:"_addBufferSizeProperty",value:function(){Object.defineProperty(this.video,"bufferSize",{get:function(){if(this.buffered)return 0===this.buffered.length||0!==this.buffered.start(0)?0:this.buffered.end(0)-this.buffered.start(0)}})}},{key:"_addResumeInvokedProperty",value:function(){Object.defineProperty(this.video,"resumeInvoked",{get:function(){return this._resumeInvoked||!1},set:function(e){this._resumeInvoked=e}})}},{key:"_addMutedChangeByUserGestureProperty",value:function(){this.params.isMobile&&Object.defineProperty(this.video,"mutedChangeByUserGesture",{get:function(){return this._mutedChangeByUserGesture||!1},set:function(e){this._mutedChangeByUserGesture=e}})}},{key:"_addVideoStateProperty",value:function(){Object.defineProperty(this.video,"videoState",{get:function(){return this._videoState||x},set:function(e){this._videoState=e}})}},{key:"_addForceCanvasProperty",value:function(){var e=this;if(this.params.isMobile){var t=this.video.forceCanvas||!1;Object.defineProperty(this.video,"forceCanvas",{get:function(){return this._forceCanvas||t},set:function(t){this._forceCanvas=t,this._forceCanvas&&e._initCanvas()}})}}},{key:"_removeCanvasMethods",value:function(){this.video.isCanvasLoaded=this.video.emitStartAd=this.video.showCanvas=this.video.hideCanvas=void 0}},{key:"_unregisterFromCanvasEvents",value:function(){this.canvas.removeListener("ready",this._onCanvasReady),this.canvas.removeListener("newVidCreated",this._onNewVidCreated),this.canvas.removeListener("play",this._onCanvasPlay),this.canvas.removeListener("canvasEnded",this._onCanvasEnded),this.canvas.removeListener("canvasError",this._onCanvasError),this._onCanvasReady=this._onNewVidCreated=this._onCanvasPlay=this._onCanvasEnded=this._onCanvasError=void 0}},{key:"_addVideoEvents",value:function(){this._addTimeupdateEvents()}},{key:"_addTimeupdateEvents",value:function(){this.quartiles={q1:!1,q2:!1,q3:!1};var e=this;this.video.addEventListener(this.video.forceCanvas?"canvas-timeupdate":"timeupdate",function t(){!e.quartiles.q1&&.25<=this.progressPrecentage?(e.quartiles.q1=!0,e._dispatchEvent("firstQuartile")):!e.quartiles.q2&&.5<=this.progressPrecentage?(e.quartiles.q2=!0,e._dispatchEvent("midpoint")):!e.quartiles.q3&&.75<=this.progressPrecentage&&(e.quartiles.q3=!0,e._dispatchEvent("thirdQuartile"));var i=!0;for(var n in this._progressEvents)this._progressEvents[n].fired||(this._progressEvents[n].offset<=this.progressPrecentage?(this._progressEvents[n].fired=!0,e._dispatchEvent("timeProgress",{pre:this.progressPrecentage,time:this.currentTime})):i=!1);if(this._ticker){var o=Math.floor(this.currentTime);this._currentTimeFloored!==o&&o%this._ticker==0&&(this._currentTimeFloored=o,e._dispatchEvent("ticking",{time:o}))}i&&e.quartiles.q3&&!this._ticker&&this.removeEventListener("timeupdate",t,!0)})}},{key:"_loopThroughMediaSources",value:function(){var e=this;this.video.addEventListener("ended",function(){if(e._isPlayingContent()&&1<this.childNodes.length){var t=this.removeChild(this.childNodes[0]);this.appendChild(t),this.load(),this.play()}})}},{key:"_dispatchEvent",value:function(e,t){var i=document.createEvent("Event");i.initEvent(e,!0,!0),i.data=t||{},this.video.dispatchEvent(i)}},{key:"_isPlayingContent",value:function(){return this.video.videoState===x}}]),e}();try{if(window.cmTag){var B=window.cmTag.config.ms||{};B["video-element"]=B["video-element"]||{},B["video-element"]["2.0.0"]=F,window.cmTag.set("ms",B)}}catch(e){}try{window.TRC=window.TRC||{},window.TRC["video-element"]=window.TRC["video-element"]||{},window.TRC["video-element"]["2.0.0"]=F}catch(e){}}])},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(199),s=n(o),r=i(11),a=(i(8),i(140));e.exports=r.View.extend({className:"video_controls show",id:"video_controls",initialize:function(e){this.log=new a({unitType:e.unitType,className:"progressBarView"}),this.model=e.model,this.container=e.container,this.video=e.video,this._bindEvents(),this.render()},_bindEvents:function(){this.video.addEventListener("ended",this.resetProgress.bind(this)),this.model.listenTo(this.model,"change:mute",this.muteChanged.bind(this)),this.model.listenTo(this.model,"change:content.startProgressBar",this.ManageProgressBarInterval.bind(this))},render:function(){this.container.appendChild(this.el),this.$el.append(s.default),this.setControls(),this.show()},setControls:function(){this.setProgressBarComponent(),this.setPlayPauseButton(),this.setMuteButton()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},setProgressPercent:function(e){this.progressDiv.style.width=e+"%"},resetProgress:function(){this.progressDiv.classList.add("init_bg"),this.setProgressPercent(0)},playClicked:function(){this.model.set("content.playClicked",!0),this.model.set("content.pauseClicked",!1),this.pauseButton.classList.add("show"),this.pauseButton.classList.remove("hide"),this.playButton.classList.remove("show"),this.playButton.classList.add("hide")},pauseClicked:function(){this.model.set("content.pauseClicked",!0),this.playButton.classList.add("show"),this.playButton.classList.remove("hide"),this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")},muteClicked:function(){this.model.get("mute")?this.unMute():this.mute()},muteChanged:function(){this.model.get("mute")?this.setMuteClasses():this.setUnMuteClasses()},mute:function(){this.model.set("mute",!0),this.setMuteClasses()},unMute:function(){this.model.set("mute",!1),this.setUnMuteClasses()},setMuteClasses:function(){this.muteImg.style.display="block",this.unmuteImg.style.display="none"},setUnMuteClasses:function(){this.muteImg.style.display="none",this.unmuteImg.style.display="block"},setProgressBarComponent:function(){this.progressDiv=this.$el.find(".blue_bg")[0],this.progressComponentDiv=this.$el.find(".cm_video_controls_progressbar_area")[0],this.model.get("components.contentVideo.hideProgressBar")&&(this.progressComponentDiv.style.display="none"),this.resetProgress()},setMuteButton:function(){this.muteButton=this.$el.find(".cm_video_controls_mute").get(0),this.model.get("components.contentVideo.hideMuteButton")&&(this.muteButton.style.display="none"),this.muteImg=this.$el.find(".cm_video_controls_mute .display_mute").get(0),this.unmuteImg=this.$el.find(".cm_video_controls_mute .display_unmute").get(0),this.muteImg.style.backgroundImage='url("'+this.model.get("components.contentVideo.muteImgUrl")+'")',this.unmuteImg.style.backgroundImage='url("'+this.model.get("components.contentVideo.unmuteImgUrl")+'")',this.muteButton.onclick=this.muteClicked.bind(this),this.muteChanged()},setPlayPauseButton:function(){this.playButton=this.$el.find(".play")[0],this.pauseButton=this.$el.find(".pause")[0],this.pauseButton.style.backgroundImage='url("'+this.model.get("components.contentVideo.pauseImgUrl")+'")',this.model.get("components.contentVideo.hidePlayButton")&&(this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")),this.playButton.onclick=this.playClicked.bind(this),this.pauseButton.onclick=this.pauseClicked.bind(this)},ManageProgressBarInterval:function(){this.model.get("content.startProgressBar")?this.progressInterval=setInterval(this.setProgress.bind(this),100):this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)},setProgress:function(){this.setProgressPercent(this.video.currentTime/this.video.duration*100)}})},function(e,t){e.exports='<div class="video_controls video_controls_main_area"> <div class=cm_video_controls_progressbar_area> <div class="cm_video_controls_progressbar_bg white_bg"></div> <div class="cm_video_controls_progressbar blue_bg"></div> </div> <div class="cm_video_controls_mute interactive"> <div class="cm_video_controls_volume display_mute"></div> <div class="cm_video_controls_volume display_unmute"></div> </div> <div class="cm_video_controls_playpause interactive show"> <div class="pause show"></div> <div class="play hide"></div> </div> </div> '},function(e,t,i){"use strict";var n=i(11),o=i(8),s=i(10),r=i(140),a=i(191);e.exports=n.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(e){e.isActive&&(this.model=e.model,this.container=e.container,this._setInitialParameters(e),this._bindEvents(),this.render(),this._startWatchingViewPort(),this.log.info("ad-loading-progress initialize"))},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenToOnce(this.model,"change:hasReadyAd",this.close.bind(this)),this.listenTo(this.model,"change:ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(e){this.log=new r({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.globalModel=e.globalModel||this.model,this.globalModel.set("progressLoaderInit",!0),this.$el=s(this.el),this.viewPercent=this.model.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.model.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.globalModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/100,this.showProgress=this.model.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this._renderComponent(),this._show()},_initTemplate:function(){var e=o.template(a),t=e(this._settings);this.$el.append(t),this.$loadingPercentElement=s("._cm-ad-loading-progress_percent_span")},_customize:function(){var e=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(o.toCssObj(e))},_renderComponent:function(){var e={width:this.model.get("width")+"px",height:this.model.get("height")+"px"};this.$el.css(e),s(this.container).append(this.el),s("._cm-ad-loading-progress_title_span").text(this.model.get("components.adLoadingProgress.title")),this.showProgress&&s("._cm-ad-loading-progress-container").css({display:"block"})},_startWatchingViewPort:function(){this.listenTo(n,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1)),this._calculateViewPortIntersection()},_calculateViewPortIntersection:function(){var e=o.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.model.get("scrollSelector"));!this.calculationRunning&&this.viewPercent<=e&&this._startLoadingTimer(),this.calculationRunning&&!e&&this.el.getBoundingClientRect().top<0&&this._stopCalculation()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this._stopCalculation()}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationRunning=!0,this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress()}.bind(this),this.progressTik),s("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})},_stopLoadingTimer:function(){this.loadingTimer&&clearTimeout(this.loadingTimer)},_stopCalculation:function(){this.calculationRunning=!1,this.globalModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null},_calculateLoadingProgress:function(){s("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=1,this.globalModel.set("loaderCurrCount",this.count))},_restart:function(){this._stopLoadingTimer(),this.globalModel.set("progressLoaderTimerReached",!1),this.model.get("ProgressLoaderRepositioned")&&(s("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,s("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.calculationRunning=!1,this.model.set("ProgressLoaderRepositioned",!1))},_show:function(){this.$el.css({display:"flex"}),this.model.set("isProgressLoaderViewRunning",!0)},_hide:function(){this.$el.css({display:"none"})},close:function(){this.log.info("close loader"),this.model.set("isProgressLoaderViewRunning",!1),this.globalModel.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(n,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive",!1)}})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(16),a=n(r),l=i(8),d=n(l),c=i(10),u=n(c),h=function(){function e(t){o(this,e),this.model=t,this.log=new a.default({unitType:"Util",className:"AnimationUtil",version:this.model.get("version"),isDebug:this.model.get("isDebug")})}return s(e,[{key:"expand",value:function(e){return e.$el.height()>=e.height?void this.log.info("No expand needed"):void this.aniamteHeight(e)}},{key:"collapse",value:function(e){return e.$el.height()<=e.height?void this.log.info("No collapse needed"):void this.aniamteHeight(e)}},{key:"aniamteHeight",value:function(e){this.model.set("isAnimationRunning",!0);var t={transition:"height "+e.timeMS+"ms",height:e.height};setTimeout(function(){e.$el.css(t)},0),this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"aniamteOpacity",value:function(e){this.model.set("isAnimationRunning",!0);var t={transition:"opacity "+e.timeMS+"ms",opacity:e.opacity};setTimeout(function(){e.$el.css(t)},0),this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"attach",value:function(e){if(!e.$el)return void this.log.warning("Called attach without an element!");var t={top:e.target.top,left:e.target.left};if(e.isAnimated){t.width=this.model.get("videoPlaceholderSize.width")+"px",t.height=this.model.get("videoPlaceholderSize.height")+"px";var i=e.$el.offset(),n={position:"absolute",top:i.top+"px",left:i.left+"px",width:i.width+"px",height:i.height+"px"};setTimeout(function(){e.$el.css(n),d.default.flushCss(e.$el[0])},0),t.transition="all "+e.timeMS+"ms ease",t=u.default.extend(t,e.additionalCss),setTimeout(function(){e.$el.css(t)}.bind(this),1)}else t.position="absolute",t=u.default.extend(t,e.additionalCss),e.$el.css(t),setTimeout(function(){d.default.flushCss(e.$el[0])},0);this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"detach",value:function(e){var t={position:"fixed",top:"auto",bottom:"auto",left:"auto",right:"auto"};if(e.isSlideIn)t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px",t.width=0,t.height=this.model.get("detachToSlider.height")+"px";else{var i=u.default.extend({},e.$el[0].getBoundingClientRect());i.right=window.innerWidth-i.left-i.width,i.bottom=window.innerHeight-i.bottom,t[e.sliderOptions.position.horizontal]=i[e.sliderOptions.position.horizontal]+"px",t[e.sliderOptions.position.vertical]=i[e.sliderOptions.position.vertical]+"px"}var n={transition:"all "+e.timeMS+"ms ease"};n[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",n[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px",n.width=this.model.get("detachToSlider.width")+"px",n.height=this.model.get("detachToSlider.height")+"px",0!==e.timeMS?(e.$el.css(t),setTimeout(function(){e.$el.css(t),d.default.flushCss(e.$el[0])},0),setTimeout(function(){e.$el.css(n)}.bind(this),1)):(e.$el.css(t),e.$el.css(n)),this.oneAnimationEnd(e.$el,e.cb,e.timeMS+1)}},{key:"slideOut",value:function(e){var t={transition:"all "+e.timeMS+"ms linear"};e.isVerticalSlideOut?(t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t[e.sliderOptions.position.vertical]="-"+(e.sliderOptions.height+parseFloat(e.sliderOptions.position.verticalOffset))+"px"):(t[e.sliderOptions.position.horizontal]="-"+(e.sliderOptions.width+parseFloat(e.sliderOptions.position.horizontalOffset))+"px",t[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px"),setTimeout(function(){e.$el.css(t)}.bind(this),0),this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"oneAnimationEnd",value:function(e,t,i){setTimeout(function(){this.model.set("isAnimationRunning",!1),e.css("transition","none"),t&&t()}.bind(this),i)}},{key:"PrefixedEvent",value:function(e,t,i,n){var o=["webkit","moz","MS","o",""];i=i.toLowerCase(),d.default.each(o,function(o){e[t](o+i,n)})}}]),e}(),p=function(){var e=void 0;return function(t){return e||(e=new h(t)),e}}();e.exports=p},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(12),c=i(10),u=o(c),h=i(8),p=o(h),f=i(16),m=o(f),g=i(203),v=o(g),y=i(155),b=i(25),_=o(b),w=i(21),T=n(w),A="_cm-native-ad",S={title:"._cm-native-ad-title",ctaButtone:"._cm-native-ad-cta-button",description:"._cm-native-ad-description",icon:"._cm-native-ad-icon",branding:"._cm-native-ad-branding",adChoice:"._cm-ad-choice",placeholder:"._cm-feed-manager-video-placeHolder",wrapper:"._cm-native-ad-bottom"},P=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e.model,i.globalModel=e.globalModel,i.log=new m.default({unitType:i.model.get("unitType"),className:constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.template=v.default,i.container=(0,u.default)(e.container),i.nativeAdMapping=i.globalModel.get("nativeAdMapping"),i.bindEvents(),i}return a(t,e),l(t,[{key:"_render",value:function(){this.renderTemplate(),this._adjustRTL(),this.$el.addClass(A),this.container.append(this.$el),this._addAdChoiceTitle(),this.rendered=!0}},{key:"_adjustRTL",value:function(){var e=this._getCssFromSelector(this.model.get("rboxCssSelectors.title")),t=e&&"rtl"===e.direction;t&&(this.ui.wrapper.css({"flex-direction":"row-reverse",direction:"ltr"}),this.ui.icon.addClass("_cm-native-ad-icon-rtl").removeClass("_cm-native-ad-icon"))}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"adNativeSettings",funcName:"_updateAdData"},{event:"repeatState:"+T.repeatState.showing,funcName:"hide"},{event:"repeatState:"+T.repeatState.hiding,funcName:"show"},{event:"loadingViewState:"+T.loadingViewState.showing,funcName:"hide"},{event:"loadingViewState:"+T.loadingViewState.hiding,funcName:"show"}])}},{key:"_updateAdData",value:function(){this.rendered||this._render(),this.adNativeSettings=this.model.get("adNativeSettings"),this.isClickable=this.adNativeSettings.isClickable,this._updateContainerViewTitleVisibility(),this._updateTitleContainerEl(this.ui.title,this.adNativeSettings[this.nativeAdMapping.title],this.model.get("rboxCssSelectors.title"),this.model.get("customization.title")),this._updateTitleContainerEl(this.ui.ctaButtone,this.adNativeSettings[this.nativeAdMapping.ctaButtone],"",this.model.get("customization.cta")),this._updateTitleContainerEl(this.ui.description,this.adNativeSettings[this.nativeAdMapping.description],this.model.get("rboxCssSelectors.description"),this.model.get("customization.description")),this._updateTitleContainerEl(this.ui.branding,this.adNativeSettings[this.nativeAdMapping.branding],this.model.get("rboxCssSelectors.branding"),this.model.get("customization.branding")),this._updateIcon(this.adNativeSettings[this.nativeAdMapping.icon]),this.show()}},{key:"_updateContainerViewTitleVisibility",value:function(){var e=this.adNativeSettings.title||this.adNativeSettings.ctatext||this.adNativeSettings.desc||this.adNativeSettings.sponsored,t=this.container.find("._cm-ad-title");e?(t.hide(),this.ui.adChoice.show()):(t.show(),this.ui.adChoice.hide())}},{key:"_updateTitleContainerEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments[2],n=arguments[3];if(e.text(t),t)this._applyCssFromSelector(e,i,n),e.show();else{var o=e===this.ui.ctaButtone;o&&e.hide()}this._updateTitleContainerClickability(e)}},{key:"_applyCssFromSelector",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=p.default.pick(this._getCssFromSelector(t),_.default.CSS_PROPERTIES_FROM_RBOX);p.default.extend(n,i),e.css(p.default.toCssObj(n))}},{key:"_getCssFromSelector",value:function(e){if(!e)return{};var t=document.querySelector(e);return t&&getComputedStyle(document.querySelector(e))}},{key:"_updateTitleContainerClickability",value:function(e){this.isClickable?(e[0].onclick=this._onClick.bind(this),e.css({cursor:"pointer"}),e.attr("role","link")):(e[0].onclick=null,e.css({cursor:"default"}),e.removeAttr("role"))}},{key:"_onClick",value:function(e){var t=e.target.getAttribute("data-click-name");this.model.set("nativeAdClick",t,{silent:!0}),this.model.trigger("change:nativeAdClick",t)}},{key:"_updateIcon",value:function(e){return e?(this.iconImg||this._createIconImg(),this.iconImg.src=e,this._updateTitleContainerClickability(this.ui.icon),void this.ui.icon.show()):void this.ui.icon.hide()}},{key:"_createIconImg",value:function(){this.iconImg=document.createElement("img"),this.iconImg.className="_cm-native-ad-icon-img",this.iconImg.setAttribute("data-click-name","adIconClick"),this.iconImg.addEventListener("error",this._onError.bind(this)),this.ui.icon.css(p.default.toCssObj(p.default.extend({},this.model.get("customization.icon")))),this.ui.icon.append(this.iconImg)}},{key:"_onError",value:function(){this.log.error("can't load native ad icon"),this.ui.icon.hide()}},{key:"_addAdChoiceTitle",value:function(){this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.title.isActive")&&(this.adChoice=new y.AdChoiceView({model:this.model,container:this.ui.adChoice,parent:this.el,type:_.default.AD_CHOICE_TYPE.TITLE}))}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this.$el.show()}},{key:"className",get:function(){return A}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=S},set:function(e){return this.UI=e}}]),t}(d.StateManagerView);e.exports=P},function(e,t){e.exports="<div class=_cm-native-ad-bottom> <div class=_cm-native-ad-title data-click-name=adTitleClick></div> <div class=_cm-native-ad-cta-wrapper> <div class=_cm-native-ad-cta-button data-click-name=adCtaButtonClick></div> </div> <div class=_cm-native-ad-description data-click-name=adDescriptionClick></div> <div class=_cm-native-ad-icon> </div> <div class=_cm-native-ad-branding data-click-name=adBrandingClick></div> <div class=_cm-ad-choice></div> </div>"},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(10),h=o(u),p=i(21),f=n(p),m=i(205),g=o(m),v=i(11),y=(o(v),i(166)),b=o(y),_=i(177),w=o(_),T=i(155),A=i(6),S=i(25),P=n(S),C=i(26),E=o(C),k=i(71),I=n(k),O=function(e){function t(e,i,n){s(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"SubVideoViewDetachable",n));if(o.subUnitId=o.model.get("subUnitId"),o.isFirstAd=!0,o.cardNumber=o.model.get("cardNumber"),o.ua=I.UAParser(window.navigator.userAgent),o.globalModel=n,o.container=(0,h.default)(o.model.get("videoContainerSelector")||"body")[0],o.animationTimeOut=null,o.sliderOptions=o.model.get("detachToSlider"),o.detachOptions=o.model.get("detachToSlider"),o.isDetachActive=o.model.get("detachToSlider.isStartFromSlider")||o.model.get("detachToSlider.isDetachToSlider"),o.isDetachedHasCloseButton=o.isDetachActive&&o.model.get("detachToSlider.hasCloseButton"),o.isAttachedHasCloseButton=o.model.get("hasCloseButton"),o.isFirstDetach=!0,o.isDetached=!1,o.isFistImpression=!0,o.isGotImpression=!0,o.attachedOnceToNewCard=!1,o.closeButtonDelayd=!1,o.scrollManager=new E.default,o._setAd(i),o.model.get("detachToSlider.isStartFromSlider")){var a=o.model.get("width"),l=o.model.get("detachToSlider.liquidSize.isActive")?o._calcLiquidWidth():o.model.get("detachToSlider.width");a>l&&(o.model.set("width",l),o.model.set("height",c.default.getVideoHeight(l)))}else o.isFirstDetach=!1;o.render(),o.feedPlayerSize={width:o.model.get("width"),height:o.model.get("height")},o.isClosedByButton=!1,o.isAnimateOnOpen=o.model.get("animation.onTransitionOpen"),o.isAnimateOnClose=o.model.get("isAnimateOnClose")||o.model.get("animation.onTransitionClose")&&"close"===o.model.get("onTimerClose"),o.animationCss={transition:"all 500ms ease-in-out"},o.animationCssFirstSlide={transition:"all 1s ease"},o.openCloseAmnimation={transition:"height "+o.model.get("animation.transitionAnimationTime")+"ms"},o.noAmnimationCss={transition:"none"},o.animationStartEndPoint={height:"0"};var d={startCondition:{stateToListen:"",state:""}},u=o.model.get("isPlacementSingleAd")?0:1e3*o.model.get("secondsToCloseFeed");return o.getAdTimer=new A.Timer(o.model,d,o.onLocalTimerEnd.bind(o,"midrollCollapse subUnit"),u),o.contentTimer=new A.Timer(o.model,d,o.onLocalTimerEnd.bind(o,"Content tiemr subUnit"),1e3*o.model.get("contentTimerSeconds")),o.sliderOptions.isStartFormSlider||"rendered"!==o.model.get("containerViewState")||(o.checkEligible(),o.containerViewStateRendered()),o._bindSubViewEvents(),o.sliderOptions.isStartFromSlider&&o.onUnitStart(),o.adCompleted=!1,o._addUIComponents(),o._addContentView(),o}return a(t,e),
l(t,[{key:"_setAd",value:function(e){this.isFirstAd?this._switchFromActiveAd("set ad first ad switch"):this.isFirstAd=!1,this.el=e.vpaidWrapper.adTarget,this.model.get("isReplayAd")&&e.vpaidWrapper.isReplayable&&e.vpaidWrapper.dontDie&&e.vpaidWrapper.dontDie(),this.$el=(0,h.default)(this.el),this.globalModel.get("volumeMuted")||"iOS"!==this.ua.os.name||this.globalModel.set("volumeMuted",!0),this._setAdBase(e)}},{key:"_switchToActiveAd",value:function(e){this.$el.removeClass("_cm-ad"),this.$el.addClass("_cm-ad-active"),this.log.warning("switchToActiveAd",this.cardNumber)}},{key:"_switchFromActiveAd",value:function(e){this.isDetached&&(this.log.warning("switchFromActiveAd",this.cardNumber),this.$el.addClass("_cm-ad"),this.$el.removeClass("_cm-ad-active")),this.repeatingAd&&this.repeatingAd.vpaidWrapper&&(0,h.default)(this.repeatingAd.vpaidWrapper.adTarget).css({display:"none !important"})}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"onVideoPlaceholderSizeChange",withBind:!1},{event:"videoPlaceholderPosition",funcName:"setVideoPlaceholderPosition",withBind:!1},{event:"containerViewState:rendered",funcName:"containerViewStateRendered"},{event:"isEligibleToPlay",funcName:"isEligibleToPlayChange"},{event:"isInTab",funcName:"isInTabChange"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"adQState:completed",funcName:"onAdComplete"},{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"learnMoreWasClicked",funcName:"_onLearnMoreClick"}])}},{key:"_bindSubViewEvents",value:function(){this.isDetachActive&&this.model.get("detachToSlider").liquidSize.isActive&&(0,h.default)(window).on("resize",this._onResize.bind(this))}},{key:"_onResize",value:function(){if(this.isDetached){var e=this.getDetachPositionAndSize().size;this._resize(this.model,e),this.model.trigger("change:videoViewSize",e)}}},{key:"onVideoPlaceholderSizeChange",value:function(){this.currentSize=null,this.setVideoPlaceholderSize()}},{key:"setVideoPlaceholderSize",value:function(){var e=this.model.get("videoPlaceholderSize");this.isDetached||this._resize(arguments[0],e)}},{key:"setVideoPlaceholderPosition",value:function(){if(!this.isDetached){var e=this.model.get("videoPlaceholderPosition");this._rePosition(this.model,{top:e.top,left:e.left}),this.repeatingAd&&this.$el!==(0,h.default)(this.repeatingAd.vpaidWrapper.adTarget)&&(0,h.default)(this.repeatingAd.vpaidWrapper.adTarget).css(arguments[1])}}},{key:"render",value:function(){this._customize(),this.$el.css({width:this.model.get("width")}),this.$el.addClass("_cm-video-with-slider"),this.model.set("targetId",this.videoAdId),this.model.set("videoViewState",f.videoViewState.rendered),this._addDisclosureText(),this.log.info("new video view is renderd. subUnitId="+this.subUnitId)}},{key:"containerViewStateRendered",value:function(){this.model.get("detachToSlider.isStartFromSlider")||this.attach()}},{key:"cleanAnimation",value:function(e){setTimeout(function(){this.$el.css({transition:""})}.bind(this),e)}},{key:"isInTabChange",value:function(){this.model.get("isInTab")&&this.model.get("videoViewState")===f.videoViewState.attached&&(this.$el.css({position:"absolute"}),this.isFirstDetach=!1),this.model.get("isInTab")&&!this.model.get("isEligibleToPlay")&&this.model.get("videoViewState")===f.videoViewState.rendered&&this.isEligibleToPlayChange(),this.activeAd&&this.activeAd.vpaidWrapper&&this.model.get("isInTab")&&c.default.forceElementRedrawWithBorderChange(this.activeAd.vpaidWrapper.adTarget)}},{key:"attach",value:function(){this.sliderOptions.isStartFromSlider||this.attachedOnceToNewCard?this._attachFromSlider():(this.attachedOnceToNewCard=!0,this._attachNewCard()),this._closeButtonHide(),this.globalModel.get("isSliderOn")&&!this.model.get("detachToSlider.isDetachToSlider")&&this.globalModel.set("isSliderOn",!1)}},{key:"_attachNewCard",value:function(){this.log.info("attaching new card to placeholder:",this.subUnitId),this._attachToCard(),this.model.set("videoViewState",f.videoViewState.attached),this.isAnimateOnOpen&&this._runAnimation(!0,null),setTimeout(function(){!this.model.get("isEligibleToPlay")&&this.model.get("detachToSlider.isDetachToSlider")&&this.model.get("videoViewState")!==f.videoViewState.detached&&(this.log.info("gotad _attachNewCard fix detach"),this.isEligibleToPlayChange(),this.checkEligible())}.bind(this),300)}},{key:"_runAnimation",value:function(e,t){this.isAnimatioRunning=!0,e?(this.$el.css(this.animationStartEndPoint),this.$el.css(this.openCloseAmnimation),setTimeout(function(){this.currentSize=null,this._resize(this.model,this.model.get("videoPlaceholderSize"))}.bind(this),100),setTimeout(function(){this._removeAnimation()}.bind(this),this.model.get("animation.transitionAnimationTime")+100)):(this.$el.css(this.openCloseAmnimation),setTimeout(function(){this.$el.css(this.animationStartEndPoint)}.bind(this),100),setTimeout(function(){this._removeAnimation(),this.$el.hide()}.bind(this),this.model.get("animation.transitionAnimationTime")+100)),t&&t()}},{key:"_removeAnimation",value:function(){this.$el.css(this.noAmnimationCss)}},{key:"_attachToCard",value:function(){this.currentSize=null,this._rePosition(this.model,this.model.get("videoPlaceholderPosition")),this._resize(this.model,this.model.get("videoPlaceholderSize")),this.$el.css(this.model.get("videoPlaceholderSize")),this.$el.css(this.model.get("additionalCss")),this.log.info("done attaching",this.$el),this._closeButtonHide()}},{key:"_attachFromSlider",value:function(){clearTimeout(this.animationTimeOut),this.log.info("attaching slider to placeholder",this.subUnitId);var e=this.$el.offset();this.cleanStyle();var t={position:"absolute",width:e.width+"px",height:e.height+"px"};h.default.extend(t,this.model.get("additionalCss")),this.$el.css(t),this._rePosition(this.model,{top:e.top+"px",left:e.left+"px"}),this.isFirstDetach=!1,this.animationTimeOut=setTimeout(this.postAttach.bind(this),100)}},{key:"postAttach",value:function(){this.model.get("detachToSlider").animation&&this.$el.css(this.animationCss);var e=this.model.get("videoPlaceholderSize");this._rePosition(this.model,this.model.get("videoPlaceholderPosition")),this._resize(this.model,e),this.model.set("videoViewState",f.videoViewState.attached),this.model.trigger("change:videoViewSize",this.model.get("videoPlaceholderSize")),this.isDetached=!1,this.cleanAnimation(500),this.isAttachedHasCloseButton&&setTimeout(this._closeButtonShow.bind(this),500)}},{key:"detach",value:function(){if(!this.isDetached){clearTimeout(this.animationTimeOut),this.log.info("detaching to placeholder"),this.isDetached=!0,this.model.set("videoViewState",f.videoViewState.detached);var e={},t={};this._closeButtonHide(),this.isFirstDetach?(e={position:"fixed"},t[this.model.get("detachToSlider").position.horizontal]="-"+(this.model.get("detachToSlider").width+this.model.get("detachToSlider").position.horizontalOffset)+"px",t[this.model.get("detachToSlider").position.vertical]=this.model.get("detachToSlider").position.verticalOffset+"px",e.width=0,e.height=c.default.getVideoHeight(this.model.get("detachToSlider").width)+"px"):(this.cleanStyle(),t=this._getFixedPositionCss(),e.width=this.model.get("videoPlaceholderSize").width+"px",e.height=this.model.get("videoPlaceholderSize").height+"px"),h.default.extend(e,this.model.get("additionalCss")),this.$el.css(e),this._rePosition(this.model,t),this.animationTimeOut=setTimeout(this.postDetach.bind(this),100)}}},{key:"_getFixedPositionCss",value:function(){var e=h.default.extend({},this.$el[0].getBoundingClientRect());e.right=window.innerWidth-e.left-e.width,e.bottom=window.innerHeight-e.bottom;var t={position:"fixed",top:"auto",bottom:"auto",left:"auto",right:"auto"};return t[this.model.get("detachToSlider").position.horizontal]=e[this.model.get("detachToSlider").position.horizontal]+"px",t[this.model.get("detachToSlider").position.vertical]=e[this.model.get("detachToSlider").position.vertical]+"px",t}},{key:"postDetach",value:function(){var e=500;this.$el.css({position:"fixed"}),this.model.get("detachToSlider").animation&&this.isFirstDetach===!1&&this.$el.css(this.animationCss),this.isFirstDetach===!0&&(this.isFirstDetach=!1,this.$el.css(this.animationCssFirstSlide),e=1200);var t=this.getDetachPositionAndSize();this._resize(this.model,t.size),this._rePosition(this.model,t.position),this.model.trigger("change:videoViewSize",t.size),c.default.isEmpty(this.model.get("detachToSlider").customCss)||this.$el.css(JSON.parse(this.model.get("detachToSlider").customCss)),this.cleanAnimation(e),this._updateCloseButtonContainer(),setTimeout(this._closeButtonShow.bind(this),e)}},{key:"cleanStyle",value:function(){this.$el.removeAttr("style")}},{key:"onUnitStart",value:function(){this.log.warning("onAdImpression isEligibleToPlay",this.model.get("isEligibleToPlay")),this.isGotImpression=!0;var e=this.detachOptions.isStartFromSlider&&this.detachOptions.isDetachToSlider;this.model.get("isEligibleToPlay")&&!e&&(this.isFirstDetach=!1,this.detachOptions.isStartFromSlider=!1,this.attach()),(!this.model.get("isEligibleToPlay")||e)&&this.model.get("detachToSlider").isStartFromSlider&&this.isFistImpression&&(this.isFistImpression=!1,this.model.get("isInTab")&&(this._playAd(),this.detach()))}},{key:"isEligibleToPlayChange",value:function(){if(this.isGotImpression)return this.model.get("isEligibleToPlay")&&this.isAdClosedByTimer&&this.isAnimateOnClose?(this.model.set("isAdClosedByTimer",!0),void this._runCloseAnimation()):void(!this.model.get("isEligibleToPlay")||this.model.get("videoViewState")!==f.videoViewState.detached||!this.model.get("renderWasCalled")||this.sliderOptions.isStartFromSlider&&this.sliderOptions.isDetachToSlider?!this.model.get("isEligibleToPlay")&&(this.model.get("videoViewState")===f.videoViewState.attached||this.model.get("videoViewState")===f.videoViewState.rendered)&&this.isDetachActive&&this.model.get("detachToSlider.isDetachToSlider")&&this.model.get("isInTab")&&"string"==typeof this.model.get("adState")&&this._isDetachAvailable()&&this.detach():this.attach())}},{key:"_isDetachAvailable",value:function(){var e=this.el.getBoundingClientRect().top;return e>0?this.model.get("detachToSlider.isDetachAbove"):this.model.get("detachToSlider.isDetachBelow")}},{key:"close",value:function(){this.log.info("close"),this.permanentAttach(),this.$el.height(0),setTimeout(function(){this.permanentClose()}.bind(this),1500)}},{key:"permanentClose",value:function(){this.log.info("permanentClose"),this.activeAd?(this.activeAd.pause(),this.activeAd=void 0):this.$el.remove(),this.terminateContent()}},{key:"checkAndClose",value:function(e){return!(this.isDetached||!this.isEligibleToPlay()||!this.isAnimateOnClose||this.model.get("isPlacementSingleAd"))&&(this._runCloseAnimation(),this.log.info("Close because of: ",e),!0)}},{key:"closeAndRemove",value:function(){this.$el&&(this.activeAd&&this.activeAd.pause(),this.$el.remove(),this._closeLoadingView(),this._closeButtonHide(),this.isDetached=!1,this.close(),this.globalModel.set("isSliderClosed",!1))}},{key:"permanentAttach",value:function(){var e=this.isDetached;this.$el.css(this.animationCss),this._closeButtonHide(),this.model.set("detachToSlider.isDetachToSlider",!1),this.globalModel.set("isSliderOn",!1),e&&this._permanentAttachAnimation(),this.globalModel.set("isSliderClosed",!0),this.terminateContent()}},{key:"_permanentAttachAnimation",value:function(){this.isAnimatioRunning=!0,setTimeout(function(){this.$el.css({width:"1px"})}.bind(this),100),setTimeout(function(){this.isAnimatioRunning=!1,this.$el.css({transition:""}),this._rePosition(this.model,this._getPositionResetCSS()),this.$el.css({position:"absolute"}),this.$el.css(this.model.get("additionalCss")),this._rePosition(this.model,this.model.get("videoPlaceholderPosition"));var e=this.model.get("videoPlaceholderSize");e||(e={width:1,height:1}),this.isDetached=!1,this.isDetachActive=!1,this._resize(this.model,e),this.model.set("videoViewState",f.videoViewState.attached),this.checkEligible(),this.model.get("isSuperSlider")&&(this.model.set("isSuperSliderClosed",!0),this.globalModel.set("isSuperSliderClosed",!0),this._updateSubAdsEligibilityStatus(!1)),this.model.set("isPermanentAttachAnimationDone",!0)}.bind(this),600)}},{key:"_onStateChange",value:function(e,t){t===e.STATE.STOPPED_BY_USER&&this.close()}},{key:"_calcLiquidWidth",value:function(){var e=this.model.get("detachToSlider").liquidSize.minWidth,t=this.model.get("detachToSlider").liquidSize.maxWidth,i=window.innerWidth*(this.model.get("detachToSlider").liquidSize.widthPercent/100);return t&&i>t&&(i=t),i<e&&(i=e),i}},{key:"getDetachPositionAndSize",value:function(e){var t=Math.floor(this.model.get("detachToSlider").liquidSize.isActive?this._calcLiquidWidth():this.model.get("detachToSlider").width),i=c.default.getVideoHeight(t),n={position:this._getPositionResetCSS(),size:{width:t,height:i}};return n.position[this.model.get("detachToSlider").position.horizontal]=this.model.get("detachToSlider").position.horizontalOffset+"px",n.position[this.model.get("detachToSlider").position.vertical]=this.model.get("detachToSlider").position.verticalOffset+"px",n}},{key:"_resize",value:function(e,t){this.currentSize&&this.currentSize.width===t.width&&this.currentSize.height===t.height||(this.log.info("_resize sizeObj: ",t),this.$el.css(t),this.activeAd&&this.activeAd.vpaidWrapper?this.activeAd.resize(t):this.repeatingAd&&this.repeatingAd.vpaidWrapper&&this.repeatingAd.resize(t),this.currentSize=t)}},{key:"onTimerEnd",value:function(e){if(this.log.info("SubVideo midroll:",e),!this.isContentViewActive()){this.ad$el&&this.ad$el.height(0),this.activeAd=void 0,this.ad$el=void 0,this._startLoadingView();var t=this.checkAndClose(e);t&&(this.isAdClosedByTimer=!0),this.permanentAttach(),this.isViewed=!1}}},{key:"onLocalTimerEnd",value:function(e){this.log.info("SubUnit onLocalTimerEnd card number: ",this.model.get("cardNumber")),this.isRepeateMode=!this.isReplayMode,this.isDetached?(this.createStateHandlers([{event:"isPermanentAttachAnimationDone",funcName:"_showRepeat",isListenOnce:!0}]),this.permanentAttach()):this._showRepeat(),this.isSkipCollapse?this.isSkipCollapse=!1:this.checkAndClose("LocalTimerEnd: "+e)}},{key:"_runCloseAnimation",value:function(){this.model.set("isAdClosedByTimer",!0),this._runAnimation(!1,null)}},{key:"onAdComplete",value:function(){return this.model.get("isReplayAd")&&(this.repeatingAd=this.activeAd,this.isReplayMode=!1),this.model.get("isCardBelongToTempAd")&&this.onConditionComplete(),this.activeAd=void 0,this.ad$el=void 0,this._handleMidroll(),this.model.get("isMultiAd")?(this.isViewed=!1,void this.checkEligible()):(this.permanentAttach(),void this.checkAndClose("Single Ad Complete"))}},{key:"isEligibleToPlay",value:function(){return this.model.get("isInTab")?!!this.model.get("isEligibleToPlay")||this.model.get("videoViewState")===f.videoViewState.detached:this.model.get("videoViewState")===f.videoViewState.detached&&"play"===this.model.get("detachToSlider").onOutOfView}},{key:"checkEligible",value:function(){if(!this.isRepeateMode){var e=this.isEligibleToPlay();this._setCardId(),e?(this.activeAd||(this.getReadyAd(),this.loadingView&&this.loadingView.show()),this.activeAd&&(this.loadingView&&this.loadingView.hide(),this.log.info("Play Ad sub unit: "+this.subUnitId+" ad:"+this.activeAd.adId),this._playAd(),this._stopLocalTimers())):this.activeAd&&(this.log.info("Pause Ad sub unit: "+this.subUnitId+" ad:"+this.activeAd.adId),this.activeAd.pause(),this._clearViewabilityTime());!e&&this.isFirstDetach&&(e=!0),this._updateSubAdsEligibilityStatus(e)}}},{key:"hasRedyAdChangeSubUnit",value:function(){this.log.info("hasRedyAdChangeSubUnit",this.globalModel.get("hasReadyAd")),!this.isRepeateMode&&this.globalModel.get("hasReadyAd")&&this.isEligibleToPlay()&&this.getReadyAd()}},{key:"_setCardId",value:function(){this.isDetached?this.model.set("cardNumber",this.cardNumber*-1):this.model.set("cardNumber",this.cardNumber)}},{key:"getReadyAd",value:function(e){if(this.globalModel.get("hasReadyAd")&&!this.model.get("isPlacementSingleAd")){var t=this.globalModel.getNextAd();if(!t)return;this.globalModel.get("lastAdID")||this.globalModel.set("lastAdID",t.adId),this.log.info("Video View Got new ad of type : "+parseInt(t.adData.requiredViewability?"1":"0"),t),this._switchFromActiveAd("getReadyAd"),this.oldAdUi=this.$el;this.activeAd;this._setAd(t),this.activeAd.setSubModel(this.model),this.isDetached?this._resetElDetached():this._attachToCard(),this.checkEligible()}else this.log.warning("Could not find ad"),this.watingForAd=!0,this.globalModel.once("change:hasReadyAd",this.hasRedyAdChangeSubUnit.bind(this))}},{key:"_onViewability",value:function(){this.isViewed=!0,this.viewabilityTimer=void 0,this.activeAd&&this.activeAd.onViewability(),this.log.info("!!@ _onViewability",this.model.get("tempAdCondition")),"viewability"===this.model.get("tempAdCondition")&&this.onConditionComplete()}},{key:"_startLoadingView",value:function(e){this.$el.hasClass("_cm-loading")||(this.loadingView=new b.default({model:this.model,container:this.container,globalModel:this.globalModel,isStartWithReplay:this.model.get("isPlacementSingleAd")&&!this.isDetached,isReplayable:this.model.get("isReplayable")}),this._switchFromActiveAd("_startLoadingView"),this.el=this.loadingView.el,this.$el=this.loadingView.$el,this.currentSize=null,this.isDetached?this._resetElDetached():this._attachToCard()),this.loadingView.show(),this.isEligibleToPlay()||(this.isSkipCollapse=!0),e||this.getAdTimer.start(this.model,"")}},{key:"_startRepeatView",value:function(){this.repeatView=new w.default({model:this.model,container:this.container,globalModel:this.globalModel}),this._switchFromActiveAd("_startRepeatView"),this.el=this.repeatView.el,this.$el=this.repeatView.$el,this._updateCloseButtonContainer(),this.isDetached?this._resetElDetached():this._attachToCard(),this.repeatView.show()}},{key:"_resetElDetached",value:function(){this.currentSize=null;var e=this.getDetachPositionAndSize();this.$el.css("position","fixed"),this._resize(this.model,e.size),this._rePosition(this.model,e.position),this.model.trigger("change:videoViewSize",e.size),c.default.isEmpty(this.model.get("detachToSlider").customCss)||this.$el.css(JSON.parse(this.model.get("detachToSlider").customCss))}},{key:"_closeLoadingView",value:function(){this.loadingView&&(this.log.info("loading view closed"),this.loadingView.hide(),this.loadingView.remove(),this.loadingView=void 0)}},{key:"_addCloseButton",value:function(){this.closeButtonView||!this.isDetachedHasCloseButton&&!this.isAttachedHasCloseButton||(this.log.info("Creating Close Button"),c.default.parseBool(this.model.get("closeButton.hasCloseButton"))===!0&&(this.closeButtonView=new T.SubFeedCloseButtonView({model:this.model,container:this.el})))}},{key:"_renderCloseButton",value:function(){if(this.closeButtonDelayd)this.closeButtonView.render(),this.closeButtonView.show();else{this.closeButtonDelayd=!0;var e=this.model.get("components.CloseButtonView.delay");setTimeout(this._renderCloseButton.bind(this),e)}}},{key:"_updateCloseButtonContainer",value:function(){this.closeButtonView&&(0,h.default)(this.closeButtonView.el).appendTo(this.$el)}},{key:"_closeButtonShow",value:function(){this.closeButtonView&&(this.isAttachedHasCloseButton||this.model.get("videoViewState")===f.videoViewState.detached)&&this.closeButtonView.show()}},{key:"_closeButtonHide",value:function(){this.closeButtonView&&this.closeButtonView.hide()}},{key:"_onLoadingClick",value:function(){this.isReplayMode||(this.model.get("isReplayAd")&&this.repeatingAd&&this.repeatingAd.vpaidWrapper.isReplayable?this._setRepeatingAd():this.getAdTimer.start(this.model,"")),this.model.set("isAdClosedByTimer",!1),this.model.set("closeTimer",void 0),this.isRepeateMode=!1,this.globalModel.once("change:hasReadyAd",this.hasRedyAdChangeSubUnit.bind(this))}},{key:"_setRepeatingAd",value:function(){var e=this.repeatingAd;this.isReplayMode=!0,this.el=e.vpaidWrapper.adTarget,this.$el=(0,h.default)(this.el),this.$el.css({position:"absolute"}),this.$el.css({display:"block !important"}),this._setAdBase(e),this.isDetached?this._resetElDetached():this._attachToCard(),e.vpaidWrapper.restartAd(),this.log.info("replaying ad "+e.adId),e.setToModel("adQState",f.adQState.repeating,e.adId),e.setToModel("adState",f.adState.repeating,e.adId)}},{key:"_setAdBase",value:function(e){this.$el.attr("data-adId",e.adId),this.activeAd=e,this.ad$el=this.$el,this._updateCloseButtonContainer(),this._updateDisclosureTextContainer(),this._updateAdChoiceContainer(),this._updateVolumeButton(),this.$el.addClass("_cm-video"),this._switchToActiveAd("set ad"),this.$el.addClass("_cm-sub-unit-id-"+this.subUnitId),this._setVolumeEvents(),this.model.set("videoViewContainer",this.$el),this.model.get("isCardBelongToTempAd")&&this.activeAd.onCardSwap(),this._closeLoadingView(),this.isDetached&&e.vpaidWrapper.nonVideoVpaid&&this.permanentAttach()}},{key:"_updateDisclosureTextContainer",value:function(){this.disclosureTextView&&this.disclosureTextView.$el.appendTo(this.$el)}},{key:"_updateAdChoiceContainer",value:function(){this.adChoiceArr&&this.adChoiceArr.length>0&&this.adChoiceArr.forEach(function(e){e.$el.appendTo(this.$el)}.bind(this))}},{key:"_getPositionResetCSS",value:function(){return{top:"auto",bottom:"auto",left:"auto",right:"auto"}}},{key:"createBasicAdDataObj",value:function(e){var t=e.adData,i={adId:e.adId,requiredViewability:t.requiredViewability,playerSequenceId:t.sequenceId,dp:t.dp.toString()};return i}},{key:"createNewAdData",value:function(e,t){var i={newAd:this.createBasicAdDataObj(e)},n=(0,h.default)(this.model.get("scrollSelector"))[0],o=void 0!=n,s=o?n.clientHeight:window.innerHeight,r=o?s+n.scrollTop:s+window.pageYOffset,a=this.model.get("parentSelector");a=c.default.isArray(a)?a[0]:a,a=(0,h.default)(a)[0];var l=c.default.getTopOfEl(a);return i.newAd.isEligible=this.model.get("isEligibleToPlay"),i.newAd.hadEligibility=this.model.get("hadEligibility"),i.newAd.hadLostEligibility=!!this.model.get("lostEligibilityTime"),i.newAd.topParentSelector=l,i.newAd.bottomViewPort=r,i.adId=t,i}},{key:"createOldAdData",value:function(e,t){return{oldAd:this.createBasicAdDataObj(e),adId:t}}},{key:"_addAdChoice",value:function(){var e=this.model.get("components.adChoice");e.isActive&&(e.videoAd.isActive&&!this.isDetachActive?this._initVideoViewAdChoice():this._initAdChoiceDetachable())}},{key:"_initVideoViewAdChoice",value:function(){this.adChoiceArr=[],this.adChoice=new T.AdChoiceView({model:this.model,container:this.el,type:P.AD_CHOICE_TYPE.VIDEO_AD}),this.adChoiceArr.push(this.adChoice)}},{key:"_initAdChoiceDetachable",value:function(){this.adChoiceArr=[],this.model.get("components.adChoice.videoAd.isActive")&&(this.adChoiceVideoAd=new T.AdChoiceView({model:this.model,container:this.el,type:P.AD_CHOICE_TYPE.VIDEO_AD}),this.adChoiceArr.push(this.adChoiceVideoAd)),this.model.get("components.adChoice.slider.isActive")&&(this.adChoiceSlider=new T.AdChoiceView({model:this.model,container:this.el,type:P.AD_CHOICE_TYPE.SLIDER}),this.adChoiceArr.push(this.adChoiceSlider))}},{key:"_rePosition",value:function(e,t){if(t.top){if(!this.isDetached&&t.top<=this.model.get("minTopForVideo")&&t.left<=this.model.get("minLeftForVideo"))return this.globalModel.set("top0Left0",!0),void this.globalModel.set("topParentSelectorLost",!0);if(this.model.get("isPlayerOutOfViewport")&&t.top&&this.activeAd){t.top-this.globalModel.get("topOffsetPosition");this.activeAd.vpaidWrapper.adTarget.parentElement.style.top="-"+this.globalModel.get("topOffsetPosition")+"px"}this.$el.css(t)}}},{key:"_playAd",value:function(){this.model.get("isToggleIframeContent")&&this.activeAd.vpaidWrapper.toggleIframeContentDisplay&&this.activeAd.vpaidWrapper.toggleIframeContentDisplay("show"),this.playAd()}},{key:"_updateSubAdsEligibilityStatus",value:function(e){e?this.globalModel.set("lastCardOutOfViewport",void 0):this.globalModel.set("lastCardOutOfViewport",this.model.get("subUnitId")),this.globalModel.set("subAdsEligibility."+this.model.get("subAdId"),e)}},{key:"injectAd",value:function(e,t){this.model.set("isCardBelongToTempAd",!0),this.model.set("tempActiveAdCondition",t),e.setSubModel(this.model),this._setAd(e),this.$el.height(this.model.get("videoPlaceholderSize.height")),this._rePosition(this.model,this.model.get("videoPlaceholderPosition")),this.isEligibleToPlay(),this.log.info("is Viewability fired",e.isViewabilityFired)}},{key:"extractAd",value:function(e){this.model.set("isCardBelongToTempAd",!0),this.model.set("tempAdCondition",e),this.ad$el&&this.ad$el.css("height","0"),this._removeAnimation(),this.activeAd=void 0,this.ad$el=void 0,this._startLoadingView(!0),this._clearViewabilityTime()}},{key:"onConditionComplete",value:function(){this.model.set("isCardBelongToTempAd",!1),this.model.set("tempAdCondition",!1),this.listeningToCondition=!1,this.globalModel.set("temAdCondition",!0)}},{key:"onTempAdEnd",value:function(){this.log.info("@!! onTempAdEnd subUnitId: ",this.subUnitId),this.log.info("@!! onTempAdEnd isCardBelongToTempAd: ",this.model.get("isCardBelongToTempAd")),this.model.get("isCardBelongToTempAd")&&(this.model.set("isCardBelongToTempAd",!1),this.model.set("tempAdCondition",!1),this.listeningToCondition=!1,this.onLocalTimerEnd("Temp Card Close"))}},{key:"_addUIComponents",value:function(){this._addCloseButton(),this._addAdChoice(),this._adVolumeButton()}},{key:"_adVolumeButton",value:function(){this.model.get("components.volume.isActive")&&(this.volume=new T.VolumeButtonView({model:this.model,container:this.el,globalModel:this.globalModel}))}},{key:"_updateVolumeButton",value:function(){this.volume&&this.volume.$el.appendTo(this.$el)}},{key:"_showRepeat",value:function(){this.loadingView&&this.loadingView.showRepeat()}},{key:"getActiveAd",value:function(){return this.activeAd}},{key:"getEl",value:function(){return this.el}},{key:"getModel",value:function(){return this.model}},{key:"isContentViewActive",value:function(){return!!this.model.get("components.contentVideo.isActive")&&(!(!this.model.get("detachToSlider.isStartFromSlider")||!this.model.get("detachToSlider.isDetachToSlider"))&&!!this.isDetached)}},{key:"_addContentView",value:function(){this.isContentViewActive()&&(this.contentView=new T.ContentVideoView({model:this.globalModel,container:this.container}),this.log.info("Content was created."))}},{key:"_showContentView",value:function(){return this.contentView?(this._switchFromActiveAd("_startLoadingView"),this.el=this.contentView.el,this.$el=this.contentView.$el,this.$el.removeClass("_cm-ad"),this.$el.removeClass("_cm-ad-active"),this.currentSize=null,this.isDetached?this._resetElDetached():this.log.warning("Should not start content when attached!!!"),void this.contentTimer.start(this.model,"")):void this.log.warning("There is no content view available!")}},{key:"terminateContent",value:function(){this.isContentViewActive()||this.contentView&&this.contentView.terminate()}},{key:"_handleMidroll",value:function(){this.isContentViewActive()?this._showContentView():this._startLoadingView()}},{key:"_stopLocalTimers",value:function(){this.getAdTimer.stop(this.model,"",null,!0),this.contentTimer.stop(this.model,"",null,!0)}}]),t}(g.default);e.exports=O},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(8),c=o(d),u=i(16),h=o(u),p=i(21),f=o(p),m=i(12),g=i(182),v=o(g),y=i(71),b=n(y),_=i(25),w=(n(_),i(90)),T=o(w),A="_cm-css-reset",S=c.default.now().toString(),P={video:"._cm-video-ad"},C=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VideoView",n=arguments[2];s(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.log=new h.default({unitType:o.model.get("unitType"),className:i,version:o.model.get("version"),isDebug:o.model.get("isDebug")}),o.ua=b.UAParser(window.navigator.userAgent),o.model.set("videoAdId",o.videoAdId),o.currModel=n?n:o.model,o._setVolumeAnimationTrigger(),o._bindEvents(),o.viewabiltyService=new T.default({model:o.model,onViewability:o._onViewability.bind(o)}),o}return a(t,e),l(t,[{key:"_bindEvents",value:function(){}},{key:"_setVolumeEvents",value:function(){this.currModel.on("change:volumeMuted",this._handleVolume.bind(this)),this.model.get("components.volume.isActive")&&this.currModel.on("change:onUnMuteClicked",this._fireUserAdUnmuted.bind(this)),this.currModel.get("autoplaySoundOn")?(this._bindOnHoverListeners(),this.checkVolumeStatus()):this.createStateHandlers([{event:"autoplaySoundOn:true",funcName:"_bindOnHoverListeners",isListenOnce:!0},{event:"autoplaySoundOn:true",funcName:"checkVolumeStatus",isListenOnce:!0}])}},{key:"checkVolumeStatus",value:function(){this.currModel.get("autoplaySoundOn")&&"on"===this.currModel.get("volume")?(this.log.info("Unmute first video because volume=on"),this.currModel.set("volumeMuted",!1)):this.currModel.set("volumeMuted",!0)}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this.$el.show()}},{key:"close",value:function(){this.model.set("closeState",f.default.closeState.videoViewClosed)}},{key:"_customize",value:function(){var e=this.model.get("additionalCss");this.$el.css(c.default.toCssObj(e))}},{key:"_rePosition",value:function(e,t){this.$el.css(t)}},{key:"_onLoadingClick",value:function(){var e=this;this.ui.video[0].id=this.videoAdId,this.model.get("isReplayAd")&&this.repeatingAd&&this.repeatingAd.vpaidWrapper.isReplayable&&(this.repeatingAd.vpaidWrapper.restartAd(),setTimeout(function(){return e.repeatingAd.vpaidWrapper.resizeAd(e.model.get("width"),e.model.get("height"))},0),this.activeAd=this.repeatingAd,this.repeatingAd.setToModel("adQState",f.default.adQState.repeating,this.repeatingAd.adId),this.repeatingAd.setToModel("adState",f.default.adState.repeating,this.repeatingAd.adId)),this.model.set("isAdClosedByTimer",!1)}},{key:"_onLearnMoreClick",value:function(){this.repeatingAd&&this.repeatingAd.onLearnMoreClick()}},{key:"_onMouseEnter",value:function(){this.activeAd&&(this.activeAd.unmute(),this.currModel.set("volumeMuted",!1))}},{key:"_onMouseLeave",value:function(){this.activeAd&&(this.activeAd.mute(),this.currModel.set("volumeMuted",!0))}},{key:"_handleVolume",value:function(){this.activeAd&&(this.currModel.get("volumeMuted")?this.activeAd.mute():this.activeAd.unmute())}},{key:"_fireUserAdUnmuted",value:function(){this.currModel.get("onUnMuteClicked")&&this.activeAd&&this.activeAd.oppsService.fireUserAdUnmuted()}},{key:"onAdComplete",value:function(){return this.setRepeatingAd(),this.activeAd=void 0,this.model.get("isMultiAd")?(this.isViewed=!1,this.isViewed100=!1,void this.checkEligible()):void this.model.set("closeState",f.default.closeState.terminate)}},{key:"checkEligible",value:function(){this.model.get("isInTab")&&this.isEligibleToPlay()?(this.activeAd||this.getReadyAd(),this.activeAd&&this.playAd()):this.activeAd&&this.activeAd.pause()}},{key:"isEligibleToPlay",value:function(){return this.model.get("isEligibleToPlay");
}},{key:"getReadyAd",value:function(){this.model.get("hasReadyAd")&&(this.model.get("volumeMuted")||"iOS"!==this.ua.os.name||this.model.set("volumeMuted",!0),this.activeAd=this.model.getNextAd(),this.model.set("aspectRatioNum",this.activeAd.getAspectRatioNum()),this.postGetAd())}},{key:"postGetAd",value:function(){}},{key:"playAd",value:function(){this.log.info("Play Ad !!!!",this.activeAd),this.activeAd.play(),this.activeAd.isUsed||(this.activeAd.isUsed=!0),this.model.get("components.volume.isActive")&&setTimeout(this._fireVolumeStateCheck.bind(this),0),this.viewabiltyService.updateActiveAd(this.activeAd)}},{key:"_onViewability",value:function(){this.log.info("Viewability reached")}},{key:"_addDisclosureText",value:function(){(this.model.get("components.disclosureText.isActive")||this.model.get("detachToSlider.components.disclosureText.isActive"))&&(this.disclosureTextView=new v.default({model:this.model,container:this.el}),this.disclosureTextView.render())}},{key:"_fireVolumeStateCheck",value:function(){this._startAnimationOnce(),this._handleVolume(),this.currModel.trigger("lastVolumeStateCheck")}},{key:"_setVolumeAnimationTrigger",value:function(){var e=this;this._startAnimationOnce=c.default.once(function(){e.currModel.trigger("startVolumeAnimation")})}},{key:"_unBindOnHoverListeners",value:function(){this.el.onmouseenter=null,this.el.onmouseleave=null}},{key:"_bindOnHoverListeners",value:function(){this.currModel.get("autoplaySoundOn")&&"onHover"===this.currModel.get("volume")&&!this.currModel.get("volumeUserInteraction")&&(this.el.onmouseenter=this._onMouseEnter.bind(this),this.el.onmouseleave=this._onMouseLeave.bind(this),this.currModel.on("change:volumeUserInteraction",this._unBindOnHoverListeners.bind(this)))}},{key:"setRepeatingAd",value:function(){this.model.get("isReplayAd")&&this.activeAd.vpaidWrapper.isReplayable?this.repeatingAd=this.activeAd:this.repeatingAd=null}},{key:"id",get:function(){return A}},{key:"videoAdId",get:function(){return S}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=P},set:function(e){return this.UI=e}}]),t}(m.StateManagerView);e.exports=C},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(16),c=o(d),u=i(207),h=o(u),p=i(12),f=i(10),m=o(f),g=i(8),v=o(g),y=i(21),b=n(y),_=i(201),w=o(_),T=i(155),A=i(166),S=o(A),P=i(25),C=n(P),E=i(182),k=o(E),I=i(6),O=i(11),V=o(O),x=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.log=new c.default({unitType:i.model.get("unitType"),className:"SubFeedFloatingView "+i.model.get("cardNumber"),version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.globalModel=e.globalModel,i.container=(0,m.default)(i.model.get("videoContainerSelector")||"body")[0],i.animationUtil=(0,w.default)(i.model),i.detachToSlider=i.model.get("detachToSlider"),i.attachedOnceToNewCard=!1,i.isStickyCardActive=i.model.get("stickyCard.isActive"),i.isDetachActive=i.detachToSlider.isStartFromSlider||i.detachToSlider.isDetachToSlider,i.isDetachedHasCloseButton=i.isDetachActive&&i.detachToSlider.hasCloseButton,i.isAttachedHasCloseButton=i.model.get("hasCloseButton"),i.isAnimateOnClose=i.model.get("isAnimateOnClose")||i.model.get("animation.onTransitionClose")&&"close"===i.model.get("onTimerClose");var n={startCondition:{stateToListen:"",state:""}},o=i.model.get("isPlacementSingleAd")?0:1e3*i.model.get("secondsToCloseFeed");return i.loadingTimer=new I.Timer(i.model,n,i.onLocalTimerEnd.bind(i,"midrollCollapse subUnit"),o),i.contentTimer=new I.Timer(i.model,n,i.onLocalTimerEnd.bind(i,"Content tiemr subUnit"),1e3*i.model.get("contentTimerSeconds")),i.currentAnimation=C.ANIMATION_TYPE.none,i._setStickParams(),i._setSliderSize(),i.render(),i.renderComponenets(),i.subFeedVideoView=new h.default(e),i._bindEvents(),i.startUnit(),i}return a(t,e),l(t,[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isEligibleToPlay",funcName:"isEligibleToPlayChange"},{event:"closeButtonClick",funcName:"_onCloseButtonClick"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"adQState:completed",funcName:"onAdComplete"},{event:"isEligibleToStick",funcName:"isEligibleToPlayChange"},{event:"videoView.showingAd",funcName:"onAdDisplayChange"},{event:"videoPlaceholderSize",funcName:"onVideoPlaceholderSizeChange",withBind:!1},{event:"videoPlaceholderPosition",funcName:"onVideoPlaceholderPosition",withBind:!1},{event:"aspectRatioNum",funcName:"onAspectRatioChange"},{event:"isInTab",funcName:"onIsInTabChange"}]),this.isStickyCardActive&&(V.default.on("window:scroll:change",this._onWindowScroll.bind(this)),V.default.on("window:resize:change",this.onWindowResize,this))}},{key:"startUnit",value:function(){this.model.get("isEligibleToPlay")&&!this.model.get("isSuperSlider")?this.startUnitAttached():this.model.get("detachToSlider.isStartFromSlider")?this.startUnitDetached():this.createStateHandlers([{event:"isEligibleToPlay",funcName:"startUnitAttached",isListenOnce:!0,withBind:!0}])}},{key:"startUnitAttached",value:function(){this.isAttachingOnStart=!0,this.attach(),this.playAd()}},{key:"startUnitDetached",value:function(){this.isFirstDetach=!0,this.detach(),this.playAd()}},{key:"render",value:function(){this.el.id="_cm-css-reset",this.$el.addClass("_cm-floating-view"),this.$el.css({width:this.model.get("width"),height:0}),this.container.appendChild(this.el)}},{key:"renderComponenets",value:function(){this.createCloseButton(),this.createLoadingView(),this._addAdChoice(),this._adVolumeButton(),this._addDisclosureText(),this._addContentView()}},{key:"_onLoadingClick",value:function(){this.isReplayMode||(this.model.get("isReplayAd")&&this.subFeedVideoView.isRepeatingAd()?(this.log.warning("Repeating ad should play"),this.subFeedVideoView.startRepeatingAd(),this.isReplayMode=!0,this.hideLoadingView()):(this.log.info("@@@ loadingTimer start"),this.loadingTimer.start(this.model,""))),this.model.set("isAdClosedByTimer",!1),this.model.set("closeTimer",void 0),this.subFeedVideoView.setRepeatMode(!1),this.globalModel.once("change:hasReadyAd",this.subFeedVideoView.hasReadyAdChangeSubUnit.bind(this.subFeedVideoView))}},{key:"_setSliderSize",value:function(){if(this.isStickyCardActive){var e=this.model.get("width"),t=this.model.get("height"),i=this.getStickyPosition();return this.detachToSlider.position.horizontalOffset=i.left,this.detachToSlider.position.verticalOffset=i.top,this.detachToSlider.position.horizontal="left",this.detachToSlider.position.vertical="top",this.model.set("detachToSlider.width",e),void this.model.set("detachToSlider.height",t)}if(this.detachToSlider=this.model.get("detachToSlider"),this.originalSliderWidth&&(this.detachToSlider.width=this.originalSliderWidth,this.originalSliderWidth=void 0),this.originalSliderHeight&&(this.detachToSlider.height=this.originalSliderHeight,this.originalSliderHeight=void 0),this.model.get("aspectRatioNum")<=1)this.originalSliderWidth=this.detachToSlider.width,this._setSliderSizeVertical();else{this.originalSliderHeight=this.detachToSlider.height;var n=this.model.get("width"),o=this.detachToSlider.liquidSize.isActive?this._calcLiquidWidth():this.detachToSlider.width;n>o&&(n=o);var s=v.default.getVideoHeightByRatio(n,this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",n),this.model.set("detachToSlider.height",s)}}},{key:"_setStickParams",value:function(){var e=this.model.get("stickyCard.navBarSelector"),t=document.querySelector(e),i=this.model.get("stickyCard.offset.top");if(t){var n=t.offsetHeight||0;this.model.set("stickyCard.offset.top",i+n)}}},{key:"getStickyPosition",value:function(){var e=(0,m.default)(this.model.get("containerViewPlaceHolder")),t=e.length?e.offset().left:0,i=this.model.get("stickyCard.offset.top")||0,n=t+(this.model.get("stickyCard.offset.left")||0),o={top:""+i,left:""+n};return o}},{key:"_setSliderSizeVertical",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=v.default.getVideoHeight(this.model.get("width")),t=this.detachToSlider.liquidSize.isActive?this._calcLiquidHeight():this.detachToSlider.height;e>t&&(e=t);var i=v.default.getVideoWidthByRatio(e,this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",i),this.model.set("detachToSlider.height",e)}},{key:"_calcLiquidWidth",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=this.detachToSlider.liquidSize.minWidth,t=this.detachToSlider.liquidSize.maxWidth,i=window.innerWidth*(this.detachToSlider.liquidSize.widthPercent/100);return t&&i>t&&(i=t),i<e&&(i=e),i}},{key:"_calcLiquidHeight",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=this.detachToSlider.liquidSize.maxHeight,t=window.innerHeight*(this.detachToSlider.liquidSize.heightPercent/100);return e&&t>e&&(t=e),t}},{key:"detach",value:function(e,t){if(e||!this.isDetached){this.log.info("detaching"),this.currentAnimation=C.ANIMATION_TYPE.detaching;var i=t?0:this.model.get("animation.detach");this.isFirstDetach&&(i=this.model.get("animation.firstDetach")),this._setSliderSize();var n={width:this.model.get("detachToSlider.width"),height:this.model.get("detachToSlider.height")};this._resize(n,!this.isFirstDetach),this.$el.css(this.model.get("additionalCss")),this.animationUtil.detach({$el:this.$el,timeMS:i,sliderOptions:this.detachToSlider,isSlideIn:this.isFirstDetach,cb:this.postDetach.bind(this)}),this.isDetached=!0,this.subFeedVideoView.detach(e,this.isFirstDetach,i)}}},{key:"postDetach",value:function(){this.currentAnimation===C.ANIMATION_TYPE.detaching&&(this.currentAnimation=C.ANIMATION_TYPE.none,this.isFirstDetach===!0&&(this.isFirstDetach=!1),this.isDetachedHasCloseButton?this._showCloseButton(this.isStickyCardActive):this._hideCloseButton())}},{key:"_resize",value:function(e,t,i){this.currentSize&&this.currentSize.width===e.width&&this.currentSize.height===e.height||(t&&!i||this.$el.css(e),this.currentSize=m.default.extend(!0,{},e),this.subFeedVideoView.resize(e,i,t))}},{key:"onIsInTabChange",value:function(){this.model.get("isInTab")&&!this.model.get("isEligibleToPlay")&&this.model.get("videoViewState")===b.videoViewState.rendered&&this.isEligibleToPlayChange()}},{key:"isEligibleToPlayChange",value:function(){if(this.currentAnimation===C.ANIMATION_TYPE.none){if(this.canAttach())this.attach();else if(this.canDetach()){this.detach();var e=this.isStickyCardActive&&this.model.get("stickyCard.restrictions.adPercent.percent");e&&this._setStickySizeRestrication()}this.subFeedVideoView.checkEligible()}}},{key:"_setStickySizeRestrication",value:function(){var e=this;if(!this.rvTimerWasSet){var t=v.default.getViewportHeight(this.model.get("scrollSelector")),i=this.model.get("height")/t*100;i>=this.model.get("stickyCard.restrictions.adPercent.percent")&&(this.rvTimerWasSet=!0,setTimeout(function(){e.permanentAttach(),e.rvTimerWasSet=!1},1e3*this.model.get("stickyCard.restrictions.adPercent.secondsToClose")))}}},{key:"canAttach",value:function(){return(!this.isStickyCardActive||!this.model.get("isEligibleToStick"))&&(!!this.model.get("isEligibleToPlay")&&(this.model.get("videoViewState")===b.videoViewState.detached&&(!!this.model.get("renderWasCalled")&&!this.isSuperSlider())))}},{key:"isSuperSlider",value:function(){return this.detachToSlider.isStartFromSlider&&this.detachToSlider.isDetachToSlider}},{key:"canDetach",value:function(){if(this.detachToSlider=this.model.get("detachToSlider"),this.isStickyCardActive){var e=this.model.get("stickyCard.restrictions.maxWidth")&&this.model.get("width")>this.model.get("stickyCard.restrictions.maxWidth"),t="any"===this.model.get("stickyCard.restrictions.rv")||this.model.get("activeAdRV")===this.model.get("stickyCard.restrictions.rv"),i=this.model.get("aspectRatioNum")<this.model.get("stickyCard.maxAspectRatio");if(e||i||!t||!this.model.get("isEligibleToStick"))return t&&!e||this.globalModel.set("isSliderOn",!1),!1}else if(this.model.get("isEligibleToPlay"))return!1;return(this.model.get("videoViewState")===b.videoViewState.attached||this.model.get("videoViewState")===b.videoViewState.rendered)&&(!!this.detachToSlider.isDetachToSlider&&(!!this.model.get("isInTab")&&!!this._isDetachAvailable()))}},{key:"_isDetachAvailable",value:function(){if(this.model.get("frameType")===C.FRAME_TYPE.amp)return this.model.get("AMPElemBelowVisible")?this.model.get("detachToSlider.isDetachBelow"):this.model.get("detachToSlider.isDetachAbove");var e=this.el.getBoundingClientRect().top;return e>0?this.model.get("detachToSlider.isDetachAbove"):this.model.get("detachToSlider.isDetachBelow")}},{key:"_runAnimation",value:function(e){e?this.expand():this.collapse()}},{key:"expand",value:function(){var e=this,t=this.model.get("videoPlaceholderSize"),i={height:0,width:t.width};this._resize(i),this.currentAnimation=C.ANIMATION_TYPE.expanding,this.animationUtil.expand({$el:this.$el,timeMS:this.model.get("animation.transitionAnimationTime"),height:this.model.get("videoPlaceholderSize.height"),cb:function(){e.postExpand()}}),this.subFeedVideoView.expand()}},{key:"postExpand",value:function(){this.currentAnimation===C.ANIMATION_TYPE.expanding&&(this.currentAnimation=C.ANIMATION_TYPE.none,this.isEligibleToPlayChange())}},{key:"collapse",value:function(){this.animationUtil.collapse({$el:this.$el,timeMS:this.model.get("animation.transitionAnimationTime"),height:0,cb:null}),this.subFeedVideoView.collapse()}},{key:"attach",value:function(e){var t=this.model.get("videoPlaceholderPosition");if(!isNaN(t.top)){var i=this.model.get("animation.attach"),n=this.detachToSlider.isStartFromSlider&&this.isDetached||this.attachedOnceToNewCard,o=!e&&n&&this.model.get("detachToSlider").animation;this.isFirstDetach=!1,this.attachedOnceToNewCard=!0,this.log.info("Attaching",this.$el),this.currentAnimation=C.ANIMATION_TYPE.attaching,this.isStickyCardActive&&(o=!1),this.isDetached=!1,this.animationUtil.attach({$el:this.$el,target:this.model.get("videoPlaceholderPosition"),isAnimated:o,timeMS:i,additionalCss:this.model.get("additionalCss"),cb:this.postAttach.bind(this,n)}),this.isAttachingOnStart&&(this.isAttachingOnStart=!1,this.expand()),this.subFeedVideoView.attach(o,i,n),!n&&this.model.get("animation.onTransitionOpen")||setTimeout(function(){this._resize(this.model.get("videoPlaceholderSize"),o,!0)}.bind(this),0),this.globalModel.get("isSliderOn")&&!this.model.get("detachToSlider.isDetachToSlider")&&this.globalModel.set("isSliderOn",!1),this.isAttachedHasCloseButton?this._showCloseButton():this._hideCloseButton()}}},{key:"postAttach",value:function(e){if(this.currentAnimation===C.ANIMATION_TYPE.attaching)return this.currentAnimation=C.ANIMATION_TYPE.none,this.log.info("Attached",this.$el),e&&(this.isFirstDetach=!1),this.model.get("animation.onTransitionOpen")&&!e?void this.expand():void this.isEligibleToPlayChange()}},{key:"permanentAttach",value:function(){var e=this;this.model.set("detachToSlider.isStartFromSlider",!1),this.model.set("detachToSlider.isDetachToSlider",!1),this.globalModel.set("isSliderOn",!1),this.globalModel.set("isSliderClosed",!0),this.isDetached?this._slideOut(function(){e._hideCloseButton(!0),e.attach(!0),e.getActiveAd()||e.showLoadingView()}):this.attach(!0),this.terminateContent()}},{key:"_slideOut",value:function(e){if(this.isDetached){var t=this.model.get("animation.slideOut"),i=this.isStickyCardActive;this.animationUtil.slideOut({$el:this.$el,timeMS:t,sliderOptions:this.detachToSlider,isVerticalSlideOut:i,cb:e}),this.subFeedVideoView.slideOut(t,i),this.isDetached=!1}}},{key:"onAdComplete",value:function(){this.model.get("isReplayAd")&&(this.isReplayMode=!1),this.model.get("isMultiAd")||(this.log.info("Single ad completed, attach and check if can close"),this.permanentAttach(),this.checkAndClose("Single ad"),this.showLoadingView()),this.isDetached&&this.isStickyCardActive&&this.permanentAttach(),this.isContentViewActive()&&this.model.set("aspectRatioNum",this.model.get("defaultAspectRatioNum")),this.subFeedVideoView.onAdComplete()}},{key:"checkAndClose",value:function(e){return!(this.isDetached||!this.model.get("isEligibleToPlay")||!this.isAnimateOnClose||this.model.get("isPlacementSingleAd"))&&(this.log.info("Close because of: ",e),this.collapse(),this.model.set("isAdClosed",!0),!0)}},{key:"onTimerEnd",value:function(e){this.model.set("viewTopComponent",C.FLOATING_VIEW_TOP_COMPONENT.repeat),this.log.info("midroll:",e),this.subFeedVideoView.setRepeatMode(!0),this.showLoadingView(),this.checkAndClose(e),this.permanentAttach(),this.subFeedVideoView.onTimerEnd()}},{key:"playAd",value:function(){this.subFeedVideoView._playAd(),this.log.info("@@@ loadingTimer stop"),this._stopLocalTimers()}},{key:"_addAdChoice",value:function(){var e=this.model.get("components.adChoice");e.isActive&&(e.videoAd.isActive&&(this.adChoice=new T.AdChoiceView({model:this.model,container:this.el,type:C.AD_CHOICE_TYPE.VIDEO_AD})),e.slider.isActive&&this.isDetachActive&&(this.adChoiceSlider=new T.AdChoiceView({model:this.model,container:this.el,type:C.AD_CHOICE_TYPE.SLIDER})))}},{key:"createCloseButton",value:function(){this.closeButtonView||!this.isDetachedHasCloseButton&&!this.isAttachedHasCloseButton||(this.log.info("Creating Close Button"),this.model.get("closeButton.hasCloseButton")===!0&&(this.closeButtonView=new T.CleanCloseButtonView({model:this.model,container:this.el,isSkipRender:!1}),this.closeButtonView.hide()))}},{key:"_onCloseButtonClick",value:function(){this.isDetached?(this.permanentAttach(),this.subFeedVideoView.onSliderClose()):(this.log.info("Close button click: close card"),this.checkAndClose())}},{key:"_showCloseButton",value:function(e){e?this.closeButtonTimer=setTimeout(this.model.set.bind(this.model,"closeButton.isShowing",!0),this.model.get("components.CloseButtonView.delay")):this.model.set("closeButton.isShowing",!0)}},{key:"_hideCloseButton",value:function(){clearTimeout(this.closeButtonTimer),this.closeButtonTimer=void 0,this.model.set("closeButton.isShowing",!1)}},{key:"_adVolumeButton",value:function(){this.model.get("components.volume.isActive")&&(this.volume=new T.VolumeButtonView({model:this.model,container:this.el,globalModel:this.globalModel}))}},{key:"onAdDisplayChange",value:function(e,t){this.log.info("@@@ onAdDisplayChange");var i=t?C.FLOATING_VIEW_TOP_COMPONENT.video:C.FLOATING_VIEW_TOP_COMPONENT.loading;this.model.set("viewTopComponent",i),t?(this.model.set("viewTopComponent",C.FLOATING_VIEW_TOP_COMPONENT.video),this.log.info("@@@ ad started displaying"),this._stopLocalTimers()):(this.log.info("@@@ ad stopped displaying"),this.isContentViewActive()?(this.hideLoadingView(),this.model.set("viewTopComponent",C.FLOATING_VIEW_TOP_COMPONENT.content),this.contentTimer.start(this.model,"",null,!0)):(this.loadingTimer.start(this.model,"",null,!0),this.model.set("viewTopComponent",C.FLOATING_VIEW_TOP_COMPONENT.loading)))}},{key:"onVideoPlaceholderPosition",value:function(){this.model.get("isAdClosed")||this.isDetached||this.attach(!0)}},{key:"onVideoPlaceholderSizeChange",value:function(e,t){this.isDetached||this.currentAnimation!==C.ANIMATION_TYPE.none||(this._setSliderSize(),this._resize(this.model.get("videoPlaceholderSize")))}},{key:"onAspectRatioChange",value:function(e,t){this.isDetached&&(this._setSliderSize(),this.detach(!0,!0))}},{key:"_addDisclosureText",value:function(){(this.model.get("components.disclosureText.isActive")||this.model.get("detachToSlider.components.disclosureText.isActive"))&&(this.disclosureTextView=new k.default({model:this.model,container:this.el}),this.disclosureTextView.render())}},{key:"createLoadingView",value:function(){this.log.info("@@@ createLoadingView"),this.loadingView=new S.default({model:this.model,container:this.el,globalModel:this.globalModel,isReplayable:this.model.get("isReplayable")})}},{key:"showLoadingView",value:function(){this.loadingView&&!this.loadingTimer.isTimerActive()&&(this.log.info("@@@ showLoadingView"),this.loadingView.showRepeat(),this.model.set("viewTopComponent",C.FLOATING_VIEW_TOP_COMPONENT.loading))}},{key:"hideLoadingView",value:function(){this.loadingView&&this.loadingView.hide()}},{key:"onLocalTimerEnd",value:function(e){this.log.info("SubUnit onLocalTimerEnd card number: ",this.model.get("cardNumber")),this.subFeedVideoView.setRepeatMode(!0);var t=!1;this.globalModel.get("isSliderOn")&&(this.permanentAttach(),t=!0);var i=this.checkAndClose("LocalTimerEnd: "+e);i||t||this.showLoadingView()}},{key:"closeAndRemove",value:function(){this.terminate()}},{key:"terminate",value:function(){this.log.info("terminate"),this.hideLoadingView(),this._hideCloseButton(),this.permanentAttach(),this.subFeedVideoView.terminate(),this.$el.hide(),this.$el.remove()}},{key:"permanentClose",value:function(){this.subFeedVideoView.permanentClose()}},{key:"getActiveAd",value:function(){return this.subFeedVideoView.getActiveAd()}},{key:"getEl",value:function(){return this.subFeedVideoView.getEl()}},{key:"getModel",value:function(){return this.subFeedVideoView.getModel()}},{key:"extractAd",value:function(e){this.model.set("isCardBelongToTempAd",!0),this.model.set("tempAdCondition",e),this.showLoadingView(),this.subFeedVideoView.extractAd()}},{key:"injectAd",value:function(e,t){this.model.set("isCardBelongToTempAd",!0),this.model.set("tempActiveAdCondition",t),this.hideLoadingView(),this.subFeedVideoView.injectAd(e),this.attach(!0)}},{key:"onTempAdEnd",value:function(){this.log.info("@!! onTempAdEnd subUnitId: ",this.subUnitId),this.log.info("@!! onTempAdEnd isCardBelongToTempAd: ",this.model.get("isCardBelongToTempAd")),this.model.get("isCardBelongToTempAd")&&(this.model.set("isCardBelongToTempAd",!1),this.model.set("tempAdCondition",!1),this.onLocalTimerEnd("Temp Card Close"))}},{key:"isContentViewActive",value:function(){return!!this.model.get("components.contentVideo.isActive")&&!(!this.model.get("detachToSlider.isStartFromSlider")||!this.model.get("detachToSlider.isDetachToSlider"))}},{key:"_addContentView",value:function(){this.isContentViewActive()&&(this.contentView=new T.ContentVideoView({model:this.globalModel,unitType:this.model.get("unitType"),container:this.el}))}},{key:"terminateContent",value:function(){this.isContentViewActive()||this.contentView&&this.contentView.terminate()}},{key:"_stopLocalTimers",value:function(){this.loadingTimer.stop(this.model,"",null,!0),this.contentTimer.stop(this.model,"",null,!0)}},{key:"_onWindowScroll",value:function(){if(this.isDetached&&this.isStickyCardActive){var e=(0,m.default)(this.model.get("videoContainerSelector")),t=e.offset().top,i=t+e.height(),n=this.$el.offset().top,o=n+this.$el.offset().height;(i<o||n<t)&&(this.log.info("Unstick Sticky Ad"),this.permanentAttach())}}},{key:"onWindowResize",value:function(){this.isStickyCardActive&&this.isDetached&&this.currentAnimation===C.ANIMATION_TYPE.none&&(this._setSliderSize(),this.detach(!0,!0))}}]),t}(p.StateManagerView);e.exports=x},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=i(21),c=o(d),u=i(205),h=n(u),p=i(10),f=n(p),m=i(8),g=n(m),v=i(201),y=n(v),b=i(25),_=o(b),w=function(e){function t(e){s(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"SubFeedVideoView "+e.model.get("cardNumber"),e.globalModel));return i.globalModel=e.globalModel,i.animationUtil=(0,y.default)(i.model),i.detachToSlider=i.model.get("detachToSlider"),i.currentAnimation=_.ANIMATION_TYPE.none,i.isstickyCardActive=i.model.get("stickyCard.isActive"),i.render(),i._setAd(e.adjs),i.isstickyCardActive&&i._setStickyCardParams(),i}return a(t,e),l(t,[{key:"render",value:function(){this.$el.addClass("_cm-video-with-slider"),this.model.set("videoViewState",c.videoViewState.rendered)}},{key:"_setStickyCardParams",value:function(){var e=this.getStickyPosition();this.detachToSlider.position.horizontalOffset=e.left,this.detachToSlider.position.verticalOffset=e.top,this.detachToSlider.position.horizontal="left",this.detachToSlider.position.vertical="top"}},{key:"getStickyPosition",value:function(){var e=this.$el.offset(),t={top:this.model.get("stickyCard.offset.top")||0,left:this.model.get("stickyCard.offset.left")||0};return{top:""+t.top,left:""+(e.left+t.left)}}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isInTab",funcName:"onIsInTabChange"}])}},{key:"_setAd",value:function(e){this.isFirstAd?this._switchFromActiveAd("set ad first ad switch"):this.isFirstAd=!1,this.el=e.vpaidWrapper.adTarget,this.model.get("isReplayAd")&&e.vpaidWrapper.isReplayable&&e.vpaidWrapper.dontDie&&e.vpaidWrapper.dontDie(),this.globalModel.get("volumeMuted")||"iOS"!==this.ua.os.name||this.globalModel.set("volumeMuted",!0),this.$el=(0,f.default)(this.el),this.activeAd=e,this.$el.addClass("_cm-video"),this._switchToActiveAd("set ad"),this._setVolumeEvents(),this.model.get("isCardBelongToTempAd")&&this.activeAd.onCardSwap(),this.model.set("videoViewContainer",this.$el)}},{key:"_switchFromActiveAd",value:function(e){this.log.info("@@@ _switchFromActiveAd"),this.isDetached&&(this.log.warning("switchFromActiveAd",this.cardNumber),this.$el.addClass("_cm-ad"),this.$el.removeClass("_cm-ad-active")),this.repeatingAd&&this.repeatingAd.vpaidWrapper&&(0,f.default)(this.repeatingAd.vpaidWrapper.adTarget).css({display:"none !important"})}},{key:"_switchToActiveAd",value:function(e){this.$el.removeClass("_cm-ad"),this.$el.addClass("_cm-ad-active"),this.changeBackgroundColor(),this.log.info("switchToActiveAd",this.cardNumber)}},{key:"detach",value:function(e,t,i){!e&&this.isDetached||(this.log.info("detaching"),this.currentAnimation=_.ANIMATION_TYPE.detaching,this.changeBackgroundColor(!0),this.$el.css(this.model.get("additionalCss")),this.animationUtil.detach({$el:this.$el,timeMS:i,sliderOptions:this.detachToSlider,isSlideIn:t,cb:this.postDetach.bind(this)}),this.isDetached=!0,this.model.set("videoViewState",c.videoViewState.detached),this.checkEligible())}},{key:"getStickyPosition",value:function(){var e=this.$el.offset(),t={top:this.model.get("stickyCard.offset.top")||0,left:this.model.get("stickyCard.offset.left")||0};return{top:t.top+"px",left:e.left+t.left+"px"}}},{key:"postDetach",value:function(){this.currentAnimation===_.ANIMATION_TYPE.detaching&&(this.currentAnimation=_.ANIMATION_TYPE.none,g.default.isEmpty(this.model.get("detachToSlider").customCss)||this.$el.css(JSON.parse(this.model.get("detachToSlider").customCss)),this.activeAd&&(this._playAd(),this.activeAd.onDetached()))}},{key:"resize",value:function(e,t,i){this.currentSize&&this.currentSize.width===e.width&&this.currentSize.height===e.height&&!t||(i&&!t||this.$el.css(e),0!==e.height&&0!==e.width&&(this.activeAd&&this.activeAd.vpaidWrapper?this.activeAd.resize(e):this.repeatingAd&&this.repeatingAd.vpaidWrapper&&this.repeatingAd.resize(e),this.currentSize=f.default.extend(!0,{},e),this.model.trigger("change:videoViewSize",e)))}},{key:"_playAd",value:function(){this.model.get("isToggleIframeContent")&&this.activeAd.vpaidWrapper.toggleIframeContentDisplay&&this.activeAd.vpaidWrapper.toggleIframeContentDisplay("show"),this.log.info("@@@ Play AD"),this.playAd()}},{key:"onAdComplete",value:function(){this.model.get("isReplayAd")&&(this.repeatingAd=this.activeAd),this.handlePlayerOutOfViewport(),this._switchFromActiveAd("end off ad"),this.activeAd=void 0,this.model.set("videoView.showingAd",!1),this.isViewed=!1,this.isViewed100=!1,this.model.get("isCardBelongToTempAd")&&this.onConditionComplete(),this.model.get("isMultiAd")&&!this.model.get("isPlacementSingleAd")?this.checkEligible():this.isSingleAdCompleted=!0}},{key:"_onViewability",value:function(){return this.activeAd?(h.default.prototype._onViewability.call(this),this.log.info("!!@ _onViewability",this.model.get("tempAdCondition")),void("viewability"===this.model.get("tempAdCondition")&&this.onConditionComplete())):void this.log.warning("Viewability without active ad was called!")}},{key:"onIsInTabChange",value:function(){this.activeAd&&this.activeAd.vpaidWrapper&&this.model.get("isInTab")&&g.default.forceElementRedrawWithBorderChange(this.activeAd.vpaidWrapper.adTarget),this.checkEligible()}},{key:"checkEligible",value:function(){if(!this.isRepeatMode){var e=this.isEligibleToPlay();this._setCardId(),e?(this.activeAd||this.getReadyAd(),this.activeAd&&(this.log.info("Play Ad sub unit: "+this.subUnitId+" ad:"+this.activeAd.adId),this._playAd())):this.pauseAd(),!e&&this.isFirstDetach&&(e=!0),this._updateSubAdEligibilityStatus(e)}}},{key:"_updateSubAdEligibilityStatus",value:function(e){e?(this.log.info("!!!@@@ _updateSubAdEligibilityStatus","set underfind"),this.globalModel.set("lastCardOutOfViewport",void 0)):(this.log.info("!!!@@@ _updateSubAdEligibilityStatus",this.model.get("subUnitId")),this.globalModel.set("lastCardOutOfViewport",this.model.get("subUnitId"))),this.globalModel.set("subAdsEligibility."+this.model.get("subAdId"),e)}},{key:"isEligibleToPlay",value:function(){return this.model.get("isInTab")?!!this.model.get("isEligibleToPlay")||this.model.get("videoViewState")===c.videoViewState.detached:this.model.get("videoViewState")===c.videoViewState.detached&&"play"===this.model.get("detachToSlider").onOutOfView}},{key:"_setCardId",value:function(){this.isDetached?this.model.set("cardNumber",this.cardNumber*-1):this.model.set("cardNumber",this.cardNumber)}},{key:"getReadyAd",value:function(){if(!this.isSingleAdCompleted)if(this.globalModel.get("hasReadyAd")){var e=this.globalModel.getNextAd();if(!e)return;this.globalModel.get("lastAdID")||this.globalModel.set("lastAdID",e.adId),this.log.info("Video View Got new ad of type : "+parseInt(e.adData.requiredViewability?"1":"0"),e),this._switchFromActiveAd("getReadyAd"),this._setAd(e),this.activeAd.setSubModel(this.model),this.postGetAd()}else this.log.warning("Could not find ad"),this.watingForAd=!0,this.globalModel.once("change:hasReadyAd",this.hasReadyAdChangeSubUnit.bind(this))}},{key:"postGetAd",value:function(){this.repositionVideo(),this.resize(this.currentSize,!0),this.model.set("videoView.showingAd",!0),this.checkEligible()}},{key:"hasReadyAdChangeSubUnit",value:function(){this.log.info("hasReadyAdChangeSubUnit",this.globalModel.get("hasReadyAd")),
!this.isRepeatMode&&this.globalModel.get("hasReadyAd")&&this.isEligibleToPlay()&&this.getReadyAd()}},{key:"expand",value:function(){this.log.info("Expand"),this.currentAnimation=_.ANIMATION_TYPE.expanding;var e=this.model.get("videoPlaceholderSize");this.resize(e);var t={height:0,width:e.width};this.resize(t),this.animationUtil.expand({$el:this.$el,timeMS:this.model.get("animation.transitionAnimationTime"),height:this.model.get("videoPlaceholderSize.height"),cb:this.postExpand.bind(this)})}},{key:"postExpand",value:function(){this.currentAnimation===_.ANIMATION_TYPE.expanding&&(this.currentAnimation=_.ANIMATION_TYPE.none)}},{key:"collapse",value:function(){this.$el&&this.animationUtil.collapse({$el:this.$el,timeMS:this.model.get("animation.transitionAnimationTime"),height:0,cb:null})}},{key:"attach",value:function(e,t,i){this.log.info("Attaching to card",this.$el),this.currentAnimation=_.ANIMATION_TYPE.attaching,this.isDetached=!1,this.changeBackgroundColor(!1),this.animationUtil.attach({$el:this.$el,target:this.model.get("videoPlaceholderPosition"),isAnimated:e,timeMS:t,additionalCss:this.model.get("additionalCss"),size:this.model.get("videoPlaceholderSize"),cb:this.postAttach.bind(this,i)}),this.handlePlayerOutOfViewport(),this.model.set("videoViewState",c.videoViewState.attached)}},{key:"postAttach",value:function(e){this.currentAnimation===_.ANIMATION_TYPE.attaching&&(this.currentAnimation=_.ANIMATION_TYPE.none,this.log.info("Attached",this.$el),e&&(this.isFirstDetach=!1,this.model.trigger("change:videoViewSize",this.model.get("videoPlaceholderSize"))),this.activeAd&&this.activeAd.onAttached(),this.checkEligible())}},{key:"slideOut",value:function(e,t){this.animationUtil.slideOut({$el:this.$el,timeMS:e,sliderOptions:this.detachToSlider,isVerticalSlideOut:t,cb:null}),this.isDetached=!1,this.model.set("videoViewState",c.videoViewState.attached),this.pauseAd(),this.model.get("isSuperSlider")&&(this.model.set("isSuperSliderClosed",!0),this.globalModel.set("isSuperSliderClosed",!0),this._updateSubAdEligibilityStatus(!1))}},{key:"onTimerEnd",value:function(){this.activeAd=void 0}},{key:"pauseAd",value:function(){this.activeAd&&(this.log.info("Pause Ad sub unit: "+this.subUnitId+" ad:"+this.activeAd.adId),this.activeAd.pause())}},{key:"handlePlayerOutOfViewport",value:function(){var e=this.activeAd&&this.activeAd.vpaidWrapper.adTarget.parentElement;this.model.get("isPlayerOutOfViewport")&&e&&(e.style.top="-"+this.globalModel.get("topOffsetPosition")+"px")}},{key:"terminate",value:function(){this.log.info("terminate"),this.$el&&(this.activeAd&&this.activeAd.pause(),this.$el.remove(),this.isDetached=!1,this.close(),this.globalModel.set("isSliderClosed",!1))}},{key:"close",value:function(){this.log.info("close"),this.$el.height(0),setTimeout(function(){this.permanentClose()}.bind(this),1500)}},{key:"permanentClose",value:function(){this.log.info("permanentClose"),this.activeAd?(this.activeAd.pause(),this.activeAd=void 0):this.$el.remove()}},{key:"getActiveAd",value:function(){return this.activeAd}},{key:"getEl",value:function(){return this.el}},{key:"getModel",value:function(){return this.model}},{key:"setRepeatMode",value:function(e){this.isRepeatMode=e}},{key:"extractAd",value:function(){this.$el&&this.$el.css("height","0"),this.activeAd=void 0,this.$el=void 0}},{key:"injectAd",value:function(e){e.setSubModel(this.model),this._setAd(e),this.$el.height(this.model.get("videoPlaceholderSize.height")),this.isEligibleToPlay(),this.log.info("is Viewability fired",e.isViewabilityFired)}},{key:"onConditionComplete",value:function(){this.model.set("isCardBelongToTempAd",!1),this.model.set("tempAdCondition",!1),this.globalModel.set("temAdCondition",!0)}},{key:"isRepeatingAd",value:function(){return this.repeatingAd&&this.repeatingAd.vpaidWrapper.isReplayable}},{key:"startRepeatingAd",value:function(){var e=this.repeatingAd;e.setNativeAdClickListener(),this._setAd(e),this.$el.css({display:"block !important"}),this.postGetAd(),e.vpaidWrapper.restartAd(),this.log.info("replaying ad "+e.adId),e.setToModel("adQState",c.adQState.repeating,e.adId),e.setToModel("adState",c.adState.repeating,e.adId),setTimeout(this.activeAd.recheckSize.bind(this.activeAd),0)}},{key:"repositionVideo",value:function(){this.isDetached?(this.isDetached=!1,this.detach(!1,0)):this.attach(!1,0,!1,!1)}},{key:"onSliderClose",value:function(){this.activeAd&&this.activeAd.onSliderClose()}},{key:"changeBackgroundColor",value:function(e){!e&&this.model.get("style.videoBackgroundColor")&&this.$el.css("background-color",this.model.get("style.videoBackgroundColor")),e&&this.$el.css("background-color","transparent")}}]),t}(h.default);e.exports=w},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8),a=n(r),l=i(11),d=n(l),c=i(10),u=n(c),h=i(16),p=n(h),f="tbl-data-mutation-observer",m=100,g=function(){function e(t,i){o(this,e),this.model=t,this.log=new p.default({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.feedSelector=this.model.get("parentSelector"),this.isObserveFeedParent=this.model.get("isObserveFeedParent"),this._bindEvents(),this._initMutationObserver(i)}return s(e,[{key:"_bindEvents",value:function(){"undefined"!=typeof TRC&&TRC.listen&&(TRC.listen("trcResponseHandled",this._updateMutationObserver.bind(this)),TRC.listen("feed-x-toggle",this._onFeedXToggle.bind(this)),TRC.listen("feedContainerChanged",this._onFeedContainerChanged.bind(this)))}},{key:"_initMutationObserver",value:function(e){var t=(0,u.default)(e||this.feedSelector);this._setObservers(t);var i=this.model.get("mutationSelectorsArray");if(i){var n=(0,u.default)(i.toString());a.default.forEach(n,this._setMutationObserver,this)}}},{key:"_setObservers",value:function(e){this.isObserveFeedParent?a.default.forEach(this._getParents(e),this._setMutationObserver,this):a.default.forEach(e,this._setMutationObserver,this)}},{key:"_getParents",value:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];n.parentElement&&t.push(n.parentElement)}return t}},{key:"_setMutationObserver",value:function(e){if(e&&!e.getAttribute(f)){var t=a.default.throttle(this._trigger.bind(this,"feed:resize:change",{}),m),i=new MutationObserver(t),n={attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeOldValue:!0};e.setAttribute(f,!0),i.observe(e,n)}}},{key:"_updateMutationObserver",value:function(){var e=(0,u.default)(this.feedSelector);if(e){var t=e.not("["+f+"]");this._setObservers(t)}}},{key:"_updateFeedSelector",value:function(){this.feedSelector=this.model.get("parentSelector"),this._updateMutationObserver()}},{key:"_onFeedXToggle",value:function(e){this._onFeedContainerChanged({eventName:"feedxToggle",containerSelector:e.data})}},{key:"_onFeedContainerChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.log.info("feed container changed",e.eventName),e.containerSelector||this.log.error("no valid explore-more selector"),this.model.set("parentSelector",e.containerSelector),e.placement&&this.model.set("placement",e.placement),this._updateFeedSelector(e.containerSelector),this.model.increaseCounter(e.eventName),this.model.increaseCounter("feedContainerChanged")}},{key:"_trigger",value:function(e,t){d.default.trigger(e,t)}}]),e}(),v=function(){var e;return function(t,i){return e||(e=new g(t,i)),e}}();e.exports=v},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=i(8),d=n(l),c=i(10),u=(n(c),i(12)),h=i(16),p=n(h),f=i(11),m=n(f),g=function(e){function t(e){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.model=e,i.log=new p.default({unitType:"FEED_MANAGER",className:"ContinuePLayAdInNextCard",version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i}return r(t,e),a(t,[{key:"_startWatchDivLeaveVeiwPort",value:function(e){this.trakingElement=e,this._watchScroll()}},{key:"_testElementInViewPort",value:function(){var e=d.default.getViewPercent(this.trakingElement,this.model.get("width"),d.default.getVideoHeight(this.model.get("width")),this.model.get("scrollSelector"));this.log.info("ContinuePLayAdInNextCard",this.trakingElement.getBoundingClientRect()),this.log.info("ContinuePLayAdInNextCard",e),0===e?(m.default.off("window:scroll:change",this._testElementInViewPort,this),this.model.set("elementOutOfView",!0)):this._watchScroll()}},{key:"_watchScroll",value:function(){m.default.once("window:scroll:change",this._testElementInViewPort.bind(this),this)}}]),t}(u.StateManager);e.exports=g}]);